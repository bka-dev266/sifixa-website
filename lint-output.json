[{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\components\\Button.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\components\\ErrorBoundary.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\components\\GlobalBackground.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\components\\Notifications.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\components\\ProtectedRoute.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\components\\ThemeToggle.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\context\\AuthContext.jsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\n  14 |     const [loading, setLoading] = useState(true);\n  15 |     const [sessionExpiry, setSessionExpiry] = useState(null);\n> 16 |     const [lastActivity, setLastActivity] = useState(Date.now());\n     |                                                      ^^^^^^^^^^ Cannot call impure function\n  17 |\n  18 |     // Load user profile and role from database\n  19 |     const loadUserData = useCallback(async (authUser) => {","line":16,"column":54,"nodeType":null,"endLine":16,"endColumn":64},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`logout` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  87 |\n  88 |             if (inactivityTime >= SESSION_TIMEOUT) {\n> 89 |                 logout();\n     |                 ^^^^^^ `logout` accessed before it is declared\n  90 |                 return;\n  91 |             }\n  92 |\n\n  159 |     };\n  160 |\n> 161 |     const logout = useCallback(async () => {\n      |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 162 |         try {\n      | ^^^^^^^^^^^^^\n> 163 |             await authService.signOut();\n      ΓÇª\n      | ^^^^^^^^^^^^^\n> 170 |         setSessionExpiry(null);\n      | ^^^^^^^^^^^^^\n> 171 |     }, []);\n      | ^^^^^^^^^^^^ `logout` is declared here\n  172 |\n  173 |     const updateUser = async (updates) => {\n  174 |         if (!user) return;","line":89,"column":17,"nodeType":null,"endLine":89,"endColumn":23},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'logout'. Either include it or remove the dependency array.","line":100,"column":8,"nodeType":"ArrayExpression","endLine":100,"endColumn":28,"suggestions":[{"desc":"Update the dependencies array to be: [user, lastActivity, logout]","fix":{"range":[3546,3566],"text":"[user, lastActivity, logout]"}}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":230,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":230,"endColumn":21}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useState, useContext, useEffect, useCallback } from 'react';\r\nimport * as authService from '../services/authService';\r\n\r\nconst AuthContext = createContext(null);\r\n\r\n// Session timeout in milliseconds (30 minutes)\r\nconst SESSION_TIMEOUT = 30 * 60 * 1000;\r\nconst SESSION_CHECK_INTERVAL = 60 * 1000; // Check every minute\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [user, setUser] = useState(null);           // Supabase auth user\r\n    const [profile, setProfile] = useState(null);     // DB profile\r\n    const [role, setRole] = useState(null);           // Primary role (admin/employee/customer)\r\n    const [loading, setLoading] = useState(true);\r\n    const [sessionExpiry, setSessionExpiry] = useState(null);\r\n    const [lastActivity, setLastActivity] = useState(Date.now());\r\n\r\n    // Load user profile and role from database\r\n    const loadUserData = useCallback(async (authUser) => {\r\n        if (!authUser) {\r\n            setProfile(null);\r\n            setRole(null);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const [userProfile, primaryRole] = await Promise.all([\r\n                authService.getProfile(authUser.id),\r\n                authService.getPrimaryRole(authUser.id)\r\n            ]);\r\n\r\n            setProfile(userProfile);\r\n            setRole(primaryRole);\r\n        } catch (error) {\r\n            console.error('Error loading user data:', error);\r\n            setProfile(null);\r\n            setRole('customer'); // Default fallback\r\n        }\r\n    }, []);\r\n\r\n    // Initialize auth state from Supabase session\r\n    useEffect(() => {\r\n        const initAuth = async () => {\r\n            try {\r\n                const session = await authService.getSession();\r\n                if (session?.user) {\r\n                    setUser(session.user);\r\n                    await loadUserData(session.user);\r\n                    setSessionExpiry(Date.now() + SESSION_TIMEOUT);\r\n                }\r\n            } catch (error) {\r\n                console.error('Auth init error:', error);\r\n            }\r\n            setLoading(false);\r\n        };\r\n\r\n        initAuth();\r\n\r\n        // Listen for auth state changes\r\n        const { data: { subscription } } = authService.onAuthStateChange(\r\n            async (event, session) => {\r\n                console.log('Auth state changed:', event);\r\n\r\n                if (event === 'SIGNED_IN' && session?.user) {\r\n                    setUser(session.user);\r\n                    await loadUserData(session.user);\r\n                    setSessionExpiry(Date.now() + SESSION_TIMEOUT);\r\n                } else if (event === 'SIGNED_OUT') {\r\n                    setUser(null);\r\n                    setProfile(null);\r\n                    setRole(null);\r\n                    setSessionExpiry(null);\r\n                }\r\n            }\r\n        );\r\n\r\n        return () => subscription.unsubscribe();\r\n    }, [loadUserData]);\r\n\r\n    // Session expiry checker\r\n    useEffect(() => {\r\n        if (!user) return;\r\n\r\n        const checkSession = () => {\r\n            const now = Date.now();\r\n            const inactivityTime = now - lastActivity;\r\n\r\n            if (inactivityTime >= SESSION_TIMEOUT) {\r\n                logout();\r\n                return;\r\n            }\r\n\r\n            // Update session expiry\r\n            const newExpiry = now + SESSION_TIMEOUT;\r\n            setSessionExpiry(newExpiry);\r\n        };\r\n\r\n        const interval = setInterval(checkSession, SESSION_CHECK_INTERVAL);\r\n        return () => clearInterval(interval);\r\n    }, [user, lastActivity]);\r\n\r\n    // Activity listener - extend session on user activity\r\n    useEffect(() => {\r\n        if (!user) return;\r\n\r\n        const updateActivity = () => {\r\n            const now = Date.now();\r\n            setLastActivity(now);\r\n            const newExpiry = now + SESSION_TIMEOUT;\r\n            setSessionExpiry(newExpiry);\r\n        };\r\n\r\n        // Listen for user activity\r\n        const events = ['mousedown', 'keydown', 'scroll', 'touchstart'];\r\n        events.forEach(event => {\r\n            window.addEventListener(event, updateActivity, { passive: true });\r\n        });\r\n\r\n        return () => {\r\n            events.forEach(event => {\r\n                window.removeEventListener(event, updateActivity);\r\n            });\r\n        };\r\n    }, [user]);\r\n\r\n    const login = async (email, password) => {\r\n        try {\r\n            const { user: authUser } = await authService.signIn(email, password);\r\n            const now = Date.now();\r\n            const expiry = now + SESSION_TIMEOUT;\r\n\r\n            setUser(authUser);\r\n            await loadUserData(authUser);\r\n            setSessionExpiry(expiry);\r\n            setLastActivity(now);\r\n\r\n            return { success: true, user: authUser };\r\n        } catch (error) {\r\n            console.error('Login error:', error);\r\n            return { success: false, error: error.message };\r\n        }\r\n    };\r\n\r\n    const signup = async (email, password, metadata = {}) => {\r\n        try {\r\n            const { user: authUser } = await authService.signUp(email, password, metadata);\r\n\r\n            // Note: User may need to verify email depending on Supabase settings\r\n            if (authUser) {\r\n                setUser(authUser);\r\n                await loadUserData(authUser);\r\n            }\r\n\r\n            return { success: true, user: authUser };\r\n        } catch (error) {\r\n            console.error('Signup error:', error);\r\n            return { success: false, error: error.message };\r\n        }\r\n    };\r\n\r\n    const logout = useCallback(async () => {\r\n        try {\r\n            await authService.signOut();\r\n        } catch (error) {\r\n            console.error('Logout error:', error);\r\n        }\r\n        setUser(null);\r\n        setProfile(null);\r\n        setRole(null);\r\n        setSessionExpiry(null);\r\n    }, []);\r\n\r\n    const updateUser = async (updates) => {\r\n        if (!user) return;\r\n\r\n        try {\r\n            const updatedProfile = await authService.updateProfile(user.id, updates);\r\n            setProfile(updatedProfile);\r\n            return { success: true, profile: updatedProfile };\r\n        } catch (error) {\r\n            return { success: false, error: error.message };\r\n        }\r\n    };\r\n\r\n    const getSessionInfo = () => {\r\n        if (!sessionExpiry) return null;\r\n        const remainingMs = sessionExpiry - Date.now();\r\n        const remainingMinutes = Math.max(0, Math.floor(remainingMs / 60000));\r\n        return {\r\n            expiresAt: new Date(sessionExpiry).toLocaleTimeString(),\r\n            remainingMinutes\r\n        };\r\n    };\r\n\r\n    // Computed properties for convenience\r\n    const isAuthenticated = !!user;\r\n    const isAdmin = role === 'admin';\r\n    const isEmployee = role === 'employee' || role === 'admin';\r\n    const isStaff = isEmployee;\r\n    const isCustomer = role === 'customer';\r\n\r\n    return (\r\n        <AuthContext.Provider value={{\r\n            // State\r\n            user,\r\n            profile,\r\n            role,\r\n            loading,\r\n            sessionExpiry,\r\n\r\n            // Computed\r\n            isAuthenticated,\r\n            isAdmin,\r\n            isEmployee,\r\n            isStaff,\r\n            isCustomer,\r\n\r\n            // Actions\r\n            login,\r\n            signup,\r\n            logout,\r\n            updateUser,\r\n            getSessionInfo\r\n        }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\context\\NotificationContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":5,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":5,"endColumn":30}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useCallback } from 'react';\r\n\r\nconst NotificationContext = createContext(null);\r\n\r\nexport const useNotifications = () => {\r\n    const context = useContext(NotificationContext);\r\n    if (!context) {\r\n        throw new Error('useNotifications must be used within NotificationProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\nexport const NotificationProvider = ({ children }) => {\r\n    const [notifications, setNotifications] = useState([]);\r\n    const [toasts, setToasts] = useState([]);\r\n\r\n    const addNotification = useCallback((notification) => {\r\n        const newNotification = {\r\n            id: Date.now(),\r\n            timestamp: new Date().toISOString(),\r\n            read: false,\r\n            ...notification\r\n        };\r\n\r\n        setNotifications(prev => [newNotification, ...prev].slice(0, 50)); // Keep last 50\r\n\r\n        // Also show as toast\r\n        setToasts(prev => [...prev, newNotification]);\r\n\r\n        // Auto-remove toast after 5 seconds\r\n        setTimeout(() => {\r\n            setToasts(prev => prev.filter(t => t.id !== newNotification.id));\r\n        }, 5000);\r\n\r\n        return newNotification;\r\n    }, []);\r\n\r\n    const markAsRead = useCallback((id) => {\r\n        setNotifications(prev =>\r\n            prev.map(n => n.id === id ? { ...n, read: true } : n)\r\n        );\r\n    }, []);\r\n\r\n    const markAllAsRead = useCallback(() => {\r\n        setNotifications(prev => prev.map(n => ({ ...n, read: true })));\r\n    }, []);\r\n\r\n    const clearNotifications = useCallback(() => {\r\n        setNotifications([]);\r\n    }, []);\r\n\r\n    const dismissToast = useCallback((id) => {\r\n        setToasts(prev => prev.filter(t => t.id !== id));\r\n    }, []);\r\n\r\n    const unreadCount = notifications.filter(n => !n.read).length;\r\n\r\n    return (\r\n        <NotificationContext.Provider value={{\r\n            notifications,\r\n            toasts,\r\n            unreadCount,\r\n            addNotification,\r\n            markAsRead,\r\n            markAllAsRead,\r\n            clearNotifications,\r\n            dismissToast\r\n        }}>\r\n            {children}\r\n        </NotificationContext.Provider>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\context\\ThemeContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":27,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":27,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect } from 'react';\r\n\r\nconst ThemeContext = createContext();\r\n\r\nexport const ThemeProvider = ({ children }) => {\r\n    const [theme, setTheme] = useState(() => {\r\n        const savedTheme = localStorage.getItem('theme');\r\n        return savedTheme || 'dark'; // Default to dark\r\n    });\r\n\r\n    useEffect(() => {\r\n        document.documentElement.setAttribute('data-theme', theme);\r\n        localStorage.setItem('theme', theme);\r\n    }, [theme]);\r\n\r\n    const toggleTheme = () => {\r\n        setTheme((prevTheme) => (prevTheme === 'dark' ? 'light' : 'dark'));\r\n    };\r\n\r\n    return (\r\n        <ThemeContext.Provider value={{ theme, toggleTheme }}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useTheme = () => useContext(ThemeContext);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\i18n.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\apiClient.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\appointments.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\customers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\devices.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\discounts.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'now' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":161,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":161,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"now"},"fix":{"range":[4941,4978],"text":""},"desc":"Remove unused variable 'now'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Supabase API - Discounts & Coupons Module\r\nimport { supabase } from '../supabase';\r\n\r\nexport const discountsApi = {\r\n    // Get all discounts\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('discounts')\r\n            .select('*')\r\n            .order('name');\r\n\r\n        if (error) return [];\r\n        return data.map(d => ({\r\n            id: d.id,\r\n            name: d.name,\r\n            discountType: d.discount_type,\r\n            value: d.value,\r\n            isActive: d.is_active,\r\n            startAt: d.start_at,\r\n            endAt: d.end_at,\r\n            createdAt: d.created_at\r\n        }));\r\n    },\r\n\r\n    // Get active discounts\r\n    getActive: async () => {\r\n        const now = new Date().toISOString();\r\n\r\n        const { data, error } = await supabase\r\n            .from('discounts')\r\n            .select('*')\r\n            .eq('is_active', true)\r\n            .or(`start_at.is.null,start_at.lte.${now}`)\r\n            .or(`end_at.is.null,end_at.gte.${now}`)\r\n            .order('name');\r\n\r\n        if (error) return [];\r\n        return data.map(d => ({\r\n            id: d.id,\r\n            name: d.name,\r\n            discountType: d.discount_type,\r\n            value: d.value\r\n        }));\r\n    },\r\n\r\n    // Create discount\r\n    create: async (discountData) => {\r\n        const { data, error } = await supabase\r\n            .from('discounts')\r\n            .insert([{\r\n                name: discountData.name,\r\n                discount_type: discountData.discountType, // 'percent' or 'fixed'\r\n                value: discountData.value,\r\n                is_active: discountData.isActive !== false,\r\n                start_at: discountData.startAt || null,\r\n                end_at: discountData.endAt || null\r\n            }])\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        return {\r\n            id: data.id,\r\n            name: data.name,\r\n            discountType: data.discount_type,\r\n            value: data.value\r\n        };\r\n    },\r\n\r\n    // Update discount\r\n    update: async (id, updates) => {\r\n        const dbUpdates = {};\r\n        if (updates.name !== undefined) dbUpdates.name = updates.name;\r\n        if (updates.discountType !== undefined) dbUpdates.discount_type = updates.discountType;\r\n        if (updates.value !== undefined) dbUpdates.value = updates.value;\r\n        if (updates.isActive !== undefined) dbUpdates.is_active = updates.isActive;\r\n        if (updates.startAt !== undefined) dbUpdates.start_at = updates.startAt;\r\n        if (updates.endAt !== undefined) dbUpdates.end_at = updates.endAt;\r\n\r\n        const { data, error } = await supabase\r\n            .from('discounts')\r\n            .update(dbUpdates)\r\n            .eq('id', id)\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    // Delete discount\r\n    delete: async (id) => {\r\n        const { error } = await supabase\r\n            .from('discounts')\r\n            .delete()\r\n            .eq('id', id);\r\n\r\n        if (error) throw error;\r\n        return true;\r\n    },\r\n\r\n    // ============== COUPONS ==============\r\n\r\n    // Get all coupons\r\n    getCoupons: async () => {\r\n        const { data, error } = await supabase\r\n            .from('coupons')\r\n            .select(`\r\n                *,\r\n                discounts(name, discount_type, value)\r\n            `)\r\n            .order('code');\r\n\r\n        if (error) return [];\r\n        return data.map(c => ({\r\n            id: c.id,\r\n            code: c.code,\r\n            discountId: c.discount_id,\r\n            discountName: c.discounts?.name,\r\n            discountType: c.discounts?.discount_type,\r\n            discountValue: c.discounts?.value,\r\n            maxUses: c.max_uses,\r\n            timesUsed: c.times_used,\r\n            isActive: c.is_active,\r\n            validFrom: c.valid_from,\r\n            validTo: c.valid_to,\r\n            createdAt: c.created_at\r\n        }));\r\n    },\r\n\r\n    // Create coupon\r\n    createCoupon: async (couponData) => {\r\n        const { data, error } = await supabase\r\n            .from('coupons')\r\n            .insert([{\r\n                code: couponData.code.toUpperCase(),\r\n                discount_id: couponData.discountId,\r\n                max_uses: couponData.maxUses || null,\r\n                is_active: couponData.isActive !== false,\r\n                valid_from: couponData.validFrom || null,\r\n                valid_to: couponData.validTo || null\r\n            }])\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            if (error.code === '23505') {\r\n                throw new Error('Coupon code already exists');\r\n            }\r\n            throw error;\r\n        }\r\n        return {\r\n            id: data.id,\r\n            code: data.code,\r\n            isActive: data.is_active\r\n        };\r\n    },\r\n\r\n    // Validate coupon\r\n    validateCoupon: async (code) => {\r\n        const now = new Date().toISOString();\r\n\r\n        const { data, error } = await supabase\r\n            .from('coupons')\r\n            .select(`\r\n                *,\r\n                discounts(name, discount_type, value, is_active)\r\n            `)\r\n            .eq('code', code.toUpperCase())\r\n            .eq('is_active', true)\r\n            .single();\r\n\r\n        if (error || !data) {\r\n            return { valid: false, error: 'Invalid coupon code' };\r\n        }\r\n\r\n        // Check if discount is active\r\n        if (!data.discounts?.is_active) {\r\n            return { valid: false, error: 'Discount is no longer active' };\r\n        }\r\n\r\n        // Check validity dates\r\n        if (data.valid_from && new Date(data.valid_from) > new Date()) {\r\n            return { valid: false, error: 'Coupon is not yet valid' };\r\n        }\r\n        if (data.valid_to && new Date(data.valid_to) < new Date()) {\r\n            return { valid: false, error: 'Coupon has expired' };\r\n        }\r\n\r\n        // Check max uses\r\n        if (data.max_uses && data.times_used >= data.max_uses) {\r\n            return { valid: false, error: 'Coupon has reached maximum uses' };\r\n        }\r\n\r\n        return {\r\n            valid: true,\r\n            coupon: {\r\n                id: data.id,\r\n                code: data.code,\r\n                discountType: data.discounts.discount_type,\r\n                discountValue: data.discounts.value,\r\n                discountName: data.discounts.name\r\n            }\r\n        };\r\n    },\r\n\r\n    // Update coupon\r\n    updateCoupon: async (id, updates) => {\r\n        const dbUpdates = {};\r\n        if (updates.isActive !== undefined) dbUpdates.is_active = updates.isActive;\r\n        if (updates.maxUses !== undefined) dbUpdates.max_uses = updates.maxUses;\r\n        if (updates.validFrom !== undefined) dbUpdates.valid_from = updates.validFrom;\r\n        if (updates.validTo !== undefined) dbUpdates.valid_to = updates.validTo;\r\n\r\n        const { data, error } = await supabase\r\n            .from('coupons')\r\n            .update(dbUpdates)\r\n            .eq('id', id)\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    // Delete coupon\r\n    deleteCoupon: async (id) => {\r\n        const { error } = await supabase\r\n            .from('coupons')\r\n            .delete()\r\n            .eq('id', id);\r\n\r\n        if (error) throw error;\r\n        return true;\r\n    },\r\n\r\n    // Get coupon usage stats\r\n    getCouponStats: async (couponId) => {\r\n        const { data, error } = await supabase\r\n            .from('coupon_redemptions')\r\n            .select(`\r\n                id,\r\n                redeemed_at,\r\n                sales_orders(order_number, total)\r\n            `)\r\n            .eq('coupon_id', couponId)\r\n            .order('redeemed_at', { ascending: false });\r\n\r\n        if (error) return [];\r\n        return data.map(r => ({\r\n            redeemedAt: r.redeemed_at,\r\n            orderNumber: r.sales_orders?.order_number,\r\n            orderTotal: r.sales_orders?.total\r\n        }));\r\n    },\r\n\r\n    // Get discount types\r\n    getDiscountTypes: () => [\r\n        { value: 'percent', label: 'Percentage' },\r\n        { value: 'fixed', label: 'Fixed Amount' }\r\n    ]\r\n};\r\n\r\nexport default discountsApi;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\inventory.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\invoices.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\messaging.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\payments.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\purchaseOrders.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\registers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\reporting.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\salesOrders.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'data' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":305,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":305,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[10084,10089],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'voidReasonId' is assigned a value but never used.","line":386,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":386,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"voidReasonId"},"fix":{"range":[12807,12828],"text":""},"desc":"Remove unused variable 'voidReasonId'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Supabase API - Sales Orders Module\r\n// POS sales order management\r\nimport { supabase } from '../supabase';\r\n\r\n// Generate order number\r\nconst generateOrderNumber = () => {\r\n    const date = new Date();\r\n    const y = date.getFullYear().toString().slice(-2);\r\n    const m = String(date.getMonth() + 1).padStart(2, '0');\r\n    const d = String(date.getDate()).padStart(2, '0');\r\n    const rand = Math.random().toString(36).substring(2, 6).toUpperCase();\r\n    return `ORD-${y}${m}${d}-${rand}`;\r\n};\r\n\r\nexport const salesOrdersApi = {\r\n    // Get all orders\r\n    getAll: async (filters = {}) => {\r\n        let query = supabase\r\n            .from('sales_orders')\r\n            .select(`\r\n                *,\r\n                registers(id, name),\r\n                customers(id, first_name, last_name),\r\n                profiles:cashier_id(full_name)\r\n            `)\r\n            .is('deleted_at', null)\r\n            .order('created_at', { ascending: false });\r\n\r\n        if (filters.status) {\r\n            query = query.eq('status', filters.status);\r\n        }\r\n        if (filters.registerId) {\r\n            query = query.eq('register_id', filters.registerId);\r\n        }\r\n\r\n        const { data, error } = await query;\r\n        if (error) return [];\r\n\r\n        return data.map(o => ({\r\n            id: o.id,\r\n            orderNumber: o.order_number,\r\n            registerId: o.register_id,\r\n            registerName: o.registers?.name,\r\n            customerId: o.customer_id,\r\n            customerName: o.customers ?\r\n                `${o.customers.first_name} ${o.customers.last_name || ''}`.trim() : null,\r\n            ticketId: o.ticket_id,\r\n            status: o.status,\r\n            cashier: o.profiles?.full_name,\r\n            subtotal: o.subtotal,\r\n            taxTotal: o.tax_total,\r\n            discountTotal: o.discount_total,\r\n            total: o.total,\r\n            openedAt: o.opened_at,\r\n            closedAt: o.closed_at\r\n        }));\r\n    },\r\n\r\n    // Get order by ID with items\r\n    getById: async (id) => {\r\n        const { data, error } = await supabase\r\n            .from('sales_orders')\r\n            .select(`\r\n                *,\r\n                registers(id, name),\r\n                customers(id, first_name, last_name, email, phone),\r\n                profiles:cashier_id(full_name),\r\n                sales_order_items(\r\n                    id, qty, unit_price, discount_amount, tax_amount, line_total, cost_at_sale,\r\n                    items(id, name, sku, item_type)\r\n                ),\r\n                sales_order_discounts(\r\n                    id, applied_amount,\r\n                    discounts(id, name, discount_type, value),\r\n                    coupons(id, code)\r\n                )\r\n            `)\r\n            .eq('id', id)\r\n            .single();\r\n\r\n        if (error) return null;\r\n\r\n        return {\r\n            id: data.id,\r\n            orderNumber: data.order_number,\r\n            registerId: data.register_id,\r\n            registerName: data.registers?.name,\r\n            customerId: data.customer_id,\r\n            customer: data.customers ? {\r\n                id: data.customers.id,\r\n                name: `${data.customers.first_name} ${data.customers.last_name || ''}`.trim(),\r\n                email: data.customers.email,\r\n                phone: data.customers.phone\r\n            } : null,\r\n            ticketId: data.ticket_id,\r\n            status: data.status,\r\n            cashier: data.profiles?.full_name,\r\n            cashierId: data.cashier_id,\r\n            items: data.sales_order_items?.map(i => ({\r\n                id: i.id,\r\n                itemId: i.items?.id,\r\n                name: i.items?.name,\r\n                sku: i.items?.sku,\r\n                type: i.items?.item_type,\r\n                qty: i.qty,\r\n                unitPrice: i.unit_price,\r\n                discount: i.discount_amount,\r\n                tax: i.tax_amount,\r\n                total: i.line_total,\r\n                cost: i.cost_at_sale\r\n            })) || [],\r\n            discounts: data.sales_order_discounts?.map(d => ({\r\n                id: d.id,\r\n                discountName: d.discounts?.name,\r\n                couponCode: d.coupons?.code,\r\n                amount: d.applied_amount\r\n            })) || [],\r\n            subtotal: data.subtotal,\r\n            taxTotal: data.tax_total,\r\n            discountTotal: data.discount_total,\r\n            total: data.total,\r\n            notes: data.notes,\r\n            openedAt: data.opened_at,\r\n            closedAt: data.closed_at\r\n        };\r\n    },\r\n\r\n    // Create new order\r\n    create: async (orderData) => {\r\n        const orderNumber = generateOrderNumber();\r\n\r\n        const { data, error } = await supabase\r\n            .from('sales_orders')\r\n            .insert([{\r\n                order_number: orderNumber,\r\n                register_id: orderData.registerId,\r\n                customer_id: orderData.customerId || null,\r\n                ticket_id: orderData.ticketId || null,\r\n                status: 'open',\r\n                cashier_id: orderData.cashierId,\r\n                notes: orderData.notes || null\r\n            }])\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        return {\r\n            id: data.id,\r\n            orderNumber: data.order_number,\r\n            status: data.status,\r\n            openedAt: data.opened_at\r\n        };\r\n    },\r\n\r\n    // Add item to order\r\n    addItem: async (orderId, itemId, qty, unitPrice, discount = 0, tax = 0, costAtSale = null) => {\r\n        const lineTotal = (qty * unitPrice) - discount + tax;\r\n\r\n        const { data, error } = await supabase\r\n            .from('sales_order_items')\r\n            .insert([{\r\n                sales_order_id: orderId,\r\n                item_id: itemId,\r\n                qty: qty,\r\n                unit_price: unitPrice,\r\n                discount_amount: discount,\r\n                tax_amount: tax,\r\n                line_total: lineTotal,\r\n                cost_at_sale: costAtSale\r\n            }])\r\n            .select(`\r\n                *,\r\n                items(name, sku)\r\n            `)\r\n            .single();\r\n\r\n        if (error) throw error;\r\n\r\n        // Recalculate order totals\r\n        await salesOrdersApi.recalculateTotals(orderId);\r\n\r\n        return {\r\n            id: data.id,\r\n            itemName: data.items?.name,\r\n            qty: data.qty,\r\n            unitPrice: data.unit_price,\r\n            total: data.line_total\r\n        };\r\n    },\r\n\r\n    // Update item quantity\r\n    updateItem: async (orderItemId, updates) => {\r\n        const dbUpdates = {};\r\n        if (updates.qty !== undefined) dbUpdates.qty = updates.qty;\r\n        if (updates.discount !== undefined) dbUpdates.discount_amount = updates.discount;\r\n\r\n        // Get current item to recalculate\r\n        const { data: current } = await supabase\r\n            .from('sales_order_items')\r\n            .select('unit_price, tax_amount, sales_order_id')\r\n            .eq('id', orderItemId)\r\n            .single();\r\n\r\n        if (updates.qty) {\r\n            dbUpdates.line_total = (updates.qty * current.unit_price) -\r\n                (updates.discount || 0) + (current.tax_amount || 0);\r\n        }\r\n\r\n        const { data, error } = await supabase\r\n            .from('sales_order_items')\r\n            .update(dbUpdates)\r\n            .eq('id', orderItemId)\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n\r\n        // Recalculate order totals\r\n        await salesOrdersApi.recalculateTotals(current.sales_order_id);\r\n\r\n        return data;\r\n    },\r\n\r\n    // Remove item from order\r\n    removeItem: async (orderItemId) => {\r\n        // Get order ID first\r\n        const { data: item } = await supabase\r\n            .from('sales_order_items')\r\n            .select('sales_order_id')\r\n            .eq('id', orderItemId)\r\n            .single();\r\n\r\n        const { error } = await supabase\r\n            .from('sales_order_items')\r\n            .update({ deleted_at: new Date().toISOString() })\r\n            .eq('id', orderItemId);\r\n\r\n        if (error) throw error;\r\n\r\n        // Recalculate order totals\r\n        if (item?.sales_order_id) {\r\n            await salesOrdersApi.recalculateTotals(item.sales_order_id);\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    // Apply discount to order\r\n    applyDiscount: async (orderId, discountId, appliedAmount) => {\r\n        const { data, error } = await supabase\r\n            .from('sales_order_discounts')\r\n            .insert([{\r\n                sales_order_id: orderId,\r\n                discount_id: discountId,\r\n                applied_amount: appliedAmount\r\n            }])\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n\r\n        // Recalculate totals\r\n        await salesOrdersApi.recalculateTotals(orderId);\r\n\r\n        return data;\r\n    },\r\n\r\n    // Apply coupon\r\n    applyCoupon: async (orderId, couponCode) => {\r\n        // Find coupon\r\n        const { data: coupon, error: couponError } = await supabase\r\n            .from('coupons')\r\n            .select(`\r\n                *,\r\n                discounts(discount_type, value)\r\n            `)\r\n            .eq('code', couponCode)\r\n            .eq('is_active', true)\r\n            .single();\r\n\r\n        if (couponError || !coupon) {\r\n            throw new Error('Invalid coupon code');\r\n        }\r\n\r\n        // Check if already used max times\r\n        if (coupon.max_uses && coupon.times_used >= coupon.max_uses) {\r\n            throw new Error('Coupon has reached maximum uses');\r\n        }\r\n\r\n        // Calculate discount amount based on order subtotal\r\n        const { data: order } = await supabase\r\n            .from('sales_orders')\r\n            .select('subtotal')\r\n            .eq('id', orderId)\r\n            .single();\r\n\r\n        let appliedAmount = 0;\r\n        if (coupon.discounts?.discount_type === 'percent') {\r\n            appliedAmount = (order.subtotal * coupon.discounts.value) / 100;\r\n        } else {\r\n            appliedAmount = coupon.discounts?.value || 0;\r\n        }\r\n\r\n        // Apply the discount\r\n        const { data, error } = await supabase\r\n            .from('sales_order_discounts')\r\n            .insert([{\r\n                sales_order_id: orderId,\r\n                discount_id: coupon.discount_id,\r\n                coupon_id: coupon.id,\r\n                applied_amount: appliedAmount\r\n            }])\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n\r\n        // Increment coupon usage\r\n        await supabase\r\n            .from('coupons')\r\n            .update({ times_used: coupon.times_used + 1 })\r\n            .eq('id', coupon.id);\r\n\r\n        // Record redemption\r\n        await supabase.from('coupon_redemptions').insert([{\r\n            coupon_id: coupon.id,\r\n            sales_order_id: orderId\r\n        }]);\r\n\r\n        // Recalculate totals\r\n        await salesOrdersApi.recalculateTotals(orderId);\r\n\r\n        return { couponCode, appliedAmount };\r\n    },\r\n\r\n    // Recalculate order totals\r\n    recalculateTotals: async (orderId) => {\r\n        // Get all items\r\n        const { data: items } = await supabase\r\n            .from('sales_order_items')\r\n            .select('unit_price, qty, discount_amount, tax_amount, line_total')\r\n            .eq('sales_order_id', orderId)\r\n            .is('deleted_at', null);\r\n\r\n        // Get all discounts\r\n        const { data: discounts } = await supabase\r\n            .from('sales_order_discounts')\r\n            .select('applied_amount')\r\n            .eq('sales_order_id', orderId);\r\n\r\n        const subtotal = items?.reduce((sum, i) => sum + (i.qty * i.unit_price), 0) || 0;\r\n        const taxTotal = items?.reduce((sum, i) => sum + (i.tax_amount || 0), 0) || 0;\r\n        const itemDiscounts = items?.reduce((sum, i) => sum + (i.discount_amount || 0), 0) || 0;\r\n        const orderDiscounts = discounts?.reduce((sum, d) => sum + (d.applied_amount || 0), 0) || 0;\r\n        const discountTotal = itemDiscounts + orderDiscounts;\r\n        const total = subtotal + taxTotal - discountTotal;\r\n\r\n        await supabase\r\n            .from('sales_orders')\r\n            .update({\r\n                subtotal,\r\n                tax_total: taxTotal,\r\n                discount_total: discountTotal,\r\n                total: Math.max(0, total)\r\n            })\r\n            .eq('id', orderId);\r\n    },\r\n\r\n    // Complete order\r\n    complete: async (orderId) => {\r\n        const { data, error } = await supabase\r\n            .from('sales_orders')\r\n            .update({\r\n                status: 'completed',\r\n                closed_at: new Date().toISOString()\r\n            })\r\n            .eq('id', orderId)\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    // Void order\r\n    void: async (orderId, voidReasonId = null, note = null) => {\r\n        const { data, error } = await supabase\r\n            .from('sales_orders')\r\n            .update({\r\n                status: 'voided',\r\n                closed_at: new Date().toISOString(),\r\n                notes: note\r\n            })\r\n            .eq('id', orderId)\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    // Get order statuses\r\n    getStatuses: () => [\r\n        { value: 'open', label: 'Open' },\r\n        { value: 'completed', label: 'Completed' },\r\n        { value: 'voided', label: 'Voided' },\r\n        { value: 'refunded', label: 'Refunded' },\r\n        { value: 'partially_refunded', label: 'Partially Refunded' }\r\n    ],\r\n\r\n    // Get today's sales summary\r\n    getTodaySummary: async () => {\r\n        const today = new Date().toISOString().split('T')[0];\r\n\r\n        const { data, error } = await supabase\r\n            .from('sales_orders')\r\n            .select('total, status')\r\n            .gte('closed_at', `${today}T00:00:00`)\r\n            .lte('closed_at', `${today}T23:59:59`)\r\n            .eq('status', 'completed');\r\n\r\n        if (error) return { count: 0, total: 0 };\r\n\r\n        return {\r\n            count: data.length,\r\n            total: data.reduce((sum, o) => sum + (o.total || 0), 0)\r\n        };\r\n    }\r\n};\r\n\r\nexport default salesOrdersApi;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\services.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\storeSettings.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\suppliers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\tickets.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\users.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\api\\warranties.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\authService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\landingService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\mockApi.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'password' is defined but never used.","line":39,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"password"},"fix":{"range":[1461,1471],"text":""},"desc":"Remove unused variable 'password'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":61,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":248,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":248,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":289,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":289,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":389,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":389,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":409,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":409,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":454,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":454,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":479,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":479,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":492,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":492,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":514,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":514,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":526,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":526,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":568,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":568,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'author' is defined but never used.","line":583,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":583,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"author"},"fix":{"range":[20942,20950],"text":""},"desc":"Remove unused variable 'author'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'newPassword' is defined but never used.","line":616,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":616,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"newPassword"},"fix":{"range":[22005,22018],"text":""},"desc":"Remove unused variable 'newPassword'."}]}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Supabase Integration - Database Only (No localStorage!)\r\n// All data is stored in Supabase database\r\nimport { supabase } from './supabase';\r\n\r\n// Import modular APIs - Core\r\nimport { customersApi } from './api/customers';\r\nimport { servicesApi } from './api/services';\r\nimport { inventoryApi } from './api/inventory';\r\nimport { usersApi } from './api/users';\r\nimport { appointmentsApi } from './api/appointments';\r\nimport { devicesApi } from './api/devices';\r\n\r\n// Import modular APIs - Tickets & Warranties\r\nimport { ticketsApi } from './api/tickets';\r\nimport { warrantiesApi } from './api/warranties';\r\n\r\n// Import modular APIs - POS & Sales\r\nimport { registersApi } from './api/registers';\r\nimport { salesOrdersApi } from './api/salesOrders';\r\nimport { paymentsApi } from './api/payments';\r\nimport { discountsApi } from './api/discounts';\r\n\r\n// Import modular APIs - Inventory\r\nimport { purchaseOrdersApi } from './api/purchaseOrders';\r\nimport { suppliersApi } from './api/suppliers';\r\n\r\n// Import modular APIs - Invoicing & Messaging\r\nimport { invoicesApi } from './api/invoices';\r\nimport { messagingApi } from './api/messaging';\r\n\r\n// Import modular APIs - Reporting & Settings\r\nimport { reportingApi } from './api/reporting';\r\nimport { storeSettingsApi } from './api/storeSettings';\r\n\r\n\r\n// ============== MOCK API - SUPABASE ONLY ==============\r\nexport const mockApi = {\r\n    // ============== AUTHENTICATION ==============\r\n    login: async (username, password) => {\r\n        // Query profiles table for user\r\n        try {\r\n            const { data: profile, error } = await supabase\r\n                .from('profiles')\r\n                .select('*')\r\n                .eq('username', username)\r\n                .single();\r\n\r\n            if (error || !profile) {\r\n                throw new Error('Invalid credentials');\r\n            }\r\n\r\n            return {\r\n                id: profile.id,\r\n                username: profile.username,\r\n                name: profile.full_name,\r\n                email: profile.email,\r\n                role: 'admin',\r\n                isStaff: true,\r\n                permissions: {}\r\n            };\r\n        } catch (err) {\r\n            throw new Error('Invalid credentials');\r\n        }\r\n    },\r\n\r\n    logout: async () => {\r\n        await supabase.auth.signOut();\r\n        return true;\r\n    },\r\n\r\n    // ============== CUSTOMERS ==============\r\n    getCustomers: () => customersApi.getAll(),\r\n    getCustomer: (id) => customersApi.getById(id),\r\n    addCustomer: (data) => customersApi.create(data),\r\n    updateCustomer: (id, updates) => customersApi.update(id, updates),\r\n    deleteCustomer: (id) => customersApi.delete(id),\r\n\r\n    // ============== SERVICES ==============\r\n    getServices: () => servicesApi.getAll(),\r\n    getService: (id) => servicesApi.getById(id),\r\n    addService: (data) => servicesApi.create(data),\r\n    updateService: (id, updates) => servicesApi.update(id, updates),\r\n    deleteService: (id) => servicesApi.delete(id),\r\n    toggleServiceActive: (id) => servicesApi.toggleActive(id),\r\n\r\n    // ============== INVENTORY ==============\r\n    getInventory: () => inventoryApi.getAll(),\r\n    getInventoryItem: (id) => inventoryApi.getById(id),\r\n    addInventoryItem: (data) => inventoryApi.create(data),\r\n    updateInventoryItem: (id, updates) => inventoryApi.update(id, updates),\r\n    deleteInventoryItem: (id) => inventoryApi.delete(id),\r\n    adjustStock: (id, adjustment, reason) => inventoryApi.adjustStock(id, adjustment, reason),\r\n    getReorderAlerts: async () => {\r\n        // Return empty array for now to avoid query errors\r\n        return [];\r\n    },\r\n\r\n    // ============== USERS ==============\r\n    getUsers: () => usersApi.getAll(),\r\n    getEmployees: () => usersApi.getStaff(),\r\n    getUser: (id) => usersApi.getById(id),\r\n    addUser: (data) => usersApi.create(data),\r\n    updateUser: (id, updates) => usersApi.update(id, updates),\r\n    deleteUser: (id) => usersApi.delete(id),\r\n    getRoles: () => usersApi.getRoles(),\r\n\r\n    // ============== APPOINTMENTS/BOOKINGS ==============\r\n    getBookings: () => appointmentsApi.getAll(),\r\n    getBooking: (id) => appointmentsApi.getById(id),\r\n\r\n    addBooking: async (bookingData) => {\r\n        try {\r\n            console.log('Starting booking creation with data:', bookingData);\r\n\r\n            // First, check if customer exists by email\r\n            const { data: existingCustomers, error: customerCheckError } = await supabase\r\n                .from('customers')\r\n                .select('id')\r\n                .eq('email', bookingData.customer.email)\r\n                .limit(1);\r\n\r\n            if (customerCheckError) {\r\n                console.error('Customer check error:', customerCheckError);\r\n                throw customerCheckError;\r\n            }\r\n\r\n            let customerId;\r\n            if (existingCustomers && existingCustomers.length > 0) {\r\n                customerId = existingCustomers[0].id;\r\n                console.log('Found existing customer:', customerId);\r\n            } else {\r\n                // Create new customer\r\n                const nameParts = bookingData.customer.name.split(' ');\r\n                const firstName = nameParts[0];\r\n                const lastName = nameParts.slice(1).join(' ') || null;\r\n\r\n                console.log('Creating new customer:', { firstName, lastName, email: bookingData.customer.email });\r\n\r\n                const { data: newCustomer, error: customerError } = await supabase\r\n                    .from('customers')\r\n                    .insert([{\r\n                        first_name: firstName,\r\n                        last_name: lastName,\r\n                        email: bookingData.customer.email,\r\n                        phone: bookingData.customer.phone\r\n                    }])\r\n                    .select()\r\n                    .single();\r\n\r\n                if (customerError) {\r\n                    console.error('Customer creation error:', customerError);\r\n                    throw customerError;\r\n                }\r\n                customerId = newCustomer.id;\r\n                console.log('Created new customer:', customerId);\r\n            }\r\n\r\n            // Get default store\r\n            const { data: store, error: storeError } = await supabase\r\n                .from('stores')\r\n                .select('id')\r\n                .eq('is_active', true)\r\n                .limit(1)\r\n                .single();\r\n\r\n            if (storeError || !store) {\r\n                console.error('Store fetch error:', storeError);\r\n                throw new Error('No active store found');\r\n            }\r\n\r\n            // Get time slot ID from name\r\n            const { data: timeSlot, error: timeSlotError } = await supabase\r\n                .from('time_slots')\r\n                .select('id, start_time')\r\n                .eq('name', bookingData.time)\r\n                .eq('is_active', true)\r\n                .limit(1)\r\n                .single();\r\n\r\n            if (timeSlotError || !timeSlot) {\r\n                console.error('Time slot fetch error:', timeSlotError);\r\n                // Use default time if no slot found\r\n                console.warn('Using default time since no time slot found');\r\n            }\r\n\r\n            const scheduledTime = timeSlot ? timeSlot.start_time : '09:00:00';\r\n\r\n            // Create appointment with all required fields\r\n            const appointmentData = {\r\n                customer_id: customerId,\r\n                store_id: store.id,\r\n                scheduled_date: bookingData.date,\r\n                scheduled_start: scheduledTime,  // Fixed: column is scheduled_start\r\n                time_slot_id: timeSlot ? timeSlot.id : null,\r\n                status: 'scheduled',\r\n                notes: `Device: ${bookingData.device}\\nService: ${bookingData.serviceType}\\nIssue: ${bookingData.issue}\\nPriority: ${bookingData.priorityLevel}`\r\n            };\r\n\r\n            console.log('Creating appointment with data:', appointmentData);\r\n\r\n            const { data: appointment, error: appointmentError } = await supabase\r\n                .from('appointments')\r\n                .insert([appointmentData])\r\n                .select()\r\n                .single();\r\n\r\n            if (appointmentError) {\r\n                console.error('Appointment creation error:', appointmentError);\r\n                throw appointmentError;\r\n            }\r\n\r\n            console.log('Created appointment:', appointment);\r\n\r\n            // Generate tracking number\r\n            const trackingNumber = `SFX-${new Date().toISOString().slice(0, 10).replace(/-/g, '')}-${appointment.id.slice(0, 4).toUpperCase()}`;\r\n\r\n            return {\r\n                id: appointment.id,\r\n                trackingNumber: trackingNumber,\r\n                ...bookingData\r\n            };\r\n        } catch (error) {\r\n            console.error('Add booking error:', error);\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    updateBooking: (id, updates) => appointmentsApi.update(id, updates),\r\n    updateBookingStatus: async (id, status) => appointmentsApi.update(id, { status }),\r\n    cancelBooking: (id) => appointmentsApi.cancel(id),\r\n    getBookingsByCustomer: (customerId) => appointmentsApi.getByCustomer(customerId),\r\n\r\n    // ============== STATISTICS ==============\r\n    getStats: async () => {\r\n        try {\r\n            const [bookings, services, customers] = await Promise.all([\r\n                appointmentsApi.getAll(),\r\n                servicesApi.getAll(),\r\n                customersApi.getAll()\r\n            ]);\r\n            return {\r\n                totalBookings: bookings.length,\r\n                pendingBookings: bookings.filter(b => b.status === 'scheduled').length,\r\n                completedToday: bookings.filter(b => b.status === 'completed').length,\r\n                activeServices: services.filter(s => s.active).length,\r\n                totalCustomers: customers.length\r\n            };\r\n        } catch (err) {\r\n            return {\r\n                totalBookings: 0,\r\n                pendingBookings: 0,\r\n                completedToday: 0,\r\n                activeServices: 0,\r\n                totalCustomers: 0\r\n            };\r\n        }\r\n    },\r\n\r\n    // ============== REPAIR TRACKING ==============\r\n    // Note: repair_ticket_history table may not exist - return empty array\r\n    getRepairTracking: async (bookingId) => {\r\n        // Skip if no booking ID provided\r\n        if (!bookingId) return [];\r\n\r\n        try {\r\n            // Try to fetch from repair_ticket_history table\r\n            const { data, error } = await supabase\r\n                .from('repair_ticket_history')\r\n                .select('*')\r\n                .eq('ticket_id', bookingId)\r\n                .order('changed_at', { ascending: true });\r\n\r\n            // If table doesn't exist (404) or other error, return empty array silently\r\n            if (error) {\r\n                // Don't log 404 errors - table may not exist\r\n                if (error.code !== 'PGRST116') {\r\n                    console.debug('Repair tracking not available:', error.message);\r\n                }\r\n                return [];\r\n            }\r\n\r\n            return (data || []).map(r => ({\r\n                id: r.id,\r\n                booking_id: r.ticket_id,\r\n                status: r.new_status,\r\n                message: r.note,\r\n                created_at: r.changed_at\r\n            }));\r\n        } catch (err) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    addRepairTrackingLog: async (bookingId, status, message, staffMember) => {\r\n        const { data, error } = await supabase\r\n            .from('repair_ticket_history')\r\n            .insert([{\r\n                ticket_id: bookingId,\r\n                new_status: status,\r\n                note: message,\r\n                changed_by: staffMember\r\n            }])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    // ============== SETTINGS ==============\r\n    getSettings: async () => {\r\n        return {\r\n            storeName: 'SIFIXA',\r\n            phone: '555-0100',\r\n            email: 'info@sifixa.com',\r\n            address: '123 Repair St',\r\n            businessHours: 'Mon-Sat: 9AM - 8PM',\r\n            taxRate: 8.0\r\n        };\r\n    },\r\n\r\n    updateSettings: async (updates) => {\r\n        return updates;\r\n    },\r\n\r\n    // ============== TIME SLOTS ==============\r\n    getTimeSlots: async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('time_slots')\r\n                .select('*')\r\n                .eq('is_active', true)\r\n                .order('start_time');\r\n\r\n            if (error) {\r\n                console.error('Time slots fetch error:', error);\r\n                // Return default time slots\r\n                return [\r\n                    { id: '1', name: 'Morning', startTime: '09:00', endTime: '12:00', maxBookings: 3, active: true },\r\n                    { id: '2', name: 'Afternoon', startTime: '12:00', endTime: '16:00', maxBookings: 3, active: true },\r\n                    { id: '3', name: 'Evening', startTime: '16:00', endTime: '20:00', maxBookings: 3, active: true }\r\n                ];\r\n            }\r\n\r\n            if (!data || data.length === 0) {\r\n                // Return default time slots if database is empty\r\n                return [\r\n                    { id: '1', name: 'Morning', startTime: '09:00', endTime: '12:00', maxBookings: 3, active: true },\r\n                    { id: '2', name: 'Afternoon', startTime: '12:00', endTime: '16:00', maxBookings: 3, active: true },\r\n                    { id: '3', name: 'Evening', startTime: '16:00', endTime: '20:00', maxBookings: 3, active: true }\r\n                ];\r\n            }\r\n\r\n            return data.map(s => ({\r\n                id: s.id,\r\n                name: s.name,\r\n                startTime: s.start_time,\r\n                endTime: s.end_time,\r\n                maxBookings: s.max_bookings,\r\n                active: s.is_active\r\n            }));\r\n        } catch (err) {\r\n            console.error('Time slots error:', err);\r\n            // Return default time slots\r\n            return [\r\n                { id: '1', name: 'Morning', startTime: '09:00', endTime: '12:00', maxBookings: 3, active: true },\r\n                { id: '2', name: 'Afternoon', startTime: '12:00', endTime: '16:00', maxBookings: 3, active: true },\r\n                { id: '3', name: 'Evening', startTime: '16:00', endTime: '20:00', maxBookings: 3, active: true }\r\n            ];\r\n        }\r\n    },\r\n\r\n    // ============== STORE PRODUCTS (POS) ==============\r\n    getStoreProducts: async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('items')\r\n                .select('*')\r\n                .eq('item_type', 'product')\r\n                .eq('is_active', true)\r\n                .is('deleted_at', null);\r\n            if (error) return [];\r\n            return data.map(p => ({\r\n                id: p.id,\r\n                name: p.name,\r\n                sku: p.sku,\r\n                price: 0,\r\n                category: 'products'\r\n            }));\r\n        } catch (err) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    // ============== SALES ==============\r\n    getSales: async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('sales_orders')\r\n                .select('*')\r\n                .order('created_at', { ascending: false });\r\n            if (error) return [];\r\n            return data.map(s => ({\r\n                id: s.id,\r\n                customer: 'Customer',\r\n                total: s.total_amount,\r\n                status: s.status,\r\n                date: s.created_at\r\n            }));\r\n        } catch (err) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    addSale: async (saleData) => {\r\n        const { data, error } = await supabase\r\n            .from('sales_orders')\r\n            .insert([{\r\n                customer_id: saleData.customerId || null,\r\n                store_id: saleData.storeId,\r\n                status: 'completed',\r\n                subtotal: saleData.subtotal,\r\n                tax_amount: saleData.tax,\r\n                total_amount: saleData.total\r\n            }])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    getSalesStats: async () => {\r\n        return {\r\n            salesToday: 0,\r\n            transactionsToday: 0,\r\n            totalSales: 0\r\n        };\r\n    },\r\n\r\n    // ============== PURCHASE ORDERS ==============\r\n    getPurchaseOrders: async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('purchase_orders')\r\n                .select('*')\r\n                .order('created_at', { ascending: false });\r\n            if (error) return [];\r\n            return data.map(po => ({\r\n                id: po.id,\r\n                supplier: 'Supplier',\r\n                status: po.status,\r\n                total: po.total,\r\n                date: po.created_at\r\n            }));\r\n        } catch (err) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    // ============== ANALYTICS ==============\r\n    getAnalyticsData: async () => {\r\n        return {\r\n            revenue: { thisMonth: 0, lastMonth: 0 },\r\n            bookings: { thisMonth: 0, lastMonth: 0 }\r\n        };\r\n    },\r\n\r\n    getRevenueByService: async () => {\r\n        return [];\r\n    },\r\n\r\n    getBookingsByStatus: async () => {\r\n        try {\r\n            const bookings = await appointmentsApi.getAll();\r\n            const statusCounts = {};\r\n            bookings.forEach(b => {\r\n                statusCounts[b.status] = (statusCounts[b.status] || 0) + 1;\r\n            });\r\n            return Object.entries(statusCounts).map(([name, value]) => ({ name, value }));\r\n        } catch (err) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    getInventoryAnalytics: async () => {\r\n        try {\r\n            const inventory = await inventoryApi.getAll();\r\n            return {\r\n                totalItems: inventory.length,\r\n                lowStockItems: 0,\r\n                totalValue: 0\r\n            };\r\n        } catch (err) {\r\n            return { totalItems: 0, lowStockItems: 0, totalValue: 0 };\r\n        }\r\n    },\r\n\r\n    getSupportStats: async () => {\r\n        return {\r\n            openTickets: 0,\r\n            resolvedToday: 0,\r\n            avgResponseTime: '2h 15m'\r\n        };\r\n    },\r\n\r\n    // ============== CUSTOMER MESSAGES ==============\r\n    getCustomerMessages: async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('notification_events')\r\n                .select('*')\r\n                .order('created_at', { ascending: false });\r\n            if (error) return [];\r\n            return data;\r\n        } catch (err) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    getMessageTemplates: async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('notification_templates')\r\n                .select('*');\r\n            if (error) return [];\r\n            return data;\r\n        } catch (err) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    sendCustomerMessage: async (messageData) => {\r\n        const { data, error } = await supabase\r\n            .from('notification_events')\r\n            .insert([{\r\n                customer_id: messageData.customerId,\r\n                type: messageData.type || 'message',\r\n                title: messageData.subject,\r\n                message: messageData.body\r\n            }])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    fillMessageTemplate: (template, data) => {\r\n        let filled = template.body;\r\n        Object.entries(data).forEach(([key, value]) => {\r\n            filled = filled.replace(new RegExp(`{{${key}}}`, 'g'), value);\r\n        });\r\n        return filled;\r\n    },\r\n\r\n    // ============== REPAIRS READY FOR PICKUP ==============\r\n    getRepairsReadyForPickup: async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('repair_tickets')\r\n                .select('*')\r\n                .eq('status', 'ready_for_pickup');\r\n            if (error) return [];\r\n            return data.map(r => ({\r\n                bookingId: r.id,\r\n                device: r.device_description,\r\n                customer: 'Customer',\r\n                total: r.final_price || 0\r\n            }));\r\n        } catch (err) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    markRepairPickedUp: async (bookingId) => {\r\n        const { error } = await supabase\r\n            .from('repair_tickets')\r\n            .update({ status: 'completed' })\r\n            .eq('id', bookingId);\r\n        if (error) throw error;\r\n        return true;\r\n    },\r\n\r\n    // ============== BOOKING OPERATIONS ==============\r\n    addBookingNote: async (bookingId, note, author) => {\r\n        return appointmentsApi.update(bookingId, { notes: note });\r\n    },\r\n\r\n    updateBookingPriority: async (bookingId, priority) => {\r\n        return appointmentsApi.update(bookingId, { priority });\r\n    },\r\n\r\n    updateBookingCostEstimate: async (bookingId, cost) => {\r\n        return appointmentsApi.update(bookingId, { estimatedCost: cost });\r\n    },\r\n\r\n    startRepairTimer: async (bookingId) => {\r\n        return { id: bookingId, timerStarted: new Date().toISOString() };\r\n    },\r\n\r\n    stopRepairTimer: async (bookingId) => {\r\n        return { id: bookingId, timerStopped: new Date().toISOString() };\r\n    },\r\n\r\n    // ============== LEGACY COMPATIBILITY ==============\r\n    updateProductStock: async (id, change) => {\r\n        return inventoryApi.adjustStock(id, change, 'stock_update');\r\n    },\r\n\r\n    updateStoreProduct: async (id, updates) => {\r\n        return inventoryApi.update(id, updates);\r\n    },\r\n\r\n    updatePurchaseOrder: async (orderId, updates) => {\r\n        return updates;\r\n    },\r\n\r\n    resetUserPassword: async (userId, newPassword) => {\r\n        console.log('Password reset requested for user:', userId);\r\n        return true;\r\n    },\r\n\r\n    getCustomerUserByEmail: async (email) => {\r\n        const { data, error } = await supabase\r\n            .from('profiles')\r\n            .select('id, username, full_name, email')\r\n            .eq('email', email)\r\n            .single();\r\n        if (error) return null;\r\n        return data;\r\n    },\r\n\r\n    // ============== WEBSITE CONTENT (CMS) ==============\r\n    getWebsiteContent: async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('website_content')\r\n                .select('*');\r\n\r\n            if (error || !data || data.length === 0) {\r\n                // Return default content\r\n                return {\r\n                    hero: {\r\n                        title: 'Professional Device Repair',\r\n                        subtitle: 'Fast, reliable repairs for phones, tablets, and computers',\r\n                        ctaText: 'Book Repair',\r\n                        ctaLink: '/booking'\r\n                    },\r\n                    whyChooseUs: {\r\n                        items: [\r\n                            { title: 'Expert Technicians', description: 'Certified professionals' },\r\n                            { title: 'Quality Parts', description: 'OEM and premium parts' },\r\n                            { title: 'Fast Service', description: 'Same-day repairs available' }\r\n                        ]\r\n                    },\r\n                    howItWorks: {\r\n                        steps: [\r\n                            { step: 1, title: 'Book Online', description: 'Schedule your repair' },\r\n                            { step: 2, title: 'Drop Off', description: 'Bring your device' },\r\n                            { step: 3, title: 'Repair', description: 'We fix it' },\r\n                            { step: 4, title: 'Pick Up', description: 'Get your device back' }\r\n                        ]\r\n                    },\r\n                    footer: {\r\n                        companyName: 'SIFIXA',\r\n                        phone: '555-0100',\r\n                        email: 'info@sifixa.com'\r\n                    }\r\n                };\r\n            }\r\n\r\n            // Transform array to object keyed by section\r\n            const content = {};\r\n            data.forEach(item => {\r\n                content[item.section] = item.content;\r\n            });\r\n            return content;\r\n        } catch (err) {\r\n            console.error('Website content error:', err);\r\n            return {};\r\n        }\r\n    },\r\n\r\n    updateWebsiteContent: async (section, content) => {\r\n        const { data, error } = await supabase\r\n            .from('website_content')\r\n            .upsert([{ section, content, updated_at: new Date().toISOString() }])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    // ============== NEW: DEVICES ==============\r\n    getDevices: (customerId) => devicesApi.getByCustomer(customerId),\r\n    getDevice: (id) => devicesApi.getById(id),\r\n    addDevice: (data) => devicesApi.create(data),\r\n    updateDevice: (id, updates) => devicesApi.update(id, updates),\r\n    deleteDevice: (id) => devicesApi.delete(id),\r\n\r\n    // ============== NEW: REPAIR TICKETS ==============\r\n    getTickets: (filters) => ticketsApi.getAll(filters),\r\n    getTicket: (id) => ticketsApi.getById(id),\r\n    createTicket: (data) => ticketsApi.create(data),\r\n    updateTicket: (id, updates) => ticketsApi.update(id, updates),\r\n    updateTicketStatus: (id, status, message, changedBy) => ticketsApi.updateStatus(id, status, message, changedBy),\r\n    getTicketStatusHistory: (ticketId) => ticketsApi.getStatusHistory(ticketId),\r\n    assignTechnician: (ticketId, techId) => ticketsApi.assignTechnician(ticketId, techId),\r\n    unassignTechnician: (ticketId, techId) => ticketsApi.unassignTechnician(ticketId, techId),\r\n    addTicketNote: (ticketId, note, isInternal, createdBy) => ticketsApi.addNote(ticketId, note, isInternal, createdBy),\r\n    getTicketNotes: (ticketId, includeInternal) => ticketsApi.getNotes(ticketId, includeInternal),\r\n    addTicketService: (ticketId, serviceItemId, qty, unitPrice, discount, tax) => ticketsApi.addService(ticketId, serviceItemId, qty, unitPrice, discount, tax),\r\n    addTicketPart: (ticketId, partItemId, qty, unitPrice, cost, usedBy) => ticketsApi.addPart(ticketId, partItemId, qty, unitPrice, cost, usedBy),\r\n    getTicketsByCustomer: (customerId) => ticketsApi.getByCustomer(customerId),\r\n    searchTicketByNumber: (ticketNumber) => ticketsApi.getByTicketNumber(ticketNumber),\r\n    deleteTicket: (id) => ticketsApi.delete(id),\r\n\r\n    // ============== NEW: WARRANTIES ==============\r\n    createWarranty: (ticketId, expiresAt, terms) => warrantiesApi.create(ticketId, expiresAt, terms),\r\n    getWarrantyByTicket: (ticketId) => warrantiesApi.getByTicket(ticketId),\r\n    getWarrantiesByCustomer: (customerId) => warrantiesApi.getByCustomer(customerId),\r\n    createWarrantyClaim: (originalTicketId, claimTicketId, reason) => warrantiesApi.createClaim(originalTicketId, claimTicketId, reason),\r\n    getExpiringWarranties: (days) => warrantiesApi.getExpiring(days),\r\n\r\n    // ============== NEW: POS REGISTERS ==============\r\n    getRegisters: () => registersApi.getAll(),\r\n    getRegister: (id) => registersApi.getById(id),\r\n    createRegister: (data) => registersApi.create(data),\r\n    openShift: (registerId, openedBy, openingCash) => registersApi.openShift(registerId, openedBy, openingCash),\r\n    closeShift: (shiftId, closedBy, closingCash, notes) => registersApi.closeShift(shiftId, closedBy, closingCash, notes),\r\n    getCurrentShift: (registerId) => registersApi.getCurrentShift(registerId),\r\n    recordCashDrop: (shiftId, amount, note, createdBy) => registersApi.recordCashDrop(shiftId, amount, note, createdBy),\r\n    recordPayout: (shiftId, amount, note, createdBy) => registersApi.recordPayout(shiftId, amount, note, createdBy),\r\n\r\n    // ============== NEW: SALES ORDERS ==============\r\n    getSalesOrders: (filters) => salesOrdersApi.getAll(filters),\r\n    getSalesOrder: (id) => salesOrdersApi.getById(id),\r\n    createSalesOrder: (data) => salesOrdersApi.create(data),\r\n    addOrderItem: (orderId, itemId, qty, unitPrice, discount, tax, cost) => salesOrdersApi.addItem(orderId, itemId, qty, unitPrice, discount, tax, cost),\r\n    updateOrderItem: (orderItemId, updates) => salesOrdersApi.updateItem(orderItemId, updates),\r\n    removeOrderItem: (orderItemId) => salesOrdersApi.removeItem(orderItemId),\r\n    applyDiscount: (orderId, discountId, appliedAmount) => salesOrdersApi.applyDiscount(orderId, discountId, appliedAmount),\r\n    applyCoupon: (orderId, couponCode) => salesOrdersApi.applyCoupon(orderId, couponCode),\r\n    completeSalesOrder: (orderId) => salesOrdersApi.complete(orderId),\r\n    voidSalesOrder: (orderId, reasonId, note) => salesOrdersApi.void(orderId, reasonId, note),\r\n    getTodaySalesSummary: () => salesOrdersApi.getTodaySummary(),\r\n\r\n    // ============== NEW: PAYMENTS ==============\r\n    createPayment: (paymentData) => paymentsApi.create(paymentData),\r\n    getPaymentsByOrder: (orderId) => paymentsApi.getByOrder(orderId),\r\n    getPaymentsByInvoice: (invoiceId) => paymentsApi.getByInvoice(invoiceId),\r\n    processRefund: (paymentData) => paymentsApi.processRefund(paymentData),\r\n    createRefund: (refundData) => paymentsApi.createRefund(refundData),\r\n    getRefundsByOrder: (orderId) => paymentsApi.getRefundsByOrder(orderId),\r\n    getDailyPaymentSummary: (date) => paymentsApi.getDailySummary(date),\r\n\r\n    // ============== NEW: DISCOUNTS & COUPONS ==============\r\n    getDiscounts: () => discountsApi.getAll(),\r\n    getActiveDiscounts: () => discountsApi.getActive(),\r\n    createDiscount: (data) => discountsApi.create(data),\r\n    updateDiscount: (id, updates) => discountsApi.update(id, updates),\r\n    deleteDiscount: (id) => discountsApi.delete(id),\r\n    getCoupons: () => discountsApi.getCoupons(),\r\n    createCoupon: (data) => discountsApi.createCoupon(data),\r\n    validateCoupon: (code) => discountsApi.validateCoupon(code),\r\n    updateCoupon: (id, updates) => discountsApi.updateCoupon(id, updates),\r\n\r\n    // ============== NEW: SUPPLIERS ==============\r\n    getSuppliers: () => suppliersApi.getAll(),\r\n    getSupplier: (id) => suppliersApi.getById(id),\r\n    createSupplier: (data) => suppliersApi.create(data),\r\n    updateSupplier: (id, updates) => suppliersApi.update(id, updates),\r\n    deleteSupplier: (id) => suppliersApi.delete(id),\r\n\r\n    // ============== NEW: PURCHASE ORDERS (Enhanced) ==============\r\n    createPurchaseOrder: (data) => purchaseOrdersApi.create(data),\r\n    getPurchaseOrder: (id) => purchaseOrdersApi.getById(id),\r\n    addPurchaseOrderItem: (poId, itemId, qty, unitCost) => purchaseOrdersApi.addItem(poId, itemId, qty, unitCost),\r\n    sendPurchaseOrder: (poId) => purchaseOrdersApi.send(poId),\r\n    receivePurchaseOrder: (poId, items, receivedBy, notes) => purchaseOrdersApi.receiveGoods(poId, items, receivedBy, notes),\r\n    cancelPurchaseOrder: (poId) => purchaseOrdersApi.cancel(poId),\r\n\r\n    // ============== NEW: INVOICES ==============\r\n    getInvoices: (filters) => invoicesApi.getAll(filters),\r\n    getInvoice: (id) => invoicesApi.getById(id),\r\n    getInvoicesByCustomer: (customerId) => invoicesApi.getByCustomer(customerId),\r\n    getInvoiceByTicket: (ticketId) => invoicesApi.getByTicket(ticketId),\r\n    createInvoice: (data) => invoicesApi.create(data),\r\n    addInvoiceItem: (invoiceId, itemData) => invoicesApi.addItem(invoiceId, itemData),\r\n    sendInvoice: (invoiceId) => invoicesApi.send(invoiceId),\r\n    markInvoicePaid: (invoiceId) => invoicesApi.markPaid(invoiceId),\r\n    voidInvoice: (invoiceId) => invoicesApi.void(invoiceId),\r\n    getOverdueInvoices: () => invoicesApi.getOverdue(),\r\n\r\n    // ============== NEW: MESSAGING ==============\r\n    getConversations: (customerId) => messagingApi.getConversations(customerId),\r\n    createConversation: (customerId, ticketId, subject) => messagingApi.createConversation(customerId, ticketId, subject),\r\n    getMessages: (conversationId) => messagingApi.getMessages(conversationId),\r\n    sendMessage: (messageData) => messagingApi.sendMessage(messageData),\r\n    markMessageRead: (messageId) => messagingApi.markAsRead(messageId),\r\n    getNotifications: (customerId, limit) => messagingApi.getNotifications(customerId, limit),\r\n    createNotification: (data) => messagingApi.createNotification(data),\r\n    markNotificationRead: (notificationId) => messagingApi.markNotificationRead(notificationId),\r\n\r\n    // ============== NEW: REPORTING & ANALYTICS ==============\r\n    getDashboardSummary: () => reportingApi.getDashboardSummary(),\r\n    getDailyMetrics: (date) => reportingApi.getDailyMetrics(date),\r\n    getMetricsRange: (startDate, endDate) => reportingApi.getMetricsRange(startDate, endDate),\r\n    getAuditLog: (filters) => reportingApi.getAuditLog(filters),\r\n    logAuditAction: (actionData) => reportingApi.logAction(actionData),\r\n    getTicketsByStatusChart: () => reportingApi.getTicketsByStatus(),\r\n    getRevenueByDayChart: (days) => reportingApi.getRevenueByDay(days),\r\n\r\n    // ============== NEW: STORE SETTINGS ==============\r\n    getStores: () => storeSettingsApi.getStores(),\r\n    getStore: (id) => storeSettingsApi.getStoreById(id),\r\n    updateStore: (id, updates) => storeSettingsApi.updateStore(id, updates),\r\n    getStoreSettings: (storeId) => storeSettingsApi.getSettings(storeId),\r\n    updateStoreSettings: (storeId, settings) => storeSettingsApi.updateSettings(storeId, settings),\r\n    getTaxRates: () => storeSettingsApi.getTaxRates(),\r\n    createTaxRate: (data) => storeSettingsApi.createTaxRate(data),\r\n    updateTaxRate: (id, updates) => storeSettingsApi.updateTaxRate(id, updates),\r\n    getTimeSlotsConfig: (storeId) => storeSettingsApi.getTimeSlots(storeId),\r\n    createTimeSlot: (data) => storeSettingsApi.createTimeSlot(data),\r\n    updateTimeSlot: (id, updates) => storeSettingsApi.updateTimeSlot(id, updates),\r\n\r\n    // ============== DIRECT API ACCESS ==============\r\n    // Provide direct access to all API modules for advanced usage\r\n    apis: {\r\n        customers: customersApi,\r\n        users: usersApi,\r\n        devices: devicesApi,\r\n        appointments: appointmentsApi,\r\n        tickets: ticketsApi,\r\n        warranties: warrantiesApi,\r\n        services: servicesApi,\r\n        inventory: inventoryApi,\r\n        registers: registersApi,\r\n        salesOrders: salesOrdersApi,\r\n        payments: paymentsApi,\r\n        discounts: discountsApi,\r\n        purchaseOrders: purchaseOrdersApi,\r\n        suppliers: suppliersApi,\r\n        invoices: invoicesApi,\r\n        messaging: messagingApi,\r\n        reporting: reportingApi,\r\n        storeSettings: storeSettingsApi\r\n    }\r\n};\r\n\r\nexport default mockApi;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\supabase.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\services\\supabaseApi.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'data' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":611,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":611,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[20663,20668],"text":""},"desc":"Remove unused variable 'data'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Supabase API Service\r\n// This module provides database operations using Supabase\r\n\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\n// Supabase configuration\r\nconst supabaseUrl = 'https://ybbdnyszdfvlbxlfdtvv.supabase.co';\r\nconst supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InliYmRueXN6ZGZ2bGJ4bGZkdHZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzNjM3MzcsImV4cCI6MjA4MTkzOTczN30.YnwtSdn2LfPt6oEq6TilIGIdJ1qkUfhE-uDkhUI3R08';\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseKey);\r\n\r\n// Helper to check if Supabase is available\r\nconst isSupabaseAvailable = async () => {\r\n    try {\r\n        const { error } = await supabase.from('users').select('id').limit(1);\r\n        return !error;\r\n    } catch {\r\n        return false;\r\n    }\r\n};\r\n\r\n// ============== USERS ==============\r\nexport const usersApi = {\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('users')\r\n            .select('*')\r\n            .order('id');\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    getById: async (id) => {\r\n        const { data, error } = await supabase\r\n            .from('users')\r\n            .select('*')\r\n            .eq('id', id)\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    getByUsername: async (username) => {\r\n        const { data, error } = await supabase\r\n            .from('users')\r\n            .select('*')\r\n            .eq('username', username)\r\n            .single();\r\n        if (error && error.code !== 'PGRST116') throw error;\r\n        return data;\r\n    },\r\n\r\n    create: async (userData) => {\r\n        const { data, error } = await supabase\r\n            .from('users')\r\n            .insert([userData])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    update: async (id, updates) => {\r\n        const { data, error } = await supabase\r\n            .from('users')\r\n            .update({ ...updates, updated_at: new Date().toISOString() })\r\n            .eq('id', id)\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    delete: async (id) => {\r\n        const { error } = await supabase\r\n            .from('users')\r\n            .delete()\r\n            .eq('id', id);\r\n        if (error) throw error;\r\n        return true;\r\n    }\r\n};\r\n\r\n// ============== CUSTOMERS ==============\r\nexport const customersApi = {\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('customers')\r\n            .select('*')\r\n            .order('id');\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    getById: async (id) => {\r\n        const { data, error } = await supabase\r\n            .from('customers')\r\n            .select('*')\r\n            .eq('id', id)\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    getByEmail: async (email) => {\r\n        const { data, error } = await supabase\r\n            .from('customers')\r\n            .select('*')\r\n            .eq('email', email)\r\n            .single();\r\n        if (error && error.code !== 'PGRST116') throw error;\r\n        return data;\r\n    },\r\n\r\n    create: async (customerData) => {\r\n        const { data, error } = await supabase\r\n            .from('customers')\r\n            .insert([customerData])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    update: async (id, updates) => {\r\n        const { data, error } = await supabase\r\n            .from('customers')\r\n            .update({ ...updates, updated_at: new Date().toISOString() })\r\n            .eq('id', id)\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    delete: async (id) => {\r\n        const { error } = await supabase\r\n            .from('customers')\r\n            .delete()\r\n            .eq('id', id);\r\n        if (error) throw error;\r\n        return true;\r\n    }\r\n};\r\n\r\n// ============== SERVICES ==============\r\nexport const servicesApi = {\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('services')\r\n            .select('*')\r\n            .order('id');\r\n        if (error) throw error;\r\n        // Map to match existing format\r\n        return data.map(s => ({\r\n            id: s.id,\r\n            name: s.name,\r\n            description: s.description,\r\n            priceMin: s.price_min,\r\n            priceMax: s.price_max,\r\n            category: s.category,\r\n            active: s.active\r\n        }));\r\n    },\r\n\r\n    getActive: async () => {\r\n        const { data, error } = await supabase\r\n            .from('services')\r\n            .select('*')\r\n            .eq('active', true)\r\n            .order('id');\r\n        if (error) throw error;\r\n        return data.map(s => ({\r\n            id: s.id,\r\n            name: s.name,\r\n            description: s.description,\r\n            priceMin: s.price_min,\r\n            priceMax: s.price_max,\r\n            category: s.category,\r\n            active: s.active\r\n        }));\r\n    },\r\n\r\n    create: async (serviceData) => {\r\n        const { data, error } = await supabase\r\n            .from('services')\r\n            .insert([{\r\n                name: serviceData.name,\r\n                description: serviceData.description,\r\n                price_min: serviceData.priceMin,\r\n                price_max: serviceData.priceMax,\r\n                category: serviceData.category,\r\n                active: serviceData.active ?? true\r\n            }])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    update: async (id, updates) => {\r\n        const dbUpdates = {};\r\n        if (updates.name !== undefined) dbUpdates.name = updates.name;\r\n        if (updates.description !== undefined) dbUpdates.description = updates.description;\r\n        if (updates.priceMin !== undefined) dbUpdates.price_min = updates.priceMin;\r\n        if (updates.priceMax !== undefined) dbUpdates.price_max = updates.priceMax;\r\n        if (updates.category !== undefined) dbUpdates.category = updates.category;\r\n        if (updates.active !== undefined) dbUpdates.active = updates.active;\r\n        dbUpdates.updated_at = new Date().toISOString();\r\n\r\n        const { data, error } = await supabase\r\n            .from('services')\r\n            .update(dbUpdates)\r\n            .eq('id', id)\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    delete: async (id) => {\r\n        const { error } = await supabase\r\n            .from('services')\r\n            .delete()\r\n            .eq('id', id);\r\n        if (error) throw error;\r\n        return true;\r\n    }\r\n};\r\n\r\n// ============== TIME SLOTS ==============\r\nexport const timeSlotsApi = {\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('time_slots')\r\n            .select('*')\r\n            .order('id');\r\n        if (error) throw error;\r\n        return data.map(s => ({\r\n            id: s.id,\r\n            name: s.name,\r\n            startTime: s.start_time,\r\n            endTime: s.end_time,\r\n            maxBookings: s.max_bookings,\r\n            active: s.active\r\n        }));\r\n    },\r\n\r\n    getActive: async () => {\r\n        const { data, error } = await supabase\r\n            .from('time_slots')\r\n            .select('*')\r\n            .eq('active', true)\r\n            .order('id');\r\n        if (error) throw error;\r\n        return data.map(s => ({\r\n            id: s.id,\r\n            name: s.name,\r\n            startTime: s.start_time,\r\n            endTime: s.end_time,\r\n            maxBookings: s.max_bookings,\r\n            active: s.active\r\n        }));\r\n    },\r\n\r\n    update: async (id, updates) => {\r\n        const dbUpdates = {};\r\n        if (updates.name !== undefined) dbUpdates.name = updates.name;\r\n        if (updates.startTime !== undefined) dbUpdates.start_time = updates.startTime;\r\n        if (updates.endTime !== undefined) dbUpdates.end_time = updates.endTime;\r\n        if (updates.maxBookings !== undefined) dbUpdates.max_bookings = updates.maxBookings;\r\n        if (updates.active !== undefined) dbUpdates.active = updates.active;\r\n\r\n        const { data, error } = await supabase\r\n            .from('time_slots')\r\n            .update(dbUpdates)\r\n            .eq('id', id)\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    }\r\n};\r\n\r\n// ============== BOOKINGS ==============\r\nexport const bookingsApi = {\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('bookings')\r\n            .select('*')\r\n            .order('created_at', { ascending: false });\r\n        if (error) throw error;\r\n        return data.map(b => ({\r\n            id: b.id,\r\n            device: b.device,\r\n            serviceType: b.service_type,\r\n            issue: b.issue,\r\n            date: b.date,\r\n            time: b.time,\r\n            customer: {\r\n                name: b.customer_name,\r\n                email: b.customer_email,\r\n                phone: b.customer_phone\r\n            },\r\n            status: b.status,\r\n            priority: b.priority,\r\n            priorityLevel: b.priority_level,\r\n            priorityFee: b.priority_fee,\r\n            baseRepairPrice: b.base_repair_price,\r\n            totalPrice: b.total_price,\r\n            costEstimate: b.cost_estimate,\r\n            notes: b.notes || [],\r\n            timeTracking: b.time_tracking || { startTime: null, endTime: null, totalMinutes: 0 }\r\n        }));\r\n    },\r\n\r\n    getById: async (id) => {\r\n        const { data, error } = await supabase\r\n            .from('bookings')\r\n            .select('*')\r\n            .eq('id', id)\r\n            .single();\r\n        if (error) throw error;\r\n        return {\r\n            id: data.id,\r\n            device: data.device,\r\n            serviceType: data.service_type,\r\n            issue: data.issue,\r\n            date: data.date,\r\n            time: data.time,\r\n            customer: {\r\n                name: data.customer_name,\r\n                email: data.customer_email,\r\n                phone: data.customer_phone\r\n            },\r\n            status: data.status,\r\n            priority: data.priority,\r\n            priorityLevel: data.priority_level,\r\n            priorityFee: data.priority_fee,\r\n            baseRepairPrice: data.base_repair_price,\r\n            totalPrice: data.total_price,\r\n            costEstimate: data.cost_estimate,\r\n            notes: data.notes || [],\r\n            timeTracking: data.time_tracking || { startTime: null, endTime: null, totalMinutes: 0 }\r\n        };\r\n    },\r\n\r\n    create: async (bookingData) => {\r\n        const id = Date.now().toString();\r\n        const { data, error } = await supabase\r\n            .from('bookings')\r\n            .insert([{\r\n                id,\r\n                device: bookingData.device,\r\n                service_type: bookingData.serviceType,\r\n                issue: bookingData.issue,\r\n                date: bookingData.date,\r\n                time: bookingData.time,\r\n                customer_name: bookingData.customer?.name,\r\n                customer_email: bookingData.customer?.email,\r\n                customer_phone: bookingData.customer?.phone,\r\n                status: 'Pending',\r\n                priority: bookingData.priority || 'normal',\r\n                priority_level: bookingData.priorityLevel || 'regular',\r\n                priority_fee: bookingData.priorityFee || 0,\r\n                base_repair_price: bookingData.baseRepairPrice,\r\n                total_price: bookingData.totalPrice,\r\n                notes: [],\r\n                time_tracking: { startTime: null, endTime: null, totalMinutes: 0 }\r\n            }])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return { ...data, id };\r\n    },\r\n\r\n    updateStatus: async (id, status) => {\r\n        const { data, error } = await supabase\r\n            .from('bookings')\r\n            .update({ status, updated_at: new Date().toISOString() })\r\n            .eq('id', id)\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    update: async (id, updates) => {\r\n        const dbUpdates = { updated_at: new Date().toISOString() };\r\n        if (updates.device !== undefined) dbUpdates.device = updates.device;\r\n        if (updates.serviceType !== undefined) dbUpdates.service_type = updates.serviceType;\r\n        if (updates.issue !== undefined) dbUpdates.issue = updates.issue;\r\n        if (updates.date !== undefined) dbUpdates.date = updates.date;\r\n        if (updates.time !== undefined) dbUpdates.time = updates.time;\r\n        if (updates.status !== undefined) dbUpdates.status = updates.status;\r\n        if (updates.priority !== undefined) dbUpdates.priority = updates.priority;\r\n        if (updates.costEstimate !== undefined) dbUpdates.cost_estimate = updates.costEstimate;\r\n        if (updates.notes !== undefined) dbUpdates.notes = updates.notes;\r\n        if (updates.timeTracking !== undefined) dbUpdates.time_tracking = updates.timeTracking;\r\n\r\n        const { data, error } = await supabase\r\n            .from('bookings')\r\n            .update(dbUpdates)\r\n            .eq('id', id)\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    delete: async (id) => {\r\n        const { error } = await supabase\r\n            .from('bookings')\r\n            .delete()\r\n            .eq('id', id);\r\n        if (error) throw error;\r\n        return true;\r\n    }\r\n};\r\n\r\n// ============== INVENTORY ==============\r\nexport const inventoryApi = {\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('inventory')\r\n            .select('*')\r\n            .order('id');\r\n        if (error) throw error;\r\n        return data.map(i => ({\r\n            id: i.id,\r\n            name: i.name,\r\n            sku: i.sku,\r\n            category: i.category,\r\n            quantity: i.quantity,\r\n            minStock: i.min_stock,\r\n            cost: i.cost,\r\n            supplier: i.supplier,\r\n            lastRestocked: i.last_restocked,\r\n            usageHistory: i.usage_history || []\r\n        }));\r\n    },\r\n\r\n    update: async (id, updates) => {\r\n        const dbUpdates = { updated_at: new Date().toISOString() };\r\n        if (updates.name !== undefined) dbUpdates.name = updates.name;\r\n        if (updates.sku !== undefined) dbUpdates.sku = updates.sku;\r\n        if (updates.category !== undefined) dbUpdates.category = updates.category;\r\n        if (updates.quantity !== undefined) dbUpdates.quantity = updates.quantity;\r\n        if (updates.minStock !== undefined) dbUpdates.min_stock = updates.minStock;\r\n        if (updates.cost !== undefined) dbUpdates.cost = updates.cost;\r\n        if (updates.supplier !== undefined) dbUpdates.supplier = updates.supplier;\r\n\r\n        const { data, error } = await supabase\r\n            .from('inventory')\r\n            .update(dbUpdates)\r\n            .eq('id', id)\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    create: async (itemData) => {\r\n        const { data, error } = await supabase\r\n            .from('inventory')\r\n            .insert([{\r\n                name: itemData.name,\r\n                sku: itemData.sku,\r\n                category: itemData.category,\r\n                quantity: itemData.quantity || 0,\r\n                min_stock: itemData.minStock || 5,\r\n                cost: itemData.cost,\r\n                supplier: itemData.supplier,\r\n                usage_history: []\r\n            }])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    }\r\n};\r\n\r\n// ============== STORE PRODUCTS ==============\r\nexport const storeProductsApi = {\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('store_products')\r\n            .select('*')\r\n            .order('id');\r\n        if (error) throw error;\r\n        return data.map(p => ({\r\n            id: p.id,\r\n            name: p.name,\r\n            sku: p.sku,\r\n            category: p.category,\r\n            price: p.price,\r\n            cost: p.cost,\r\n            quantity: p.quantity,\r\n            minStock: p.min_stock,\r\n            description: p.description\r\n        }));\r\n    },\r\n\r\n    update: async (id, updates) => {\r\n        const dbUpdates = { updated_at: new Date().toISOString() };\r\n        if (updates.name !== undefined) dbUpdates.name = updates.name;\r\n        if (updates.sku !== undefined) dbUpdates.sku = updates.sku;\r\n        if (updates.category !== undefined) dbUpdates.category = updates.category;\r\n        if (updates.price !== undefined) dbUpdates.price = updates.price;\r\n        if (updates.cost !== undefined) dbUpdates.cost = updates.cost;\r\n        if (updates.quantity !== undefined) dbUpdates.quantity = updates.quantity;\r\n        if (updates.minStock !== undefined) dbUpdates.min_stock = updates.minStock;\r\n        if (updates.description !== undefined) dbUpdates.description = updates.description;\r\n\r\n        const { data, error } = await supabase\r\n            .from('store_products')\r\n            .update(dbUpdates)\r\n            .eq('id', id)\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    }\r\n};\r\n\r\n// ============== SALES ==============\r\nexport const salesApi = {\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('sales')\r\n            .select('*')\r\n            .order('created_at', { ascending: false });\r\n        if (error) throw error;\r\n        return data.map(s => ({\r\n            id: s.id,\r\n            date: s.date,\r\n            time: s.time,\r\n            items: s.items,\r\n            subtotal: s.subtotal,\r\n            tax: s.tax,\r\n            discount: s.discount,\r\n            total: s.total,\r\n            paymentMethod: s.payment_method,\r\n            employeeId: s.employee_id,\r\n            employeeName: s.employee_name,\r\n            customerId: s.customer_id,\r\n            customerName: s.customer_name,\r\n            receiptNumber: s.receipt_number,\r\n            type: s.type,\r\n            bookingId: s.booking_id\r\n        }));\r\n    },\r\n\r\n    create: async (saleData) => {\r\n        const id = `SALE-${Date.now()}`;\r\n        const receiptNumber = `RCP-${new Date().toISOString().split('T')[0].replace(/-/g, '')}-${Math.floor(Math.random() * 1000).toString().padStart(3, '0')}`;\r\n\r\n        const { data, error } = await supabase\r\n            .from('sales')\r\n            .insert([{\r\n                id,\r\n                date: saleData.date || new Date().toISOString().split('T')[0],\r\n                time: saleData.time || new Date().toLocaleTimeString(),\r\n                items: saleData.items,\r\n                subtotal: saleData.subtotal,\r\n                tax: saleData.tax,\r\n                discount: saleData.discount || 0,\r\n                total: saleData.total,\r\n                payment_method: saleData.paymentMethod,\r\n                employee_id: saleData.employeeId,\r\n                employee_name: saleData.employeeName,\r\n                customer_id: saleData.customerId,\r\n                customer_name: saleData.customerName || 'Walk-in Customer',\r\n                receipt_number: receiptNumber,\r\n                type: saleData.type,\r\n                booking_id: saleData.bookingId\r\n            }])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return { ...data, id, receiptNumber };\r\n    }\r\n};\r\n\r\n// ============== WEBSITE CONTENT ==============\r\nexport const websiteContentApi = {\r\n    get: async () => {\r\n        const { data, error } = await supabase\r\n            .from('website_content')\r\n            .select('content_data')\r\n            .eq('content_key', 'website_content')\r\n            .single();\r\n        if (error) throw error;\r\n        return data?.content_data;\r\n    },\r\n\r\n    update: async (section, sectionData) => {\r\n        // Get current content\r\n        const { data: existing } = await supabase\r\n            .from('website_content')\r\n            .select('content_data')\r\n            .eq('content_key', 'website_content')\r\n            .single();\r\n\r\n        const currentContent = existing?.content_data || {};\r\n        const updatedContent = {\r\n            ...currentContent,\r\n            [section]: { ...currentContent[section], ...sectionData }\r\n        };\r\n\r\n        const { data, error } = await supabase\r\n            .from('website_content')\r\n            .upsert({\r\n                content_key: 'website_content',\r\n                content_data: updatedContent,\r\n                updated_at: new Date().toISOString()\r\n            }, { onConflict: 'content_key' })\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return updatedContent;\r\n    }\r\n};\r\n\r\n// ============== ACTIVITY LOG ==============\r\nexport const activityLogApi = {\r\n    getAll: async (limit = 100) => {\r\n        const { data, error } = await supabase\r\n            .from('activity_log')\r\n            .select('*')\r\n            .order('timestamp', { ascending: false })\r\n            .limit(limit);\r\n        if (error) throw error;\r\n        return data.map(a => ({\r\n            id: a.id,\r\n            timestamp: a.timestamp,\r\n            userId: a.user_id,\r\n            userName: a.user_name,\r\n            userRole: a.user_role,\r\n            action: a.action,\r\n            category: a.category,\r\n            details: a.details,\r\n            metadata: a.metadata\r\n        }));\r\n    },\r\n\r\n    create: async (logData) => {\r\n        const id = `ACT-${Date.now()}`;\r\n        const { data, error } = await supabase\r\n            .from('activity_log')\r\n            .insert([{\r\n                id,\r\n                timestamp: new Date().toISOString(),\r\n                user_id: logData.userId,\r\n                user_name: logData.userName,\r\n                user_role: logData.userRole,\r\n                action: logData.action,\r\n                category: logData.category,\r\n                details: logData.details,\r\n                metadata: logData.metadata\r\n            }])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    }\r\n};\r\n\r\n// ============== MESSAGE TEMPLATES ==============\r\nexport const messageTemplatesApi = {\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('message_templates')\r\n            .select('*')\r\n            .order('id');\r\n        if (error) throw error;\r\n        return data;\r\n    }\r\n};\r\n\r\n// ============== CUSTOMER MESSAGES ==============\r\nexport const customerMessagesApi = {\r\n    getAll: async () => {\r\n        const { data, error } = await supabase\r\n            .from('customer_messages')\r\n            .select('*')\r\n            .order('created_at', { ascending: false });\r\n        if (error) throw error;\r\n        return data.map(m => ({\r\n            id: m.id,\r\n            customerId: m.customer_id,\r\n            customerName: m.customer_name,\r\n            customerEmail: m.customer_email,\r\n            customerPhone: m.customer_phone,\r\n            bookingId: m.booking_id,\r\n            employeeId: m.employee_id,\r\n            employeeName: m.employee_name,\r\n            type: m.type,\r\n            subject: m.subject,\r\n            message: m.message,\r\n            channel: m.channel,\r\n            status: m.status,\r\n            sentAt: m.sent_at,\r\n            readAt: m.read_at\r\n        }));\r\n    },\r\n\r\n    create: async (messageData) => {\r\n        const { data, error } = await supabase\r\n            .from('customer_messages')\r\n            .insert([{\r\n                customer_id: messageData.customerId,\r\n                customer_name: messageData.customerName,\r\n                customer_email: messageData.customerEmail,\r\n                customer_phone: messageData.customerPhone,\r\n                booking_id: messageData.bookingId,\r\n                employee_id: messageData.employeeId,\r\n                employee_name: messageData.employeeName,\r\n                type: messageData.type,\r\n                subject: messageData.subject,\r\n                message: messageData.message,\r\n                channel: messageData.channel,\r\n                status: 'sent',\r\n                sent_at: new Date().toISOString()\r\n            }])\r\n            .select()\r\n            .single();\r\n        if (error) throw error;\r\n        return data;\r\n    }\r\n};\r\n\r\n// Export all APIs\r\nexport default {\r\n    supabase,\r\n    isSupabaseAvailable,\r\n    users: usersApi,\r\n    customers: customersApi,\r\n    services: servicesApi,\r\n    timeSlots: timeSlotsApi,\r\n    bookings: bookingsApi,\r\n    inventory: inventoryApi,\r\n    storeProducts: storeProductsApi,\r\n    sales: salesApi,\r\n    websiteContent: websiteContentApi,\r\n    activityLog: activityLogApi,\r\n    messageTemplates: messageTemplatesApi,\r\n    customerMessages: customerMessagesApi\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\BeforeAfterGallery.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[75,82],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'sectionHeader' is defined but never used.","line":48,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"sectionHeader"},"fix":{"range":[1723,1740],"text":""},"desc":"Remove unused variable 'sectionHeader'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { ChevronLeft, ChevronRight, Pause, Play } from 'lucide-react';\r\nimport { getGallery } from '../../../services/landingService';\r\nimport './BeforeAfterGallery.css';\r\n\r\n// Default gallery items with real images\r\nconst defaultGalleryItems = [\r\n    {\r\n        id: 1,\r\n        title: 'iPhone Screen Repair',\r\n        description: 'Shattered screen restored to brand new condition',\r\n        before_image: '/gallery/phone-before.png',\r\n        after_image: '/gallery/phone-after.png',\r\n    },\r\n    {\r\n        id: 2,\r\n        title: 'MacBook Screen Replacement',\r\n        description: 'Cracked display replaced with original parts',\r\n        before_image: '/gallery/laptop-before.png',\r\n        after_image: '/gallery/laptop-after.png',\r\n    },\r\n    {\r\n        id: 3,\r\n        title: 'Samsung Galaxy Screen Repair',\r\n        description: 'Severely cracked display restored to perfect condition',\r\n        before_image: '/gallery/samsung-before.png',\r\n        after_image: '/gallery/samsung-after.png',\r\n    },\r\n    {\r\n        id: 4,\r\n        title: 'iPad Screen Replacement',\r\n        description: 'Damaged tablet screen replaced with premium parts',\r\n        before_image: '/gallery/ipad-before.png',\r\n        after_image: '/gallery/ipad-after.png',\r\n    },\r\n    {\r\n        id: 5,\r\n        title: 'iPhone Battery Replacement',\r\n        description: 'Swollen battery replaced - 100% health restored',\r\n        before_image: '/gallery/battery-before.png',\r\n        after_image: '/gallery/battery-after.png',\r\n    },\r\n];\r\n\r\nconst AUTO_PLAY_INTERVAL = 5000; // 5 seconds\r\n\r\nconst BeforeAfterGallery = ({ sectionHeader }) => {\r\n    const [currentIndex, setCurrentIndex] = useState(0);\r\n    const [galleryItems, setGalleryItems] = useState(defaultGalleryItems);\r\n    const [isAutoPlaying, setIsAutoPlaying] = useState(true);\r\n    const [direction, setDirection] = useState(1);\r\n\r\n    // Load gallery items from database\r\n    useEffect(() => {\r\n        const loadGallery = async () => {\r\n            try {\r\n                const data = await getGallery();\r\n                if (data.length > 0) {\r\n                    setGalleryItems(data);\r\n                }\r\n            } catch (error) {\r\n                console.error('Failed to load gallery:', error);\r\n            }\r\n        };\r\n        loadGallery();\r\n    }, []);\r\n\r\n    const nextSlide = useCallback(() => {\r\n        setDirection(1);\r\n        setCurrentIndex((prev) => (prev + 1) % galleryItems.length);\r\n    }, [galleryItems.length]);\r\n\r\n    const prevSlide = useCallback(() => {\r\n        setDirection(-1);\r\n        setCurrentIndex((prev) => (prev - 1 + galleryItems.length) % galleryItems.length);\r\n    }, [galleryItems.length]);\r\n\r\n    const goToSlide = (index) => {\r\n        setDirection(index > currentIndex ? 1 : -1);\r\n        setCurrentIndex(index);\r\n    };\r\n\r\n    // Auto-play functionality\r\n    useEffect(() => {\r\n        if (!isAutoPlaying || galleryItems.length <= 1) return;\r\n\r\n        const interval = setInterval(() => {\r\n            nextSlide();\r\n        }, AUTO_PLAY_INTERVAL);\r\n\r\n        return () => clearInterval(interval);\r\n    }, [isAutoPlaying, nextSlide, galleryItems.length]);\r\n\r\n    // Pause on hover\r\n    const handleMouseEnter = () => setIsAutoPlaying(false);\r\n    const handleMouseLeave = () => setIsAutoPlaying(true);\r\n\r\n    if (galleryItems.length === 0) return null;\r\n\r\n    const currentItem = galleryItems[currentIndex];\r\n\r\n    const slideVariants = {\r\n        enter: (direction) => ({\r\n            x: direction > 0 ? 300 : -300,\r\n            opacity: 0,\r\n            scale: 0.95,\r\n        }),\r\n        center: {\r\n            x: 0,\r\n            opacity: 1,\r\n            scale: 1,\r\n        },\r\n        exit: (direction) => ({\r\n            x: direction > 0 ? -300 : 300,\r\n            opacity: 0,\r\n            scale: 0.95,\r\n        }),\r\n    };\r\n\r\n    return (\r\n        <section className=\"gallery-section section-padding\">\r\n            <div className=\"container\">\r\n                <div className=\"section-header text-center\">\r\n                    <h2 className=\"section-title\">Before & After</h2>\r\n                    <p className=\"section-subtitle\">See the transformation - real repairs by our expert technicians</p>\r\n                </div>\r\n\r\n                <div\r\n                    className=\"gallery-showcase\"\r\n                    onMouseEnter={handleMouseEnter}\r\n                    onMouseLeave={handleMouseLeave}\r\n                >\r\n                    {/* Progress bar */}\r\n                    <div className=\"slideshow-progress\">\r\n                        {galleryItems.map((_, index) => (\r\n                            <div\r\n                                key={index}\r\n                                className={`progress-segment ${index === currentIndex ? 'active' : ''} ${index < currentIndex ? 'completed' : ''}`}\r\n                                onClick={() => goToSlide(index)}\r\n                            >\r\n                                <div\r\n                                    className=\"progress-fill\"\r\n                                    style={{\r\n                                        animationDuration: index === currentIndex && isAutoPlaying ? `${AUTO_PLAY_INTERVAL}ms` : '0ms',\r\n                                        animationPlayState: index === currentIndex && isAutoPlaying ? 'running' : 'paused',\r\n                                    }}\r\n                                />\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    <div className=\"gallery-main\">\r\n                        <button className=\"gallery-nav-btn prev\" onClick={prevSlide}>\r\n                            <ChevronLeft size={28} />\r\n                        </button>\r\n\r\n                        <div className=\"gallery-content\">\r\n                            <AnimatePresence mode=\"wait\" custom={direction}>\r\n                                <motion.div\r\n                                    key={currentIndex}\r\n                                    className=\"gallery-slide\"\r\n                                    custom={direction}\r\n                                    variants={slideVariants}\r\n                                    initial=\"enter\"\r\n                                    animate=\"center\"\r\n                                    exit=\"exit\"\r\n                                    transition={{\r\n                                        type: \"spring\",\r\n                                        stiffness: 300,\r\n                                        damping: 30,\r\n                                        duration: 0.5\r\n                                    }}\r\n                                >\r\n                                    <div className=\"comparison-container\">\r\n                                        <div className=\"comparison-side before\">\r\n                                            <div className=\"side-label\">\r\n                                                <span className=\"label-dot\"></span>\r\n                                                Before\r\n                                            </div>\r\n                                            <div className=\"side-image\">\r\n                                                <img\r\n                                                    src={currentItem.before_image}\r\n                                                    alt={`${currentItem.title} - Before`}\r\n                                                />\r\n                                                <div className=\"image-overlay before-overlay\"></div>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"comparison-divider\">\r\n                                            <div className=\"divider-line\"></div>\r\n                                            <div className=\"divider-icon\">\r\n                                                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                                    <path d=\"M5 12h14M12 5l7 7-7 7\" />\r\n                                                </svg>\r\n                                            </div>\r\n                                            <div className=\"divider-line\"></div>\r\n                                        </div>\r\n\r\n                                        <div className=\"comparison-side after\">\r\n                                            <div className=\"side-label\">\r\n                                                <span className=\"label-dot\"></span>\r\n                                                After\r\n                                            </div>\r\n                                            <div className=\"side-image\">\r\n                                                <img\r\n                                                    src={currentItem.after_image}\r\n                                                    alt={`${currentItem.title} - After`}\r\n                                                />\r\n                                                <div className=\"image-overlay after-overlay\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"slide-info\">\r\n                                        <h3>{currentItem.title}</h3>\r\n                                        <p>{currentItem.description}</p>\r\n                                    </div>\r\n                                </motion.div>\r\n                            </AnimatePresence>\r\n                        </div>\r\n\r\n                        <button className=\"gallery-nav-btn next\" onClick={nextSlide}>\r\n                            <ChevronRight size={28} />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Slide counter and play/pause */}\r\n                    <div className=\"gallery-controls\">\r\n                        <div className=\"slide-counter\">\r\n                            <span className=\"current\">{String(currentIndex + 1).padStart(2, '0')}</span>\r\n                            <span className=\"separator\">/</span>\r\n                            <span className=\"total\">{String(galleryItems.length).padStart(2, '0')}</span>\r\n                        </div>\r\n                        <button\r\n                            className=\"play-pause-btn\"\r\n                            onClick={() => setIsAutoPlaying(!isAutoPlaying)}\r\n                            aria-label={isAutoPlaying ? 'Pause slideshow' : 'Play slideshow'}\r\n                        >\r\n                            {isAutoPlaying ? <Pause size={18} /> : <Play size={18} />}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default BeforeAfterGallery;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\BrandsWeRepair.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[28,67],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport './BrandsWeRepair.css';\r\n\r\nconst brands = [\r\n    { name: 'Apple', logo: '≡ƒìÄ' },\r\n    { name: 'Samsung', logo: '≡ƒô▒' },\r\n    { name: 'Google', logo: '≡ƒöì' },\r\n    { name: 'Dell', logo: '≡ƒÆ╗' },\r\n    { name: 'HP', logo: '≡ƒûÑ∩╕Å' },\r\n    { name: 'Lenovo', logo: 'Γî¿∩╕Å' },\r\n    { name: 'Microsoft', logo: '≡ƒ¬ƒ' },\r\n    { name: 'Asus', logo: '≡ƒÄ«' },\r\n    { name: 'Sony', logo: '≡ƒÄº' },\r\n    { name: 'LG', logo: '≡ƒô║' },\r\n    { name: 'OnePlus', logo: 'Γ₧ò' },\r\n    { name: 'Huawei', logo: '≡ƒô╢' },\r\n];\r\n\r\nconst BrandsWeRepair = () => {\r\n    return (\r\n        <section className=\"brands-section section-padding\">\r\n            <div className=\"container\">\r\n                <div className=\"section-header text-center\">\r\n                    <h2 className=\"section-title\">Brands We Repair</h2>\r\n                    <p className=\"section-subtitle\">We service all major brands with genuine parts and expert care</p>\r\n                </div>\r\n\r\n                <div className=\"brands-grid\">\r\n                    {brands.map((brand, index) => (\r\n                        <motion.div\r\n                            key={brand.name}\r\n                            className=\"brand-card\"\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            whileInView={{ opacity: 1, y: 0 }}\r\n                            viewport={{ once: true }}\r\n                            transition={{ delay: index * 0.05, duration: 0.4 }}\r\n                            whileHover={{ scale: 1.05 }}\r\n                        >\r\n                            <span className=\"brand-logo\">{brand.logo}</span>\r\n                            <span className=\"brand-name\">{brand.name}</span>\r\n                        </motion.div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default BrandsWeRepair;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\CustomerLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\FAQ.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[51,58],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { ChevronDown } from 'lucide-react';\r\nimport './FAQ.css';\r\n\r\nconst defaultFaqData = [\r\n    {\r\n        question: 'How long does a typical repair take?',\r\n        answer: 'Most repairs are completed within 30-60 minutes. Complex repairs like water damage or motherboard issues may take 1-3 days. We\\'ll give you an accurate time estimate before starting.'\r\n    },\r\n    {\r\n        question: 'Do you offer a warranty on repairs?',\r\n        answer: 'Yes! All our repairs come with a lifetime warranty on parts and labor. If anything goes wrong with the repaired component, we\\'ll fix it free of charge.'\r\n    },\r\n    {\r\n        question: 'What payment methods do you accept?',\r\n        answer: 'We accept all major credit/debit cards, cash, Apple Pay, Google Pay, and can arrange payment plans for larger repairs.'\r\n    },\r\n    {\r\n        question: 'Do I need to make an appointment?',\r\n        answer: 'While walk-ins are welcome at our shop, we recommend booking an appointment to ensure minimal wait time. For mobile service, appointments are required.'\r\n    },\r\n    {\r\n        question: 'What if you can\\'t fix my device?',\r\n        answer: 'If we determine a device is unrepairable, you won\\'t be charged for the diagnostic. We\\'ll also offer data recovery options and recommend alternatives.'\r\n    },\r\n    {\r\n        question: 'Is my data safe during the repair?',\r\n        answer: 'Absolutely. We never access personal data unless required for the repair (like testing after a screen replacement). Your privacy is our priority.'\r\n    },\r\n    {\r\n        question: 'Do you use genuine parts?',\r\n        answer: 'We offer both OEM (Original Equipment Manufacturer) and high-quality aftermarket parts. You choose what works best for your budget and needs.'\r\n    },\r\n    {\r\n        question: 'Can you fix water-damaged devices?',\r\n        answer: 'Yes, we specialize in water damage repair. Success depends on how quickly you bring it in and the extent of the damage. Never try to charge a wet device!'\r\n    },\r\n];\r\n\r\nconst FAQ = ({ faqItems, loading }) => {\r\n    const [openIndex, setOpenIndex] = useState(null);\r\n\r\n    // Use props FAQ or defaults (check for both undefined AND empty array)\r\n    const faqData = faqItems && faqItems.length > 0 ? faqItems : defaultFaqData;\r\n\r\n    const toggleFAQ = (index) => {\r\n        setOpenIndex(openIndex === index ? null : index);\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <section className=\"faq-section section-padding\">\r\n                <div className=\"container\">\r\n                    <div className=\"section-header text-center\">\r\n                        <h2 className=\"section-title\">Frequently Asked Questions</h2>\r\n                        <p className=\"section-subtitle\">Got questions? We've got answers.</p>\r\n                    </div>\r\n                    <div className=\"faq-container\">\r\n                        {[1, 2, 3, 4].map((i) => (\r\n                            <div key={i} className=\"faq-item skeleton\">\r\n                                <div className=\"skeleton-question\"></div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </section>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <section className=\"faq-section section-padding\">\r\n            <div className=\"container\">\r\n                <div className=\"section-header text-center\">\r\n                    <h2 className=\"section-title\">Frequently Asked Questions</h2>\r\n                    <p className=\"section-subtitle\">Got questions? We've got answers.</p>\r\n                </div>\r\n\r\n                <div className=\"faq-container\">\r\n                    {faqData.map((faq, index) => (\r\n                        <motion.div\r\n                            key={index}\r\n                            className={`faq-item ${openIndex === index ? 'open' : ''}`}\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            whileInView={{ opacity: 1, y: 0 }}\r\n                            viewport={{ once: true }}\r\n                            transition={{ delay: index * 0.05, duration: 0.3 }}\r\n                        >\r\n                            <button\r\n                                className=\"faq-question\"\r\n                                onClick={() => toggleFAQ(index)}\r\n                            >\r\n                                <span>{faq.question}</span>\r\n                                <motion.div\r\n                                    className=\"faq-icon\"\r\n                                    animate={{ rotate: openIndex === index ? 180 : 0 }}\r\n                                    transition={{ duration: 0.3 }}\r\n                                >\r\n                                    <ChevronDown size={20} />\r\n                                </motion.div>\r\n                            </button>\r\n                            <AnimatePresence>\r\n                                {openIndex === index && (\r\n                                    <motion.div\r\n                                        className=\"faq-answer\"\r\n                                        initial={{ height: 0, opacity: 0 }}\r\n                                        animate={{ height: 'auto', opacity: 1 }}\r\n                                        exit={{ height: 0, opacity: 0 }}\r\n                                        transition={{ duration: 0.3 }}\r\n                                    >\r\n                                        <p>{faq.answer}</p>\r\n                                    </motion.div>\r\n                                )}\r\n                            </AnimatePresence>\r\n                        </motion.div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default FAQ;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\Footer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\Hero.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[49,56],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'loading' is defined but never used.","line":9,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[388,397],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'letterVariants' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":62,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"letterVariants"},"fix":{"range":[1757,2077],"text":""},"desc":"Remove unused variable 'letterVariants'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef } from 'react';\r\nimport { motion, useInView, useScroll, useTransform } from 'framer-motion';\r\nimport { ArrowRight, Star, Zap, Shield, Award } from 'lucide-react';\r\nimport { Link } from 'react-router-dom';\r\nimport Button from '../../../components/Button';\r\nimport heroImage from '../../../assets/images/hero-repair.png';\r\nimport './Hero.css';\r\n\r\nconst Hero = ({ hero, loading }) => {\r\n    const heroRef = useRef(null);\r\n    const isInView = useInView(heroRef, { once: true, margin: \"-100px\" });\r\n\r\n    // Use props or defaults\r\n    const content = hero || {};\r\n\r\n\r\n    const { scrollYProgress } = useScroll({\r\n        target: heroRef,\r\n        offset: [\"start start\", \"end start\"]\r\n    });\r\n\r\n    const imageY = useTransform(scrollYProgress, [0, 1], [0, 100]);\r\n    const contentY = useTransform(scrollYProgress, [0, 1], [0, 50]);\r\n\r\n    // Animation variants\r\n    const containerVariants = {\r\n        hidden: { opacity: 0 },\r\n        visible: {\r\n            opacity: 1,\r\n            transition: {\r\n                staggerChildren: 0.12,\r\n                delayChildren: 0.1\r\n            }\r\n        }\r\n    };\r\n\r\n    const itemVariants = {\r\n        hidden: { opacity: 0, y: 30 },\r\n        visible: {\r\n            opacity: 1,\r\n            y: 0,\r\n            transition: {\r\n                duration: 0.7,\r\n                ease: [0.25, 0.46, 0.45, 0.94]\r\n            }\r\n        }\r\n    };\r\n\r\n    const cardVariants = {\r\n        hidden: { opacity: 0, scale: 0.8 },\r\n        visible: (custom) => ({\r\n            opacity: 1,\r\n            scale: 1,\r\n            transition: {\r\n                delay: 0.6 + (custom * 0.15),\r\n                duration: 0.6,\r\n                ease: [0.25, 0.46, 0.45, 0.94]\r\n            }\r\n        })\r\n    };\r\n\r\n    const letterVariants = {\r\n        hidden: { opacity: 0, y: 50 },\r\n        visible: (i) => ({\r\n            opacity: 1,\r\n            y: 0,\r\n            transition: {\r\n                delay: 0.3 + (i * 0.03),\r\n                duration: 0.5,\r\n                ease: [0.25, 0.46, 0.45, 0.94]\r\n            }\r\n        })\r\n    };\r\n\r\n    // Use dynamic content or fallback\r\n    const headingText = content?.title || \"Expert Device Repair\";\r\n    const highlightText = content?.subtitle || \"Done Right.\";\r\n\r\n    return (\r\n        <section className=\"hero\" ref={heroRef}>\r\n            <div className=\"container hero-container\">\r\n                <motion.div\r\n                    className=\"hero-content\"\r\n                    variants={containerVariants}\r\n                    initial=\"hidden\"\r\n                    animate={isInView ? \"visible\" : \"hidden\"}\r\n                    style={{ y: contentY }}\r\n                >\r\n                    <motion.div className=\"badge\" variants={itemVariants}>\r\n                        <Star size={14} fill=\"currentColor\" />\r\n                        <span>Trusted by 2,500+ Happy Customers</span>\r\n                    </motion.div>\r\n\r\n                    <motion.h1 variants={itemVariants}>\r\n                        <span className=\"hero-title-main\">{headingText}</span>\r\n                        {' '}\r\n                        <span className=\"highlight\">{highlightText}</span>\r\n                    </motion.h1>\r\n\r\n                    <motion.p variants={itemVariants}>\r\n                        {content?.description || 'Premium repair services for iPhones, Samsung, Laptops & Tablets. Fast turnaround. Certified technicians. 90-day warranty on all repairs.'}\r\n                    </motion.p>\r\n\r\n                    <motion.div className=\"hero-actions\" variants={itemVariants}>\r\n                        <Link to=\"/booking\">\r\n                            <Button variant=\"primary\">{content?.primaryButtonText || 'Book Repair'} <ArrowRight size={18} /></Button>\r\n                        </Link>\r\n                        <Link to=\"/services\">\r\n                            <Button variant=\"secondary\">{content?.secondaryButtonText || 'View Services'}</Button>\r\n                        </Link>\r\n                    </motion.div>\r\n                </motion.div>\r\n\r\n                <motion.div\r\n                    className=\"hero-image\"\r\n                    initial={{ opacity: 0, scale: 0.9, rotateY: -10 }}\r\n                    animate={isInView ? { opacity: 1, scale: 1, rotateY: 0 } : {}}\r\n                    transition={{ delay: 0.3, duration: 0.9, ease: \"easeOut\" }}\r\n                    style={{ y: imageY }}\r\n                >\r\n                    <div className=\"hero-image-wrapper\">\r\n                        <div className=\"hero-image-border\"></div>\r\n                        <img\r\n                            src={heroImage}\r\n                            alt=\"Professional device repair by SIFIXA technicians\"\r\n                            className=\"hero-main-image\"\r\n                        />\r\n                        <div className=\"hero-image-overlay\"></div>\r\n                        <div className=\"hero-image-glow\"></div>\r\n                    </div>\r\n\r\n                    {/* Glassmorphism floating cards */}\r\n                    <motion.div\r\n                        className=\"glass-card card-rating\"\r\n                        custom={0}\r\n                        variants={cardVariants}\r\n                        initial=\"hidden\"\r\n                        animate={isInView ? \"visible\" : \"hidden\"}\r\n                        whileHover={{ scale: 1.05, y: -5 }}\r\n                    >\r\n                        <div className=\"glass-card-icon rating-icon\">\r\n                            <Star size={22} fill=\"#fbbf24\" stroke=\"#fbbf24\" />\r\n                        </div>\r\n                        <div className=\"glass-card-content\">\r\n                            <span className=\"glass-card-value\">4.9</span>\r\n                            <span className=\"glass-card-label\">Rating</span>\r\n                        </div>\r\n                    </motion.div>\r\n\r\n                    <motion.div\r\n                        className=\"glass-card card-speed\"\r\n                        custom={1}\r\n                        variants={cardVariants}\r\n                        initial=\"hidden\"\r\n                        animate={isInView ? \"visible\" : \"hidden\"}\r\n                        whileHover={{ scale: 1.05, y: -5 }}\r\n                    >\r\n                        <div className=\"glass-card-icon speed-icon\">\r\n                            <Zap size={22} />\r\n                        </div>\r\n                        <div className=\"glass-card-content\">\r\n                            <span className=\"glass-card-value\">30 min</span>\r\n                            <span className=\"glass-card-label\">Avg Time</span>\r\n                        </div>\r\n                    </motion.div>\r\n\r\n                    <motion.div\r\n                        className=\"glass-card card-warranty\"\r\n                        custom={2}\r\n                        variants={cardVariants}\r\n                        initial=\"hidden\"\r\n                        animate={isInView ? \"visible\" : \"hidden\"}\r\n                        whileHover={{ scale: 1.05, y: -5 }}\r\n                    >\r\n                        <div className=\"glass-card-icon warranty-icon\">\r\n                            <Shield size={22} />\r\n                        </div>\r\n                        <div className=\"glass-card-content\">\r\n                            <span className=\"glass-card-value\">90 Days</span>\r\n                            <span className=\"glass-card-label\">Warranty</span>\r\n                        </div>\r\n                    </motion.div>\r\n\r\n                    <motion.div\r\n                        className=\"glass-card card-repairs\"\r\n                        custom={3}\r\n                        variants={cardVariants}\r\n                        initial=\"hidden\"\r\n                        animate={isInView ? \"visible\" : \"hidden\"}\r\n                        whileHover={{ scale: 1.05, y: -5 }}\r\n                    >\r\n                        <div className=\"glass-card-icon repairs-icon\">\r\n                            <Award size={22} />\r\n                        </div>\r\n                        <div className=\"glass-card-content\">\r\n                            <span className=\"glass-card-value\">15K+</span>\r\n                            <span className=\"glass-card-label\">Repairs</span>\r\n                        </div>\r\n                    </motion.div>\r\n                </motion.div>\r\n            </div>\r\n\r\n            {/* Scroll indicator */}\r\n            <motion.div\r\n                className=\"scroll-indicator\"\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                transition={{ delay: 1.5, duration: 0.6 }}\r\n            >\r\n                <span>Scroll</span>\r\n                <div className=\"scroll-indicator-line\"></div>\r\n            </motion.div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default Hero;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\HowItWorks.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[75,82],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'loading' is defined but never used.","line":47,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[2079,2088],"text":""},"desc":"Remove unused variable 'loading'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { MapPin, Store, Truck, Calendar, Wrench, CheckCircle, ArrowRight, Pause, Play } from 'lucide-react';\r\nimport './HowItWorks.css';\r\n\r\nconst serviceOptions = [\r\n    {\r\n        id: 'come-to-you',\r\n        title: 'We Come To You',\r\n        icon: MapPin,\r\n        description: 'Our technician visits your location',\r\n        steps: [\r\n            { icon: Calendar, title: 'Book Online', desc: 'Schedule a convenient time' },\r\n            { icon: MapPin, title: 'We Arrive', desc: 'Technician comes to your location' },\r\n            { icon: Wrench, title: 'Quick Repair', desc: 'Fixed on the spot' },\r\n            { icon: CheckCircle, title: 'All Done!', desc: 'Back to working perfectly' }\r\n        ]\r\n    },\r\n    {\r\n        id: 'visit-shop',\r\n        title: 'Visit Our Shop',\r\n        icon: Store,\r\n        description: 'Walk in - no appointment needed',\r\n        steps: [\r\n            { icon: Store, title: 'Visit Us', desc: 'Bring your device to our shop' },\r\n            { icon: Wrench, title: 'Expert Repair', desc: 'We fix it while you wait or notify you if it takes longer' },\r\n            { icon: CheckCircle, title: 'We Notify You', desc: 'Get notified when your device is ready' },\r\n            { icon: Truck, title: 'Pick Up or Delivery', desc: 'Collect in-store or we deliver to you' }\r\n        ]\r\n    },\r\n    {\r\n        id: 'pickup-delivery',\r\n        title: 'Pickup & Delivery',\r\n        icon: Truck,\r\n        description: 'We pick up and deliver back to you',\r\n        steps: [\r\n            { icon: Calendar, title: 'Schedule Pickup', desc: 'Choose a pickup time' },\r\n            { icon: Truck, title: 'We Collect', desc: 'We pick up your device' },\r\n            { icon: Wrench, title: 'Repair at Shop', desc: 'Fixed by our experts' },\r\n            { icon: Truck, title: 'Delivered', desc: 'Returned to your door' }\r\n        ]\r\n    }\r\n];\r\n\r\nconst AUTO_PLAY_INTERVAL = 6000; // 6 seconds per service option\r\n\r\nconst HowItWorks = ({ section, loading }) => {\r\n    const [activeIndex, setActiveIndex] = useState(0);\r\n    const [isAutoPlaying, setIsAutoPlaying] = useState(true);\r\n\r\n    // Use props from parent or defaults\r\n    const content = section || {};\r\n    const currentOption = serviceOptions[activeIndex];\r\n\r\n    const nextOption = useCallback(() => {\r\n        setActiveIndex((prev) => (prev + 1) % serviceOptions.length);\r\n    }, []);\r\n\r\n    // Auto-play functionality\r\n    useEffect(() => {\r\n        if (!isAutoPlaying) return;\r\n\r\n        const interval = setInterval(() => {\r\n            nextOption();\r\n        }, AUTO_PLAY_INTERVAL);\r\n\r\n        return () => clearInterval(interval);\r\n    }, [isAutoPlaying, nextOption]);\r\n\r\n    // Pause on hover\r\n    const handleMouseEnter = () => setIsAutoPlaying(false);\r\n    const handleMouseLeave = () => setIsAutoPlaying(true);\r\n\r\n    return (\r\n        <section className=\"how-it-works-section section-padding\">\r\n            <div className=\"container\">\r\n                <div className=\"section-header text-center\">\r\n                    <h2 className=\"section-title\">{content?.sectionTitle || 'How It Works'}</h2>\r\n                    <p className=\"section-subtitle\">{content?.sectionSubtitle || 'Choose the service option that works best for you'}</p>\r\n                </div>\r\n\r\n                <div\r\n                    className=\"how-it-works-showcase\"\r\n                    onMouseEnter={handleMouseEnter}\r\n                    onMouseLeave={handleMouseLeave}\r\n                >\r\n                    {/* Progress bar */}\r\n                    <div className=\"service-progress-bar\">\r\n                        {serviceOptions.map((option, index) => (\r\n                            <div\r\n                                key={option.id}\r\n                                className={`progress-segment ${index === activeIndex ? 'active' : ''} ${index < activeIndex ? 'completed' : ''}`}\r\n                                onClick={() => setActiveIndex(index)}\r\n                            >\r\n                                <div\r\n                                    className=\"progress-fill\"\r\n                                    style={{\r\n                                        animationDuration: index === activeIndex && isAutoPlaying ? `${AUTO_PLAY_INTERVAL}ms` : '0ms',\r\n                                        animationPlayState: index === activeIndex && isAutoPlaying ? 'running' : 'paused',\r\n                                    }}\r\n                                />\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    <div className=\"service-options-tabs\">\r\n                        {serviceOptions.map((option, index) => {\r\n                            const Icon = option.icon;\r\n                            return (\r\n                                <button\r\n                                    key={option.id}\r\n                                    className={`option-tab ${activeIndex === index ? 'active' : ''}`}\r\n                                    onClick={() => setActiveIndex(index)}\r\n                                >\r\n                                    <div className=\"tab-icon-wrapper\">\r\n                                        <Icon size={24} />\r\n                                    </div>\r\n                                    <span className=\"tab-title\">{option.title}</span>\r\n                                    <span className=\"tab-desc\">{option.description}</span>\r\n                                </button>\r\n                            );\r\n                        })}\r\n                    </div>\r\n\r\n                    <AnimatePresence mode=\"wait\">\r\n                        <motion.div\r\n                            key={activeIndex}\r\n                            className=\"steps-container\"\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            exit={{ opacity: 0, y: -20 }}\r\n                            transition={{ duration: 0.4, ease: \"easeOut\" }}\r\n                        >\r\n                            <div className=\"steps-grid\">\r\n                                {currentOption.steps.map((step, index) => {\r\n                                    const StepIcon = step.icon;\r\n                                    return (\r\n                                        <motion.div\r\n                                            key={index}\r\n                                            className=\"step-card\"\r\n                                            initial={{ opacity: 0, y: 20 }}\r\n                                            animate={{ opacity: 1, y: 0 }}\r\n                                            transition={{ delay: index * 0.1, duration: 0.3 }}\r\n                                        >\r\n                                            <div className=\"step-number\">{index + 1}</div>\r\n                                            <div className=\"step-icon\">\r\n                                                <StepIcon size={28} />\r\n                                            </div>\r\n                                            <h4>{step.title}</h4>\r\n                                            <p>{step.desc}</p>\r\n                                            {index < currentOption.steps.length - 1 && (\r\n                                                <div className=\"step-arrow\">\r\n                                                    <ArrowRight size={20} />\r\n                                                </div>\r\n                                            )}\r\n                                        </motion.div>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </motion.div>\r\n                    </AnimatePresence>\r\n\r\n                    {/* Controls */}\r\n                    <div className=\"how-it-works-controls\">\r\n                        <div className=\"slide-counter\">\r\n                            <span className=\"current\">{String(activeIndex + 1).padStart(2, '0')}</span>\r\n                            <span className=\"separator\">/</span>\r\n                            <span className=\"total\">{String(serviceOptions.length).padStart(2, '0')}</span>\r\n                        </div>\r\n                        <button\r\n                            className=\"play-pause-btn\"\r\n                            onClick={() => setIsAutoPlaying(!isAutoPlaying)}\r\n                            aria-label={isAutoPlaying ? 'Pause' : 'Play'}\r\n                        >\r\n                            {isAutoPlaying ? <Pause size={16} /> : <Play size={16} />}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default HowItWorks;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\LocationMap.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\Navbar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\PricingTable.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[53,92],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { Smartphone, Tablet, Laptop, Battery, Monitor, HardDrive, ArrowRight } from 'lucide-react';\r\nimport { Link } from 'react-router-dom';\r\nimport { getPricing } from '../../../services/landingService';\r\nimport './PricingTable.css';\r\n\r\n// Icon mapping\r\nconst iconMap = {\r\n    Smartphone, Tablet, Laptop, Battery, Monitor, HardDrive\r\n};\r\n\r\nconst defaultPricingData = [\r\n    {\r\n        category: 'Phone Screen', icon: 'Smartphone', items: [\r\n            { name: 'iPhone Screen Repair', price: 'From $79' },\r\n            { name: 'Samsung Screen Repair', price: 'From $69' },\r\n            { name: 'Other Android Screen', price: 'From $59' }\r\n        ]\r\n    },\r\n    {\r\n        category: 'Phone Battery', icon: 'Battery', items: [\r\n            { name: 'iPhone Battery', price: 'From $49' },\r\n            { name: 'Samsung Battery', price: 'From $45' },\r\n            { name: 'Other Android Battery', price: 'From $39' }\r\n        ]\r\n    },\r\n    {\r\n        category: 'Tablet Repair', icon: 'Tablet', items: [\r\n            { name: 'iPad Screen Repair', price: 'From $129' },\r\n            { name: 'iPad Battery', price: 'From $79' },\r\n            { name: 'Samsung Tab Screen', price: 'From $99' }\r\n        ]\r\n    },\r\n    {\r\n        category: 'Laptop Repair', icon: 'Laptop', items: [\r\n            { name: 'Laptop Screen', price: 'From $149' },\r\n            { name: 'Laptop Battery', price: 'From $89' },\r\n            { name: 'Keyboard Replacement', price: 'From $99' }\r\n        ]\r\n    },\r\n    {\r\n        category: 'Desktop & PC', icon: 'Monitor', items: [\r\n            { name: 'OS Reinstall', price: 'From $49' },\r\n            { name: 'Virus Removal', price: 'From $59' },\r\n            { name: 'Hardware Upgrade', price: 'From $79' }\r\n        ]\r\n    },\r\n    {\r\n        category: 'Data Recovery', icon: 'HardDrive', items: [\r\n            { name: 'Basic Recovery', price: 'From $99' },\r\n            { name: 'Advanced Recovery', price: 'From $199' },\r\n            { name: 'SSD/HDD Failure', price: 'From $299' }\r\n        ]\r\n    }\r\n];\r\n\r\nconst PricingTable = ({ sectionHeader, loading: propLoading }) => {\r\n    const [pricingData, setPricingData] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const loadPricing = async () => {\r\n            try {\r\n                const data = await getPricing();\r\n                setPricingData(data.length > 0 ? data : defaultPricingData);\r\n            } catch (error) {\r\n                console.error('Failed to load pricing:', error);\r\n                setPricingData(defaultPricingData);\r\n            }\r\n            setLoading(false);\r\n        };\r\n        loadPricing();\r\n    }, []);\r\n\r\n    const isLoading = propLoading || loading;\r\n\r\n    return (\r\n        <section className=\"pricing-section section-padding\">\r\n            <div className=\"container\">\r\n                <div className=\"section-header text-center\">\r\n                    <h2 className=\"section-title\">{sectionHeader?.title || 'Transparent Pricing'}</h2>\r\n                    <p className=\"section-subtitle\">{sectionHeader?.subtitle || 'No hidden fees. Get an instant estimate for your repair.'}</p>\r\n                </div>\r\n\r\n                {isLoading ? (\r\n                    <div className=\"pricing-grid\">\r\n                        {[1, 2, 3, 4, 5, 6].map((i) => (\r\n                            <div key={i} className=\"pricing-card skeleton\">\r\n                                <div className=\"skeleton-header\"></div>\r\n                                <div className=\"skeleton-list\"></div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"pricing-grid\">\r\n                        {pricingData.map((cat, index) => {\r\n                            const Icon = iconMap[cat.icon] || Smartphone;\r\n                            return (\r\n                                <motion.div\r\n                                    key={cat.id || cat.category}\r\n                                    className=\"pricing-card\"\r\n                                    initial={{ opacity: 0, y: 20 }}\r\n                                    whileInView={{ opacity: 1, y: 0 }}\r\n                                    viewport={{ once: true }}\r\n                                    transition={{ delay: index * 0.1, duration: 0.4 }}\r\n                                >\r\n                                    <div className=\"pricing-card-header\">\r\n                                        <div className=\"pricing-icon\">\r\n                                            <Icon size={24} />\r\n                                        </div>\r\n                                        <h3>{cat.category}</h3>\r\n                                    </div>\r\n                                    <ul className=\"pricing-list\">\r\n                                        {(cat.items || []).map((item, idx) => (\r\n                                            <li key={item.id || idx}>\r\n                                                <span className=\"service-name\">{item.name}</span>\r\n                                                <span className=\"service-price\">{item.price}</span>\r\n                                            </li>\r\n                                        ))}\r\n                                    </ul>\r\n                                </motion.div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                )}\r\n\r\n                <div className=\"pricing-cta\">\r\n                    <p className=\"pricing-disclaimer\">* Prices are estimates. Final price depends on device model and damage extent.</p>\r\n                    <Link to=\"/booking\" className=\"btn btn-primary\">\r\n                        Get Exact Quote <ArrowRight size={18} />\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default PricingTable;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\ServiceCard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[28,67],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":5,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[123,134],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport './ServiceCard.css';\r\n\r\nconst ServiceCard = ({ icon: Icon, title, description, price, delay = 0 }) => {\r\n    return (\r\n        <motion.div\r\n            className=\"service-card\"\r\n            initial={{ opacity: 0, y: 20 }}\r\n            whileInView={{ opacity: 1, y: 0 }}\r\n            viewport={{ once: true }}\r\n            transition={{ delay: delay, duration: 0.5 }}\r\n            whileHover={{ y: -10 }}\r\n        >\r\n            <div className=\"icon-wrapper\">\r\n                <Icon size={32} />\r\n            </div>\r\n            <h3>{title}</h3>\r\n            <p>{description}</p>\r\n            {price && <div className=\"service-price\">{price}</div>}\r\n        </motion.div>\r\n    );\r\n};\r\n\r\nexport default ServiceCard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\Testimonials.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[147,154],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'loading' is defined but never used.","line":46,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":64,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[1754,1763],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getPreviewIndex' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":95,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":95,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"getPreviewIndex"},"fix":{"range":[3516,3646],"text":""},"desc":"Remove unused variable 'getPreviewIndex'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { Star, Quote, ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport './Testimonials.css';\r\n\r\nconst defaultTestimonials = [\r\n    {\r\n        customer_name: \"Sarah Johnson\",\r\n        customer_title: \"iPhone User\",\r\n        content: \"Amazing service! They came to my office and fixed my screen in 20 minutes. Highly recommended!\",\r\n        rating: 5,\r\n        device_repaired: \"Fixed in 20 minutes\"\r\n    },\r\n    {\r\n        customer_name: \"Mike Chen\",\r\n        customer_title: \"Samsung User\",\r\n        content: \"Thought my phone was a goner after water damage. TechFix saved it and my data. Lifesavers!\",\r\n        rating: 5,\r\n        device_repaired: \"Data recovery success\"\r\n    },\r\n    {\r\n        customer_name: \"Emily Davis\",\r\n        customer_title: \"iPad User\",\r\n        content: \"Professional, polite, and very affordable. The lifetime warranty gives me peace of mind.\",\r\n        rating: 5,\r\n        device_repaired: \"Lifetime warranty\"\r\n    },\r\n    {\r\n        customer_name: \"James Wilson\",\r\n        customer_title: \"MacBook User\",\r\n        content: \"They replaced my MacBook screen same day. The quality is indistinguishable from original. Outstanding!\",\r\n        rating: 5,\r\n        device_repaired: \"Same day service\"\r\n    },\r\n    {\r\n        customer_name: \"Ana Rodriguez\",\r\n        customer_title: \"Google Pixel User\",\r\n        content: \"Best repair shop in town! Fair prices and honest technicians. I've been a customer for 3 years now.\",\r\n        rating: 5,\r\n        device_repaired: \"Trusted for 3 years\"\r\n    }\r\n];\r\n\r\nconst AUTO_SLIDE_INTERVAL = 4000;\r\n\r\nconst Testimonials = ({ testimonials: propTestimonials, loading }) => {\r\n    const [currentIndex, setCurrentIndex] = useState(0);\r\n    const [isAutoPlaying, setIsAutoPlaying] = useState(true);\r\n    const [direction, setDirection] = useState(1);\r\n\r\n    // Use props testimonials or defaults\r\n    const testimonials = propTestimonials?.length > 0\r\n        ? propTestimonials.map(t => ({\r\n            ...t,\r\n            name: t.customer_name,\r\n            role: t.customer_title,\r\n            avatar: t.customer_avatar || (t.customer_name?.split(' ').map(n => n[0]).join('') || 'U'),\r\n            highlight: t.device_repaired\r\n        }))\r\n        : defaultTestimonials.map(t => ({\r\n            ...t,\r\n            name: t.customer_name,\r\n            role: t.customer_title,\r\n            avatar: t.customer_name?.split(' ').map(n => n[0]).join('') || 'U',\r\n            highlight: t.device_repaired\r\n        }));\r\n\r\n    const nextSlide = useCallback(() => {\r\n        setDirection(1);\r\n        setCurrentIndex((prev) => (prev + 1) % testimonials.length);\r\n    }, [testimonials.length]);\r\n\r\n    const prevSlide = useCallback(() => {\r\n        setDirection(-1);\r\n        setCurrentIndex((prev) => (prev - 1 + testimonials.length) % testimonials.length);\r\n    }, [testimonials.length]);\r\n\r\n    // Auto-play\r\n    useEffect(() => {\r\n        if (!isAutoPlaying) return;\r\n\r\n        const interval = setInterval(() => {\r\n            nextSlide();\r\n        }, AUTO_SLIDE_INTERVAL);\r\n\r\n        return () => clearInterval(interval);\r\n    }, [isAutoPlaying, nextSlide]);\r\n\r\n    const handleMouseEnter = () => setIsAutoPlaying(false);\r\n    const handleMouseLeave = () => setIsAutoPlaying(true);\r\n\r\n    const currentTestimonial = testimonials[currentIndex];\r\n\r\n    // Get visible testimonials for the preview row (previous and next)\r\n    const getPreviewIndex = (offset) => {\r\n        return (currentIndex + offset + testimonials.length) % testimonials.length;\r\n    };\r\n\r\n    const slideVariants = {\r\n        enter: (direction) => ({\r\n            x: direction > 0 ? 100 : -100,\r\n            opacity: 0,\r\n            scale: 0.95,\r\n        }),\r\n        center: {\r\n            x: 0,\r\n            opacity: 1,\r\n            scale: 1,\r\n        },\r\n        exit: (direction) => ({\r\n            x: direction > 0 ? -100 : 100,\r\n            opacity: 0,\r\n            scale: 0.95,\r\n        }),\r\n    };\r\n\r\n    return (\r\n        <section className=\"testimonials section-padding\">\r\n            <div className=\"container\">\r\n                <div className=\"section-header text-center\">\r\n                    <h2 className=\"section-title\">What Our Customers Say</h2>\r\n                    <p className=\"section-subtitle\">Real reviews from real people who trust us with their devices</p>\r\n                </div>\r\n\r\n                <div\r\n                    className=\"testimonials-showcase\"\r\n                    onMouseEnter={handleMouseEnter}\r\n                    onMouseLeave={handleMouseLeave}\r\n                >\r\n                    {/* Main testimonial card */}\r\n                    <div className=\"testimonial-main\">\r\n                        <button className=\"testimonial-nav prev\" onClick={prevSlide}>\r\n                            <ChevronLeft size={24} />\r\n                        </button>\r\n\r\n                        <div className=\"testimonial-content-wrapper\">\r\n                            <AnimatePresence mode=\"wait\" custom={direction}>\r\n                                <motion.div\r\n                                    key={currentIndex}\r\n                                    className=\"testimonial-featured\"\r\n                                    custom={direction}\r\n                                    variants={slideVariants}\r\n                                    initial=\"enter\"\r\n                                    animate=\"center\"\r\n                                    exit=\"exit\"\r\n                                    transition={{\r\n                                        type: \"spring\",\r\n                                        stiffness: 300,\r\n                                        damping: 30,\r\n                                    }}\r\n                                >\r\n                                    <div className=\"quote-icon\">\r\n                                        <Quote size={32} />\r\n                                    </div>\r\n\r\n                                    <div className=\"testimonial-body\">\r\n                                        <div className=\"stars-row\">\r\n                                            {[...Array(currentTestimonial.rating)].map((_, i) => (\r\n                                                <Star key={i} size={20} fill=\"currentColor\" />\r\n                                            ))}\r\n                                        </div>\r\n\r\n                                        <p className=\"testimonial-text\">\"{currentTestimonial.content}\"</p>\r\n\r\n                                        <span className=\"testimonial-highlight\">{currentTestimonial.highlight}</span>\r\n                                    </div>\r\n\r\n                                    <div className=\"testimonial-footer\">\r\n                                        <div className=\"testimonial-avatar\">\r\n                                            {currentTestimonial.avatar}\r\n                                        </div>\r\n                                        <div className=\"testimonial-author-info\">\r\n                                            <h4>{currentTestimonial.name}</h4>\r\n                                            <span>{currentTestimonial.role}</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </motion.div>\r\n                            </AnimatePresence>\r\n                        </div>\r\n\r\n                        <button className=\"testimonial-nav next\" onClick={nextSlide}>\r\n                            <ChevronRight size={24} />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Thumbnail previews */}\r\n                    <div className=\"testimonial-thumbnails\">\r\n                        {testimonials.map((testimonial, index) => (\r\n                            <button\r\n                                key={index}\r\n                                className={`thumbnail ${index === currentIndex ? 'active' : ''}`}\r\n                                onClick={() => {\r\n                                    setDirection(index > currentIndex ? 1 : -1);\r\n                                    setCurrentIndex(index);\r\n                                }}\r\n                            >\r\n                                <div className=\"thumbnail-avatar\">{testimonial.avatar}</div>\r\n                                <div className=\"thumbnail-info\">\r\n                                    <span className=\"thumbnail-name\">{testimonial.name}</span>\r\n                                    <span className=\"thumbnail-role\">{testimonial.role}</span>\r\n                                </div>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {/* Progress indicator */}\r\n                    <div className=\"testimonial-progress\">\r\n                        {testimonials.map((_, index) => (\r\n                            <div\r\n                                key={index}\r\n                                className={`progress-dot ${index === currentIndex ? 'active' : ''}`}\r\n                                onClick={() => {\r\n                                    setDirection(index > currentIndex ? 1 : -1);\r\n                                    setCurrentIndex(index);\r\n                                }}\r\n                            >\r\n                                <div\r\n                                    className=\"progress-dot-fill\"\r\n                                    style={{\r\n                                        animationDuration: index === currentIndex && isAutoPlaying ? `${AUTO_SLIDE_INTERVAL}ms` : '0ms',\r\n                                        animationPlayState: index === currentIndex && isAutoPlaying ? 'running' : 'paused',\r\n                                    }}\r\n                                />\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default Testimonials;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\components\\WhyChooseUs.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[128,167],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'loading' is defined but never used.","line":25,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[959,968],"text":""},"desc":"Remove unused variable 'loading'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Clock, ShieldCheck, Truck, Wrench, Shield, Award, Star, DollarSign } from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\nimport './WhyChooseUs.css';\r\n\r\n// Icon mapping for CMS\r\nconst iconMap = {\r\n    Clock: Clock,\r\n    Shield: Shield,\r\n    ShieldCheck: ShieldCheck,\r\n    Award: Award,\r\n    Star: Star,\r\n    Truck: Truck,\r\n    Wrench: Wrench,\r\n    DollarSign: DollarSign\r\n};\r\n\r\nconst defaultFeatures = [\r\n    { icon: Clock, title: \"Fast Turnaround\", description: \"Most repairs completed in under 30 minutes.\" },\r\n    { icon: ShieldCheck, title: \"Lifetime Warranty\", description: \"We stand by our parts and labor with a lifetime warranty.\" },\r\n    { icon: Truck, title: \"We Come to You\", description: \"Home, office, or coffee shop - we meet you anywhere.\" },\r\n    { icon: Wrench, title: \"Expert Technicians\", description: \"Certified professionals with years of experience.\" }\r\n];\r\n\r\nconst WhyChooseUs = ({ section, loading }) => {\r\n    // Use props from parent or defaults\r\n    const content = section || {};\r\n\r\n    // Use CMS features from section.content.features or defaults\r\n    const features = content?.content?.features?.map(f => ({\r\n        icon: iconMap[f.icon] || ShieldCheck,\r\n        title: f.title,\r\n        description: f.description\r\n    })) || defaultFeatures;\r\n\r\n    return (\r\n        <section className=\"why-choose-us section-padding\">\r\n            <div className=\"container\">\r\n                <div className=\"section-header text-center\">\r\n                    <h2 className=\"section-title\">{content?.sectionTitle || 'Why Choose SIFIXA?'}</h2>\r\n                    <p className=\"section-subtitle\">{content?.sectionSubtitle || 'The smartest way to repair your device'}</p>\r\n                </div>\r\n\r\n                <div className=\"features-grid\">\r\n                    {features.map((feature, index) => (\r\n                        <motion.div\r\n                            key={index}\r\n                            className=\"feature-card\"\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            whileInView={{ opacity: 1, y: 0 }}\r\n                            viewport={{ once: true }}\r\n                            transition={{ delay: index * 0.1, duration: 0.5 }}\r\n                        >\r\n                            <div className=\"feature-icon\">\r\n                                <feature.icon size={32} />\r\n                            </div>\r\n                            <h3>{feature.title}</h3>\r\n                            <p>{feature.description}</p>\r\n                        </motion.div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default WhyChooseUs;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\Booking.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[278,317],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'bookingId' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":14,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"bookingId"},"fix":{"range":[794,803],"text":""},"desc":"Remove unused variable 'bookingId'."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  82 |     useEffect(() => {\n  83 |         if (user) {\n> 84 |             setFormData(prev => ({\n     |             ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  85 |                 ...prev,\n  86 |                 name: user.name || '',\n  87 |                 email: user.email || '',","line":84,"column":13,"nodeType":null,"endLine":84,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'basePrice' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":217,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":217,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"basePrice"},"fix":{"range":[7630,7728],"text":""},"desc":"Remove unused variable 'basePrice'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'priorityFee' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":218,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":218,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"priorityFee"},"fix":{"range":[7742,7830],"text":""},"desc":"Remove unused variable 'priorityFee'."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { CheckCircle, Clock, AlertCircle, UserPlus, Lock, Calendar, Smartphone, User, ArrowRight, ArrowLeft, Shield, Zap, Award, DollarSign, Star } from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\nimport Button from '../../../components/Button';\r\nimport { api } from '../../../services/apiClient';\r\nimport { mockApi } from '../../../services/mockApi'; // Keep for user/account operations\r\nimport { useAuth } from '../../../context/AuthContext';\r\nimport { validatePhone, validateName, validateText, validateUsername, validateEmail } from '../../../utils/validation';\r\nimport './Booking.css';\r\n\r\nconst Booking = () => {\r\n    const [step, setStep] = useState(1);\r\n    const [bookingId, setBookingId] = useState('');\r\n    const [trackingNumber, setTrackingNumber] = useState('');\r\n    const [existingBookings, setExistingBookings] = useState([]);\r\n    const [timeSlots, setTimeSlots] = useState([]);\r\n    const [services, setServices] = useState([]);\r\n    const [createAccount, setCreateAccount] = useState(false);\r\n    const [accountCreated, setAccountCreated] = useState(false);\r\n    const [formData, setFormData] = useState({\r\n        // Device info - structured for database\r\n        deviceType: 'phone',\r\n        deviceBrand: '',\r\n        deviceModel: '',\r\n        // Service - by ID for database linking\r\n        serviceId: '',\r\n        serviceType: '', // kept for display\r\n        issue: '',\r\n        priorityLevel: 'regular', // regular | priority | express\r\n        date: '',\r\n        time: '',\r\n        timeSlotId: '', // for database linking\r\n        name: '',\r\n        email: '',\r\n        phone: '',\r\n        username: '',\r\n        password: '',\r\n        confirmPassword: ''\r\n    });\r\n\r\n    // Priority levels configuration\r\n    const priorityLevels = [\r\n        {\r\n            id: 'regular',\r\n            name: 'Regular',\r\n            badge: 'Standard',\r\n            fee: 0,\r\n            description: 'Next available slot',\r\n            turnaround: 'Standard turnaround',\r\n            icon: Clock\r\n        },\r\n        {\r\n            id: 'priority',\r\n            name: 'Priority',\r\n            badge: 'Premium',\r\n            fee: 20,\r\n            description: 'Moved ahead in the queue',\r\n            turnaround: 'Faster service',\r\n            icon: Zap,\r\n            popular: true\r\n        },\r\n        {\r\n            id: 'express',\r\n            name: 'Express',\r\n            badge: 'Pro',\r\n            fee: 40,\r\n            description: 'Same-day / fastest available',\r\n            turnaround: 'Priority handling',\r\n            icon: Star\r\n        }\r\n    ];\r\n\r\n    const { user, login } = useAuth();\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        window.scrollTo(0, 0);\r\n    }, []);\r\n\r\n    // Pre-fill form if user is logged in\r\n    useEffect(() => {\r\n        if (user) {\r\n            setFormData(prev => ({\r\n                ...prev,\r\n                name: user.name || '',\r\n                email: user.email || '',\r\n                phone: user.phone || ''\r\n            }));\r\n        }\r\n    }, [user]);\r\n\r\n    // Fetch existing bookings and time slots\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                const [bookings, slots, servicesData] = await Promise.all([\r\n                    api.bookings.list(),\r\n                    api.timeSlots.list(),\r\n                    api.services.list()\r\n                ]);\r\n                setExistingBookings(bookings || []);\r\n                setTimeSlots((slots || []).filter(s => s.active));\r\n                setServices((servicesData || []).filter(s => s.active));\r\n            } catch (error) {\r\n                console.error('Failed to fetch data:', error);\r\n            }\r\n        };\r\n        fetchData();\r\n    }, []);\r\n\r\n    // Get availability for a specific date and time slot\r\n    const getSlotAvailability = (date, slot) => {\r\n        if (!date) return { available: true, count: 0, max: slot.maxBookings };\r\n\r\n        const bookingsForSlot = existingBookings.filter(\r\n            b => b.date === date && b.time === slot.name && b.status !== 'Cancelled'\r\n        );\r\n\r\n        return {\r\n            available: bookingsForSlot.length < slot.maxBookings,\r\n            count: bookingsForSlot.length,\r\n            max: slot.maxBookings\r\n        };\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n        let sanitizedValue = value;\r\n\r\n        // Apply validation based on field type\r\n        switch (name) {\r\n            case 'name':\r\n                sanitizedValue = validateName(value);\r\n                break;\r\n            case 'phone':\r\n                sanitizedValue = validatePhone(value);\r\n                break;\r\n            case 'email':\r\n                sanitizedValue = validateEmail(value);\r\n                break;\r\n            case 'username':\r\n                sanitizedValue = validateUsername(value);\r\n                break;\r\n            case 'device':\r\n            case 'issue':\r\n                sanitizedValue = validateText(value);\r\n                break;\r\n            default:\r\n                sanitizedValue = value;\r\n        }\r\n\r\n        setFormData({ ...formData, [name]: sanitizedValue });\r\n    };\r\n\r\n    const nextStep = () => setStep(step + 1);\r\n    const prevStep = () => setStep(step - 1);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        console.log('≡ƒö╡ BOOKING SUBMIT STARTED');\r\n        console.log('Form Data:', formData);\r\n\r\n        // Validate account creation fields if enabled\r\n        if (createAccount) {\r\n            if (!formData.username) {\r\n                alert('Please enter a username');\r\n                return;\r\n            }\r\n            if (formData.password.length < 6) {\r\n                alert('Password must be at least 6 characters');\r\n                return;\r\n            }\r\n            if (formData.password !== formData.confirmPassword) {\r\n                alert('Passwords do not match');\r\n                return;\r\n            }\r\n        }\r\n\r\n        try {\r\n            // Create account first if requested\r\n            if (createAccount && !user) {\r\n                const users = await mockApi.getUsers();\r\n                if (users.find(u => u.username.toLowerCase() === formData.username.toLowerCase())) {\r\n                    alert('Username already exists. Please choose another.');\r\n                    return;\r\n                }\r\n\r\n                // Create user account\r\n                await mockApi.addUser({\r\n                    name: formData.name,\r\n                    username: formData.username,\r\n                    email: formData.email,\r\n                    phone: formData.phone,\r\n                    password: formData.password,\r\n                    role: 'customer'\r\n                });\r\n\r\n                // Create customer record\r\n                await mockApi.addCustomer({\r\n                    name: formData.name,\r\n                    email: formData.email,\r\n                    phone: formData.phone,\r\n                    totalBookings: 1,\r\n                    lastVisit: new Date().toISOString().split('T')[0],\r\n                    notes: 'Created during booking',\r\n                    tags: []\r\n                });\r\n\r\n                setAccountCreated(true);\r\n\r\n                // Auto-login the new user\r\n                await login(formData.username, formData.password);\r\n            }\r\n\r\n            const selectedService = services.find(s => s.id === formData.serviceId || s.name === formData.serviceType);\r\n            const basePrice = selectedService ? (selectedService.priceMin + selectedService.priceMax) / 2 : 0;\r\n            const priorityFee = priorityLevels.find(p => p.id === formData.priorityLevel)?.fee || 0;\r\n\r\n            const bookingData = {\r\n                // Structured device info for creating device record\r\n                device: {\r\n                    type: formData.deviceType,\r\n                    brand: formData.deviceBrand,\r\n                    model: formData.deviceModel\r\n                },\r\n                // Service with ID for database linking\r\n                serviceId: formData.serviceId || selectedService?.id || null,\r\n                issue: formData.issue,\r\n                priorityLevel: formData.priorityLevel,\r\n                date: formData.date,\r\n                timeSlotId: formData.timeSlotId || null,\r\n                customer: {\r\n                    name: formData.name,\r\n                    email: formData.email,\r\n                    phone: formData.phone\r\n                }\r\n            };\r\n            console.log('≡ƒƒó Calling api.bookings.create with:', bookingData);\r\n            const result = await api.bookings.create(bookingData);\r\n            console.log('Γ£à Booking created successfully:', result);\r\n            setBookingId(result.booking_id);\r\n            setTrackingNumber(result.tracking_number);\r\n            setStep(4); // Success step\r\n        } catch (error) {\r\n            console.error('Γ¥î Booking failed:', error);\r\n            console.error('Error details:', error.message, error.stack);\r\n            alert('Failed to submit booking. Please try again.');\r\n        }\r\n    };\r\n\r\n    // Get minimum date (today)\r\n    const getMinDate = () => {\r\n        const today = new Date();\r\n        return today.toISOString().split('T')[0];\r\n    };\r\n\r\n    const canConfirmBooking = () => {\r\n        const basicValid = formData.name.trim() && formData.email.trim() && formData.phone.trim();\r\n        if (!createAccount) return basicValid;\r\n        return basicValid && formData.username && formData.password.length >= 6 && formData.password === formData.confirmPassword;\r\n    };\r\n\r\n    const features = [\r\n        { icon: Zap, title: 'Quick Service', description: 'Same-day repairs', color: 'blue' },\r\n        { icon: Shield, title: '30-Day Warranty', description: 'On all repairs', color: 'green' },\r\n        { icon: Award, title: 'Expert Techs', description: 'Certified specialists', color: 'purple' },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"booking-page\">\r\n            {/* Hero Section */}\r\n            <section className=\"booking-hero\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"booking-hero-content\"\r\n                        initial={{ opacity: 0, y: 30 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.6 }}\r\n                    >\r\n                        <span className=\"hero-badge\">Book a Repair</span>\r\n                        <h1>Schedule Your Device Repair</h1>\r\n                        <p>Book an appointment in minutes. Our expert technicians will get your device working like new.</p>\r\n                    </motion.div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Features Section */}\r\n            <section className=\"booking-features-section\">\r\n                <div className=\"container\">\r\n                    <div className=\"features-row\">\r\n                        {features.map((feature, index) => (\r\n                            <motion.div\r\n                                key={feature.title}\r\n                                className=\"feature-item\"\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ duration: 0.4, delay: index * 0.1 }}\r\n                            >\r\n                                <div className={`feature-icon-small ${feature.color}`}>\r\n                                    <feature.icon size={20} />\r\n                                </div>\r\n                                <div>\r\n                                    <h3>{feature.title}</h3>\r\n                                    <p>{feature.description}</p>\r\n                                </div>\r\n                            </motion.div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Form Section */}\r\n            <section className=\"booking-form-section\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"booking-form-card\"\r\n                        initial={{ opacity: 0, y: 20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.5, delay: 0.2 }}\r\n                    >\r\n                        {/* Step Indicator */}\r\n                        {step < 4 && (\r\n                            <div className=\"step-indicator\">\r\n                                <div className=\"step-progress-bar\">\r\n                                    <div className=\"step-progress-fill\" style={{ width: `${((step - 1) / 2) * 100}%` }}></div>\r\n                                </div>\r\n                                <div className=\"step-items\">\r\n                                    <div className={`step ${step >= 1 ? 'active' : ''} ${step > 1 ? 'completed' : ''}`}>\r\n                                        <span className=\"step-number\">1</span>\r\n                                        <span className=\"step-label\">Device</span>\r\n                                    </div>\r\n                                    <div className={`step ${step >= 2 ? 'active' : ''} ${step > 2 ? 'completed' : ''}`}>\r\n                                        <span className=\"step-number\">2</span>\r\n                                        <span className=\"step-label\">Schedule</span>\r\n                                    </div>\r\n                                    <div className={`step ${step >= 3 ? 'active' : ''}`}>\r\n                                        <span className=\"step-number\">3</span>\r\n                                        <span className=\"step-label\">Contact</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {step === 1 && (\r\n                            <motion.div\r\n                                className=\"form-step\"\r\n                                initial={{ opacity: 0, x: 20 }}\r\n                                animate={{ opacity: 1, x: 0 }}\r\n                                transition={{ duration: 0.3 }}\r\n                            >\r\n                                <div className=\"form-step-header\">\r\n                                    <Smartphone size={24} />\r\n                                    <div>\r\n                                        <h2>Device Information</h2>\r\n                                        <p>Tell us about your device and the issue</p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"form-row\">\r\n                                    <div className=\"form-group\">\r\n                                        <label>Device Type *</label>\r\n                                        <select name=\"deviceType\" value={formData.deviceType} onChange={handleChange}>\r\n                                            <option value=\"phone\">Phone</option>\r\n                                            <option value=\"tablet\">Tablet</option>\r\n                                            <option value=\"laptop\">Laptop</option>\r\n                                            <option value=\"desktop\">Desktop</option>\r\n                                            <option value=\"watch\">Smart Watch</option>\r\n                                            <option value=\"console\">Game Console</option>\r\n                                            <option value=\"other\">Other</option>\r\n                                        </select>\r\n                                    </div>\r\n                                    <div className=\"form-group\">\r\n                                        <label>Brand *</label>\r\n                                        <input type=\"text\" name=\"deviceBrand\" placeholder=\"e.g. Apple, Samsung, Dell\" value={formData.deviceBrand} onChange={handleChange} />\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Model *</label>\r\n                                    <input type=\"text\" name=\"deviceModel\" placeholder=\"e.g. iPhone 14 Pro, Galaxy S23, MacBook Air\" value={formData.deviceModel} onChange={handleChange} />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Service Type *</label>\r\n                                    <select name=\"serviceType\" value={formData.serviceType} onChange={(e) => {\r\n                                        const selectedService = services.find(s => s.name === e.target.value);\r\n                                        setFormData({\r\n                                            ...formData,\r\n                                            serviceType: e.target.value,\r\n                                            serviceId: selectedService?.id || ''\r\n                                        });\r\n                                    }}>\r\n                                        <option value=\"\">Select a service...</option>\r\n                                        {services.map(service => (\r\n                                            <option key={service.id} value={service.name}>\r\n                                                {service.name} (${service.priceMin} - ${service.priceMax})\r\n                                            </option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Issue Description *</label>\r\n                                    <textarea name=\"issue\" placeholder=\"Describe the problem...\" rows=\"4\" value={formData.issue} onChange={handleChange}></textarea>\r\n                                </div>\r\n\r\n                                {/* Priority Service Selection */}\r\n                                {formData.serviceType && (\r\n                                    <div className=\"priority-section\">\r\n                                        <div className=\"priority-header\">\r\n                                            <Zap size={20} />\r\n                                            <div>\r\n                                                <h3>Priority Service</h3>\r\n                                                <p>Choose how fast you want your repair handled. Priority options add a service fee and move your repair ahead in the queue.</p>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"priority-options\">\r\n                                            {priorityLevels.map(level => {\r\n                                                const Icon = level.icon;\r\n                                                return (\r\n                                                    <div\r\n                                                        key={level.id}\r\n                                                        className={`priority-card ${formData.priorityLevel === level.id ? 'selected' : ''} ${level.popular ? 'popular' : ''}`}\r\n                                                        onClick={() => setFormData({ ...formData, priorityLevel: level.id })}\r\n                                                    >\r\n                                                        {level.popular && <span className=\"popular-badge\">Most Popular</span>}\r\n                                                        <div className=\"priority-card-header\">\r\n                                                            <div className=\"priority-icon\">\r\n                                                                <Icon size={20} />\r\n                                                            </div>\r\n                                                            <div className=\"priority-info\">\r\n                                                                <span className=\"priority-name\">{level.name}</span>\r\n                                                                <span className=\"priority-badge\">{level.badge}</span>\r\n                                                            </div>\r\n                                                            <div className=\"priority-fee\">\r\n                                                                {level.fee === 0 ? (\r\n                                                                    <span className=\"fee-free\">$0 extra</span>\r\n                                                                ) : (\r\n                                                                    <span className=\"fee-amount\">+${level.fee}</span>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <p className=\"priority-description\">{level.description}</p>\r\n                                                        <div className=\"priority-radio\">\r\n                                                            <input\r\n                                                                type=\"radio\"\r\n                                                                name=\"priorityLevel\"\r\n                                                                value={level.id}\r\n                                                                checked={formData.priorityLevel === level.id}\r\n                                                                onChange={() => setFormData({ ...formData, priorityLevel: level.id })}\r\n                                                            />\r\n                                                            <span className=\"radio-custom\"></span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                );\r\n                                            })}\r\n                                        </div>\r\n\r\n                                        {/* Price Summary */}\r\n                                        <div className=\"price-summary\">\r\n                                            <h4><DollarSign size={18} /> Price Summary</h4>\r\n                                            <div className=\"summary-row\">\r\n                                                <span>Repair Estimate:</span>\r\n                                                <span>\r\n                                                    {(() => {\r\n                                                        const service = services.find(s => s.name === formData.serviceType);\r\n                                                        return service ? `$${service.priceMin} - $${service.priceMax}` : '--';\r\n                                                    })()}\r\n                                                </span>\r\n                                            </div>\r\n                                            <div className=\"summary-row\">\r\n                                                <span>Priority add-on:</span>\r\n                                                <span className={priorityLevels.find(p => p.id === formData.priorityLevel)?.fee > 0 ? 'highlight' : ''}>\r\n                                                    +${priorityLevels.find(p => p.id === formData.priorityLevel)?.fee || 0}\r\n                                                </span>\r\n                                            </div>\r\n                                            <div className=\"summary-row total\">\r\n                                                <span>Estimated Total:</span>\r\n                                                <span>\r\n                                                    {(() => {\r\n                                                        const service = services.find(s => s.name === formData.serviceType);\r\n                                                        const fee = priorityLevels.find(p => p.id === formData.priorityLevel)?.fee || 0;\r\n                                                        if (!service) return '--';\r\n                                                        return `$${service.priceMin + fee} - $${service.priceMax + fee}`;\r\n                                                    })()}\r\n                                                </span>\r\n                                            </div>\r\n                                            <p className=\"summary-disclaimer\">\r\n                                                Turnaround depends on device condition and parts availability.\r\n                                            </p>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                <div className=\"step-actions\">\r\n                                    <div></div>\r\n                                    <Button variant=\"primary\" onClick={nextStep} disabled={!formData.deviceBrand.trim() || !formData.deviceModel.trim() || !formData.serviceType || !formData.issue.trim()}>\r\n                                        Next Step <ArrowRight size={18} />\r\n                                    </Button>\r\n                                </div>\r\n                            </motion.div>\r\n                        )}\r\n\r\n                        {step === 2 && (\r\n                            <motion.div\r\n                                className=\"form-step\"\r\n                                initial={{ opacity: 0, x: 20 }}\r\n                                animate={{ opacity: 1, x: 0 }}\r\n                                transition={{ duration: 0.3 }}\r\n                            >\r\n                                <div className=\"form-step-header\">\r\n                                    <Calendar size={24} />\r\n                                    <div>\r\n                                        <h2>Date & Time</h2>\r\n                                        <p>Select your preferred appointment time</p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"form-group\">\r\n                                    <label>Preferred Date *</label>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        name=\"date\"\r\n                                        value={formData.date}\r\n                                        onChange={handleChange}\r\n                                        min={getMinDate()}\r\n                                    />\r\n                                </div>\r\n\r\n                                <div className=\"form-group\">\r\n                                    <label>Available Time Slots</label>\r\n                                    {formData.date ? (\r\n                                        <div className=\"time-slots-grid\">\r\n                                            {timeSlots.length > 0 ? timeSlots.map(slot => {\r\n                                                const availability = getSlotAvailability(formData.date, slot);\r\n                                                return (\r\n                                                    <div\r\n                                                        key={slot.id}\r\n                                                        className={`time-slot-card ${formData.time === slot.name ? 'selected' : ''} ${!availability.available ? 'unavailable' : ''}`}\r\n                                                        onClick={() => availability.available && setFormData({ ...formData, time: slot.name, timeSlotId: slot.id })}\r\n                                                    >\r\n                                                        <div className=\"slot-header\">\r\n                                                            <Clock size={18} />\r\n                                                            <span className=\"slot-name\">{slot.name}</span>\r\n                                                        </div>\r\n                                                        <div className=\"slot-time\">{slot.startTime} - {slot.endTime}</div>\r\n                                                        <div className={`slot-availability ${availability.available ? 'available' : 'full'}`}>\r\n                                                            {availability.available ? (\r\n                                                                <>\r\n                                                                    <CheckCircle size={14} />\r\n                                                                    <span>{availability.max - availability.count} slots available</span>\r\n                                                                </>\r\n                                                            ) : (\r\n                                                                <>\r\n                                                                    <AlertCircle size={14} />\r\n                                                                    <span>Fully booked</span>\r\n                                                                </>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                );\r\n                                            }) : (\r\n                                                <p className=\"select-date-hint\">No time slots configured. Please contact the shop.</p>\r\n                                            )}\r\n                                        </div>\r\n                                    ) : (\r\n                                        <p className=\"select-date-hint\">Please select a date first to see available time slots</p>\r\n                                    )}\r\n                                </div>\r\n\r\n                                <div className=\"step-actions\">\r\n                                    <Button variant=\"secondary\" onClick={prevStep}>\r\n                                        <ArrowLeft size={18} /> Back\r\n                                    </Button>\r\n                                    <Button variant=\"primary\" onClick={nextStep} disabled={!formData.date || !formData.time}>\r\n                                        Next Step <ArrowRight size={18} />\r\n                                    </Button>\r\n                                </div>\r\n                            </motion.div>\r\n                        )}\r\n\r\n                        {step === 3 && (\r\n                            <motion.div\r\n                                className=\"form-step\"\r\n                                initial={{ opacity: 0, x: 20 }}\r\n                                animate={{ opacity: 1, x: 0 }}\r\n                                transition={{ duration: 0.3 }}\r\n                            >\r\n                                <div className=\"form-step-header\">\r\n                                    <User size={24} />\r\n                                    <div>\r\n                                        <h2>Contact Details</h2>\r\n                                        <p>How can we reach you?</p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {user && (\r\n                                    <div className=\"logged-in-notice\">\r\n                                        <CheckCircle size={18} />\r\n                                        <span>Logged in as <strong>{user.name || user.username}</strong></span>\r\n                                    </div>\r\n                                )}\r\n\r\n                                <div className=\"form-group\">\r\n                                    <label>Name *</label>\r\n                                    <input type=\"text\" name=\"name\" value={formData.name} onChange={handleChange} placeholder=\"Your full name\" />\r\n                                </div>\r\n                                <div className=\"form-row\">\r\n                                    <div className=\"form-group\">\r\n                                        <label>Email *</label>\r\n                                        <input type=\"email\" name=\"email\" value={formData.email} onChange={handleChange} placeholder=\"your@email.com\" />\r\n                                    </div>\r\n                                    <div className=\"form-group\">\r\n                                        <label>Phone *</label>\r\n                                        <input type=\"tel\" name=\"phone\" value={formData.phone} onChange={handleChange} placeholder=\"(555) 123-4567\" />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {!user && (\r\n                                    <div className=\"create-account-section\">\r\n                                        <label className=\"checkbox-label\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={createAccount}\r\n                                                onChange={(e) => setCreateAccount(e.target.checked)}\r\n                                            />\r\n                                            <UserPlus size={16} />\r\n                                            <span>Create an account to track your repairs</span>\r\n                                        </label>\r\n\r\n                                        {createAccount && (\r\n                                            <motion.div\r\n                                                className=\"account-fields\"\r\n                                                initial={{ opacity: 0, height: 0 }}\r\n                                                animate={{ opacity: 1, height: 'auto' }}\r\n                                            >\r\n                                                <div className=\"form-group\">\r\n                                                    <label><Lock size={14} /> Username</label>\r\n                                                    <input\r\n                                                        type=\"text\"\r\n                                                        name=\"username\"\r\n                                                        value={formData.username}\r\n                                                        onChange={handleChange}\r\n                                                        placeholder=\"Choose a username\"\r\n                                                    />\r\n                                                </div>\r\n                                                <div className=\"form-row\">\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><Lock size={14} /> Password</label>\r\n                                                        <input\r\n                                                            type=\"password\"\r\n                                                            name=\"password\"\r\n                                                            value={formData.password}\r\n                                                            onChange={handleChange}\r\n                                                            placeholder=\"Min 6 characters\"\r\n                                                        />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><Lock size={14} /> Confirm Password</label>\r\n                                                        <input\r\n                                                            type=\"password\"\r\n                                                            name=\"confirmPassword\"\r\n                                                            value={formData.confirmPassword}\r\n                                                            onChange={handleChange}\r\n                                                            placeholder=\"Re-enter password\"\r\n                                                        />\r\n                                                    </div>\r\n                                                </div>\r\n                                            </motion.div>\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n\r\n                                <div className=\"step-actions\">\r\n                                    <Button variant=\"secondary\" onClick={prevStep}>\r\n                                        <ArrowLeft size={18} /> Back\r\n                                    </Button>\r\n                                    <Button variant=\"primary\" onClick={handleSubmit} disabled={!canConfirmBooking()}>\r\n                                        Confirm Booking <CheckCircle size={18} />\r\n                                    </Button>\r\n                                </div>\r\n                            </motion.div>\r\n                        )}\r\n\r\n                        {step === 4 && (\r\n                            <motion.div\r\n                                className=\"booking-success\"\r\n                                initial={{ opacity: 0, scale: 0.9 }}\r\n                                animate={{ opacity: 1, scale: 1 }}\r\n                                transition={{ duration: 0.5 }}\r\n                            >\r\n                                <div className=\"success-icon-wrapper\">\r\n                                    <CheckCircle size={60} />\r\n                                </div>\r\n                                <h2>Booking Confirmed!</h2>\r\n                                <div className=\"booking-id-box\">\r\n                                    <span>Your Tracking Number</span>\r\n                                    <strong style={{ fontSize: '1.5rem', letterSpacing: '1px' }}>{trackingNumber}</strong>\r\n                                </div>\r\n                                {accountCreated && (\r\n                                    <div className=\"account-created-notice\">\r\n                                        <UserPlus size={18} />\r\n                                        <span>Your account has been created! You're now logged in.</span>\r\n                                    </div>\r\n                                )}\r\n                                <p>Save this tracking number to follow your repair progress. We'll contact you shortly to confirm your appointment.</p>\r\n                                <div className=\"success-actions\">\r\n                                    {(user || accountCreated) ? (\r\n                                        <Button variant=\"primary\" onClick={() => navigate('/customer/profile')}>\r\n                                            Go to My Profile <ArrowRight size={18} />\r\n                                        </Button>\r\n                                    ) : (\r\n                                        <Link to={`/track`}>\r\n                                            <Button variant=\"primary\">\r\n                                                Track Repair <ArrowRight size={18} />\r\n                                            </Button>\r\n                                        </Link>\r\n                                    )}\r\n                                    <Link to=\"/\">\r\n                                        <Button variant=\"secondary\">Back to Home</Button>\r\n                                    </Link>\r\n                                </div>\r\n                            </motion.div>\r\n                        )}\r\n                    </motion.div>\r\n                </div>\r\n            </section>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Booking;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\Contact.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[158,197],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Phone, Mail, MapPin, Send, Clock, MessageCircle, Headphones, ArrowRight } from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\nimport Button from '../../../components/Button';\r\nimport { api } from '../../../services/apiClient';\r\nimport { mockApi } from '../../../services/mockApi'; // Keep for settings\r\nimport './Contact.css';\r\n\r\nconst Contact = () => {\r\n    const [settings, setSettings] = useState({\r\n        phone: '(555) 123-4567',\r\n        email: 'support@sifixa.com',\r\n        address: '123 Tech Street, New York, NY 10001',\r\n        businessHours: 'Mon-Sat: 9AM - 8PM'\r\n    });\r\n\r\n    const [formData, setFormData] = useState({\r\n        name: '',\r\n        email: '',\r\n        subject: '',\r\n        message: ''\r\n    });\r\n\r\n    useEffect(() => {\r\n        window.scrollTo(0, 0);\r\n        const loadSettings = async () => {\r\n            try {\r\n                const data = await mockApi.getSettings();\r\n                setSettings(data);\r\n            } catch (error) {\r\n                console.error('Failed to load settings', error);\r\n            }\r\n        };\r\n        loadSettings();\r\n    }, []);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            await api.messages.create({\r\n                name: formData.name,\r\n                email: formData.email,\r\n                subject: formData.subject,\r\n                message: formData.message\r\n            });\r\n            alert('Message sent! We\\'ll get back to you within 24 hours.');\r\n            setFormData({ name: '', email: '', subject: '', message: '' });\r\n        } catch (error) {\r\n            console.error('Failed to send message:', error);\r\n            alert('Failed to send message. Please try again.');\r\n        }\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n        setFormData({ ...formData, [e.target.name]: e.target.value });\r\n    };\r\n\r\n    return (\r\n        <div className=\"contact-page\">\r\n            {/* Hero Section */}\r\n            <section className=\"contact-hero\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"contact-hero-content\"\r\n                        initial={{ opacity: 0, y: 30 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.6 }}\r\n                    >\r\n                        <span className=\"hero-badge\">Contact Us</span>\r\n                        <h1>Let's Start a Conversation</h1>\r\n                        <p>Have questions about our repair services? Need a quote? We're here to help!</p>\r\n                    </motion.div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Quick Contact Cards */}\r\n            <section className=\"quick-contact-section\">\r\n                <div className=\"container\">\r\n                    <div className=\"quick-contact-grid\">\r\n                        <motion.a\r\n                            href={`tel:${settings.phone}`}\r\n                            className=\"quick-contact-card\"\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ duration: 0.4, delay: 0.1 }}\r\n                            whileHover={{ y: -5 }}\r\n                        >\r\n                            <div className=\"quick-icon phone\">\r\n                                <Phone size={24} />\r\n                            </div>\r\n                            <h3>Call Us</h3>\r\n                            <p>{settings.phone}</p>\r\n                            <span className=\"quick-link\">Call now <ArrowRight size={16} /></span>\r\n                        </motion.a>\r\n\r\n                        <motion.a\r\n                            href={`mailto:${settings.email}`}\r\n                            className=\"quick-contact-card\"\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ duration: 0.4, delay: 0.2 }}\r\n                            whileHover={{ y: -5 }}\r\n                        >\r\n                            <div className=\"quick-icon email\">\r\n                                <Mail size={24} />\r\n                            </div>\r\n                            <h3>Email Us</h3>\r\n                            <p>{settings.email}</p>\r\n                            <span className=\"quick-link\">Send email <ArrowRight size={16} /></span>\r\n                        </motion.a>\r\n\r\n                        <motion.div\r\n                            className=\"quick-contact-card\"\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ duration: 0.4, delay: 0.3 }}\r\n                        >\r\n                            <div className=\"quick-icon location\">\r\n                                <MapPin size={24} />\r\n                            </div>\r\n                            <h3>Visit Us</h3>\r\n                            <p>{settings.address}</p>\r\n                            <span className=\"quick-link\">Get directions <ArrowRight size={16} /></span>\r\n                        </motion.div>\r\n\r\n                        <motion.div\r\n                            className=\"quick-contact-card\"\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ duration: 0.4, delay: 0.4 }}\r\n                        >\r\n                            <div className=\"quick-icon hours\">\r\n                                <Clock size={24} />\r\n                            </div>\r\n                            <h3>Business Hours</h3>\r\n                            <p>Mon-Sat: 9AM - 8PM</p>\r\n                            <p className=\"sub-text\">Sun: 10AM - 6PM</p>\r\n                        </motion.div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Main Contact Section */}\r\n            <section className=\"main-contact-section\">\r\n                <div className=\"container\">\r\n                    <div className=\"contact-grid\">\r\n                        {/* Contact Form */}\r\n                        <motion.div\r\n                            className=\"contact-form-wrapper\"\r\n                            initial={{ opacity: 0, x: -30 }}\r\n                            animate={{ opacity: 1, x: 0 }}\r\n                            transition={{ duration: 0.5 }}\r\n                        >\r\n                            <div className=\"form-header\">\r\n                                <MessageCircle size={28} className=\"form-icon\" />\r\n                                <div>\r\n                                    <h2>Send Us a Message</h2>\r\n                                    <p>Fill out the form and we'll respond within 24 hours</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <form className=\"contact-form\" onSubmit={handleSubmit}>\r\n                                <div className=\"form-row\">\r\n                                    <div className=\"form-group\">\r\n                                        <label>Your Name *</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            name=\"name\"\r\n                                            placeholder=\"John Doe\"\r\n                                            value={formData.name}\r\n                                            onChange={handleChange}\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"form-group\">\r\n                                        <label>Email Address *</label>\r\n                                        <input\r\n                                            type=\"email\"\r\n                                            name=\"email\"\r\n                                            placeholder=\"john@example.com\"\r\n                                            value={formData.email}\r\n                                            onChange={handleChange}\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"form-group\">\r\n                                    <label>Subject</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        name=\"subject\"\r\n                                        placeholder=\"How can we help you?\"\r\n                                        value={formData.subject}\r\n                                        onChange={handleChange}\r\n                                    />\r\n                                </div>\r\n\r\n                                <div className=\"form-group\">\r\n                                    <label>Your Message *</label>\r\n                                    <textarea\r\n                                        name=\"message\"\r\n                                        placeholder=\"Tell us about your device issue or inquiry...\"\r\n                                        rows=\"6\"\r\n                                        value={formData.message}\r\n                                        onChange={handleChange}\r\n                                        required\r\n                                    ></textarea>\r\n                                </div>\r\n\r\n                                <Button variant=\"primary\" type=\"submit\" className=\"submit-btn\">\r\n                                    Send Message <Send size={18} />\r\n                                </Button>\r\n                            </form>\r\n                        </motion.div>\r\n\r\n                        {/* Map & Additional Info */}\r\n                        <motion.div\r\n                            className=\"contact-info-wrapper\"\r\n                            initial={{ opacity: 0, x: 30 }}\r\n                            animate={{ opacity: 1, x: 0 }}\r\n                            transition={{ duration: 0.5 }}\r\n                        >\r\n                            <div className=\"map-card\">\r\n                                <iframe\r\n                                    src=\"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d49475.76863554285!2d-78.91827565!3d38.4495688!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89b4e4102bd07dc9%3A0x7dfb3f2497379cb!2sHarrisonburg%2C%20VA!5e0!3m2!1sen!2sus!4v1701720000000!5m2!1sen!2sus\"\r\n                                    width=\"100%\"\r\n                                    height=\"280\"\r\n                                    style={{ border: 0, borderRadius: '16px' }}\r\n                                    allowFullScreen=\"\"\r\n                                    loading=\"lazy\">\r\n                                </iframe>\r\n                            </div>\r\n\r\n                            <div className=\"support-card\">\r\n                                <div className=\"support-icon\">\r\n                                    <Headphones size={32} />\r\n                                </div>\r\n                                <div className=\"support-content\">\r\n                                    <h3>Need Immediate Help?</h3>\r\n                                    <p>Our support team is available during business hours for urgent repairs.</p>\r\n                                    <a href={`tel:${settings.phone}`} className=\"support-call-btn\">\r\n                                        <Phone size={18} />\r\n                                        Call {settings.phone}\r\n                                    </a>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"faq-promo-card\">\r\n                                <h3>Frequently Asked Questions</h3>\r\n                                <p>Find quick answers to common questions about our services.</p>\r\n                                <a href=\"/faq\" className=\"faq-link\">\r\n                                    View FAQ <ArrowRight size={16} />\r\n                                </a>\r\n                            </div>\r\n                        </motion.div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Contact;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\CookiePolicy.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\CustomerLogin.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":93,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":93,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport { useAuth } from '../../../context/AuthContext';\r\nimport Button from '../../../components/Button';\r\nimport ThemeToggle from '../../../components/ThemeToggle';\r\nimport { validateName, validateEmail, validatePhone } from '../../../utils/validation';\r\nimport { User, UserPlus, ArrowLeft, Mail, Phone, Lock, KeyRound, ShieldCheck, AlertCircle } from 'lucide-react';\r\nimport './Login.css';\r\n\r\nconst CustomerLogin = () => {\r\n    const [mode, setMode] = useState('login');\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [confirmPassword, setConfirmPassword] = useState('');\r\n    const [name, setName] = useState('');\r\n    const [phone, setPhone] = useState('');\r\n    const [error, setError] = useState('');\r\n    const [success, setSuccess] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const [acceptedTerms, setAcceptedTerms] = useState(false);\r\n\r\n    const { login, signup, isAuthenticated, isCustomer } = useAuth();\r\n    const navigate = useNavigate();\r\n\r\n    // Redirect if already logged in as customer\r\n    useEffect(() => {\r\n        if (isAuthenticated && isCustomer) {\r\n            navigate('/customer/profile');\r\n        }\r\n    }, [isAuthenticated, isCustomer, navigate]);\r\n\r\n    const handleNameChange = (e) => {\r\n        const sanitized = validateName(e.target.value);\r\n        setName(sanitized);\r\n    };\r\n\r\n    const handlePhoneChange = (e) => {\r\n        const sanitized = validatePhone(e.target.value);\r\n        setPhone(sanitized);\r\n    };\r\n\r\n    const handleLogin = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setLoading(true);\r\n\r\n        const result = await login(email, password);\r\n        if (result.success) {\r\n            // Redirect handled by useEffect\r\n        } else {\r\n            setError(result.error || 'Login failed. Please check your credentials.');\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const handleSignup = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setSuccess('');\r\n\r\n        if (!acceptedTerms) {\r\n            setError('You must accept the Terms of Use and Privacy Policy to create an account');\r\n            return;\r\n        }\r\n        if (password.length < 6) {\r\n            setError('Password must be at least 6 characters');\r\n            return;\r\n        }\r\n        if (password !== confirmPassword) {\r\n            setError('Passwords do not match');\r\n            return;\r\n        }\r\n        if (!email.includes('@')) {\r\n            setError('Please enter a valid email address');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n\r\n        try {\r\n            const result = await signup(email, password, { fullName: name, phone });\r\n\r\n            if (result.success) {\r\n                setSuccess('Account created! Please check your email to verify your account.');\r\n                setMode('login');\r\n                setPassword('');\r\n                setConfirmPassword('');\r\n                setName('');\r\n                setPhone('');\r\n            } else {\r\n                setError(result.error || 'Signup failed. Please try again.');\r\n            }\r\n        } catch (err) {\r\n            setError('Failed to create account. Please try again.');\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const switchMode = (newMode) => {\r\n        setMode(newMode);\r\n        setError('');\r\n        setSuccess('');\r\n    };\r\n\r\n    return (\r\n        <div className=\"login-page\">\r\n            <div className=\"theme-toggle-corner\">\r\n                <ThemeToggle />\r\n            </div>\r\n            <Link to=\"/\" className=\"home-link\">\r\n                <ArrowLeft size={18} /> Back to Home\r\n            </Link>\r\n            <div className=\"login-container\">\r\n                <div className=\"portal-badge customer\">Customer Portal</div>\r\n\r\n                {(mode === 'login' || mode === 'signup') && (\r\n                    <div className=\"auth-tabs\">\r\n                        <button\r\n                            className={`auth-tab ${mode === 'login' ? 'active' : ''}`}\r\n                            onClick={() => switchMode('login')}\r\n                        >\r\n                            <User size={18} /> Sign In\r\n                        </button>\r\n                        <button\r\n                            className={`auth-tab ${mode === 'signup' ? 'active' : ''}`}\r\n                            onClick={() => switchMode('signup')}\r\n                        >\r\n                            <UserPlus size={18} /> Sign Up\r\n                        </button>\r\n                    </div>\r\n                )}\r\n\r\n                {mode === 'login' && (\r\n                    <>\r\n                        <h1>Welcome Back</h1>\r\n                        <p>Sign in to track your repairs and manage bookings.</p>\r\n\r\n                        {error && <div className=\"error-message\"><AlertCircle size={16} /> {error}</div>}\r\n                        {success && <div className=\"success-message\">{success}</div>}\r\n\r\n                        <form className=\"login-form\" onSubmit={handleLogin}>\r\n                            <div className=\"form-group\">\r\n                                <label><Mail size={16} /> Email</label>\r\n                                <input\r\n                                    type=\"email\"\r\n                                    value={email}\r\n                                    onChange={(e) => setEmail(e.target.value)}\r\n                                    placeholder=\"Enter your email\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label><Lock size={16} /> Password</label>\r\n                                <input\r\n                                    type=\"password\"\r\n                                    value={password}\r\n                                    onChange={(e) => setPassword(e.target.value)}\r\n                                    placeholder=\"Enter your password\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <Button variant=\"primary\" type=\"submit\" disabled={loading}>\r\n                                {loading ? 'Signing in...' : 'Sign In'}\r\n                            </Button>\r\n                        </form>\r\n\r\n                        <button\r\n                            className=\"forgot-password-link\"\r\n                            onClick={() => alert('Password reset functionality coming soon. Please contact support.')}\r\n                        >\r\n                            <KeyRound size={14} /> Forgot Password?\r\n                        </button>\r\n                    </>\r\n                )}\r\n\r\n                {mode === 'signup' && (\r\n                    <>\r\n                        <h1>Create Account</h1>\r\n                        <p>Sign up to track your repairs and manage bookings.</p>\r\n\r\n                        {error && <div className=\"error-message\"><AlertCircle size={16} /> {error}</div>}\r\n\r\n                        <form className=\"login-form signup-form\" onSubmit={handleSignup}>\r\n                            <div className=\"form-row\">\r\n                                <div className=\"form-group\">\r\n                                    <label><User size={16} /> Full Name</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={name}\r\n                                        onChange={handleNameChange}\r\n                                        placeholder=\"John Doe\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label><Phone size={16} /> Phone <span className=\"optional\">(optional)</span></label>\r\n                                    <input\r\n                                        type=\"tel\"\r\n                                        value={phone}\r\n                                        onChange={handlePhoneChange}\r\n                                        placeholder=\"5551234567\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label><Mail size={16} /> Email <span className=\"required\">*</span></label>\r\n                                <input\r\n                                    type=\"email\"\r\n                                    value={email}\r\n                                    onChange={(e) => setEmail(validateEmail(e.target.value))}\r\n                                    placeholder=\"john@example.com\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-row\">\r\n                                <div className=\"form-group\">\r\n                                    <label><Lock size={16} /> Password</label>\r\n                                    <input\r\n                                        type=\"password\"\r\n                                        value={password}\r\n                                        onChange={(e) => setPassword(e.target.value)}\r\n                                        placeholder=\"Min 6 characters\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label><Lock size={16} /> Confirm Password</label>\r\n                                    <input\r\n                                        type=\"password\"\r\n                                        value={confirmPassword}\r\n                                        onChange={(e) => setConfirmPassword(e.target.value)}\r\n                                        placeholder=\"Re-enter password\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"verification-notice\">\r\n                                <ShieldCheck size={16} />\r\n                                <span>You'll receive a verification email to confirm your account</span>\r\n                            </div>\r\n\r\n                            <div className=\"terms-consent\">\r\n                                <label className=\"consent-checkbox\">\r\n                                    <input\r\n                                        type=\"checkbox\"\r\n                                        checked={acceptedTerms}\r\n                                        onChange={(e) => setAcceptedTerms(e.target.checked)}\r\n                                        required\r\n                                    />\r\n                                    <span className=\"checkmark\"></span>\r\n                                    <span className=\"consent-text\">\r\n                                        I agree to the{' '}\r\n                                        <Link to=\"/terms\" target=\"_blank\">Terms of Use</Link> and{' '}\r\n                                        <Link to=\"/privacy\" target=\"_blank\">Privacy Policy</Link>\r\n                                    </span>\r\n                                </label>\r\n                            </div>\r\n\r\n                            <Button variant=\"primary\" type=\"submit\" disabled={loading || !acceptedTerms}>\r\n                                {loading ? 'Creating Account...' : 'Create Account'}\r\n                            </Button>\r\n                        </form>\r\n                    </>\r\n                )}\r\n\r\n                <div className=\"staff-portal-link\">\r\n                    <p>Are you a staff member?</p>\r\n                    <Link to=\"/staff/login\">Go to Staff Portal</Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CustomerLogin;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\CustomerProfile.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'lazy' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"lazy"},"fix":{"range":[48,54],"text":""},"desc":"Remove unused variable 'lazy'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[194,233],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'api' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"api"},"fix":{"range":[235,285],"text":""},"desc":"Remove unused variable 'api'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getCustomerName' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":20,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"getCustomerName"},"fix":{"range":[1169,1186],"text":""},"desc":"Remove unused variable 'getCustomerName'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getBookingDate' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":20,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":56,"suggestions":[{"messageId":"removeVar","data":{"varName":"getBookingDate"},"fix":{"range":[1186,1202],"text":""},"desc":"Remove unused variable 'getBookingDate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'favorites' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":40,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"favorites"},"fix":{"range":[2113,2122],"text":""},"desc":"Remove unused variable 'favorites'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'services' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":41,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"services"},"fix":{"range":[2166,2174],"text":""},"desc":"Remove unused variable 'services'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAllData'. Either include it or remove the dependency array.","line":77,"column":8,"nodeType":"ArrayExpression","endLine":77,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [loadAllData, user]","fix":{"range":[4175,4181],"text":"[loadAllData, user]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getDeviceIcon' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":165,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"getDeviceIcon"},"fix":{"range":[8309,8680],"text":""},"desc":"Remove unused variable 'getDeviceIcon'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'totalSpent' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":206,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"totalSpent"},"fix":{"range":[10053,10172],"text":""},"desc":"Remove unused variable 'totalSpent'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleRemoveFavorite' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":272,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":272,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleRemoveFavorite"},"fix":{"range":[12383,12578],"text":""},"desc":"Remove unused variable 'handleRemoveFavorite'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleClaimWarranty' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":306,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":306,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleClaimWarranty"},"fix":{"range":[13503,13914],"text":""},"desc":"Remove unused variable 'handleClaimWarranty'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleAddPaymentMethod' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":318,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":318,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleAddPaymentMethod"},"fix":{"range":[13922,14206],"text":""},"desc":"Remove unused variable 'handleAddPaymentMethod'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getCardIcon' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":571,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":571,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"getCardIcon"},"fix":{"range":[26731,26979],"text":""},"desc":"Remove unused variable 'getCardIcon'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'idx' is defined but never used.","line":938,"column":88,"nodeType":"Identifier","messageId":"unusedVar","endLine":938,"endColumn":91,"suggestions":[{"messageId":"removeVar","data":{"varName":"idx"},"fix":{"range":[53211,53216],"text":""},"desc":"Remove unused variable 'idx'."}]},{"ruleId":"no-undef","severity":2,"message":"'handleSavePaymentMethod' is not defined.","line":2548,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":2548,"endColumn":52},{"ruleId":"no-undef","severity":2,"message":"'handleFileWarrantyClaim' is not defined.","line":2564,"column":31,"nodeType":"Identifier","messageId":"undef","endLine":2564,"endColumn":54},{"ruleId":"no-regex-spaces","severity":2,"message":"Spaces are hard to count. Use {2}.","line":2731,"column":134,"nodeType":"Literal","messageId":"multipleSpaces","endLine":2731,"endColumn":139,"fix":{"range":[175619,175621],"text":" {2}"}}],"suppressedMessages":[],"errorCount":17,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, lazy, Suspense } from 'react';\r\nimport { useAuth } from '../../../context/AuthContext';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport { api } from '../../../services/apiClient';\r\nimport { mockApi } from '../../../services/mockApi'; // Keep for legacy operations\r\nimport { generateInvoicePDF } from '../../../utils/pdfGenerator';\r\nimport Button from '../../../components/Button';\r\nimport ThemeToggle from '../../../components/ThemeToggle';\r\nimport {\r\n    User, Calendar, Package, Clock, Phone, Mail, MapPin, Home,\r\n    ChevronRight, MessageSquare, Send, ArrowLeft, CheckCircle,\r\n    AlertCircle, Clock3, XCircle, Edit2, Star, DollarSign, Bell,\r\n    Gift, Smartphone, Laptop, Tablet, Watch, Settings, Shield,\r\n    FileText, Heart, Award, TrendingUp, Download, Trash2, Plus,\r\n    X, Eye, EyeOff, Save, RefreshCw, CreditCard, Receipt, Crown, Menu, Camera,\r\n    Share2, Users, Copy, ShieldCheck, Globe, Volume2, VolumeX, Languages,\r\n    Lock, Unlock, ThumbsUp, MessageCircle, Ticket, Percent, Headphones, Loader2, Info\r\n} from 'lucide-react';\r\nimport { getDeviceName, getCustomerName, getBookingDate } from '../../../utils/schemaHelpers';\r\nimport './CustomerProfile.css';\r\n\r\nconst CustomerProfile = () => {\r\n    const { user, logout, updateUser } = useAuth();\r\n    const navigate = useNavigate();\r\n    const [activeTab, setActiveTab] = useState('overview');\r\n    const [bookings, setBookings] = useState([]);\r\n    const [customerData, setCustomerData] = useState(null);\r\n    const [customerId, setCustomerId] = useState(null);\r\n    const [messages, setMessages] = useState([]);\r\n    const [newMessage, setNewMessage] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n    const [sidebarOpen, setSidebarOpen] = useState(false);\r\n\r\n    // New state for enhanced features\r\n    const [devices, setDevices] = useState([]);\r\n    const [notifications, setNotifications] = useState([]);\r\n    const [loyalty, setLoyalty] = useState(null);\r\n    const [invoices, setInvoices] = useState([]);\r\n    const [favorites, setFavorites] = useState([]);\r\n    const [services, setServices] = useState([]);\r\n    const [timeSlots, setTimeSlots] = useState([]);\r\n\r\n    // New feature states\r\n    const [referrals, setReferrals] = useState([]);\r\n    const [referralCode, setReferralCode] = useState('');\r\n    const [warranties, setWarranties] = useState([]);\r\n    const [paymentMethods, setPaymentMethods] = useState([]);\r\n    const [customerSettings, setCustomerSettings] = useState(null);\r\n    const [reviews, setReviews] = useState([]);\r\n    const [reviewableBookings, setReviewableBookings] = useState([]);\r\n    const [liveChatMessages, setLiveChatMessages] = useState([]);\r\n    const [liveChatOpen, setLiveChatOpen] = useState(false);\r\n    const [liveChatInput, setLiveChatInput] = useState('');\r\n    const [isTyping, setIsTyping] = useState(false);\r\n    const [chatAttachment, setChatAttachment] = useState(null);\r\n    const [showQuickReplies, setShowQuickReplies] = useState(true);\r\n\r\n    // Modal states\r\n    const [showDeviceModal, setShowDeviceModal] = useState(false);\r\n    const [showRescheduleModal, setShowRescheduleModal] = useState(false);\r\n    const [showProfileModal, setShowProfileModal] = useState(false);\r\n    const [showPasswordModal, setShowPasswordModal] = useState(false);\r\n    const [showInvoiceModal, setShowInvoiceModal] = useState(false);\r\n    const [showPaymentModal, setShowPaymentModal] = useState(false);\r\n    const [showReviewModal, setShowReviewModal] = useState(false);\r\n    const [showWarrantyClaimModal, setShowWarrantyClaimModal] = useState(false);\r\n    const [showReferralInviteModal, setShowReferralInviteModal] = useState(false);\r\n    const [editingDevice, setEditingDevice] = useState(null);\r\n    const [selectedBooking, setSelectedBooking] = useState(null);\r\n    const [selectedInvoice, setSelectedInvoice] = useState(null);\r\n    const [selectedWarranty, setSelectedWarranty] = useState(null);\r\n    const [selectedBookingForReview, setSelectedBookingForReview] = useState(null);\r\n\r\n    useEffect(() => {\r\n        loadAllData();\r\n    }, [user]);\r\n\r\n    const loadAllData = useCallback(async () => {\r\n        if (!user) return;\r\n        setLoading(true);\r\n        try {\r\n            // Get customer profile\r\n            const customers = await mockApi.getCustomers();\r\n            const customer = customers.find(c => c.email === user.email);\r\n            setCustomerData(customer);\r\n            const custId = customer?.id || user.id;\r\n            setCustomerId(custId);\r\n\r\n            // Parallel load all data\r\n            const [\r\n                allBookings, servicesData, timeSlotsData, devicesData,\r\n                notificationsData, loyaltyData, invoicesData, favoritesData,\r\n                referralsData, refCode, warrantiesData, paymentMethodsData,\r\n                settingsData, reviewsData, reviewableData, chatHistory\r\n            ] = await Promise.all([\r\n                mockApi.getBookings(),\r\n                mockApi.getServices(),\r\n                mockApi.getTimeSlots(),\r\n                mockApi.getCustomerDevices(custId),\r\n                mockApi.getCustomerNotifications(custId),\r\n                mockApi.getCustomerLoyalty(custId),\r\n                mockApi.getCustomerInvoices(custId),\r\n                mockApi.getCustomerFavorites(custId),\r\n                mockApi.getCustomerReferrals(custId),\r\n                mockApi.generateReferralCode(custId),\r\n                mockApi.getCustomerWarranties(custId),\r\n                mockApi.getCustomerPaymentMethods(custId),\r\n                mockApi.getCustomerSettings(custId),\r\n                mockApi.getCustomerReviews(custId),\r\n                mockApi.getReviewableBookings(user.email),\r\n                mockApi.getLiveChatHistory(custId)\r\n            ]);\r\n\r\n            // Filter bookings for this customer\r\n            const customerBookings = allBookings.filter(\r\n                b => b.customer?.email === user.email || b.customer?.name?.toLowerCase() === user.name?.toLowerCase()\r\n            );\r\n            setBookings(customerBookings);\r\n            setServices(servicesData);\r\n            setTimeSlots(timeSlotsData.filter(s => s.active));\r\n            setDevices(devicesData);\r\n            setNotifications(notificationsData);\r\n            setLoyalty(loyaltyData);\r\n            setInvoices(invoicesData);\r\n            setFavorites(favoritesData);\r\n            setReferrals(referralsData);\r\n            setReferralCode(refCode);\r\n            setWarranties(warrantiesData);\r\n            setPaymentMethods(paymentMethodsData);\r\n            setCustomerSettings(settingsData);\r\n            setReviews(reviewsData);\r\n            setReviewableBookings(reviewableData);\r\n            setLiveChatMessages(chatHistory);\r\n\r\n            // Mock messages\r\n            setMessages([\r\n                { id: 1, type: 'received', sender: 'SIFIXA Support', message: 'Welcome to SIFIXA! Your account has been created.', date: '2025-12-01 09:00 AM' },\r\n                { id: 2, type: 'sent', sender: user.name, message: 'Hi, I wanted to check on my booking status.', date: '2025-12-05 02:30 PM' },\r\n                { id: 3, type: 'received', sender: 'SIFIXA Support', message: 'Your device repair is in progress. Expected completion tomorrow.', date: '2025-12-05 03:15 PM' },\r\n            ]);\r\n        } catch (error) {\r\n            console.error('Failed to load customer data:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [user]);\r\n\r\n    const handleLogout = () => {\r\n        logout();\r\n        navigate('/');\r\n    };\r\n\r\n    const getStatusIcon = (status) => {\r\n        switch (status) {\r\n            case 'Completed': return <CheckCircle size={16} className=\"status-icon completed\" />;\r\n            case 'In Progress': return <Clock3 size={16} className=\"status-icon in-progress\" />;\r\n            case 'Confirmed': return <CheckCircle size={16} className=\"status-icon confirmed\" />;\r\n            case 'Pending': return <AlertCircle size={16} className=\"status-icon pending\" />;\r\n            case 'Cancelled': return <XCircle size={16} className=\"status-icon cancelled\" />;\r\n            default: return <Clock size={16} className=\"status-icon\" />;\r\n        }\r\n    };\r\n\r\n    const getDeviceIcon = (type) => {\r\n        switch (type) {\r\n            case 'smartphone': return <Smartphone size={20} />;\r\n            case 'laptop': return <Laptop size={20} />;\r\n            case 'tablet': return <Tablet size={20} />;\r\n            case 'smartwatch': return <Watch size={20} />;\r\n            default: return <Smartphone size={20} />;\r\n        }\r\n    };\r\n\r\n    const getTierColor = (tier) => {\r\n        switch (tier) {\r\n            case 'Bronze': return '#cd7f32';\r\n            case 'Silver': return '#c0c0c0';\r\n            case 'Gold': return '#ffd700';\r\n            case 'Platinum': return '#e5e4e2';\r\n            default: return '#cd7f32';\r\n        }\r\n    };\r\n\r\n    const getTimeGreeting = () => {\r\n        const hour = new Date().getHours();\r\n        if (hour < 12) return 'Good morning';\r\n        if (hour < 17) return 'Good afternoon';\r\n        return 'Good evening';\r\n    };\r\n\r\n    const getRepairProgress = (status) => {\r\n        switch (status) {\r\n            case 'Pending': return { percent: 20, step: 1, label: 'Received' };\r\n            case 'Confirmed': return { percent: 40, step: 2, label: 'Confirmed' };\r\n            case 'In Progress': return { percent: 70, step: 3, label: 'Repairing' };\r\n            case 'Completed': return { percent: 100, step: 4, label: 'Ready' };\r\n            case 'Cancelled': return { percent: 0, step: 0, label: 'Cancelled' };\r\n            default: return { percent: 0, step: 0, label: 'Unknown' };\r\n        }\r\n    };\r\n\r\n    const unreadCount = notifications.filter(n => !n.read).length;\r\n    const activeBookings = bookings.filter(b => ['Pending', 'Confirmed', 'In Progress'].includes(b.status));\r\n    const completedBookings = bookings.filter(b => b.status === 'Completed');\r\n    const totalSpent = bookings.filter(b => b.status === 'Completed').reduce((sum, b) => sum + (b.costEstimate || 100), 0);\r\n\r\n    // Handlers\r\n    const handleMarkNotificationRead = async (id) => {\r\n        await mockApi.markNotificationRead(id);\r\n        setNotifications(prev => prev.map(n => n.id === id ? { ...n, read: true } : n));\r\n    };\r\n\r\n    const handleMarkAllRead = async () => {\r\n        await mockApi.markAllNotificationsRead(customerId);\r\n        setNotifications(prev => prev.map(n => ({ ...n, read: true })));\r\n    };\r\n\r\n    const handleReschedule = async (newDate, newTime) => {\r\n        if (!selectedBooking) return;\r\n        try {\r\n            await mockApi.rescheduleBooking(selectedBooking.id, newDate, newTime);\r\n            setShowRescheduleModal(false);\r\n            setSelectedBooking(null);\r\n            loadAllData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleCancelBooking = async (bookingId) => {\r\n        if (!window.confirm('Are you sure you want to cancel this booking?')) return;\r\n        try {\r\n            await mockApi.cancelBookingByCustomer(bookingId);\r\n            loadAllData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleSaveDevice = async (deviceData) => {\r\n        try {\r\n            if (editingDevice) {\r\n                await mockApi.updateCustomerDevice(editingDevice.id, deviceData);\r\n            } else {\r\n                await mockApi.addCustomerDevice(customerId, deviceData);\r\n            }\r\n            setShowDeviceModal(false);\r\n            setEditingDevice(null);\r\n            loadAllData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleDeleteDevice = async (deviceId) => {\r\n        if (!window.confirm('Delete this device?')) return;\r\n        await mockApi.deleteCustomerDevice(deviceId);\r\n        loadAllData();\r\n    };\r\n\r\n    const handleRedeemReward = async (rewardId) => {\r\n        try {\r\n            const result = await mockApi.redeemLoyaltyPoints(customerId, rewardId);\r\n            alert(`Successfully redeemed: ${result.reward.name}! Remaining points: ${result.remainingPoints}`);\r\n            loadAllData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleRemoveFavorite = async (serviceId) => {\r\n        await mockApi.removeFromFavorites(customerId, serviceId);\r\n        setFavorites(prev => prev.filter(f => f.id !== serviceId));\r\n    };\r\n\r\n    const handleSendMessage = () => {\r\n        if (!newMessage.trim()) return;\r\n        setMessages([...messages, {\r\n            id: Date.now(),\r\n            type: 'sent',\r\n            sender: user?.name || 'You',\r\n            message: newMessage,\r\n            date: new Date().toLocaleString()\r\n        }]);\r\n        setNewMessage('');\r\n    };\r\n\r\n    // New handlers for additional features\r\n    const handleCopyReferralCode = () => {\r\n        navigator.clipboard.writeText(referralCode);\r\n        alert('Referral code copied to clipboard!');\r\n    };\r\n\r\n    const handleSendReferralInvite = async (email, name) => {\r\n        try {\r\n            await mockApi.sendReferralInvite(customerId, email, name);\r\n            setShowReferralInviteModal(false);\r\n            loadAllData();\r\n            alert('Invitation sent successfully!');\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleClaimWarranty = async (issueDescription) => {\r\n        try {\r\n            await mockApi.claimWarranty(selectedWarranty.id, issueDescription);\r\n            setShowWarrantyClaimModal(false);\r\n            setSelectedWarranty(null);\r\n            loadAllData();\r\n            alert('Warranty claim submitted successfully!');\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleAddPaymentMethod = async (cardData) => {\r\n        try {\r\n            await mockApi.addPaymentMethod(customerId, cardData);\r\n            setShowPaymentModal(false);\r\n            loadAllData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleRemovePaymentMethod = async (methodId) => {\r\n        if (!window.confirm('Remove this payment method?')) return;\r\n        await mockApi.removePaymentMethod(methodId);\r\n        loadAllData();\r\n    };\r\n\r\n    const handleSetDefaultPayment = async (methodId) => {\r\n        await mockApi.setDefaultPaymentMethod(customerId, methodId);\r\n        loadAllData();\r\n    };\r\n\r\n    const handleUpdateSettings = async (newSettings) => {\r\n        try {\r\n            await mockApi.updateCustomerSettings(customerId, newSettings);\r\n            setCustomerSettings(newSettings);\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleSubmitReview = async (rating, title, comment, wouldRecommend) => {\r\n        try {\r\n            await mockApi.submitReview(customerId, selectedBookingForReview.id, rating, title, comment, wouldRecommend);\r\n            setShowReviewModal(false);\r\n            setSelectedBookingForReview(null);\r\n            loadAllData();\r\n            alert('Thank you for your review!');\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    // Smart auto-response system for Live Chat\r\n    const getSmartResponse = (message) => {\r\n        const msg = message.toLowerCase();\r\n\r\n        // Greeting responses\r\n        if (msg.match(/^(hi|hello|hey|good morning|good afternoon|good evening)/)) {\r\n            return \"Hello! ≡ƒæï Welcome to SIFIXA Support! I'm here to help you with any questions about our repair services, pricing, or your existing orders. How can I assist you today?\";\r\n        }\r\n\r\n        // Pricing questions\r\n        if (msg.match(/price|cost|how much|pricing|quote|estimate|fee/)) {\r\n            return \"≡ƒô▒ **Our Pricing:**\\n\\nΓÇó iPhone Screen Repair: $79-$299\\nΓÇó Android Screen Repair: $69-$249\\nΓÇó Battery Replacement: $49-$99\\nΓÇó Water Damage Repair: $99-$199\\nΓÇó Computer/Laptop Repair: $49-$299\\n\\nPrices vary by model. For an exact quote, please book a free diagnostic or reply with your specific device and issue!\";\r\n        }\r\n\r\n        // Location questions\r\n        if (msg.match(/location|address|where|find you|directions|located/)) {\r\n            return \"≡ƒôì **Our Location:**\\n\\nSIFIXA Repair Center\\n123 Tech Boulevard, Suite 100\\nSan Francisco, CA 94102\\n\\n≡ƒÜù Free parking available\\n≡ƒÜç Near Powell St. BART Station\\n\\nWe're located in the heart of downtown with easy access!\";\r\n        }\r\n\r\n        // Contact information\r\n        if (msg.match(/contact|phone|call|email|reach/)) {\r\n            return \"≡ƒô₧ **Contact Us:**\\n\\nΓÇó Phone: (555) 123-4567\\nΓÇó Email: support@sifixa.com\\nΓÇó Emergency Line: (555) 999-HELP\\n\\n≡ƒÆ¼ Or continue chatting here for instant support!\";\r\n        }\r\n\r\n        // Hours of operation\r\n        if (msg.match(/hour|open|close|when|time|schedule|available/)) {\r\n            return \"≡ƒòÉ **Business Hours:**\\n\\nΓÇó Monday-Friday: 9:00 AM - 7:00 PM\\nΓÇó Saturday: 10:00 AM - 5:00 PM\\nΓÇó Sunday: Closed\\n\\nΓÜí Same-day repairs available for most services if dropped off before 2 PM!\";\r\n        }\r\n\r\n        // Warranty questions\r\n        if (msg.match(/warranty|guarantee|covered|protection/)) {\r\n            return \"≡ƒ¢í∩╕Å **Warranty Information:**\\n\\nΓÇó All repairs come with a 90-day warranty\\nΓÇó Screen repairs: 6-month warranty\\nΓÇó Battery replacements: 1-year warranty\\nΓÇó Original parts used when available\\n\\nWarranty covers defects in parts and workmanship. Accidental damage is not covered.\";\r\n        }\r\n\r\n        // Repair time questions\r\n        if (msg.match(/how long|time|duration|wait|turnaround|ready/)) {\r\n            return \"ΓÅ▒∩╕Å **Repair Times:**\\n\\nΓÇó Screen Replacement: 30 min - 2 hours\\nΓÇó Battery Replacement: 30 min - 1 hour\\nΓÇó Water Damage: 24-48 hours\\nΓÇó Data Recovery: 1-3 days\\nΓÇó Computer Repairs: Same day - 3 days\\n\\nMost phone repairs are completed while you wait!\";\r\n        }\r\n\r\n        // Services offered\r\n        if (msg.match(/service|repair|fix|what do you|can you/)) {\r\n            return \"≡ƒöº **Our Services:**\\n\\n≡ƒô▒ **Phone Repairs:**\\nΓÇó Screen & LCD replacement\\nΓÇó Battery replacement\\nΓÇó Charging port repair\\nΓÇó Water damage recovery\\n\\n≡ƒÆ╗ **Computer Repairs:**\\nΓÇó Virus removal\\nΓÇó Hardware upgrades\\nΓÇó Data recovery\\nΓÇó Screen replacement\\n\\nWe repair all major brands: Apple, Samsung, Google, and more!\";\r\n        }\r\n\r\n        // Booking/Appointment\r\n        if (msg.match(/book|appointment|schedule|reserve/)) {\r\n            return \"≡ƒôà **Book an Appointment:**\\n\\nYou can easily book online:\\n1. Click 'Book Repair' from your dashboard\\n2. Select your device and issue\\n3. Choose a convenient time slot\\n\\nWalk-ins are also welcome during business hours! No appointment needed for quick diagnostics.\";\r\n        }\r\n\r\n        // Status/Order questions\r\n        if (msg.match(/status|order|track|my repair|progress/)) {\r\n            return \"≡ƒôª **Track Your Repair:**\\n\\nYou can check your repair status anytime:\\n1. Go to 'My Bookings' in your dashboard\\n2. Click on your active repair\\n3. View real-time progress updates\\n\\nYou'll also receive email/SMS updates at each stage!\";\r\n        }\r\n\r\n        // Payment questions\r\n        if (msg.match(/pay|payment|accept|card|cash|method/)) {\r\n            return \"≡ƒÆ│ **Payment Options:**\\n\\nΓÇó All major credit/debit cards\\nΓÇó Apple Pay & Google Pay\\nΓÇó Cash\\nΓÇó PayPal\\nΓÇó Financing available for repairs over $200\\n\\nPayment is collected after your repair is complete and tested!\";\r\n        }\r\n\r\n        // Thanks/Goodbye\r\n        if (msg.match(/thank|thanks|bye|goodbye|great|awesome|perfect/)) {\r\n            return \"You're welcome! ≡ƒÿè Is there anything else I can help you with? If not, have a wonderful day! Remember, you can reach us anytime at (555) 123-4567.\";\r\n        }\r\n\r\n        // Help/General\r\n        if (msg.match(/help|support|assist|question/)) {\r\n            return \"I'm here to help! ≡ƒÖï Here are some things I can assist with:\\n\\nΓÇó ≡ƒÆ░ Pricing & quotes\\nΓÇó ≡ƒôì Location & hours\\nΓÇó ≡ƒöº Services we offer\\nΓÇó ΓÅ▒∩╕Å Repair times\\nΓÇó ≡ƒ¢í∩╕Å Warranty info\\nΓÇó ≡ƒô▒ Booking appointments\\n\\nJust ask your question and I'll do my best to help!\";\r\n        }\r\n\r\n        // Real agent request - return special marker\r\n        if (msg.match(/real agent|human|person|speak to|talk to|real person|live agent|actual person|someone real/)) {\r\n            return \"CONNECT_REAL_AGENT\";\r\n        }\r\n\r\n        // Default response for unrecognized queries\r\n        return \"Thanks for your message! For specific inquiries, our team will respond shortly. In the meantime, I can help with:\\n\\nΓÇó Pricing ΓåÆ just ask 'how much'\\nΓÇó Location ΓåÆ ask 'where are you located'\\nΓÇó Hours ΓåÆ ask 'what are your hours'\\nΓÇó Services ΓåÆ ask 'what services do you offer'\\n\\nOr type 'real agent' to connect with a support specialist! ≡ƒÖé\";\r\n    };\r\n\r\n    const handleSendLiveChat = async (quickReplyMessage = null) => {\r\n        const message = quickReplyMessage || liveChatInput.trim();\r\n        if (!message && !chatAttachment) return;\r\n\r\n        setLiveChatInput('');\r\n        setShowQuickReplies(false);\r\n\r\n        // Add user message\r\n        const userMsg = {\r\n            id: Date.now(),\r\n            sender: 'customer',\r\n            message: message || '',\r\n            attachment: chatAttachment,\r\n            timestamp: new Date().toISOString(),\r\n            status: 'sent'\r\n        };\r\n        setLiveChatMessages(prev => [...prev, userMsg]);\r\n        setChatAttachment(null);\r\n\r\n        // Show typing indicator\r\n        setIsTyping(true);\r\n\r\n        // Simulate message delivered status\r\n        setTimeout(() => {\r\n            setLiveChatMessages(prev =>\r\n                prev.map(msg => msg.id === userMsg.id ? { ...msg, status: 'delivered' } : msg)\r\n            );\r\n        }, 500);\r\n\r\n        // Smart auto-response with typing delay\r\n        setTimeout(() => {\r\n            setIsTyping(false);\r\n            const smartResponse = getSmartResponse(message);\r\n\r\n            // Check if user wants a real agent\r\n            if (smartResponse === \"CONNECT_REAL_AGENT\") {\r\n                // First send connecting message\r\n                const connectingMsg = {\r\n                    id: Date.now() + 1,\r\n                    sender: 'agent',\r\n                    agentName: 'SIFIXA Assistant',\r\n                    agentAvatar: '≡ƒñû',\r\n                    message: \"Connecting you with a support specialist... Please hold for a moment! ≡ƒöä\",\r\n                    timestamp: new Date().toISOString(),\r\n                    isBot: true\r\n                };\r\n                setLiveChatMessages(prev => [...prev, connectingMsg]);\r\n\r\n                // Show typing again for real agent\r\n                setTimeout(() => {\r\n                    setIsTyping(true);\r\n\r\n                    setTimeout(() => {\r\n                        setIsTyping(false);\r\n\r\n                        // Random real agent\r\n                        const agents = [\r\n                            { name: 'Sarah Johnson', avatar: '≡ƒæ⌐ΓÇì≡ƒÆ╝', greeting: \"Hi there! I'm Sarah, a Support Specialist. I saw you wanted to speak with someone directly. How can I help you today?\" },\r\n                            { name: 'Mike Chen', avatar: '≡ƒæ¿ΓÇì≡ƒÆ╗', greeting: \"Hello! Mike here from the support team. I understand you'd like to chat with a real person - I'm here for you! What can I assist you with?\" },\r\n                            { name: 'Emma Davis', avatar: '≡ƒæ⌐ΓÇì≡ƒöº', greeting: \"Hey! Emma from SIFIXA support here. You asked to speak with a real agent, and here I am! What questions do you have for me?\" }\r\n                        ];\r\n                        const agent = agents[Math.floor(Math.random() * agents.length)];\r\n\r\n                        const realAgentMsg = {\r\n                            id: Date.now() + 2,\r\n                            sender: 'agent',\r\n                            agentName: agent.name,\r\n                            agentAvatar: agent.avatar,\r\n                            message: agent.greeting,\r\n                            timestamp: new Date().toISOString(),\r\n                            isBot: false,\r\n                            isRealAgent: true\r\n                        };\r\n                        setLiveChatMessages(prev => [...prev, realAgentMsg]);\r\n                    }, 2000);\r\n                }, 500);\r\n            } else {\r\n                // Normal bot response\r\n                const botMsg = {\r\n                    id: Date.now() + 1,\r\n                    sender: 'agent',\r\n                    agentName: 'SIFIXA Assistant',\r\n                    agentAvatar: '≡ƒñû',\r\n                    message: smartResponse,\r\n                    timestamp: new Date().toISOString(),\r\n                    isBot: true\r\n                };\r\n                setLiveChatMessages(prev => [...prev, botMsg]);\r\n            }\r\n\r\n            // Mark user message as read\r\n            setLiveChatMessages(prev =>\r\n                prev.map(msg => msg.id === userMsg.id ? { ...msg, status: 'read' } : msg)\r\n            );\r\n        }, 1500 + Math.random() * 1000);\r\n    };\r\n\r\n    // Quick reply options\r\n    const quickReplies = [\r\n        { icon: '≡ƒÆ░', label: 'Pricing', message: 'What are your prices?' },\r\n        { icon: '≡ƒôì', label: 'Location', message: 'Where are you located?' },\r\n        { icon: 'ΓÅ░', label: 'Hours', message: 'What are your hours?' },\r\n        { icon: '≡ƒöº', label: 'Services', message: 'What services do you offer?' },\r\n        { icon: '≡ƒô▒', label: 'My Repair', message: 'What is the status of my repair?' },\r\n        { icon: '≡ƒæñ', label: 'Real Agent', message: 'I want to speak with a real agent' }\r\n    ];\r\n\r\n    const handleFileUpload = (e) => {\r\n        const file = e.target.files[0];\r\n        if (file) {\r\n            const reader = new FileReader();\r\n            reader.onload = (e) => {\r\n                setChatAttachment({\r\n                    name: file.name,\r\n                    type: file.type,\r\n                    size: file.size,\r\n                    preview: e.target.result\r\n                });\r\n            };\r\n            reader.readAsDataURL(file);\r\n        }\r\n    };\r\n\r\n\r\n    const getWarrantyStatus = (warranty) => {\r\n        const today = new Date();\r\n        const expiry = new Date(warranty.warrantyExpiry);\r\n        const daysRemaining = Math.ceil((expiry - today) / (1000 * 60 * 60 * 24));\r\n        if (daysRemaining < 0) return { status: 'expired', label: 'Expired', color: 'red' };\r\n        if (daysRemaining <= 14) return { status: 'expiring', label: `${daysRemaining} days left`, color: 'orange' };\r\n        return { status: 'active', label: `${daysRemaining} days left`, color: 'green' };\r\n    };\r\n\r\n    const getCardIcon = (type) => {\r\n        switch (type?.toLowerCase()) {\r\n            case 'visa': return '≡ƒÆ│';\r\n            case 'mastercard': return '≡ƒÆ│';\r\n            case 'amex': return '≡ƒÆ│';\r\n            default: return '≡ƒÆ│';\r\n        }\r\n    };\r\n\r\n    if (!user) {\r\n        return (\r\n            <div className=\"customer-profile-page\" role=\"main\" aria-label=\"Customer Profile\">\r\n                <div className=\"profile-container\">\r\n                    <div className=\"not-logged-in\">\r\n                        <User size={48} aria-hidden=\"true\" />\r\n                        <h2>Please Log In</h2>\r\n                        <p>You need to be logged in to view your profile.</p>\r\n                        <Link to=\"/login\">\r\n                            <Button variant=\"primary\">Go to Login</Button>\r\n                        </Link>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"customer-profile-page\">\r\n            {/* Mobile Menu Toggle Button */}\r\n            <button\r\n                className=\"mobile-menu-toggle\"\r\n                onClick={() => setSidebarOpen(!sidebarOpen)}\r\n                aria-label=\"Toggle menu\"\r\n            >\r\n                {sidebarOpen ? <X size={24} /> : <Menu size={24} />}\r\n            </button>\r\n\r\n            {/* Sidebar Overlay for Mobile */}\r\n            {sidebarOpen && (\r\n                <div\r\n                    className=\"sidebar-overlay\"\r\n                    onClick={() => setSidebarOpen(false)}\r\n                />\r\n            )}\r\n\r\n            {/* Sidebar */}\r\n            <aside className={`profile-sidebar ${sidebarOpen ? 'open' : ''}`}>\r\n                <div className=\"sidebar-close-btn\" onClick={() => setSidebarOpen(false)}>\r\n                    <X size={20} />\r\n                </div>\r\n                <div className=\"profile-header\">\r\n                    <Link to=\"/\" className=\"back-link\">\r\n                        <Home size={18} /> Home\r\n                    </Link>\r\n                    <div className=\"profile-avatar-wrapper\">\r\n                        <div className=\"profile-avatar\" style={{ borderColor: getTierColor(loyalty?.tier) }}>\r\n                            {user.name?.charAt(0) || user.username?.charAt(0) || 'U'}\r\n                        </div>\r\n                    </div>\r\n                    {loyalty && (\r\n                        <div className=\"tier-badge-container\">\r\n                            <span className={`tier-badge ${loyalty.tier.toLowerCase()}`}>\r\n                                <Crown size={12} /> {loyalty.tier}\r\n                            </span>\r\n                        </div>\r\n                    )}\r\n                    <h2>{user.name || user.username}</h2>\r\n                    <p className=\"profile-email\">{user.email}</p>\r\n                </div>\r\n\r\n                <nav className=\"profile-nav\" role=\"navigation\" aria-label=\"Profile navigation\">\r\n                    <button className={`nav-item ${activeTab === 'overview' ? 'active' : ''}`} onClick={() => { setActiveTab('overview'); setSidebarOpen(false); }} aria-current={activeTab === 'overview' ? 'page' : undefined}>\r\n                        <Home size={18} aria-hidden=\"true\" /> <span>Overview</span>\r\n                    </button>\r\n                    <button className={`nav-item ${activeTab === 'profile' ? 'active' : ''}`} onClick={() => { setActiveTab('profile'); setSidebarOpen(false); }} aria-current={activeTab === 'profile' ? 'page' : undefined}>\r\n                        <User size={18} aria-hidden=\"true\" /> <span>Profile</span>\r\n                    </button>\r\n                    <button className={`nav-item ${activeTab === 'bookings' ? 'active' : ''}`} onClick={() => { setActiveTab('bookings'); setSidebarOpen(false); }} aria-current={activeTab === 'bookings' ? 'page' : undefined}>\r\n                        <Calendar size={18} aria-hidden=\"true\" /> <span>My Bookings</span>\r\n                        {activeBookings.length > 0 && <span className=\"badge\" aria-label={`${activeBookings.length} active`}>{activeBookings.length}</span>}\r\n                    </button>\r\n                    <button className={`nav-item ${activeTab === 'warranties' ? 'active' : ''}`} onClick={() => { setActiveTab('warranties'); setSidebarOpen(false); }} aria-current={activeTab === 'warranties' ? 'page' : undefined}>\r\n                        <ShieldCheck size={18} aria-hidden=\"true\" /> <span>Warranties</span>\r\n                        {warranties.filter(w => w.status === 'active').length > 0 && <span className=\"badge subtle\">{warranties.filter(w => getWarrantyStatus(w).status !== 'expired').length}</span>}\r\n                    </button>\r\n                    <button className={`nav-item ${activeTab === 'notifications' ? 'active' : ''}`} onClick={() => { setActiveTab('notifications'); setSidebarOpen(false); }} aria-current={activeTab === 'notifications' ? 'page' : undefined}>\r\n                        <Bell size={18} aria-hidden=\"true\" /> <span>Notifications</span>\r\n                        {unreadCount > 0 && <span className=\"badge alert\" aria-label={`${unreadCount} unread`}>{unreadCount}</span>}\r\n                    </button>\r\n                    <button className={`nav-item ${activeTab === 'loyalty' ? 'active' : ''}`} onClick={() => { setActiveTab('loyalty'); setSidebarOpen(false); }} aria-current={activeTab === 'loyalty' ? 'page' : undefined}>\r\n                        <Award size={18} aria-hidden=\"true\" /> <span>Rewards & Referrals</span>\r\n                    </button>\r\n                    <button className={`nav-item ${activeTab === 'devices' ? 'active' : ''}`} onClick={() => { setActiveTab('devices'); setSidebarOpen(false); }} aria-current={activeTab === 'devices' ? 'page' : undefined}>\r\n                        <Smartphone size={18} aria-hidden=\"true\" /> <span>My Devices</span>\r\n                        {devices.length > 0 && <span className=\"badge subtle\">{devices.length}</span>}\r\n                    </button>\r\n                    <button className={`nav-item ${activeTab === 'invoices' ? 'active' : ''}`} onClick={() => { setActiveTab('invoices'); setSidebarOpen(false); }} aria-current={activeTab === 'invoices' ? 'page' : undefined}>\r\n                        <Receipt size={18} aria-hidden=\"true\" /> <span>Invoices</span>\r\n                    </button>\r\n                    <button className={`nav-item ${activeTab === 'reviews' ? 'active' : ''}`} onClick={() => { setActiveTab('reviews'); setSidebarOpen(false); }} aria-current={activeTab === 'reviews' ? 'page' : undefined}>\r\n                        <Star size={18} aria-hidden=\"true\" /> <span>My Reviews</span>\r\n                        {reviewableBookings.length > 0 && <span className=\"badge alert\">{reviewableBookings.length}</span>}\r\n                    </button>\r\n                    <button className={`nav-item ${activeTab === 'settings' ? 'active' : ''}`} onClick={() => { setActiveTab('settings'); setSidebarOpen(false); }} aria-current={activeTab === 'settings' ? 'page' : undefined}>\r\n                        <Settings size={18} aria-hidden=\"true\" /> <span>Settings</span>\r\n                    </button>\r\n                </nav>\r\n\r\n                <div className=\"sidebar-footer\">\r\n                    <ThemeToggle />\r\n                    <button className=\"logout-btn\" onClick={handleLogout}>Logout</button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"profile-main\">\r\n                {loading ? (\r\n                    <div className=\"loading-state\"><RefreshCw size={24} className=\"spin\" /> Loading your profile...</div>\r\n                ) : (\r\n                    <>\r\n                        {/* OVERVIEW TAB */}\r\n                        {activeTab === 'overview' && (\r\n                            <div className=\"overview-section\">\r\n                                {/* Welcome Hero with Time-based Greeting */}\r\n                                <motion.div\r\n                                    className=\"welcome-hero\"\r\n                                    initial={{ opacity: 0, y: 20 }}\r\n                                    animate={{ opacity: 1, y: 0 }}\r\n                                    transition={{ duration: 0.5 }}\r\n                                >\r\n                                    <div className=\"hero-content\">\r\n                                        <div className=\"greeting-icon\">\r\n                                            {new Date().getHours() < 17 ? 'ΓÿÇ∩╕Å' : '≡ƒîÖ'}\r\n                                        </div>\r\n                                        <div className=\"welcome-text\">\r\n                                            <h1>{getTimeGreeting()}, {user.name?.split(' ')[0] || user.username}!</h1>\r\n                                            <p>Here's your repair dashboard at a glance</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    {loyalty && (\r\n                                        <motion.div\r\n                                            className=\"loyalty-badge\"\r\n                                            initial={{ opacity: 0, scale: 0.9 }}\r\n                                            animate={{ opacity: 1, scale: 1 }}\r\n                                            transition={{ delay: 0.3 }}\r\n                                            style={{ background: `linear-gradient(135deg, ${getTierColor(loyalty.tier)}30, ${getTierColor(loyalty.tier)}50)` }}\r\n                                        >\r\n                                            <Crown size={24} style={{ color: getTierColor(loyalty.tier) }} />\r\n                                            <div className=\"loyalty-info\">\r\n                                                <span className=\"tier-name\">{loyalty.tier}</span>\r\n                                                <span className=\"points-count\">{loyalty.points} pts</span>\r\n                                            </div>\r\n                                        </motion.div>\r\n                                    )}\r\n                                </motion.div>\r\n\r\n                                {/* Stats Cards */}\r\n                                <div className=\"stats-cards\">\r\n                                    {[\r\n                                        { icon: <Package size={24} />, value: bookings.length, label: 'Total Repairs', color: 'blue' },\r\n                                        { icon: <Clock3 size={24} />, value: activeBookings.length, label: 'Active', color: 'orange' },\r\n                                        { icon: <CheckCircle size={24} />, value: completedBookings.length, label: 'Completed', color: 'green' },\r\n                                        { icon: <Star size={24} />, value: loyalty?.points || 0, label: 'Points', color: 'purple' }\r\n                                    ].map((stat, index) => (\r\n                                        <motion.div\r\n                                            key={stat.label}\r\n                                            className=\"stat-card\"\r\n                                            initial={{ opacity: 0, y: 20 }}\r\n                                            animate={{ opacity: 1, y: 0 }}\r\n                                            transition={{ duration: 0.4, delay: 0.1 + index * 0.1 }}\r\n                                            whileHover={{ scale: 1.02, y: -4 }}\r\n                                        >\r\n                                            <div className={`stat-icon ${stat.color}`}>{stat.icon}</div>\r\n                                            <div className=\"stat-info\">\r\n                                                <span className=\"stat-value\">{stat.value}</span>\r\n                                                <span className=\"stat-label\">{stat.label}</span>\r\n                                            </div>\r\n                                        </motion.div>\r\n                                    ))}\r\n                                </div>\r\n\r\n                                {/* Notification Alert */}\r\n                                {unreadCount > 0 && (\r\n                                    <motion.div\r\n                                        className=\"notification-alert\"\r\n                                        initial={{ opacity: 0, x: -20 }}\r\n                                        animate={{ opacity: 1, x: 0 }}\r\n                                        onClick={() => setActiveTab('notifications')}\r\n                                    >\r\n                                        <div className=\"alert-icon\">\r\n                                            <Bell size={20} />\r\n                                            <span className=\"alert-count\">{unreadCount}</span>\r\n                                        </div>\r\n                                        <span>You have {unreadCount} unread notification{unreadCount > 1 ? 's' : ''}</span>\r\n                                        <ChevronRight size={18} />\r\n                                    </motion.div>\r\n                                )}\r\n\r\n                                {/* Two Column Layout */}\r\n                                <div className=\"overview-grid\">\r\n                                    {/* Left Column - Active Repairs with Progress */}\r\n                                    <motion.div\r\n                                        className=\"overview-card repairs-tracker\"\r\n                                        initial={{ opacity: 0, y: 20 }}\r\n                                        animate={{ opacity: 1, y: 0 }}\r\n                                        transition={{ delay: 0.3 }}\r\n                                    >\r\n                                        <div className=\"card-title\">\r\n                                            <Package size={20} />\r\n                                            <h3>Active Repairs</h3>\r\n                                            {activeBookings.length > 0 && (\r\n                                                <span className=\"count-badge\">{activeBookings.length}</span>\r\n                                            )}\r\n                                        </div>\r\n\r\n                                        {activeBookings.length === 0 ? (\r\n                                            <div className=\"empty-card-state\">\r\n                                                <CheckCircle size={40} />\r\n                                                <p>No active repairs</p>\r\n                                                <Link to=\"/booking\">\r\n                                                    <Button variant=\"primary\">Book a Repair</Button>\r\n                                                </Link>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <div className=\"repairs-tracker-list\">\r\n                                                {activeBookings.slice(0, 3).map((booking, idx) => {\r\n                                                    const progress = getRepairProgress(booking.status);\r\n                                                    return (\r\n                                                        <motion.div\r\n                                                            key={booking.id}\r\n                                                            className=\"repair-tracker-item\"\r\n                                                            initial={{ opacity: 0, x: -20 }}\r\n                                                            animate={{ opacity: 1, x: 0 }}\r\n                                                            transition={{ delay: 0.4 + idx * 0.1 }}\r\n                                                        >\r\n                                                            <div className=\"repair-header\">\r\n                                                                <div className=\"device-info\">\r\n                                                                    <Smartphone size={18} />\r\n                                                                    <div>\r\n                                                                        <h4>{getDeviceName(booking.device)}</h4>\r\n                                                                        <span className=\"issue\">{booking.issue}</span>\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                                <span className={`status-pill ${booking.status.toLowerCase().replace(' ', '-')}`}>\r\n                                                                    {booking.status}\r\n                                                                </span>\r\n                                                            </div>\r\n                                                            <div className=\"progress-tracker\">\r\n                                                                <div className=\"progress-bar-track\">\r\n                                                                    <motion.div\r\n                                                                        className=\"progress-bar-fill\"\r\n                                                                        initial={{ width: 0 }}\r\n                                                                        animate={{ width: `${progress.percent}%` }}\r\n                                                                        transition={{ duration: 0.8, delay: 0.5 + idx * 0.1 }}\r\n                                                                    />\r\n                                                                </div>\r\n                                                                <div className=\"progress-steps\">\r\n                                                                    {['Received', 'Confirmed', 'Repairing', 'Ready'].map((step, i) => (\r\n                                                                        <div\r\n                                                                            key={step}\r\n                                                                            className={`progress-step ${progress.step > i ? 'completed' : ''} ${progress.step === i + 1 ? 'active' : ''}`}\r\n                                                                        >\r\n                                                                            <div className=\"step-dot\" />\r\n                                                                            <span>{step}</span>\r\n                                                                        </div>\r\n                                                                    ))}\r\n                                                                </div>\r\n                                                            </div>\r\n                                                            <div className=\"repair-footer\">\r\n                                                                <span className=\"repair-date\"><Calendar size={14} /> {booking.date}</span>\r\n                                                                <button\r\n                                                                    className=\"view-details-btn\"\r\n                                                                    onClick={() => setActiveTab('bookings')}\r\n                                                                >\r\n                                                                    View Details <ChevronRight size={14} />\r\n                                                                </button>\r\n                                                            </div>\r\n                                                        </motion.div>\r\n                                                    );\r\n                                                })}\r\n                                            </div>\r\n                                        )}\r\n                                    </motion.div>\r\n\r\n                                    {/* Right Column */}\r\n                                    <div className=\"overview-right-col\">\r\n                                        {/* Quick Actions */}\r\n                                        <motion.div\r\n                                            className=\"overview-card quick-actions-card\"\r\n                                            initial={{ opacity: 0, y: 20 }}\r\n                                            animate={{ opacity: 1, y: 0 }}\r\n                                            transition={{ delay: 0.4 }}\r\n                                        >\r\n                                            <div className=\"card-title\">\r\n                                                <Settings size={20} />\r\n                                                <h3>Quick Actions</h3>\r\n                                            </div>\r\n                                            <div className=\"quick-actions-list\">\r\n                                                <Link to=\"/booking\" className=\"quick-action-item\">\r\n                                                    <div className=\"action-icon blue\"><Package size={18} /></div>\r\n                                                    <span>Book Repair</span>\r\n                                                    <ChevronRight size={16} />\r\n                                                </Link>\r\n                                                <Link to=\"/track\" className=\"quick-action-item\">\r\n                                                    <div className=\"action-icon orange\"><Clock size={18} /></div>\r\n                                                    <span>Track Order</span>\r\n                                                    <ChevronRight size={16} />\r\n                                                </Link>\r\n                                                <button className=\"quick-action-item\" onClick={() => setActiveTab('messages')}>\r\n                                                    <div className=\"action-icon green\"><MessageSquare size={18} /></div>\r\n                                                    <span>Contact Support</span>\r\n                                                    <ChevronRight size={16} />\r\n                                                </button>\r\n                                                <button className=\"quick-action-item\" onClick={() => setActiveTab('loyalty')}>\r\n                                                    <div className=\"action-icon purple\"><Gift size={18} /></div>\r\n                                                    <span>Redeem Points</span>\r\n                                                    <ChevronRight size={16} />\r\n                                                </button>\r\n                                            </div>\r\n                                        </motion.div>\r\n\r\n                                        {/* Upcoming Appointments */}\r\n                                        <motion.div\r\n                                            className=\"overview-card appointments-card\"\r\n                                            initial={{ opacity: 0, y: 20 }}\r\n                                            animate={{ opacity: 1, y: 0 }}\r\n                                            transition={{ delay: 0.5 }}\r\n                                        >\r\n                                            <div className=\"card-title\">\r\n                                                <Calendar size={20} />\r\n                                                <h3>Upcoming</h3>\r\n                                            </div>\r\n                                            {activeBookings.filter(b => b.status === 'Confirmed').length === 0 ? (\r\n                                                <div className=\"no-appointments\">\r\n                                                    <Calendar size={32} />\r\n                                                    <p>No upcoming appointments</p>\r\n                                                </div>\r\n                                            ) : (\r\n                                                <div className=\"appointments-list\">\r\n                                                    {activeBookings.filter(b => b.status === 'Confirmed').slice(0, 2).map(booking => (\r\n                                                        <div key={booking.id} className=\"appointment-item\">\r\n                                                            <div className=\"appointment-date\">\r\n                                                                <span className=\"day\">{new Date(booking.date).getDate()}</span>\r\n                                                                <span className=\"month\">{new Date(booking.date).toLocaleString('default', { month: 'short' })}</span>\r\n                                                            </div>\r\n                                                            <div className=\"appointment-info\">\r\n                                                                <h4>{getDeviceName(booking.device)}</h4>\r\n                                                                <span>{booking.time || 'Morning'}</span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            )}\r\n                                        </motion.div>\r\n\r\n                                        {/* Recent Activity */}\r\n                                        <motion.div\r\n                                            className=\"overview-card activity-card\"\r\n                                            initial={{ opacity: 0, y: 20 }}\r\n                                            animate={{ opacity: 1, y: 0 }}\r\n                                            transition={{ delay: 0.6 }}\r\n                                        >\r\n                                            <div className=\"card-title\">\r\n                                                <TrendingUp size={20} />\r\n                                                <h3>Recent Activity</h3>\r\n                                            </div>\r\n                                            <div className=\"activity-timeline\">\r\n                                                {notifications.slice(0, 4).map((notif, idx) => (\r\n                                                    <div key={notif.id} className={`activity-item ${!notif.read ? 'unread' : ''}`}>\r\n                                                        <div className=\"activity-dot\" />\r\n                                                        <div className=\"activity-content\">\r\n                                                            <p>{notif.title}</p>\r\n                                                            <span className=\"activity-time\">\r\n                                                                {new Date(notif.date).toLocaleDateString()}\r\n                                                            </span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                ))}\r\n                                                {notifications.length === 0 && (\r\n                                                    <div className=\"no-activity\">\r\n                                                        <p>No recent activity</p>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        </motion.div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* PROFILE TAB */}\r\n                        {activeTab === 'profile' && (\r\n                            <div className=\"profile-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>My Profile</h1>\r\n                                </div>\r\n\r\n                                <div className=\"profile-grid\">\r\n                                    <div className=\"profile-card main-info\">\r\n                                        <div className=\"card-header\">\r\n                                            <h3><User size={18} /> Personal Information</h3>\r\n                                            <Button variant=\"secondary\" onClick={() => setShowProfileModal(true)}>\r\n                                                <Edit2 size={14} /> Edit\r\n                                            </Button>\r\n                                        </div>\r\n\r\n                                        {/* Profile Photo Section */}\r\n                                        <div className=\"profile-photo-section\">\r\n                                            <div className=\"profile-photo-large\">\r\n                                                {user.avatar ? (\r\n                                                    <img src={user.avatar} alt={user.name} />\r\n                                                ) : (\r\n                                                    <span>{user.name?.charAt(0) || user.username?.charAt(0) || 'U'}</span>\r\n                                                )}\r\n                                            </div>\r\n                                            <div className=\"photo-actions\">\r\n                                                <Button variant=\"secondary\" size=\"small\">\r\n                                                    <Camera size={14} /> Change Photo\r\n                                                </Button>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"info-grid\">\r\n                                            <div className=\"info-item\">\r\n                                                <span className=\"label\">Full Name</span>\r\n                                                <span className=\"value\">{user.name || 'Not set'}</span>\r\n                                            </div>\r\n                                            <div className=\"info-item\">\r\n                                                <span className=\"label\">Username</span>\r\n                                                <span className=\"value\">@{user.username}</span>\r\n                                            </div>\r\n                                            <div className=\"info-item\">\r\n                                                <span className=\"label\">Email</span>\r\n                                                <span className=\"value\">{user.email || 'Not set'}</span>\r\n                                            </div>\r\n                                            <div className=\"info-item\">\r\n                                                <span className=\"label\">Phone</span>\r\n                                                <span className=\"value\">{user.phone || customerData?.phone || 'Not set'}</span>\r\n                                            </div>\r\n                                            <div className=\"info-item full-width\">\r\n                                                <span className=\"label\">Address</span>\r\n                                                <span className=\"value\">{customerData?.address || user.address || 'Not set'}</span>\r\n                                            </div>\r\n                                            <div className=\"info-item\">\r\n                                                <span className=\"label\">Member Since</span>\r\n                                                <span className=\"value\">\r\n                                                    {user.verifiedAt\r\n                                                        ? new Date(user.verifiedAt).toLocaleDateString('en-US', { month: 'long', year: 'numeric' })\r\n                                                        : 'December 2024'}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"profile-card security-info\">\r\n                                        <div className=\"card-header\">\r\n                                            <h3><Shield size={18} /> Security & Session</h3>\r\n                                        </div>\r\n                                        <div className=\"security-item\">\r\n                                            <div>\r\n                                                <span className=\"label\">Password</span>\r\n                                                <span className=\"value\">ΓÇóΓÇóΓÇóΓÇóΓÇóΓÇóΓÇóΓÇó</span>\r\n                                            </div>\r\n                                            <Button variant=\"secondary\" onClick={() => setShowPasswordModal(true)}>\r\n                                                Change\r\n                                            </Button>\r\n                                        </div>\r\n                                        <div className=\"security-details\">\r\n                                            <div className=\"security-detail-item\">\r\n                                                <Clock size={14} />\r\n                                                <span className=\"label\">Last Login</span>\r\n                                                <span className=\"value\">\r\n                                                    {user.lastLoginTime\r\n                                                        ? new Date(user.lastLoginTime).toLocaleString()\r\n                                                        : 'Current session'}\r\n                                                </span>\r\n                                            </div>\r\n                                            <div className=\"security-detail-item\">\r\n                                                <Shield size={14} />\r\n                                                <span className=\"label\">Session Status</span>\r\n                                                <span className=\"value session-active\">Active & Secure</span>\r\n                                            </div>\r\n                                        </div>\r\n                                        {user.verified && (\r\n                                            <div className=\"verified-badge\">\r\n                                                <CheckCircle size={16} /> Email Verified\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    <div className=\"profile-card membership-info\">\r\n                                        <div className=\"card-header\">\r\n                                            <h3><Award size={18} /> Membership</h3>\r\n                                        </div>\r\n                                        {loyalty && (\r\n                                            <div className=\"membership-details\">\r\n                                                <div className=\"tier-display\" style={{ background: `linear-gradient(135deg, ${getTierColor(loyalty.tier)}30, ${getTierColor(loyalty.tier)}50)` }}>\r\n                                                    <Crown size={32} style={{ color: getTierColor(loyalty.tier) }} />\r\n                                                    <div>\r\n                                                        <span className=\"tier-name\">{loyalty.tier}</span>\r\n                                                        <span className=\"tier-points\">{loyalty.lifetimePoints} lifetime pts</span>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"tier-progress\">\r\n                                                    <div className=\"progress-bar\">\r\n                                                        <div className=\"progress-fill\" style={{ width: `${loyalty.tierProgress}%`, background: getTierColor(loyalty.tier) }}></div>\r\n                                                    </div>\r\n                                                    <span className=\"progress-text\">{loyalty.tierProgress}% to next tier</span>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    <div className=\"profile-card stats-info\">\r\n                                        <div className=\"card-header\">\r\n                                            <h3><TrendingUp size={18} /> Account Stats</h3>\r\n                                        </div>\r\n                                        <div className=\"account-stats\">\r\n                                            <div className=\"stat\">\r\n                                                <span className=\"stat-value\">{bookings.length}</span>\r\n                                                <span className=\"stat-label\">Total Repairs</span>\r\n                                            </div>\r\n                                            <div className=\"stat\">\r\n                                                <span className=\"stat-value\">{loyalty?.points || 0}</span>\r\n                                                <span className=\"stat-label\">Points Earned</span>\r\n                                            </div>\r\n                                            <div className=\"stat\">\r\n                                                <span className=\"stat-value\">{devices.length}</span>\r\n                                                <span className=\"stat-label\">Saved Devices</span>\r\n                                            </div>\r\n                                            <div className=\"stat\">\r\n                                                <span className=\"stat-value\">{customerData?.lastVisit || 'N/A'}</span>\r\n                                                <span className=\"stat-label\">Last Visit</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* BOOKINGS TAB */}\r\n                        {activeTab === 'bookings' && (\r\n                            <div className=\"bookings-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>My Bookings</h1>\r\n                                    <Link to=\"/booking\">\r\n                                        <Button variant=\"primary\"><Plus size={16} /> Book New Repair</Button>\r\n                                    </Link>\r\n                                </div>\r\n\r\n                                {bookings.length === 0 ? (\r\n                                    <div className=\"empty-state\">\r\n                                        <Package size={48} />\r\n                                        <h3>No bookings yet</h3>\r\n                                        <p>You haven't made any repair bookings yet.</p>\r\n                                        <Link to=\"/booking\">\r\n                                            <Button variant=\"primary\">Book Your First Repair</Button>\r\n                                        </Link>\r\n                                    </div>\r\n                                ) : (\r\n                                    <>\r\n                                        {activeBookings.length > 0 && (\r\n                                            <div className=\"bookings-group\">\r\n                                                <h3 className=\"group-title\"><Clock3 size={18} /> Active Bookings</h3>\r\n                                                <div className=\"bookings-list\">\r\n                                                    {activeBookings.map(booking => (\r\n                                                        <div key={booking.id} className=\"booking-card active\">\r\n                                                            <div className=\"booking-header\">\r\n                                                                <div className=\"booking-device\">\r\n                                                                    <h3>{getDeviceName(booking.device)}</h3>\r\n                                                                    <span className={`status-badge ${booking.status.toLowerCase().replace(' ', '-')}`}>\r\n                                                                        {getStatusIcon(booking.status)} {booking.status}\r\n                                                                    </span>\r\n                                                                </div>\r\n                                                                <span className=\"booking-id\">#{booking.id}</span>\r\n                                                            </div>\r\n                                                            <div className=\"booking-details\">\r\n                                                                <div className=\"detail\"><span className=\"label\">Service</span><span className=\"value\">{booking.issue}</span></div>\r\n                                                                <div className=\"detail\"><span className=\"label\">Date</span><span className=\"value\">{booking.date}</span></div>\r\n                                                                <div className=\"detail\"><span className=\"label\">Time</span><span className=\"value\">{booking.time}</span></div>\r\n                                                                {booking.costEstimate && (\r\n                                                                    <div className=\"detail\"><span className=\"label\">Estimate</span><span className=\"value\">${booking.costEstimate}</span></div>\r\n                                                                )}\r\n                                                            </div>\r\n                                                            <div className=\"booking-actions\">\r\n                                                                <Button variant=\"secondary\" onClick={() => { setSelectedBooking(booking); setShowRescheduleModal(true); }}>\r\n                                                                    <Calendar size={14} /> Reschedule\r\n                                                                </Button>\r\n                                                                <Button variant=\"danger\" onClick={() => handleCancelBooking(booking.id)}>\r\n                                                                    <XCircle size={14} /> Cancel\r\n                                                                </Button>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {completedBookings.length > 0 && (\r\n                                            <div className=\"bookings-group\">\r\n                                                <h3 className=\"group-title\"><CheckCircle size={18} /> Past Bookings</h3>\r\n                                                <div className=\"bookings-list past\">\r\n                                                    {completedBookings.map(booking => (\r\n                                                        <div key={booking.id} className=\"booking-card past\">\r\n                                                            <div className=\"booking-header\">\r\n                                                                <div className=\"booking-device\">\r\n                                                                    <h3>{getDeviceName(booking.device)}</h3>\r\n                                                                    <span className=\"status-badge completed\"><CheckCircle size={14} /> Completed</span>\r\n                                                                </div>\r\n                                                                <span className=\"booking-id\">#{booking.id}</span>\r\n                                                            </div>\r\n                                                            <div className=\"booking-details compact\">\r\n                                                                <span>{booking.issue}</span>\r\n                                                                <span>{booking.date}</span>\r\n                                                                {booking.costEstimate && <span>${booking.costEstimate}</span>}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n                                    </>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* NOTIFICATIONS TAB */}\r\n                        {activeTab === 'notifications' && (\r\n                            <div className=\"notifications-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>Notifications</h1>\r\n                                    {unreadCount > 0 && (\r\n                                        <Button variant=\"secondary\" onClick={handleMarkAllRead}>\r\n                                            <CheckCircle size={14} /> Mark All Read\r\n                                        </Button>\r\n                                    )}\r\n                                </div>\r\n\r\n                                {notifications.length === 0 ? (\r\n                                    <div className=\"empty-state\">\r\n                                        <Bell size={48} />\r\n                                        <h3>No notifications</h3>\r\n                                        <p>You're all caught up!</p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"notifications-list\">\r\n                                        {notifications.map(notif => (\r\n                                            <div\r\n                                                key={notif.id}\r\n                                                className={`notification-item ${notif.type} ${notif.read ? 'read' : 'unread'}`}\r\n                                                onClick={() => !notif.read && handleMarkNotificationRead(notif.id)}\r\n                                            >\r\n                                                <div className=\"notif-icon\">\r\n                                                    {notif.type === 'repair' && <Package size={20} />}\r\n                                                    {notif.type === 'promotion' && <Gift size={20} />}\r\n                                                    {notif.type === 'system' && <Bell size={20} />}\r\n                                                    {notif.type === 'loyalty' && <Star size={20} />}\r\n                                                </div>\r\n                                                <div className=\"notif-content\">\r\n                                                    <h4>{notif.title}</h4>\r\n                                                    <p>{notif.message}</p>\r\n                                                    <span className=\"notif-date\">{new Date(notif.date).toLocaleString()}</span>\r\n                                                </div>\r\n                                                {!notif.read && <span className=\"unread-dot\"></span>}\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* LOYALTY TAB (Rewards & Referrals) */}\r\n                        {activeTab === 'loyalty' && loyalty && (\r\n                            <div className=\"loyalty-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>Rewards & Referrals</h1>\r\n                                    <p className=\"section-subtitle\">Earn points, unlock rewards, and invite friends</p>\r\n                                </div>\r\n\r\n                                <div className=\"loyalty-hero\" style={{ background: `linear-gradient(135deg, ${getTierColor(loyalty.tier)}20, ${getTierColor(loyalty.tier)}50)` }}>\r\n                                    <div className=\"hero-content\">\r\n                                        <Crown size={48} style={{ color: getTierColor(loyalty.tier) }} />\r\n                                        <div className=\"hero-info\">\r\n                                            <span className=\"tier-label\">{loyalty.tier} Member</span>\r\n                                            <span className=\"points-balance\">{loyalty.points} <small>points</small></span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"tier-progress-large\">\r\n                                        <div className=\"progress-bar\">\r\n                                            <div className=\"progress-fill\" style={{ width: `${loyalty.tierProgress}%`, background: getTierColor(loyalty.tier) }}></div>\r\n                                        </div>\r\n                                        <span>{loyalty.tierProgress}% to next tier</span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"loyalty-grid\">\r\n                                    <div className=\"rewards-section\">\r\n                                        <h3><Gift size={18} /> Available Rewards</h3>\r\n                                        <div className=\"rewards-list\">\r\n                                            {loyalty.availableRewards.map(reward => (\r\n                                                <div key={reward.id} className={`reward-card ${loyalty.points >= reward.points ? 'available' : 'locked'}`}>\r\n                                                    <div className=\"reward-info\">\r\n                                                        <h4>{reward.name}</h4>\r\n                                                        <p>{reward.description}</p>\r\n                                                    </div>\r\n                                                    <div className=\"reward-action\">\r\n                                                        <span className=\"reward-points\">{reward.points} pts</span>\r\n                                                        <Button\r\n                                                            variant={loyalty.points >= reward.points ? 'primary' : 'secondary'}\r\n                                                            disabled={loyalty.points < reward.points}\r\n                                                            onClick={() => handleRedeemReward(reward.id)}\r\n                                                        >\r\n                                                            {loyalty.points >= reward.points ? 'Redeem' : 'Locked'}\r\n                                                        </Button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"points-history\">\r\n                                        <h3><TrendingUp size={18} /> Points History</h3>\r\n                                        <div className=\"history-list\">\r\n                                            {loyalty.pointsHistory.map(entry => (\r\n                                                <div key={entry.id} className={`history-item ${entry.type}`}>\r\n                                                    <div className=\"history-info\">\r\n                                                        <span className=\"description\">{entry.description}</span>\r\n                                                        <span className=\"date\">{entry.date}</span>\r\n                                                    </div>\r\n                                                    <span className={`points ${entry.points > 0 ? 'positive' : 'negative'}`}>\r\n                                                        {entry.points > 0 ? '+' : ''}{entry.points}\r\n                                                    </span>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* REFERRAL PROGRAM SECTION */}\r\n                                <div className=\"referral-divider\">\r\n                                    <div className=\"divider-line\"></div>\r\n                                    <span><Share2 size={16} /> Referral Program</span>\r\n                                    <div className=\"divider-line\"></div>\r\n                                </div>\r\n\r\n                                {/* Referral Hero */}\r\n                                <div className=\"referral-hero-pro\">\r\n                                    <div className=\"hero-background\">\r\n                                        <div className=\"hero-pattern\"></div>\r\n                                    </div>\r\n                                    <div className=\"hero-content\">\r\n                                        <div className=\"hero-badge\">\r\n                                            <Gift size={20} />\r\n                                            <span>Exclusive Rewards</span>\r\n                                        </div>\r\n                                        <h2>Give $10, Get $15</h2>\r\n                                        <p>Share your unique referral code with friends. When they complete their first repair, they get $10 off and you earn $15 in credits!</p>\r\n\r\n                                        <div className=\"referral-code-container\">\r\n                                            <div className=\"code-label\">Your Referral Code</div>\r\n                                            <div className=\"code-box\">\r\n                                                <code>{referralCode || 'LOADING...'}</code>\r\n                                                <button\r\n                                                    className=\"copy-button\"\r\n                                                    onClick={handleCopyReferralCode}\r\n                                                    aria-label=\"Copy referral code\"\r\n                                                >\r\n                                                    <Copy size={18} />\r\n                                                    <span>Copy</span>\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"share-buttons\">\r\n                                            <Button variant=\"secondary\" onClick={() => setShowReferralInviteModal(true)}>\r\n                                                <Mail size={16} /> Email Invite\r\n                                            </Button>\r\n                                            <Button variant=\"secondary\" onClick={handleCopyReferralCode}>\r\n                                                <Share2 size={16} /> Share Link\r\n                                            </Button>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"hero-illustration\">\r\n                                        <div className=\"illustration-circle\">\r\n                                            <Users size={64} />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Referral Stats */}\r\n                                <div className=\"referral-stats-pro\">\r\n                                    <div className=\"stat-card-pro\">\r\n                                        <div className=\"stat-icon-wrapper blue\">\r\n                                            <Users size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-details\">\r\n                                            <span className=\"stat-number\">{referrals.length}</span>\r\n                                            <span className=\"stat-text\">Total Referrals</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"stat-card-pro\">\r\n                                        <div className=\"stat-icon-wrapper green\">\r\n                                            <CheckCircle size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-details\">\r\n                                            <span className=\"stat-number\">{referrals.filter(r => r.status === 'completed').length}</span>\r\n                                            <span className=\"stat-text\">Completed</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"stat-card-pro\">\r\n                                        <div className=\"stat-icon-wrapper yellow\">\r\n                                            <Clock size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-details\">\r\n                                            <span className=\"stat-number\">{referrals.filter(r => r.status === 'pending').length}</span>\r\n                                            <span className=\"stat-text\">Pending</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"stat-card-pro\">\r\n                                        <div className=\"stat-icon-wrapper purple\">\r\n                                            <DollarSign size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-details\">\r\n                                            <span className=\"stat-number\">${referrals.filter(r => r.status === 'completed').length * 15}</span>\r\n                                            <span className=\"stat-text\">Total Earned</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Referrals List */}\r\n                                {referrals.length > 0 && (\r\n                                    <div className=\"referrals-list-pro\">\r\n                                        <div className=\"list-header\">\r\n                                            <h3>Your Referrals</h3>\r\n                                            <span className=\"referral-count\">{referrals.length} total</span>\r\n                                        </div>\r\n                                        <div className=\"referrals-table\">\r\n                                            {referrals.map((ref, index) => (\r\n                                                <motion.div\r\n                                                    key={ref.id}\r\n                                                    className=\"referral-row\"\r\n                                                    initial={{ opacity: 0, x: -20 }}\r\n                                                    animate={{ opacity: 1, x: 0 }}\r\n                                                    transition={{ delay: index * 0.1 }}\r\n                                                >\r\n                                                    <div className=\"referral-user\">\r\n                                                        <div className=\"user-avatar\">\r\n                                                            {ref.referredName.charAt(0).toUpperCase()}\r\n                                                        </div>\r\n                                                        <div className=\"user-info\">\r\n                                                            <h4>{ref.referredName}</h4>\r\n                                                            <span>{ref.referredEmail}</span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"referral-date\">\r\n                                                        <Calendar size={14} />\r\n                                                        <span>{new Date(ref.createdAt).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>\r\n                                                    </div>\r\n                                                    <div className=\"referral-status-badge\">\r\n                                                        <span className={`status-pill ${ref.status}`}>\r\n                                                            {ref.status === 'completed' && <CheckCircle size={14} />}\r\n                                                            {ref.status === 'pending' && <Clock size={14} />}\r\n                                                            {ref.status === 'expired' && <XCircle size={14} />}\r\n                                                            {ref.status.charAt(0).toUpperCase() + ref.status.slice(1)}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                    <div className=\"referral-reward\">\r\n                                                        {ref.status === 'completed' ? (\r\n                                                            <span className=\"reward-earned\">+$15</span>\r\n                                                        ) : ref.status === 'pending' ? (\r\n                                                            <span className=\"reward-pending\">Pending</span>\r\n                                                        ) : (\r\n                                                            <span className=\"reward-expired\">-</span>\r\n                                                        )}\r\n                                                    </div>\r\n                                                </motion.div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* DEVICES TAB */}\r\n                        {activeTab === 'devices' && (\r\n                            <div className=\"devices-section-pro\">\r\n                                <div className=\"section-header\">\r\n                                    <div>\r\n                                        <h1>My Devices</h1>\r\n                                        <p className=\"section-subtitle\">Manage your registered devices for faster service</p>\r\n                                    </div>\r\n                                    <Button variant=\"primary\" onClick={() => { setEditingDevice(null); setShowDeviceModal(true); }}>\r\n                                        <Plus size={16} /> Add Device\r\n                                    </Button>\r\n                                </div>\r\n\r\n                                {/* Device Stats Overview */}\r\n                                <div className=\"device-stats-overview\">\r\n                                    <div className=\"device-stat-card\">\r\n                                        <div className=\"stat-icon-wrapper blue\">\r\n                                            <Smartphone size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-details\">\r\n                                            <span className=\"stat-number\">{devices.filter(d => d.type === 'smartphone').length}</span>\r\n                                            <span className=\"stat-text\">Smartphones</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"device-stat-card\">\r\n                                        <div className=\"stat-icon-wrapper purple\">\r\n                                            <Laptop size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-details\">\r\n                                            <span className=\"stat-number\">{devices.filter(d => d.type === 'laptop').length}</span>\r\n                                            <span className=\"stat-text\">Laptops</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"device-stat-card\">\r\n                                        <div className=\"stat-icon-wrapper green\">\r\n                                            <Tablet size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-details\">\r\n                                            <span className=\"stat-number\">{devices.filter(d => d.type === 'tablet').length}</span>\r\n                                            <span className=\"stat-text\">Tablets</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"device-stat-card\">\r\n                                        <div className=\"stat-icon-wrapper yellow\">\r\n                                            <Package size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-details\">\r\n                                            <span className=\"stat-number\">{devices.length}</span>\r\n                                            <span className=\"stat-text\">Total Devices</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {devices.length === 0 ? (\r\n                                    <div className=\"empty-state device-empty\">\r\n                                        <div className=\"empty-icon\">\r\n                                            <Smartphone size={64} />\r\n                                        </div>\r\n                                        <h3>No Devices Registered</h3>\r\n                                        <p>Register your devices to speed up the booking process and keep track of repair history.</p>\r\n                                        <Button variant=\"primary\" onClick={() => setShowDeviceModal(true)}>\r\n                                            <Plus size={16} /> Add Your First Device\r\n                                        </Button>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"devices-grid-pro\">\r\n                                        {devices.map((device, index) => (\r\n                                            <motion.div\r\n                                                key={device.id}\r\n                                                className=\"device-card-pro\"\r\n                                                initial={{ opacity: 0, y: 20 }}\r\n                                                animate={{ opacity: 1, y: 0 }}\r\n                                                transition={{ delay: index * 0.1 }}\r\n                                            >\r\n                                                <div className=\"device-card-header\">\r\n                                                    <div className={`device-type-icon ${device.type}`}>\r\n                                                        {device.type === 'laptop' ? <Laptop size={28} /> :\r\n                                                            device.type === 'tablet' ? <Tablet size={28} /> :\r\n                                                                <Smartphone size={28} />}\r\n                                                    </div>\r\n                                                    <div className=\"device-card-actions\">\r\n                                                        <button onClick={() => { setEditingDevice(device); setShowDeviceModal(true); }} title=\"Edit device\" className=\"action-btn edit\">\r\n                                                            <Edit2 size={16} />\r\n                                                        </button>\r\n                                                        <button onClick={() => handleDeleteDevice(device.id)} title=\"Delete device\" className=\"action-btn delete\">\r\n                                                            <Trash2 size={16} />\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"device-card-content\">\r\n                                                    <div className=\"device-name-row\">\r\n                                                        <h3>{device.name}</h3>\r\n                                                        <span className={`device-type-badge ${device.type}`}>\r\n                                                            {device.type === 'smartphone' ? 'Phone' : device.type === 'laptop' ? 'Laptop' : 'Tablet'}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                    <p className=\"device-model-text\">{device.brand} {device.model}</p>\r\n\r\n                                                    <div className=\"device-details-grid\">\r\n                                                        {device.color && (\r\n                                                            <div className=\"device-detail\">\r\n                                                                <span className=\"detail-label\">Color</span>\r\n                                                                <span className=\"detail-value\">{device.color}</span>\r\n                                                            </div>\r\n                                                        )}\r\n                                                        <div className=\"device-detail\">\r\n                                                            <span className=\"detail-label\">Added</span>\r\n                                                            <span className=\"detail-value\">{new Date(device.addedDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    {device.notes && (\r\n                                                        <div className=\"device-notes-section\">\r\n                                                            <FileText size={14} />\r\n                                                            <span>{device.notes}</span>\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n\r\n                                                <div className=\"device-card-footer\">\r\n                                                    <Link to={`/booking?device=${encodeURIComponent(device.brand + ' ' + device.model)}`} className=\"book-repair-btn\">\r\n                                                        <Calendar size={16} />\r\n                                                        Book Repair\r\n                                                    </Link>\r\n                                                </div>\r\n                                            </motion.div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Device Tips */}\r\n                                <div className=\"device-tips-section\">\r\n                                    <h4><Info size={18} /> Device Management Tips</h4>\r\n                                    <div className=\"tips-grid\">\r\n                                        <div className=\"tip-card\">\r\n                                            <Smartphone size={20} />\r\n                                            <div>\r\n                                                <strong>Keep Info Updated</strong>\r\n                                                <p>Update device details when you upgrade to ensure accurate service quotes.</p>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"tip-card\">\r\n                                            <Shield size={20} />\r\n                                            <div>\r\n                                                <strong>Track Warranties</strong>\r\n                                                <p>Registered devices are automatically linked to warranty tracking.</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* INVOICES TAB */}\r\n                        {activeTab === 'invoices' && (\r\n                            <div className=\"invoices-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>Invoices & Receipts</h1>\r\n                                </div>\r\n\r\n                                {invoices.length === 0 ? (\r\n                                    <div className=\"empty-state\">\r\n                                        <Receipt size={48} />\r\n                                        <h3>No invoices yet</h3>\r\n                                        <p>Your invoices will appear here after completed repairs.</p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"invoices-list\">\r\n                                        {invoices.map(invoice => (\r\n                                            <div key={invoice.id} className=\"invoice-card\">\r\n                                                <div className=\"invoice-main\">\r\n                                                    <div className=\"invoice-id\">\r\n                                                        <FileText size={20} />\r\n                                                        <span>{invoice.id}</span>\r\n                                                    </div>\r\n                                                    <div className=\"invoice-info\">\r\n                                                        <span className=\"invoice-date\">{invoice.date}</span>\r\n                                                        <span className={`invoice-status ${invoice.status.toLowerCase()}`}>{invoice.status}</span>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"invoice-summary\">\r\n                                                    {invoice.items.map((item, idx) => (\r\n                                                        <span key={idx}>{item.description}</span>\r\n                                                    ))}\r\n                                                </div>\r\n                                                <div className=\"invoice-footer\">\r\n                                                    <span className=\"invoice-total\">${invoice.total.toFixed(2)}</span>\r\n                                                    <div className=\"invoice-actions\">\r\n                                                        <Button variant=\"secondary\" onClick={() => { setSelectedInvoice(invoice); setShowInvoiceModal(true); }}>\r\n                                                            <Eye size={14} /> View\r\n                                                        </Button>\r\n                                                        <Button variant=\"secondary\" onClick={() => generateInvoicePDF(invoice, { name: user.name, email: user.email })}>\r\n                                                            <Download size={14} /> PDF\r\n                                                        </Button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n\r\n                        {/* MESSAGES TAB */}\r\n                        {activeTab === 'messages' && (\r\n                            <div className=\"messages-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>Support Chat</h1>\r\n                                </div>\r\n\r\n                                <div className=\"chat-container\">\r\n                                    <div className=\"messages-list\">\r\n                                        {messages.map(msg => (\r\n                                            <div key={msg.id} className={`message ${msg.type}`}>\r\n                                                <div className=\"message-bubble\">\r\n                                                    <p>{msg.message}</p>\r\n                                                </div>\r\n                                                <span className=\"message-meta\">{msg.sender} ΓÇó {msg.date}</span>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n\r\n                                    <div className=\"message-input\">\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={newMessage}\r\n                                            onChange={(e) => setNewMessage(e.target.value)}\r\n                                            placeholder=\"Type your message...\"\r\n                                            onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}\r\n                                            aria-label=\"Type your message\"\r\n                                        />\r\n                                        <button onClick={handleSendMessage} aria-label=\"Send message\"><Send size={18} /></button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* WARRANTIES TAB */}\r\n                        {activeTab === 'warranties' && (\r\n                            <div className=\"warranties-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>Warranty Tracker</h1>\r\n                                    <p className=\"section-subtitle\">Monitor and manage warranties for all your repaired devices</p>\r\n                                </div>\r\n\r\n                                {/* Warranty Overview Stats */}\r\n                                <div className=\"warranty-overview-stats\">\r\n                                    <div className=\"warranty-stat-card\">\r\n                                        <div className=\"stat-icon active\">\r\n                                            <ShieldCheck size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-content\">\r\n                                            <span className=\"stat-value\">{warranties.filter(w => getWarrantyStatus(w).status === 'active').length}</span>\r\n                                            <span className=\"stat-label\">Active Warranties</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"warranty-stat-card\">\r\n                                        <div className=\"stat-icon expiring\">\r\n                                            <Clock size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-content\">\r\n                                            <span className=\"stat-value\">{warranties.filter(w => getWarrantyStatus(w).status === 'expiring').length}</span>\r\n                                            <span className=\"stat-label\">Expiring Soon</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"warranty-stat-card\">\r\n                                        <div className=\"stat-icon total\">\r\n                                            <FileText size={24} />\r\n                                        </div>\r\n                                        <div className=\"stat-content\">\r\n                                            <span className=\"stat-value\">{warranties.length}</span>\r\n                                            <span className=\"stat-label\">Total Warranties</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {warranties.length === 0 ? (\r\n                                    <div className=\"empty-state warranty-empty\">\r\n                                        <div className=\"empty-icon\">\r\n                                            <ShieldCheck size={64} />\r\n                                        </div>\r\n                                        <h3>No Warranties Yet</h3>\r\n                                        <p>When you complete a repair with us, your warranty information will appear here. All repairs include our standard 90-day warranty.</p>\r\n                                        <Button variant=\"primary\" onClick={() => navigate('/booking')}>\r\n                                            <Calendar size={16} /> Book a Repair\r\n                                        </Button>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"warranties-list\">\r\n                                        {warranties.map(warranty => {\r\n                                            const status = getWarrantyStatus(warranty);\r\n                                            const daysRemaining = Math.max(0, Math.ceil((new Date(warranty.warrantyExpiry) - new Date()) / (1000 * 60 * 60 * 24)));\r\n                                            const progressPercent = Math.min(100, Math.max(0, (daysRemaining / warranty.warrantyDays) * 100));\r\n\r\n                                            return (\r\n                                                <motion.div\r\n                                                    key={warranty.id}\r\n                                                    className={`warranty-card-pro ${status.status}`}\r\n                                                    initial={{ opacity: 0, y: 20 }}\r\n                                                    animate={{ opacity: 1, y: 0 }}\r\n                                                    transition={{ duration: 0.3 }}\r\n                                                >\r\n                                                    <div className=\"warranty-card-header\">\r\n                                                        <div className=\"warranty-device-info\">\r\n                                                            <div className={`device-icon ${status.status}`}>\r\n                                                                {warranty.deviceType === 'laptop' ? <Laptop size={24} /> :\r\n                                                                    warranty.deviceType === 'tablet' ? <Tablet size={24} /> :\r\n                                                                        <Smartphone size={24} />}\r\n                                                            </div>\r\n                                                            <div className=\"device-details\">\r\n                                                                <h3>{warranty.deviceName}</h3>\r\n                                                                <span className=\"service-type\">{warranty.serviceName}</span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <div className={`warranty-badge ${status.status}`}>\r\n                                                            {status.status === 'active' && <ShieldCheck size={14} />}\r\n                                                            {status.status === 'expiring' && <AlertCircle size={14} />}\r\n                                                            {status.status === 'expired' && <XCircle size={14} />}\r\n                                                            {status.label}\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"warranty-progress-section\">\r\n                                                        <div className=\"progress-header\">\r\n                                                            <span className=\"progress-label\">Warranty Period</span>\r\n                                                            <span className=\"progress-days\">\r\n                                                                {status.status === 'expired' ? 'Expired' : `${daysRemaining} days remaining`}\r\n                                                            </span>\r\n                                                        </div>\r\n                                                        <div className=\"warranty-progress-bar\">\r\n                                                            <div\r\n                                                                className={`progress-fill ${status.status}`}\r\n                                                                style={{ width: `${progressPercent}%` }}\r\n                                                            />\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"warranty-info-grid\">\r\n                                                        <div className=\"info-item\">\r\n                                                            <Calendar size={16} />\r\n                                                            <div>\r\n                                                                <span className=\"info-label\">Repair Date</span>\r\n                                                                <span className=\"info-value\">{new Date(warranty.repairDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <div className=\"info-item\">\r\n                                                            <Clock size={16} />\r\n                                                            <div>\r\n                                                                <span className=\"info-label\">Expiry Date</span>\r\n                                                                <span className=\"info-value\">{new Date(warranty.warrantyExpiry).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <div className=\"info-item\">\r\n                                                            <Shield size={16} />\r\n                                                            <div>\r\n                                                                <span className=\"info-label\">Coverage Period</span>\r\n                                                                <span className=\"info-value\">{warranty.warrantyDays} Days</span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <div className=\"info-item\">\r\n                                                            <FileText size={16} />\r\n                                                            <div>\r\n                                                                <span className=\"info-label\">Warranty ID</span>\r\n                                                                <span className=\"info-value\">#{warranty.id}</span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    {warranty.coverage && warranty.coverage.length > 0 && (\r\n                                                        <div className=\"warranty-coverage-section\">\r\n                                                            <h4><CheckCircle size={16} /> What's Covered</h4>\r\n                                                            <div className=\"coverage-grid\">\r\n                                                                {warranty.coverage.map((item, i) => (\r\n                                                                    <div key={i} className=\"coverage-item\">\r\n                                                                        <CheckCircle size={14} />\r\n                                                                        <span>{item}</span>\r\n                                                                    </div>\r\n                                                                ))}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    )}\r\n\r\n                                                    <div className=\"warranty-card-footer\">\r\n                                                        {status.status === 'active' && (\r\n                                                            <Button\r\n                                                                variant=\"primary\"\r\n                                                                onClick={() => { setSelectedWarranty(warranty); setShowWarrantyClaimModal(true); }}\r\n                                                            >\r\n                                                                <AlertCircle size={16} /> File a Warranty Claim\r\n                                                            </Button>\r\n                                                        )}\r\n                                                        {status.status === 'expiring' && (\r\n                                                            <>\r\n                                                                <div className=\"expiring-notice\">\r\n                                                                    <AlertCircle size={16} />\r\n                                                                    <span>Your warranty expires in {daysRemaining} days</span>\r\n                                                                </div>\r\n                                                                <Button\r\n                                                                    variant=\"primary\"\r\n                                                                    onClick={() => { setSelectedWarranty(warranty); setShowWarrantyClaimModal(true); }}\r\n                                                                >\r\n                                                                    <AlertCircle size={16} /> File a Claim\r\n                                                                </Button>\r\n                                                            </>\r\n                                                        )}\r\n                                                        {status.status === 'expired' && (\r\n                                                            <div className=\"expired-notice\">\r\n                                                                <XCircle size={16} />\r\n                                                                <span>This warranty has expired. Contact support for repair options.</span>\r\n                                                            </div>\r\n                                                        )}\r\n                                                        <Button variant=\"secondary\" onClick={() => navigate('/booking')}>\r\n                                                            <RefreshCw size={16} /> Book New Repair\r\n                                                        </Button>\r\n                                                    </div>\r\n                                                </motion.div>\r\n                                            );\r\n                                        })}\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Warranty Info Footer */}\r\n                                <div className=\"warranty-info-footer\">\r\n                                    <div className=\"info-card\">\r\n                                        <ShieldCheck size={20} />\r\n                                        <div>\r\n                                            <h4>Our Warranty Promise</h4>\r\n                                            <p>All repairs come with a minimum 90-day warranty. Screen replacements include a 6-month warranty on parts and labor.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"info-card\">\r\n                                        <Headphones size={20} />\r\n                                        <div>\r\n                                            <h4>Need Help?</h4>\r\n                                            <p>Contact our support team for warranty questions or to file a claim by phone.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* PAYMENT METHODS TAB */}\r\n                        {activeTab === 'payments' && (\r\n                            <div className=\"payments-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>Payment Methods</h1>\r\n                                    <Button variant=\"primary\" onClick={() => setShowPaymentModal(true)}>\r\n                                        <Plus size={16} /> Add Card\r\n                                    </Button>\r\n                                </div>\r\n\r\n                                <div className=\"security-notice\">\r\n                                    <Lock size={18} />\r\n                                    <p>Your payment information is encrypted and securely stored. We never store your full card number.</p>\r\n                                </div>\r\n\r\n                                {paymentMethods.length === 0 ? (\r\n                                    <div className=\"empty-state\">\r\n                                        <CreditCard size={48} />\r\n                                        <h3>No payment methods</h3>\r\n                                        <p>Add a payment method for faster checkout.</p>\r\n                                        <Button variant=\"primary\" onClick={() => setShowPaymentModal(true)}>\r\n                                            <Plus size={16} /> Add Payment Method\r\n                                        </Button>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"payment-methods-list\">\r\n                                        {paymentMethods.map(method => (\r\n                                            <div key={method.id} className={`payment-card ${method.isDefault ? 'default' : ''}`}>\r\n                                                <div className=\"card-visual\">\r\n                                                    <span className=\"card-type\">{method.type?.toUpperCase()}</span>\r\n                                                    <span className=\"card-number\">ΓÇóΓÇóΓÇóΓÇó ΓÇóΓÇóΓÇóΓÇó ΓÇóΓÇóΓÇóΓÇó {method.last4}</span>\r\n                                                    <span className=\"card-expiry\">{method.expiryMonth}/{method.expiryYear}</span>\r\n                                                </div>\r\n                                                <div className=\"card-info\">\r\n                                                    <span className=\"cardholder\">{method.cardholderName}</span>\r\n                                                    {method.isDefault && <span className=\"default-badge\">Default</span>}\r\n                                                </div>\r\n                                                <div className=\"card-actions\">\r\n                                                    {!method.isDefault && (\r\n                                                        <Button variant=\"secondary\" onClick={() => handleSetDefaultPayment(method.id)}>\r\n                                                            Set Default\r\n                                                        </Button>\r\n                                                    )}\r\n                                                    <button\r\n                                                        className=\"delete-btn\"\r\n                                                        onClick={() => handleRemovePaymentMethod(method.id)}\r\n                                                        aria-label=\"Remove payment method\"\r\n                                                    >\r\n                                                        <Trash2 size={16} />\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* REVIEWS TAB */}\r\n                        {activeTab === 'reviews' && (\r\n                            <div className=\"reviews-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>My Reviews</h1>\r\n                                </div>\r\n\r\n                                {reviewableBookings.length > 0 && (\r\n                                    <div className=\"pending-reviews\">\r\n                                        <h3><Star size={18} /> Pending Reviews</h3>\r\n                                        <p>Share your experience! These repairs are waiting for your feedback.</p>\r\n                                        <div className=\"reviewable-list\">\r\n                                            {reviewableBookings.map(booking => (\r\n                                                <div key={booking.id} className=\"reviewable-item\">\r\n                                                    <div className=\"item-info\">\r\n                                                        <h4>{getDeviceName(booking.device)}</h4>\r\n                                                        <span>{booking.issue}</span>\r\n                                                    </div>\r\n                                                    <Button\r\n                                                        variant=\"primary\"\r\n                                                        onClick={() => { setSelectedBookingForReview(booking); setShowReviewModal(true); }}\r\n                                                    >\r\n                                                        Write Review\r\n                                                    </Button>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {reviews.length === 0 && reviewableBookings.length === 0 ? (\r\n                                    <div className=\"empty-state\">\r\n                                        <Star size={48} />\r\n                                        <h3>No reviews yet</h3>\r\n                                        <p>After completing a repair, you can leave a review here.</p>\r\n                                    </div>\r\n                                ) : reviews.length > 0 && (\r\n                                    <div className=\"reviews-list\">\r\n                                        <h3>Your Reviews</h3>\r\n                                        {reviews.map(review => (\r\n                                            <div key={review.id} className=\"review-card\">\r\n                                                <div className=\"review-header\">\r\n                                                    <div className=\"review-service\">\r\n                                                        <h4>{review.deviceName}</h4>\r\n                                                        <span>{review.serviceName}</span>\r\n                                                    </div>\r\n                                                    <div className=\"review-rating\">\r\n                                                        {[1, 2, 3, 4, 5].map(star => (\r\n                                                            <Star\r\n                                                                key={star}\r\n                                                                size={18}\r\n                                                                fill={star <= review.rating ? '#fbbf24' : 'none'}\r\n                                                                color={star <= review.rating ? '#fbbf24' : '#94a3b8'}\r\n                                                            />\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n                                                <h5>{review.title}</h5>\r\n                                                <p>{review.comment}</p>\r\n                                                <div className=\"review-footer\">\r\n                                                    <span className=\"review-date\">{new Date(review.date).toLocaleDateString()}</span>\r\n                                                    {review.wouldRecommend && (\r\n                                                        <span className=\"would-recommend\">\r\n                                                            <ThumbsUp size={14} /> Would recommend\r\n                                                        </span>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* MESSAGES TAB */}\r\n                        {activeTab === 'messages' && (\r\n                            <div className=\"messages-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>Messages</h1>\r\n                                    <button className=\"add-btn\" onClick={() => setLiveChatOpen(true)}>\r\n                                        <Plus size={20} /> New Chat\r\n                                    </button>\r\n                                </div>\r\n\r\n                                <div className=\"messages-container\">\r\n                                    {liveChatMessages.length === 0 ? (\r\n                                        <div className=\"empty-messages\">\r\n                                            <div className=\"empty-icon\">≡ƒÆ¼</div>\r\n                                            <h3>No messages yet</h3>\r\n                                            <p>Start a conversation with our support team</p>\r\n                                            <button className=\"start-chat-btn\" onClick={() => setLiveChatOpen(true)}>\r\n                                                <MessageSquare size={18} /> Start Chat\r\n                                            </button>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"conversation-view\">\r\n                                            <div className=\"conversation-header\">\r\n                                                <div className=\"conversation-info\">\r\n                                                    <span className=\"conversation-icon\">≡ƒÆ¼</span>\r\n                                                    <div>\r\n                                                        <h3>Support Conversation</h3>\r\n                                                        <span className=\"conversation-status online\">Active</span>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <span className=\"message-count\">{liveChatMessages.length} messages</span>\r\n                                            </div>\r\n\r\n                                            <div className=\"messages-list\">\r\n                                                {liveChatMessages.map(msg => (\r\n                                                    <motion.div\r\n                                                        key={msg.id}\r\n                                                        className={`message-item ${msg.sender}`}\r\n                                                        initial={{ opacity: 0, y: 10 }}\r\n                                                        animate={{ opacity: 1, y: 0 }}\r\n                                                    >\r\n                                                        <div className=\"message-avatar\">\r\n                                                            {msg.sender === 'customer'\r\n                                                                ? (user.name?.charAt(0) || 'U')\r\n                                                                : (msg.agentAvatar || '≡ƒñû')\r\n                                                            }\r\n                                                        </div>\r\n                                                        <div className=\"message-body\">\r\n                                                            <div className=\"message-header\">\r\n                                                                <span className=\"message-sender\">\r\n                                                                    {msg.sender === 'customer'\r\n                                                                        ? 'You'\r\n                                                                        : (msg.agentName || 'Support')\r\n                                                                    }\r\n                                                                </span>\r\n                                                                {msg.isRealAgent && (\r\n                                                                    <span className=\"real-agent-badge\">Support Agent</span>\r\n                                                                )}\r\n                                                                {msg.isBot && (\r\n                                                                    <span className=\"bot-badge\">Bot</span>\r\n                                                                )}\r\n                                                                <span className=\"message-timestamp\">\r\n                                                                    {new Date(msg.timestamp).toLocaleString()}\r\n                                                                </span>\r\n                                                            </div>\r\n                                                            {msg.attachment && (\r\n                                                                <div className=\"message-attachment-preview\">\r\n                                                                    {msg.attachment.type?.startsWith('image/') ? (\r\n                                                                        <img src={msg.attachment.preview} alt=\"Attachment\" />\r\n                                                                    ) : (\r\n                                                                        <div className=\"file-preview-item\">\r\n                                                                            <FileText size={16} />\r\n                                                                            <span>{msg.attachment.name}</span>\r\n                                                                        </div>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                            )}\r\n                                                            <p className=\"message-text\">{msg.message}</p>\r\n                                                        </div>\r\n                                                    </motion.div>\r\n                                                ))}\r\n                                            </div>\r\n\r\n                                            <div className=\"conversation-actions\">\r\n                                                <button className=\"open-chat-btn\" onClick={() => setLiveChatOpen(true)}>\r\n                                                    <Send size={18} /> Continue Chat\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* SETTINGS TAB */}\r\n                        {activeTab === 'settings' && customerSettings && (\r\n                            <div className=\"settings-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h1>Settings</h1>\r\n                                </div>\r\n\r\n                                <div className=\"settings-grid\">\r\n                                    {/* Notification Settings */}\r\n                                    <div className=\"settings-card\">\r\n                                        <div className=\"card-header\">\r\n                                            <h3><Bell size={18} /> Notification Preferences</h3>\r\n                                        </div>\r\n                                        <div className=\"settings-list\">\r\n                                            <div className=\"setting-item\">\r\n                                                <div className=\"setting-info\">\r\n                                                    <span className=\"setting-label\">Email - Repair Updates</span>\r\n                                                    <span className=\"setting-desc\">Get notified about your repair status</span>\r\n                                                </div>\r\n                                                <label className=\"toggle-switch\">\r\n                                                    <input\r\n                                                        type=\"checkbox\"\r\n                                                        checked={customerSettings.notifications?.emailRepairUpdates}\r\n                                                        onChange={(e) => handleUpdateSettings({\r\n                                                            ...customerSettings,\r\n                                                            notifications: { ...customerSettings.notifications, emailRepairUpdates: e.target.checked }\r\n                                                        })}\r\n                                                    />\r\n                                                    <span className=\"slider\"></span>\r\n                                                </label>\r\n                                            </div>\r\n                                            <div className=\"setting-item\">\r\n                                                <div className=\"setting-info\">\r\n                                                    <span className=\"setting-label\">Email - Promotions</span>\r\n                                                    <span className=\"setting-desc\">Receive special offers and discounts</span>\r\n                                                </div>\r\n                                                <label className=\"toggle-switch\">\r\n                                                    <input\r\n                                                        type=\"checkbox\"\r\n                                                        checked={customerSettings.notifications?.emailPromotions}\r\n                                                        onChange={(e) => handleUpdateSettings({\r\n                                                            ...customerSettings,\r\n                                                            notifications: { ...customerSettings.notifications, emailPromotions: e.target.checked }\r\n                                                        })}\r\n                                                    />\r\n                                                    <span className=\"slider\"></span>\r\n                                                </label>\r\n                                            </div>\r\n                                            <div className=\"setting-item\">\r\n                                                <div className=\"setting-info\">\r\n                                                    <span className=\"setting-label\">SMS - Repair Updates</span>\r\n                                                    <span className=\"setting-desc\">Text message notifications</span>\r\n                                                </div>\r\n                                                <label className=\"toggle-switch\">\r\n                                                    <input\r\n                                                        type=\"checkbox\"\r\n                                                        checked={customerSettings.notifications?.smsRepairUpdates}\r\n                                                        onChange={(e) => handleUpdateSettings({\r\n                                                            ...customerSettings,\r\n                                                            notifications: { ...customerSettings.notifications, smsRepairUpdates: e.target.checked }\r\n                                                        })}\r\n                                                    />\r\n                                                    <span className=\"slider\"></span>\r\n                                                </label>\r\n                                            </div>\r\n                                            <div className=\"setting-item\">\r\n                                                <div className=\"setting-info\">\r\n                                                    <span className=\"setting-label\">Push Notifications</span>\r\n                                                    <span className=\"setting-desc\">Browser push notifications</span>\r\n                                                </div>\r\n                                                <label className=\"toggle-switch\">\r\n                                                    <input\r\n                                                        type=\"checkbox\"\r\n                                                        checked={customerSettings.notifications?.pushNotifications}\r\n                                                        onChange={(e) => handleUpdateSettings({\r\n                                                            ...customerSettings,\r\n                                                            notifications: { ...customerSettings.notifications, pushNotifications: e.target.checked }\r\n                                                        })}\r\n                                                    />\r\n                                                    <span className=\"slider\"></span>\r\n                                                </label>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Reminder Settings */}\r\n                                    <div className=\"settings-card\">\r\n                                        <div className=\"card-header\">\r\n                                            <h3><Clock size={18} /> Appointment Reminders</h3>\r\n                                        </div>\r\n                                        <div className=\"settings-list\">\r\n                                            <div className=\"setting-item\">\r\n                                                <div className=\"setting-info\">\r\n                                                    <span className=\"setting-label\">Reminder Time</span>\r\n                                                    <span className=\"setting-desc\">When to send appointment reminders</span>\r\n                                                </div>\r\n                                                <select\r\n                                                    value={customerSettings.reminders?.appointmentReminder || '24h'}\r\n                                                    onChange={(e) => handleUpdateSettings({\r\n                                                        ...customerSettings,\r\n                                                        reminders: { ...customerSettings.reminders, appointmentReminder: e.target.value }\r\n                                                    })}\r\n                                                    className=\"setting-select\"\r\n                                                >\r\n                                                    <option value=\"1h\">1 hour before</option>\r\n                                                    <option value=\"3h\">3 hours before</option>\r\n                                                    <option value=\"24h\">24 hours before</option>\r\n                                                    <option value=\"48h\">48 hours before</option>\r\n                                                </select>\r\n                                            </div>\r\n                                            <div className=\"setting-item\">\r\n                                                <div className=\"setting-info\">\r\n                                                    <span className=\"setting-label\">Pickup Reminders</span>\r\n                                                    <span className=\"setting-desc\">Remind me when repair is ready</span>\r\n                                                </div>\r\n                                                <label className=\"toggle-switch\">\r\n                                                    <input\r\n                                                        type=\"checkbox\"\r\n                                                        checked={customerSettings.reminders?.pickupReminder}\r\n                                                        onChange={(e) => handleUpdateSettings({\r\n                                                            ...customerSettings,\r\n                                                            reminders: { ...customerSettings.reminders, pickupReminder: e.target.checked }\r\n                                                        })}\r\n                                                    />\r\n                                                    <span className=\"slider\"></span>\r\n                                                </label>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Privacy Settings */}\r\n                                    <div className=\"settings-card\">\r\n                                        <div className=\"card-header\">\r\n                                            <h3><Shield size={18} /> Privacy</h3>\r\n                                        </div>\r\n                                        <div className=\"settings-list\">\r\n                                            <div className=\"setting-item\">\r\n                                                <div className=\"setting-info\">\r\n                                                    <span className=\"setting-label\">Analytics</span>\r\n                                                    <span className=\"setting-desc\">Help us improve by sharing usage data</span>\r\n                                                </div>\r\n                                                <label className=\"toggle-switch\">\r\n                                                    <input\r\n                                                        type=\"checkbox\"\r\n                                                        checked={customerSettings.privacy?.shareDataForAnalytics}\r\n                                                        onChange={(e) => handleUpdateSettings({\r\n                                                            ...customerSettings,\r\n                                                            privacy: { ...customerSettings.privacy, shareDataForAnalytics: e.target.checked }\r\n                                                        })}\r\n                                                    />\r\n                                                    <span className=\"slider\"></span>\r\n                                                </label>\r\n                                            </div>\r\n                                            <div className=\"setting-item\">\r\n                                                <div className=\"setting-info\">\r\n                                                    <span className=\"setting-label\">Marketing Calls</span>\r\n                                                    <span className=\"setting-desc\">Allow promotional phone calls</span>\r\n                                                </div>\r\n                                                <label className=\"toggle-switch\">\r\n                                                    <input\r\n                                                        type=\"checkbox\"\r\n                                                        checked={customerSettings.privacy?.allowMarketingCalls}\r\n                                                        onChange={(e) => handleUpdateSettings({\r\n                                                            ...customerSettings,\r\n                                                            privacy: { ...customerSettings.privacy, allowMarketingCalls: e.target.checked }\r\n                                                        })}\r\n                                                    />\r\n                                                    <span className=\"slider\"></span>\r\n                                                </label>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Support Chat Card */}\r\n                                    <div className=\"settings-card support-card\">\r\n                                        <div className=\"card-header\">\r\n                                            <h3><Headphones size={18} /> Support & Help</h3>\r\n                                        </div>\r\n                                        <div className=\"settings-list\">\r\n                                            <div className=\"setting-item clickable\" onClick={() => setActiveTab('messages')}>\r\n                                                <div className=\"setting-info\">\r\n                                                    <span className=\"setting-label\">Live Support Chat</span>\r\n                                                    <span className=\"setting-desc\">Chat with our support team in real-time</span>\r\n                                                </div>\r\n                                                <ChevronRight size={20} className=\"chevron-icon\" />\r\n                                            </div>\r\n                                            <div className=\"setting-item clickable\" onClick={() => setLiveChatOpen(true)}>\r\n                                                <div className=\"setting-info\">\r\n                                                    <span className=\"setting-label\">Quick Chat Widget</span>\r\n                                                    <span className=\"setting-desc\">Open floating chat for quick questions</span>\r\n                                                </div>\r\n                                                <ChevronRight size={20} className=\"chevron-icon\" />\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </>\r\n                )}\r\n            </main>\r\n\r\n            {/* LIVE CHAT WIDGET */}\r\n            <div className={`live-chat-widget ${liveChatOpen ? 'open' : ''}`}>\r\n                <motion.button\r\n                    className=\"chat-toggle\"\r\n                    onClick={() => setLiveChatOpen(!liveChatOpen)}\r\n                    aria-label={liveChatOpen ? 'Close chat' : 'Open live chat'}\r\n                    whileHover={{ scale: 1.1 }}\r\n                    whileTap={{ scale: 0.95 }}\r\n                    animate={liveChatOpen ? { rotate: 0 } : { rotate: 0 }}\r\n                >\r\n                    {liveChatOpen ? <X size={24} /> : <Headphones size={24} />}\r\n                    {!liveChatOpen && <span className=\"chat-badge\">1</span>}\r\n                </motion.button>\r\n\r\n                {liveChatOpen && (\r\n                    <motion.div\r\n                        className=\"chat-window\"\r\n                        initial={{ opacity: 0, y: 20, scale: 0.95 }}\r\n                        animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                        exit={{ opacity: 0, y: 20, scale: 0.95 }}\r\n                        transition={{ duration: 0.2 }}\r\n                    >\r\n                        <div className=\"chat-header\">\r\n                            <div className=\"chat-header-info\">\r\n                                <div className=\"chat-avatar\">\r\n                                    <span>≡ƒñû</span>\r\n                                    <span className=\"status-dot online\"></span>\r\n                                </div>\r\n                                <div className=\"chat-header-text\">\r\n                                    <h4>SIFIXA Support</h4>\r\n                                    <span className=\"chat-status-text\">\r\n                                        {isTyping ? 'Typing...' : 'Online ΓÇó Ready to help'}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                            <button className=\"chat-close-btn\" onClick={() => setLiveChatOpen(false)} aria-label=\"Close chat\">\r\n                                <X size={20} />\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"chat-messages\">\r\n                            {liveChatMessages.length === 0 && (\r\n                                <div className=\"chat-welcome\">\r\n                                    <div className=\"welcome-icon\">≡ƒÆ¼</div>\r\n                                    <h3>Hi there! ≡ƒæï</h3>\r\n                                    <p>How can we help you today?</p>\r\n                                </div>\r\n                            )}\r\n\r\n                            {liveChatMessages.map(msg => (\r\n                                <motion.div\r\n                                    key={msg.id}\r\n                                    className={`chat-message ${msg.sender}`}\r\n                                    initial={{ opacity: 0, y: 10 }}\r\n                                    animate={{ opacity: 1, y: 0 }}\r\n                                    transition={{ duration: 0.2 }}\r\n                                >\r\n                                    {msg.sender === 'agent' && (\r\n                                        <div className=\"agent-avatar\">\r\n                                            {msg.agentAvatar || '≡ƒæñ'}\r\n                                        </div>\r\n                                    )}\r\n                                    <div className=\"message-content\">\r\n                                        {msg.agentName && <span className=\"agent-name\">{msg.agentName}</span>}\r\n                                        {msg.attachment && (\r\n                                            <div className=\"message-attachment\">\r\n                                                {msg.attachment.type?.startsWith('image/') ? (\r\n                                                    <img src={msg.attachment.preview} alt=\"Attachment\" />\r\n                                                ) : (\r\n                                                    <div className=\"file-attachment\">\r\n                                                        <FileText size={16} />\r\n                                                        <span>{msg.attachment.name}</span>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        )}\r\n                                        {msg.message && <p>{msg.message}</p>}\r\n                                        <div className=\"message-meta\">\r\n                                            <span className=\"message-time\">\r\n                                                {new Date(msg.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                                            </span>\r\n                                            {msg.sender === 'customer' && msg.status && (\r\n                                                <span className={`message-status ${msg.status}`}>\r\n                                                    {msg.status === 'sent' && 'Γ£ô'}\r\n                                                    {msg.status === 'delivered' && 'Γ£ôΓ£ô'}\r\n                                                    {msg.status === 'read' && <span className=\"read-check\">Γ£ôΓ£ô</span>}\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                </motion.div>\r\n                            ))}\r\n\r\n                            {isTyping && (\r\n                                <div className=\"chat-message agent typing-indicator\">\r\n                                    <div className=\"agent-avatar\">≡ƒñû</div>\r\n                                    <div className=\"message-content typing\">\r\n                                        <div className=\"typing-dots\">\r\n                                            <span></span>\r\n                                            <span></span>\r\n                                            <span></span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Quick Replies */}\r\n                        {showQuickReplies && liveChatMessages.length === 0 && (\r\n                            <div className=\"quick-replies\">\r\n                                <span className=\"quick-replies-label\">Quick questions:</span>\r\n                                <div className=\"quick-replies-grid\">\r\n                                    {quickReplies.map((reply, idx) => (\r\n                                        <button\r\n                                            key={idx}\r\n                                            className=\"quick-reply-btn\"\r\n                                            onClick={() => handleSendLiveChat(reply.message)}\r\n                                        >\r\n                                            <span className=\"quick-reply-icon\">{reply.icon}</span>\r\n                                            <span>{reply.label}</span>\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* File Attachment Preview */}\r\n                        {chatAttachment && (\r\n                            <div className=\"attachment-preview\">\r\n                                {chatAttachment.type?.startsWith('image/') ? (\r\n                                    <img src={chatAttachment.preview} alt=\"Preview\" />\r\n                                ) : (\r\n                                    <div className=\"file-preview\">\r\n                                        <FileText size={20} />\r\n                                        <span>{chatAttachment.name}</span>\r\n                                    </div>\r\n                                )}\r\n                                <button className=\"remove-attachment\" onClick={() => setChatAttachment(null)}>\r\n                                    <X size={16} />\r\n                                </button>\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"chat-input-area\">\r\n                            <label className=\"attachment-btn\">\r\n                                <input\r\n                                    type=\"file\"\r\n                                    accept=\"image/*,.pdf,.doc,.docx\"\r\n                                    onChange={handleFileUpload}\r\n                                    hidden\r\n                                />\r\n                                <Plus size={20} />\r\n                            </label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={liveChatInput}\r\n                                onChange={(e) => setLiveChatInput(e.target.value)}\r\n                                placeholder=\"Type a message...\"\r\n                                onKeyPress={(e) => e.key === 'Enter' && handleSendLiveChat()}\r\n                                aria-label=\"Type a message\"\r\n                            />\r\n                            <button\r\n                                className=\"send-btn\"\r\n                                onClick={() => handleSendLiveChat()}\r\n                                aria-label=\"Send\"\r\n                                disabled={!liveChatInput.trim() && !chatAttachment}\r\n                            >\r\n                                <Send size={18} />\r\n                            </button>\r\n                        </div>\r\n                    </motion.div>\r\n                )}\r\n            </div>\r\n\r\n            {/* MODALS */}\r\n            {showDeviceModal && (\r\n                <DeviceModal\r\n                    device={editingDevice}\r\n                    onSave={handleSaveDevice}\r\n                    onClose={() => { setShowDeviceModal(false); setEditingDevice(null); }}\r\n                />\r\n            )}\r\n\r\n            {showRescheduleModal && selectedBooking && (\r\n                <RescheduleModal\r\n                    booking={selectedBooking}\r\n                    timeSlots={timeSlots}\r\n                    onReschedule={handleReschedule}\r\n                    onClose={() => { setShowRescheduleModal(false); setSelectedBooking(null); }}\r\n                />\r\n            )}\r\n\r\n            {showProfileModal && (\r\n                <ProfileModal\r\n                    user={user}\r\n                    customerData={customerData}\r\n                    onSave={async (data) => {\r\n                        await mockApi.updateUserProfile(user.id, data);\r\n                        updateUser({ ...user, ...data });\r\n                        setShowProfileModal(false);\r\n                        loadAllData();\r\n                    }}\r\n                    onClose={() => setShowProfileModal(false)}\r\n                />\r\n            )}\r\n\r\n            {showPasswordModal && (\r\n                <PasswordModal\r\n                    userId={user.id}\r\n                    onClose={() => setShowPasswordModal(false)}\r\n                />\r\n            )}\r\n\r\n            {showInvoiceModal && selectedInvoice && (\r\n                <InvoiceModal\r\n                    invoice={selectedInvoice}\r\n                    onClose={() => { setShowInvoiceModal(false); setSelectedInvoice(null); }}\r\n                />\r\n            )}\r\n\r\n            {showPaymentModal && (\r\n                <PaymentModal\r\n                    paymentMethod={null}\r\n                    onSave={handleSavePaymentMethod}\r\n                    onClose={() => setShowPaymentModal(false)}\r\n                />\r\n            )}\r\n\r\n            {showReviewModal && selectedBookingForReview && (\r\n                <ReviewModal\r\n                    booking={selectedBookingForReview}\r\n                    onSubmit={handleSubmitReview}\r\n                    onClose={() => { setShowReviewModal(false); setSelectedBookingForReview(null); }}\r\n                />\r\n            )}\r\n\r\n            {showWarrantyClaimModal && selectedWarranty && (\r\n                <WarrantyClaimModal\r\n                    warranty={selectedWarranty}\r\n                    onSubmit={handleFileWarrantyClaim}\r\n                    onClose={() => { setShowWarrantyClaimModal(false); setSelectedWarranty(null); }}\r\n                />\r\n            )}\r\n\r\n            {showReferralInviteModal && (\r\n                <ReferralInviteModal\r\n                    referralCode={referralCode}\r\n                    onSend={handleSendReferralInvite}\r\n                    onClose={() => setShowReferralInviteModal(false)}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\n// ========== MODAL COMPONENTS ==========\r\n\r\nconst DeviceModal = ({ device, onSave, onClose }) => {\r\n    const [formData, setFormData] = useState({\r\n        name: device?.name || '',\r\n        type: device?.type || 'smartphone',\r\n        brand: device?.brand || '',\r\n        model: device?.model || '',\r\n        color: device?.color || '',\r\n        serialNumber: device?.serialNumber || '',\r\n        notes: device?.notes || ''\r\n    });\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSave(formData);\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>{device ? 'Edit Device' : 'Add New Device'}</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group\">\r\n                        <label>Device Name</label>\r\n                        <input type=\"text\" value={formData.name} onChange={e => setFormData({ ...formData, name: e.target.value })} placeholder=\"My iPhone\" required />\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>Type</label>\r\n                            <select value={formData.type} onChange={e => setFormData({ ...formData, type: e.target.value })}>\r\n                                <option value=\"smartphone\">Smartphone</option>\r\n                                <option value=\"laptop\">Laptop</option>\r\n                                <option value=\"tablet\">Tablet</option>\r\n                                <option value=\"smartwatch\">Smartwatch</option>\r\n                            </select>\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Brand</label>\r\n                            <input type=\"text\" value={formData.brand} onChange={e => setFormData({ ...formData, brand: e.target.value })} placeholder=\"Apple, Samsung...\" required />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>Model</label>\r\n                            <input type=\"text\" value={formData.model} onChange={e => setFormData({ ...formData, model: e.target.value })} placeholder=\"iPhone 15, Galaxy S24...\" required />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Color</label>\r\n                            <input type=\"text\" value={formData.color} onChange={e => setFormData({ ...formData, color: e.target.value })} placeholder=\"Black, Silver...\" />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Serial Number / IMEI (optional)</label>\r\n                        <input type=\"text\" value={formData.serialNumber} onChange={e => setFormData({ ...formData, serialNumber: e.target.value })} placeholder=\"For warranty purposes\" />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Notes</label>\r\n                        <textarea value={formData.notes} onChange={e => setFormData({ ...formData, notes: e.target.value })} placeholder=\"Any additional notes...\"></textarea>\r\n                    </div>\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\"><Save size={16} /> Save Device</Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst RescheduleModal = ({ booking, timeSlots, onReschedule, onClose }) => {\r\n    const [newDate, setNewDate] = useState(booking.date);\r\n    const [newTime, setNewTime] = useState(booking.time);\r\n    const minDate = new Date().toISOString().split('T')[0];\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content small\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Reschedule Booking</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <div className=\"reschedule-info\">\r\n                    <p><strong>{getDeviceName(booking.device)}</strong> - {booking.issue}</p>\r\n                    <p className=\"current\">Current: {booking.date} ({booking.time})</p>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label>New Date</label>\r\n                    <input type=\"date\" value={newDate} min={minDate} onChange={e => setNewDate(e.target.value)} />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label>New Time</label>\r\n                    <select value={newTime} onChange={e => setNewTime(e.target.value)}>\r\n                        {timeSlots.map(slot => (\r\n                            <option key={slot.id} value={slot.name}>{slot.name} ({slot.startTime} - {slot.endTime})</option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n                <div className=\"modal-actions\">\r\n                    <Button variant=\"secondary\" onClick={onClose}>Cancel</Button>\r\n                    <Button variant=\"primary\" onClick={() => onReschedule(newDate, newTime)}>\r\n                        <Calendar size={16} /> Confirm Reschedule\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst ProfileModal = ({ user, customerData, onSave, onClose }) => {\r\n    // Helper to parse address string if separate fields don't exist\r\n    const parseAddress = (addrString) => {\r\n        if (!addrString) return { street: '', city: '', state: '', zip: '' };\r\n        // Try simple parsing: \"Street, City, State Zip\"\r\n        const parts = addrString.split(', ');\r\n        if (parts.length >= 2) {\r\n            const street = parts[0];\r\n            const city = parts[1];\r\n            // Last part might be \"State Zip\" or just State\r\n            const lastPart = parts[2] || '';\r\n            const lastSpaceIndex = lastPart.lastIndexOf(' ');\r\n            let state = lastPart;\r\n            let zip = '';\r\n            if (lastSpaceIndex > 0) {\r\n                state = lastPart.substring(0, lastSpaceIndex);\r\n                zip = lastPart.substring(lastSpaceIndex + 1);\r\n            }\r\n            return { street, city, state, zip };\r\n        }\r\n        return { street: addrString, city: '', state: '', zip: '' };\r\n    };\r\n\r\n    const initialAddress = customerData?.address || user.address || '';\r\n    const addressComponents = user.addressComponents || parseAddress(initialAddress);\r\n\r\n    const [formData, setFormData] = useState({\r\n        name: user.name || '',\r\n        email: user.email || '',\r\n        phone: user.phone || customerData?.phone || '',\r\n        street: addressComponents.street || '',\r\n        city: addressComponents.city || '',\r\n        state: addressComponents.state || '',\r\n        zip: addressComponents.zip || ''\r\n    });\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        // Construct full address string for display compatibility\r\n        const fullAddress = `${formData.street}, ${formData.city}, ${formData.state} ${formData.zip}`.replace(/, , /g, ', ').replace(/  /g, ' ').trim();\r\n\r\n        onSave({\r\n            ...formData,\r\n            address: fullAddress,\r\n            // Also save individual components for future editing\r\n            addressComponents: {\r\n                street: formData.street,\r\n                city: formData.city,\r\n                state: formData.state,\r\n                zip: formData.zip\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Edit Profile</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group readonly\">\r\n                        <label>Username <span className=\"readonly-badge\">Cannot be changed</span></label>\r\n                        <input type=\"text\" value={`@${user.username}`} disabled />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Full Name</label>\r\n                        <input type=\"text\" value={formData.name} onChange={e => setFormData({ ...formData, name: e.target.value })} required />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Email</label>\r\n                        <input type=\"email\" value={formData.email} onChange={e => setFormData({ ...formData, email: e.target.value })} required />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Phone</label>\r\n                        <input type=\"tel\" value={formData.phone} onChange={e => setFormData({ ...formData, phone: e.target.value })} placeholder=\"555-123-4567\" />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Street Address</label>\r\n                        <input type=\"text\" value={formData.street} onChange={e => setFormData({ ...formData, street: e.target.value })} placeholder=\"123 Main St\" />\r\n                    </div>\r\n\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>City</label>\r\n                            <input type=\"text\" value={formData.city} onChange={e => setFormData({ ...formData, city: e.target.value })} placeholder=\"City\" />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>State</label>\r\n                            <input type=\"text\" value={formData.state} onChange={e => setFormData({ ...formData, state: e.target.value })} placeholder=\"State\" />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Zip Code</label>\r\n                            <input type=\"text\" value={formData.zip} onChange={e => setFormData({ ...formData, zip: e.target.value })} placeholder=\"Zip\" />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\"><Save size={16} /> Save Changes</Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst PasswordModal = ({ userId, onClose }) => {\r\n    const [currentPassword, setCurrentPassword] = useState('');\r\n    const [newPassword, setNewPassword] = useState('');\r\n    const [confirmPassword, setConfirmPassword] = useState('');\r\n    const [showPasswords, setShowPasswords] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [success, setSuccess] = useState(false);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n\r\n        if (newPassword.length < 6) {\r\n            setError('Password must be at least 6 characters');\r\n            return;\r\n        }\r\n        if (newPassword !== confirmPassword) {\r\n            setError('Passwords do not match');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            await mockApi.changePassword(userId, currentPassword, newPassword);\r\n            setSuccess(true);\r\n            setTimeout(onClose, 1500);\r\n        } catch (err) {\r\n            setError(err.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content small\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Change Password</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                {success ? (\r\n                    <div className=\"success-message\">\r\n                        <CheckCircle size={48} />\r\n                        <p>Password changed successfully!</p>\r\n                    </div>\r\n                ) : (\r\n                    <form onSubmit={handleSubmit}>\r\n                        {error && <div className=\"error-message\">{error}</div>}\r\n                        <div className=\"form-group\">\r\n                            <label>Current Password</label>\r\n                            <div className=\"password-input\">\r\n                                <input type={showPasswords ? 'text' : 'password'} value={currentPassword} onChange={e => setCurrentPassword(e.target.value)} required />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>New Password</label>\r\n                            <input type={showPasswords ? 'text' : 'password'} value={newPassword} onChange={e => setNewPassword(e.target.value)} required />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Confirm New Password</label>\r\n                            <input type={showPasswords ? 'text' : 'password'} value={confirmPassword} onChange={e => setConfirmPassword(e.target.value)} required />\r\n                        </div>\r\n                        <label className=\"show-password\">\r\n                            <input type=\"checkbox\" checked={showPasswords} onChange={() => setShowPasswords(!showPasswords)} />\r\n                            Show passwords\r\n                        </label>\r\n                        <div className=\"modal-actions\">\r\n                            <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                            <Button variant=\"primary\" type=\"submit\"><Shield size={16} /> Change Password</Button>\r\n                        </div>\r\n                    </form>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst InvoiceModal = ({ invoice, onClose }) => {\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content invoice-modal\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Invoice {invoice.id}</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <div className=\"invoice-details\">\r\n                    <div className=\"invoice-meta\">\r\n                        <div><strong>Date:</strong> {invoice.date}</div>\r\n                        <div><strong>Status:</strong> <span className={`status ${invoice.status.toLowerCase()}`}>{invoice.status}</span></div>\r\n                        {invoice.paymentMethod && <div><strong>Payment:</strong> {invoice.paymentMethod}</div>}\r\n                    </div>\r\n\r\n                    <table className=\"invoice-items\">\r\n                        <thead>\r\n                            <tr><th>Description</th><th>Qty</th><th>Price</th><th>Total</th></tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {invoice.items.map((item, idx) => (\r\n                                <tr key={idx}>\r\n                                    <td>{item.description}</td>\r\n                                    <td>{item.quantity}</td>\r\n                                    <td>${item.unitPrice.toFixed(2)}</td>\r\n                                    <td>${item.total.toFixed(2)}</td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n\r\n                    <div className=\"invoice-totals\">\r\n                        <div className=\"total-row\"><span>Subtotal</span><span>${invoice.subtotal.toFixed(2)}</span></div>\r\n                        <div className=\"total-row\"><span>Tax</span><span>${invoice.tax.toFixed(2)}</span></div>\r\n                        {invoice.discount > 0 && <div className=\"total-row discount\"><span>Discount</span><span>-${invoice.discount.toFixed(2)}</span></div>}\r\n                        <div className=\"total-row grand\"><span>Total</span><span>${invoice.total.toFixed(2)}</span></div>\r\n                    </div>\r\n\r\n                    {invoice.notes && <div className=\"invoice-notes\"><strong>Notes:</strong> {invoice.notes}</div>}\r\n                </div>\r\n                <div className=\"modal-actions\">\r\n                    <Button variant=\"secondary\" onClick={onClose}>Close</Button>\r\n                    <Button variant=\"primary\"><Download size={16} /> Download PDF</Button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ========== PAYMENT METHOD MODAL ==========\r\nconst PaymentModal = ({ paymentMethod, onSave, onClose }) => {\r\n    const [formData, setFormData] = useState({\r\n        type: paymentMethod?.type || 'credit',\r\n        cardNumber: paymentMethod?.cardNumber || '',\r\n        cardHolder: paymentMethod?.cardHolder || '',\r\n        expiryDate: paymentMethod?.expiryDate || '',\r\n        isDefault: paymentMethod?.isDefault || false\r\n    });\r\n    const [errors, setErrors] = useState({});\r\n\r\n    const validateCard = () => {\r\n        const newErrors = {};\r\n        if (!formData.cardNumber || formData.cardNumber.replace(/\\s/g, '').length !== 16) {\r\n            newErrors.cardNumber = 'Card number must be 16 digits';\r\n        }\r\n        if (!formData.cardHolder) {\r\n            newErrors.cardHolder = 'Cardholder name is required';\r\n        }\r\n        if (!formData.expiryDate || !/^\\d{2}\\/\\d{2}$/.test(formData.expiryDate)) {\r\n            newErrors.expiryDate = 'Expiry date must be MM/YY format';\r\n        }\r\n        setErrors(newErrors);\r\n        return Object.keys(newErrors).length === 0;\r\n    };\r\n\r\n    const formatCardNumber = (value) => {\r\n        const v = value.replace(/\\s+/g, '').replace(/[^0-9]/gi, '');\r\n        const matches = v.match(/\\d{4,16}/g);\r\n        const match = matches && matches[0] || '';\r\n        const parts = [];\r\n        for (let i = 0, len = match.length; i < len; i += 4) {\r\n            parts.push(match.substring(i, i + 4));\r\n        }\r\n        return parts.length ? parts.join(' ') : v;\r\n    };\r\n\r\n    const formatExpiry = (value) => {\r\n        const v = value.replace(/\\s+/g, '').replace(/[^0-9]/gi, '');\r\n        if (v.length >= 2) {\r\n            return v.substring(0, 2) + '/' + v.substring(2, 4);\r\n        }\r\n        return v;\r\n    };\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        if (validateCard()) {\r\n            onSave(formData);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>{paymentMethod ? 'Edit Payment Method' : 'Add Payment Method'}</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group\">\r\n                        <label>Card Type</label>\r\n                        <select\r\n                            value={formData.type}\r\n                            onChange={e => setFormData({ ...formData, type: e.target.value })}\r\n                        >\r\n                            <option value=\"credit\">Credit Card</option>\r\n                            <option value=\"debit\">Debit Card</option>\r\n                        </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Card Number</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.cardNumber}\r\n                            onChange={e => setFormData({ ...formData, cardNumber: formatCardNumber(e.target.value) })}\r\n                            placeholder=\"1234 5678 9012 3456\"\r\n                            maxLength={19}\r\n                            required\r\n                        />\r\n                        {errors.cardNumber && <span className=\"field-error\">{errors.cardNumber}</span>}\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Cardholder Name</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.cardHolder}\r\n                            onChange={e => setFormData({ ...formData, cardHolder: e.target.value.toUpperCase() })}\r\n                            placeholder=\"JOHN DOE\"\r\n                            required\r\n                        />\r\n                        {errors.cardHolder && <span className=\"field-error\">{errors.cardHolder}</span>}\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>Expiry Date</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={formData.expiryDate}\r\n                                onChange={e => setFormData({ ...formData, expiryDate: formatExpiry(e.target.value) })}\r\n                                placeholder=\"MM/YY\"\r\n                                maxLength={5}\r\n                                required\r\n                            />\r\n                            {errors.expiryDate && <span className=\"field-error\">{errors.expiryDate}</span>}\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>CVV</label>\r\n                            <input\r\n                                type=\"password\"\r\n                                placeholder=\"ΓÇóΓÇóΓÇó\"\r\n                                maxLength={4}\r\n                                required\r\n                            />\r\n                            <small className=\"form-hint\">For verification only, not stored</small>\r\n                        </div>\r\n                    </div>\r\n                    <label className=\"checkbox-label\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            checked={formData.isDefault}\r\n                            onChange={e => setFormData({ ...formData, isDefault: e.target.checked })}\r\n                        />\r\n                        Set as default payment method\r\n                    </label>\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\">\r\n                            <CreditCard size={16} /> {paymentMethod ? 'Update' : 'Add'} Card\r\n                        </Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ========== REVIEW MODAL ==========\r\nconst ReviewModal = ({ booking, onSubmit, onClose }) => {\r\n    const [rating, setRating] = useState(5);\r\n    const [title, setTitle] = useState('');\r\n    const [comment, setComment] = useState('');\r\n    const [recommend, setRecommend] = useState(true);\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSubmit({\r\n            bookingId: booking.id,\r\n            serviceType: booking.service,\r\n            rating,\r\n            title,\r\n            comment,\r\n            recommend\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Review Your Service</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"review-service-info\">\r\n                        <strong>{booking.service}</strong>\r\n                        <span className=\"text-muted\">{getDeviceName(booking.device)} ΓÇó {booking.date}</span>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Your Rating</label>\r\n                        <div className=\"star-rating-input\">\r\n                            {[1, 2, 3, 4, 5].map(star => (\r\n                                <button\r\n                                    key={star}\r\n                                    type=\"button\"\r\n                                    className={`star-btn ${rating >= star ? 'active' : ''}`}\r\n                                    onClick={() => setRating(star)}\r\n                                >\r\n                                    <Star size={32} fill={rating >= star ? 'currentColor' : 'none'} />\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                        <span className=\"rating-text\">\r\n                            {rating === 5 ? 'Excellent!' : rating === 4 ? 'Very Good' : rating === 3 ? 'Good' : rating === 2 ? 'Fair' : 'Poor'}\r\n                        </span>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Review Title</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={title}\r\n                            onChange={e => setTitle(e.target.value)}\r\n                            placeholder=\"Summarize your experience\"\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Your Review</label>\r\n                        <textarea\r\n                            value={comment}\r\n                            onChange={e => setComment(e.target.value)}\r\n                            placeholder=\"Tell us about your experience...\"\r\n                            rows={4}\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <label className=\"checkbox-label\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            checked={recommend}\r\n                            onChange={e => setRecommend(e.target.checked)}\r\n                        />\r\n                        I would recommend this service to others\r\n                    </label>\r\n\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\">\r\n                            <Star size={16} /> Submit Review\r\n                        </Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ========== WARRANTY CLAIM MODAL ==========\r\nconst WarrantyClaimModal = ({ warranty, onSubmit, onClose }) => {\r\n    const [issueDescription, setIssueDescription] = useState('');\r\n    const [issueType, setIssueType] = useState('same_issue');\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSubmit({\r\n            warrantyId: warranty.id,\r\n            issueType,\r\n            issueDescription\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>File Warranty Claim</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"warranty-claim-info\">\r\n                        <div className=\"info-row\">\r\n                            <span>Device:</span>\r\n                            <strong>{warranty.device}</strong>\r\n                        </div>\r\n                        <div className=\"info-row\">\r\n                            <span>Original Service:</span>\r\n                            <strong>{warranty.service}</strong>\r\n                        </div>\r\n                        <div className=\"info-row\">\r\n                            <span>Warranty Expires:</span>\r\n                            <strong>{warranty.expiresAt}</strong>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Issue Type</label>\r\n                        <select\r\n                            value={issueType}\r\n                            onChange={e => setIssueType(e.target.value)}\r\n                        >\r\n                            <option value=\"same_issue\">Same issue as original repair</option>\r\n                            <option value=\"related_issue\">Related issue from repair</option>\r\n                            <option value=\"part_failure\">Replaced part failure</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Describe the Issue</label>\r\n                        <textarea\r\n                            value={issueDescription}\r\n                            onChange={e => setIssueDescription(e.target.value)}\r\n                            placeholder=\"Please describe what's happening with your device...\"\r\n                            rows={4}\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"warranty-notice\">\r\n                        <AlertCircle size={16} />\r\n                        <span>Our team will review your claim within 24-48 hours. If approved, you'll be contacted to schedule a free repair.</span>\r\n                    </div>\r\n\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\">\r\n                            <Shield size={16} /> Submit Claim\r\n                        </Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ========== REFERRAL INVITE MODAL ==========\r\nconst ReferralInviteModal = ({ referralCode, onSend, onClose }) => {\r\n    const [email, setEmail] = useState('');\r\n    const [name, setName] = useState('');\r\n    const [message, setMessage] = useState(`Hey! I've been using FixIt Pro for my device repairs and they're amazing. Use my referral code ${referralCode} to get $10 off your first repair!`);\r\n    const [sending, setSending] = useState(false);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setSending(true);\r\n        await onSend({ email, name, message });\r\n        setSending(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Invite a Friend</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"referral-preview\">\r\n                        <Gift size={32} />\r\n                        <div>\r\n                            <strong>Both of you get rewarded!</strong>\r\n                            <p>Your friend gets $10 off, you get $15 credit</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Friend's Name</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={name}\r\n                            onChange={e => setName(e.target.value)}\r\n                            placeholder=\"John\"\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Friend's Email</label>\r\n                        <input\r\n                            type=\"email\"\r\n                            value={email}\r\n                            onChange={e => setEmail(e.target.value)}\r\n                            placeholder=\"friend@email.com\"\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Personal Message (Optional)</label>\r\n                        <textarea\r\n                            value={message}\r\n                            onChange={e => setMessage(e.target.value)}\r\n                            rows={3}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\" disabled={sending}>\r\n                            {sending ? (\r\n                                <><Loader2 size={16} className=\"spin\" /> Sending...</>\r\n                            ) : (\r\n                                <><Send size={16} /> Send Invitation</>\r\n                            )}\r\n                        </Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CustomerProfile;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\FAQPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\Home.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\Login.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":157,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":157,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":205,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":205,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":255,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":255,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":295,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":295,"endColumn":21}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport { useAuth } from '../../../context/AuthContext';\r\nimport { mockApi } from '../../../services/mockApi';\r\nimport Button from '../../../components/Button';\r\nimport ThemeToggle from '../../../components/ThemeToggle';\r\nimport { validateUsername, validateName, validateEmail, validatePhone } from '../../../utils/validation';\r\nimport { User, UserPlus, ArrowLeft, Mail, Phone, Lock, KeyRound, CheckCircle, ShieldCheck } from 'lucide-react';\r\nimport './Login.css';\r\n\r\nconst Login = () => {\r\n    // Mode: 'login', 'signup', 'verify-signup', 'forgot', 'reset'\r\n    const [mode, setMode] = useState('login');\r\n    const [recoveryMethod, setRecoveryMethod] = useState('email'); // 'email' or 'phone'\r\n    const [verifyMethod, setVerifyMethod] = useState('email'); // for signup verification\r\n    const [username, setUsername] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [confirmPassword, setConfirmPassword] = useState('');\r\n    const [newPassword, setNewPassword] = useState('');\r\n    const [confirmNewPassword, setConfirmNewPassword] = useState('');\r\n    const [name, setName] = useState('');\r\n    const [email, setEmail] = useState('');\r\n    const [phone, setPhone] = useState('');\r\n    const [recoveryInput, setRecoveryInput] = useState('');\r\n    const [verificationCode, setVerificationCode] = useState('');\r\n    const [generatedCode, setGeneratedCode] = useState('');\r\n    const [recoveredUser, setRecoveredUser] = useState(null);\r\n    const [pendingUser, setPendingUser] = useState(null); // Stores user data during verification\r\n    const [error, setError] = useState('');\r\n    const [success, setSuccess] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const { login } = useAuth();\r\n    const navigate = useNavigate();\r\n\r\n    const handleUsernameChange = (e) => {\r\n        const sanitized = validateUsername(e.target.value);\r\n        setUsername(sanitized);\r\n    };\r\n\r\n    const handleNameChange = (e) => {\r\n        const sanitized = validateName(e.target.value);\r\n        setName(sanitized);\r\n    };\r\n\r\n    const handlePhoneChange = (e) => {\r\n        const sanitized = validatePhone(e.target.value);\r\n        setPhone(sanitized);\r\n    };\r\n\r\n    const handleRecoveryInputChange = (e) => {\r\n        if (recoveryMethod === 'email') {\r\n            setRecoveryInput(validateEmail(e.target.value));\r\n        } else {\r\n            setRecoveryInput(validatePhone(e.target.value));\r\n        }\r\n    };\r\n\r\n    const handleLogin = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setLoading(true);\r\n\r\n        const result = await login(username, password);\r\n        if (result.success) {\r\n            // Check if user is verified\r\n            if (result.user?.verified === false) {\r\n                setError('Please verify your account first. Check your email or phone.');\r\n                setLoading(false);\r\n                return;\r\n            }\r\n            // Redirect based on role\r\n            switch (result.user?.role) {\r\n                case 'admin':\r\n                    navigate('/admin');\r\n                    break;\r\n                case 'employee':\r\n                    navigate('/employee');\r\n                    break;\r\n                case 'support':\r\n                    navigate('/support');\r\n                    break;\r\n                case 'inventory':\r\n                    navigate('/inventory');\r\n                    break;\r\n                case 'sales':\r\n                    navigate('/pos');\r\n                    break;\r\n                default:\r\n                    navigate('/customer/profile');\r\n            }\r\n        } else {\r\n            setError(result.error);\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n\r\n    const handleSignup = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setSuccess('');\r\n\r\n        // Validation\r\n        if (password.length < 6) {\r\n            setError('Password must be at least 6 characters');\r\n            return;\r\n        }\r\n        if (password !== confirmPassword) {\r\n            setError('Passwords do not match');\r\n            return;\r\n        }\r\n        if (!email.includes('@')) {\r\n            setError('Please enter a valid email address');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n\r\n        try {\r\n            // Check if username already exists\r\n            const users = await mockApi.getUsers();\r\n            if (users.find(u => u.username.toLowerCase() === username.toLowerCase())) {\r\n                setError('Username already exists');\r\n                setLoading(false);\r\n                return;\r\n            }\r\n            if (users.find(u => u.email?.toLowerCase() === email.toLowerCase())) {\r\n                setError('Email already registered');\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            // Generate verification code\r\n            const code = Math.floor(100000 + Math.random() * 900000).toString();\r\n            setGeneratedCode(code);\r\n\r\n            // Store pending user data (not yet saved to database)\r\n            setPendingUser({\r\n                name,\r\n                username,\r\n                email,\r\n                phone,\r\n                password,\r\n                role: 'customer'\r\n            });\r\n\r\n            // Determine verification method based on what was provided\r\n            if (phone && phone.length >= 10) {\r\n                setVerifyMethod('phone');\r\n                setSuccess(`Verification code sent to phone: ${phone.slice(-4).padStart(phone.length, '*')} (Demo code: ${code})`);\r\n            } else {\r\n                setVerifyMethod('email');\r\n                setSuccess(`Verification code sent to: ${email} (Demo code: ${code})`);\r\n            }\r\n\r\n            setMode('verify-signup');\r\n        } catch (err) {\r\n            setError('Failed to initiate signup. Please try again.');\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const handleVerifySignup = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n\r\n        if (verificationCode !== generatedCode) {\r\n            setError('Invalid verification code. Please try again.');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n\r\n        try {\r\n            // Now create the verified user\r\n            await mockApi.addUser({\r\n                ...pendingUser,\r\n                verified: true,\r\n                verifiedAt: new Date().toISOString()\r\n            });\r\n\r\n            // Also add to customers list\r\n            await mockApi.addCustomer({\r\n                name: pendingUser.name,\r\n                email: pendingUser.email,\r\n                phone: pendingUser.phone,\r\n                totalBookings: 0,\r\n                lastVisit: new Date().toISOString().split('T')[0],\r\n                notes: 'Verified customer',\r\n                tags: ['verified']\r\n            });\r\n\r\n            setSuccess('Account verified and created successfully! You can now log in.');\r\n            setMode('login');\r\n            setUsername(pendingUser.username);\r\n\r\n            // Clear all signup fields\r\n            setPassword('');\r\n            setConfirmPassword('');\r\n            setName('');\r\n            setEmail('');\r\n            setPhone('');\r\n            setVerificationCode('');\r\n            setPendingUser(null);\r\n        } catch (err) {\r\n            setError('Failed to create account. Please try again.');\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const resendVerificationCode = () => {\r\n        const code = Math.floor(100000 + Math.random() * 900000).toString();\r\n        setGeneratedCode(code);\r\n        setVerificationCode('');\r\n        setError('');\r\n\r\n        if (verifyMethod === 'phone') {\r\n            setSuccess(`New code sent to phone! (Demo code: ${code})`);\r\n        } else {\r\n            setSuccess(`New code sent to email! (Demo code: ${code})`);\r\n        }\r\n    };\r\n\r\n    const handleForgotPassword = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setLoading(true);\r\n\r\n        try {\r\n            const users = await mockApi.getUsers();\r\n            let foundUser = null;\r\n\r\n            if (recoveryMethod === 'email') {\r\n                foundUser = users.find(u => u.email?.toLowerCase() === recoveryInput.toLowerCase());\r\n            } else {\r\n                // Clean phone numbers for comparison\r\n                const cleanInput = recoveryInput.replace(/\\D/g, '');\r\n                foundUser = users.find(u => u.phone?.replace(/\\D/g, '') === cleanInput);\r\n            }\r\n\r\n            if (!foundUser) {\r\n                setError(`No account found with this ${recoveryMethod}`);\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            // Generate a simulated verification code\r\n            const code = Math.floor(100000 + Math.random() * 900000).toString();\r\n            setGeneratedCode(code);\r\n            setRecoveredUser(foundUser);\r\n\r\n            // In a real app, this would send an email/SMS\r\n            setSuccess(`Verification code sent to your ${recoveryMethod}! (Demo code: ${code})`);\r\n            setMode('reset');\r\n        } catch (err) {\r\n            setError('Failed to process recovery. Please try again.');\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const handleResetPassword = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n\r\n        if (verificationCode !== generatedCode) {\r\n            setError('Invalid verification code');\r\n            return;\r\n        }\r\n\r\n        if (newPassword.length < 6) {\r\n            setError('Password must be at least 6 characters');\r\n            return;\r\n        }\r\n\r\n        if (newPassword !== confirmNewPassword) {\r\n            setError('Passwords do not match');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n\r\n        try {\r\n            // Update user password\r\n            await mockApi.updateUser(recoveredUser.id, { password: newPassword });\r\n\r\n            setSuccess('Password reset successfully! You can now log in with your new password.');\r\n            setMode('login');\r\n            setUsername(recoveredUser.username);\r\n            setPassword('');\r\n            setNewPassword('');\r\n            setConfirmNewPassword('');\r\n            setVerificationCode('');\r\n            setRecoveryInput('');\r\n            setRecoveredUser(null);\r\n        } catch (err) {\r\n            setError('Failed to reset password. Please try again.');\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const switchMode = (newMode) => {\r\n        setMode(newMode);\r\n        setError('');\r\n        setSuccess('');\r\n        setRecoveryInput('');\r\n        setVerificationCode('');\r\n        setNewPassword('');\r\n        setConfirmNewPassword('');\r\n    };\r\n\r\n    return (\r\n        <div className=\"login-page\">\r\n            <div className=\"theme-toggle-corner\">\r\n                <ThemeToggle />\r\n            </div>\r\n            <Link to=\"/\" className=\"home-link\">\r\n                <ArrowLeft size={18} /> Back to Home\r\n            </Link>\r\n            <div className=\"login-container\">\r\n                {/* Tab Switcher - only show for login/signup */}\r\n                {(mode === 'login' || mode === 'signup') && (\r\n                    <div className=\"auth-tabs\">\r\n                        <button\r\n                            className={`auth-tab ${mode === 'login' ? 'active' : ''}`}\r\n                            onClick={() => switchMode('login')}\r\n                        >\r\n                            <User size={18} /> Sign In\r\n                        </button>\r\n                        <button\r\n                            className={`auth-tab ${mode === 'signup' ? 'active' : ''}`}\r\n                            onClick={() => switchMode('signup')}\r\n                        >\r\n                            <UserPlus size={18} /> Sign Up\r\n                        </button>\r\n                    </div>\r\n                )}\r\n\r\n                {mode === 'login' && (\r\n                    <>\r\n                        <h1>Welcome Back</h1>\r\n                        <p>Sign in to access your account or dashboard.</p>\r\n\r\n                        {error && <div className=\"error-message\">{error}</div>}\r\n                        {success && <div className=\"success-message\">{success}</div>}\r\n\r\n                        <form className=\"login-form\" onSubmit={handleLogin}>\r\n                            <div className=\"form-group\">\r\n                                <label><User size={16} /> Username</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={username}\r\n                                    onChange={handleUsernameChange}\r\n                                    placeholder=\"Enter your username\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label><Lock size={16} /> Password</label>\r\n                                <input\r\n                                    type=\"password\"\r\n                                    value={password}\r\n                                    onChange={(e) => setPassword(e.target.value)}\r\n                                    placeholder=\"Enter your password\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <Button variant=\"primary\" type=\"submit\" disabled={loading}>\r\n                                {loading ? 'Signing in...' : 'Sign In'}\r\n                            </Button>\r\n                        </form>\r\n\r\n                        <button\r\n                            className=\"forgot-password-link\"\r\n                            onClick={() => switchMode('forgot')}\r\n                        >\r\n                            <KeyRound size={14} /> Forgot Password?\r\n                        </button>\r\n\r\n                        <div className=\"demo-credentials\">\r\n                            <p><strong>Demo Accounts:</strong></p>\r\n                            <p>Admin: admin / password</p>\r\n                            <p>Technician: employee / password</p>\r\n                            <p>Support: support / password</p>\r\n                            <p>Inventory: dataentry / password</p>\r\n                            <p>POS: cashier / password</p>\r\n                        </div>\r\n\r\n                    </>\r\n                )}\r\n\r\n                {mode === 'signup' && (\r\n                    <>\r\n                        <h1>Create Account</h1>\r\n                        <p>Sign up to track your repairs and manage bookings.</p>\r\n\r\n                        {error && <div className=\"error-message\">{error}</div>}\r\n\r\n                        <form className=\"login-form signup-form\" onSubmit={handleSignup}>\r\n                            <div className=\"form-row\">\r\n                                <div className=\"form-group\">\r\n                                    <label><User size={16} /> Full Name</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={name}\r\n                                        onChange={handleNameChange}\r\n                                        placeholder=\"John Doe\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label><User size={16} /> Username</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={username}\r\n                                        onChange={handleUsernameChange}\r\n                                        placeholder=\"johndoe\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"form-row\">\r\n                                <div className=\"form-group\">\r\n                                    <label><Mail size={16} /> Email <span className=\"required\">*</span></label>\r\n                                    <input\r\n                                        type=\"email\"\r\n                                        value={email}\r\n                                        onChange={(e) => setEmail(validateEmail(e.target.value))}\r\n                                        placeholder=\"john@example.com\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label><Phone size={16} /> Phone <span className=\"optional\">(optional)</span></label>\r\n                                    <input\r\n                                        type=\"tel\"\r\n                                        value={phone}\r\n                                        onChange={handlePhoneChange}\r\n                                        placeholder=\"5551234567\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"form-row\">\r\n                                <div className=\"form-group\">\r\n                                    <label><Lock size={16} /> Password</label>\r\n                                    <input\r\n                                        type=\"password\"\r\n                                        value={password}\r\n                                        onChange={(e) => setPassword(e.target.value)}\r\n                                        placeholder=\"Min 6 characters\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label><Lock size={16} /> Confirm Password</label>\r\n                                    <input\r\n                                        type=\"password\"\r\n                                        value={confirmPassword}\r\n                                        onChange={(e) => setConfirmPassword(e.target.value)}\r\n                                        placeholder=\"Re-enter password\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"verification-notice\">\r\n                                <ShieldCheck size={16} />\r\n                                <span>We'll send a verification code to confirm your identity</span>\r\n                            </div>\r\n\r\n                            <Button variant=\"primary\" type=\"submit\" disabled={loading}>\r\n                                {loading ? 'Processing...' : 'Continue to Verification'}\r\n                            </Button>\r\n                        </form>\r\n\r\n                        <p className=\"terms-notice\">\r\n                            By signing up, you agree to our{' '}\r\n                            <Link to=\"/terms\">Terms of Use</Link> and{' '}\r\n                            <Link to=\"/privacy\">Privacy Policy</Link>.\r\n                        </p>\r\n                    </>\r\n                )}\r\n\r\n                {mode === 'verify-signup' && (\r\n                    <>\r\n                        <div className=\"forgot-header\">\r\n                            <ShieldCheck size={40} className=\"forgot-icon\" />\r\n                            <h1>Verify Your Account</h1>\r\n                            <p>\r\n                                Enter the 6-digit code sent to your {verifyMethod === 'email' ? 'email' : 'phone'}.\r\n                            </p>\r\n                        </div>\r\n\r\n                        {error && <div className=\"error-message\">{error}</div>}\r\n                        {success && <div className=\"success-message\">{success}</div>}\r\n\r\n                        <form className=\"login-form\" onSubmit={handleVerifySignup}>\r\n                            <div className=\"form-group\">\r\n                                <label><KeyRound size={16} /> Verification Code</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={verificationCode}\r\n                                    onChange={(e) => setVerificationCode(e.target.value.replace(/\\D/g, '').slice(0, 6))}\r\n                                    placeholder=\"Enter 6-digit code\"\r\n                                    maxLength={6}\r\n                                    className=\"verification-input\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <Button variant=\"primary\" type=\"submit\" disabled={loading || verificationCode.length !== 6}>\r\n                                {loading ? 'Verifying...' : 'Verify & Create Account'}\r\n                            </Button>\r\n                        </form>\r\n\r\n                        <div className=\"resend-section\">\r\n                            <p>Didn't receive the code?</p>\r\n                            <button\r\n                                className=\"resend-link\"\r\n                                onClick={resendVerificationCode}\r\n                            >\r\n                                <Mail size={14} /> Resend Code\r\n                            </button>\r\n                        </div>\r\n\r\n                        <button\r\n                            className=\"back-to-login-link\"\r\n                            onClick={() => switchMode('signup')}\r\n                        >\r\n                            <ArrowLeft size={14} /> Back to Sign Up\r\n                        </button>\r\n                    </>\r\n                )}\r\n\r\n                {mode === 'forgot' && (\r\n                    <>\r\n                        <div className=\"forgot-header\">\r\n                            <KeyRound size={40} className=\"forgot-icon\" />\r\n                            <h1>Forgot Password</h1>\r\n                            <p>Recover your account using email or phone number.</p>\r\n                        </div>\r\n\r\n                        {error && <div className=\"error-message\">{error}</div>}\r\n\r\n                        <div className=\"recovery-method-tabs\">\r\n                            <button\r\n                                className={`method-tab ${recoveryMethod === 'email' ? 'active' : ''}`}\r\n                                onClick={() => { setRecoveryMethod('email'); setRecoveryInput(''); }}\r\n                            >\r\n                                <Mail size={16} /> Email\r\n                            </button>\r\n                            <button\r\n                                className={`method-tab ${recoveryMethod === 'phone' ? 'active' : ''}`}\r\n                                onClick={() => { setRecoveryMethod('phone'); setRecoveryInput(''); }}\r\n                            >\r\n                                <Phone size={16} /> Phone\r\n                            </button>\r\n                        </div>\r\n\r\n                        <form className=\"login-form\" onSubmit={handleForgotPassword}>\r\n                            <div className=\"form-group\">\r\n                                <label>\r\n                                    {recoveryMethod === 'email' ? <Mail size={16} /> : <Phone size={16} />}\r\n                                    {recoveryMethod === 'email' ? ' Email Address' : ' Phone Number'}\r\n                                </label>\r\n                                <input\r\n                                    type={recoveryMethod === 'email' ? 'email' : 'tel'}\r\n                                    value={recoveryInput}\r\n                                    onChange={handleRecoveryInputChange}\r\n                                    placeholder={recoveryMethod === 'email' ? 'john@example.com' : '5551234567'}\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <Button variant=\"primary\" type=\"submit\" disabled={loading}>\r\n                                {loading ? 'Sending...' : 'Send Verification Code'}\r\n                            </Button>\r\n                        </form>\r\n\r\n                        <button\r\n                            className=\"back-to-login-link\"\r\n                            onClick={() => switchMode('login')}\r\n                        >\r\n                            <ArrowLeft size={14} /> Back to Sign In\r\n                        </button>\r\n                    </>\r\n                )}\r\n\r\n                {mode === 'reset' && (\r\n                    <>\r\n                        <div className=\"forgot-header\">\r\n                            <CheckCircle size={40} className=\"forgot-icon success\" />\r\n                            <h1>Reset Password</h1>\r\n                            <p>Enter the verification code and set your new password.</p>\r\n                        </div>\r\n\r\n                        {error && <div className=\"error-message\">{error}</div>}\r\n                        {success && <div className=\"success-message\">{success}</div>}\r\n\r\n                        <form className=\"login-form\" onSubmit={handleResetPassword}>\r\n                            <div className=\"form-group\">\r\n                                <label><KeyRound size={16} /> Verification Code</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={verificationCode}\r\n                                    onChange={(e) => setVerificationCode(e.target.value.replace(/\\D/g, '').slice(0, 6))}\r\n                                    placeholder=\"Enter 6-digit code\"\r\n                                    maxLength={6}\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label><Lock size={16} /> New Password</label>\r\n                                <input\r\n                                    type=\"password\"\r\n                                    value={newPassword}\r\n                                    onChange={(e) => setNewPassword(e.target.value)}\r\n                                    placeholder=\"Min 6 characters\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label><Lock size={16} /> Confirm New Password</label>\r\n                                <input\r\n                                    type=\"password\"\r\n                                    value={confirmNewPassword}\r\n                                    onChange={(e) => setConfirmNewPassword(e.target.value)}\r\n                                    placeholder=\"Re-enter new password\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <Button variant=\"primary\" type=\"submit\" disabled={loading}>\r\n                                {loading ? 'Resetting...' : 'Reset Password'}\r\n                            </Button>\r\n                        </form>\r\n\r\n                        <button\r\n                            className=\"back-to-login-link\"\r\n                            onClick={() => switchMode('forgot')}\r\n                        >\r\n                            <ArrowLeft size={14} /> Try Different Method\r\n                        </button>\r\n                    </>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Login;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\PrivacyPolicy.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'iconMap' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":26,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"iconMap"},"fix":{"range":[882,1052],"text":""},"desc":"Remove unused variable 'iconMap'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { Shield, Lock, Eye, Database, UserCheck, Mail, ArrowLeft } from 'lucide-react';\r\nimport { getLegalPage } from '../../../services/landingService';\r\nimport './LegalPages.css';\r\n\r\nconst PrivacyPolicy = () => {\r\n    const [content, setContent] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const loadContent = async () => {\r\n            try {\r\n                const data = await getLegalPage('privacy');\r\n                setContent(data);\r\n            } catch (error) {\r\n                console.error('Failed to load privacy policy content:', error);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n        loadContent();\r\n    }, []);\r\n\r\n    // Icon mapping for dynamic rendering\r\n    const iconMap = {\r\n        Lock: Lock,\r\n        Database: Database,\r\n        Eye: Eye,\r\n        UserCheck: UserCheck,\r\n        Shield: Shield,\r\n        Mail: Mail\r\n    };\r\n\r\n    // Default content fallback\r\n    const defaultContent = {\r\n        title: 'Privacy Policy',\r\n        lastUpdated: 'December 2025',\r\n        intro: 'At SIFIXA, we understand that your privacy is important to you. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you visit our website or use our repair services.',\r\n        sections: [\r\n            { heading: 'Information We Collect', content: 'We may collect personal information that you voluntarily provide to us when you register for an account, book a repair service, contact us for support, subscribe to our newsletter, or sell a device to us.' },\r\n            { heading: 'How We Use Your Information', content: 'We use the information we collect to provide, maintain, and improve our repair services; process your repair bookings and transactions; send you service updates and notifications.' },\r\n            { heading: 'Information Sharing', content: 'We do not sell, trade, or rent your personal information to third parties.' },\r\n            { heading: 'Data Security', content: 'We implement appropriate technical and organizational measures to protect your personal information against unauthorized access.' },\r\n            { heading: 'Your Rights', content: 'You have the right to access your personal data, request correction, request deletion, and opt-out of marketing communications.' }\r\n        ],\r\n        contactEmail: 'info@sifixa.com'\r\n    };\r\n\r\n    const displayContent = content || defaultContent;\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"legal-page\">\r\n                <div className=\"legal-container\">\r\n                    <div className=\"loading-state\">Loading...</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"legal-page\">\r\n            <div className=\"legal-container\">\r\n                <Link to=\"/\" className=\"back-link\">\r\n                    <ArrowLeft size={18} /> Back to Home\r\n                </Link>\r\n\r\n                <div className=\"legal-header\">\r\n                    <Shield size={48} className=\"legal-icon\" />\r\n                    <h1>{displayContent.title}</h1>\r\n                    <p className=\"last-updated\">Last updated: {displayContent.lastUpdated}</p>\r\n                </div>\r\n\r\n                <div className=\"legal-content\">\r\n                    <section>\r\n                        <h2><Lock size={20} /> Introduction</h2>\r\n                        <p>{displayContent.intro}</p>\r\n                    </section>\r\n\r\n                    {displayContent.sections?.map((section, index) => (\r\n                        <section key={index}>\r\n                            <h2>{section.heading}</h2>\r\n                            <p>{section.content}</p>\r\n                        </section>\r\n                    ))}\r\n\r\n                    <section>\r\n                        <h2><Mail size={20} /> Contact Us</h2>\r\n                        <p>\r\n                            If you have questions or concerns about this Privacy Policy or our data practices,\r\n                            please contact us:\r\n                        </p>\r\n                        <div className=\"contact-info\">\r\n                            <p>Email: <a href={`mailto:${displayContent.contactEmail}`}>{displayContent.contactEmail}</a></p>\r\n                        </div>\r\n                    </section>\r\n\r\n                    <section>\r\n                        <h2>Changes to This Policy</h2>\r\n                        <p>\r\n                            We may update this Privacy Policy from time to time. We will notify you of any changes\r\n                            by posting the new Privacy Policy on this page and updating the \"Last updated\" date.\r\n                        </p>\r\n                    </section>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PrivacyPolicy;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\RefundPolicy.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\SellDevice.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[206,245],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Smartphone, Laptop, Tablet, Watch, DollarSign, CheckCircle2, Send, ArrowRight, ArrowLeft, Package, Clock, Shield, Award } from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\nimport Button from '../../../components/Button';\r\nimport { api } from '../../../services/apiClient';\r\nimport './SellDevice.css';\r\n\r\nconst deviceTypes = [\r\n    { id: 'phone', name: 'Smartphone', icon: Smartphone },\r\n    { id: 'laptop', name: 'Laptop', icon: Laptop },\r\n    { id: 'tablet', name: 'Tablet', icon: Tablet },\r\n    { id: 'watch', name: 'Smartwatch', icon: Watch },\r\n];\r\n\r\nconst conditions = [\r\n    { id: 'excellent', label: 'Excellent', description: 'Like new, no scratches or damage', multiplier: 1.0, color: 'green' },\r\n    { id: 'good', label: 'Good', description: 'Minor scratches, fully functional', multiplier: 0.8, color: 'blue' },\r\n    { id: 'fair', label: 'Fair', description: 'Visible wear, works properly', multiplier: 0.6, color: 'orange' },\r\n    { id: 'poor', label: 'Poor', description: 'Significant damage, may have issues', multiplier: 0.4, color: 'red' },\r\n];\r\n\r\nconst SellDevice = () => {\r\n    const [step, setStep] = useState(1);\r\n    const [formData, setFormData] = useState({\r\n        deviceType: '',\r\n        brand: '',\r\n        model: '',\r\n        condition: '',\r\n        storage: '',\r\n        name: '',\r\n        email: '',\r\n        phone: '',\r\n        notes: ''\r\n    });\r\n    const [submitted, setSubmitted] = useState(false);\r\n    const [estimatedPrice, setEstimatedPrice] = useState(null);\r\n\r\n    useEffect(() => {\r\n        window.scrollTo(0, 0);\r\n    }, []);\r\n\r\n    const handleDeviceSelect = (deviceId) => {\r\n        setFormData({ ...formData, deviceType: deviceId });\r\n    };\r\n\r\n    const handleConditionSelect = (conditionId) => {\r\n        setFormData({ ...formData, condition: conditionId });\r\n        // Calculate estimated price based on condition\r\n        const basePrice = formData.deviceType === 'laptop' ? 300 :\r\n            formData.deviceType === 'phone' ? 200 :\r\n                formData.deviceType === 'tablet' ? 150 : 100;\r\n        const condition = conditions.find(c => c.id === conditionId);\r\n        setEstimatedPrice(Math.round(basePrice * condition.multiplier));\r\n    };\r\n\r\n    const handleInputChange = (e) => {\r\n        setFormData({ ...formData, [e.target.name]: e.target.value });\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            await api.sellDevice.submit({\r\n                deviceType: formData.deviceType,\r\n                brand: formData.brand,\r\n                model: formData.model,\r\n                condition: formData.condition,\r\n                storage: formData.storage,\r\n                name: formData.name,\r\n                email: formData.email,\r\n                phone: formData.phone,\r\n                notes: formData.notes,\r\n                estimatedPrice: estimatedPrice\r\n            });\r\n            setSubmitted(true);\r\n        } catch (error) {\r\n            console.error('Failed to submit device:', error);\r\n            alert('Failed to submit your device. Please try again.');\r\n        }\r\n    };\r\n\r\n    const canProceedStep1 = formData.deviceType && formData.brand && formData.model;\r\n    const canProceedStep2 = formData.condition;\r\n    const canProceedStep3 = formData.name && formData.email && formData.phone;\r\n\r\n    const features = [\r\n        { icon: DollarSign, title: 'Best Prices', description: 'Competitive offers', color: 'green' },\r\n        { icon: Clock, title: 'Quick Process', description: 'Same-day quotes', color: 'blue' },\r\n        { icon: Shield, title: 'Safe & Secure', description: 'Data wiped safely', color: 'purple' },\r\n        { icon: Award, title: 'Instant Payment', description: 'Get paid right away', color: 'orange' },\r\n    ];\r\n\r\n    if (submitted) {\r\n        return (\r\n            <div className=\"sell-page\">\r\n                <section className=\"sell-hero\">\r\n                    <div className=\"container\">\r\n                        <motion.div\r\n                            className=\"sell-success\"\r\n                            initial={{ opacity: 0, scale: 0.9 }}\r\n                            animate={{ opacity: 1, scale: 1 }}\r\n                            transition={{ duration: 0.5 }}\r\n                        >\r\n                            <div className=\"success-icon-wrapper\">\r\n                                <CheckCircle2 size={60} />\r\n                            </div>\r\n                            <h2>Quote Request Submitted!</h2>\r\n                            <p>Thank you for your interest in selling your device. Our team will review your submission and contact you within 24 hours with a final offer.</p>\r\n\r\n                            <div className=\"estimate-box\">\r\n                                <span>Estimated Value</span>\r\n                                <strong>${estimatedPrice} - ${estimatedPrice + 50}</strong>\r\n                            </div>\r\n\r\n                            <div className=\"next-steps-card\">\r\n                                <h3>What happens next?</h3>\r\n                                <ul>\r\n                                    <li><CheckCircle2 size={18} /> We'll review your device details</li>\r\n                                    <li><CheckCircle2 size={18} /> You'll receive a final offer via email</li>\r\n                                    <li><CheckCircle2 size={18} /> Bring your device to our store for inspection</li>\r\n                                    <li><CheckCircle2 size={18} /> Get paid instantly upon verification</li>\r\n                                </ul>\r\n                            </div>\r\n\r\n                            <div className=\"success-actions\">\r\n                                <Button variant=\"primary\" onClick={() => window.location.href = '/'}>\r\n                                    Back to Home\r\n                                </Button>\r\n                            </div>\r\n                        </motion.div>\r\n                    </div>\r\n                </section>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"sell-page\">\r\n            {/* Hero Section */}\r\n            <section className=\"sell-hero\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"sell-hero-content\"\r\n                        initial={{ opacity: 0, y: 30 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.6 }}\r\n                    >\r\n                        <span className=\"hero-badge\">Sell Your Device</span>\r\n                        <h1>Get Cash for Your Old Devices</h1>\r\n                        <p>Sell your old phones, laptops, tablets, and more. Quick quotes, fair prices, instant payment!</p>\r\n                    </motion.div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Features Section */}\r\n            <section className=\"sell-features-section\">\r\n                <div className=\"container\">\r\n                    <div className=\"features-grid\">\r\n                        {features.map((feature, index) => (\r\n                            <motion.div\r\n                                key={feature.title}\r\n                                className=\"feature-card\"\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ duration: 0.4, delay: index * 0.1 }}\r\n                            >\r\n                                <div className={`feature-icon ${feature.color}`}>\r\n                                    <feature.icon size={24} />\r\n                                </div>\r\n                                <h3>{feature.title}</h3>\r\n                                <p>{feature.description}</p>\r\n                            </motion.div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Form Section */}\r\n            <section className=\"sell-form-section\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"sell-form-card\"\r\n                        initial={{ opacity: 0, y: 20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.5, delay: 0.2 }}\r\n                    >\r\n                        {/* Step Indicator */}\r\n                        <div className=\"step-indicator\">\r\n                            <div className=\"step-progress-bar\">\r\n                                <div className=\"step-progress-fill\" style={{ width: `${((step - 1) / 2) * 100}%` }}></div>\r\n                            </div>\r\n                            <div className=\"step-items\">\r\n                                <div className={`step ${step >= 1 ? 'active' : ''} ${step > 1 ? 'completed' : ''}`}>\r\n                                    <span className=\"step-number\">1</span>\r\n                                    <span className=\"step-label\">Device Info</span>\r\n                                </div>\r\n                                <div className={`step ${step >= 2 ? 'active' : ''} ${step > 2 ? 'completed' : ''}`}>\r\n                                    <span className=\"step-number\">2</span>\r\n                                    <span className=\"step-label\">Condition</span>\r\n                                </div>\r\n                                <div className={`step ${step >= 3 ? 'active' : ''}`}>\r\n                                    <span className=\"step-number\">3</span>\r\n                                    <span className=\"step-label\">Contact</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <form onSubmit={handleSubmit}>\r\n                            {/* Step 1: Device Info */}\r\n                            {step === 1 && (\r\n                                <motion.div\r\n                                    className=\"form-step\"\r\n                                    initial={{ opacity: 0, x: 20 }}\r\n                                    animate={{ opacity: 1, x: 0 }}\r\n                                    transition={{ duration: 0.3 }}\r\n                                >\r\n                                    <div className=\"form-step-header\">\r\n                                        <Package size={24} />\r\n                                        <div>\r\n                                            <h2>Device Information</h2>\r\n                                            <p>Tell us about your device</p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"form-group\">\r\n                                        <label>Select Device Type</label>\r\n                                        <div className=\"device-type-grid\">\r\n                                            {deviceTypes.map(device => (\r\n                                                <div\r\n                                                    key={device.id}\r\n                                                    className={`device-type-card ${formData.deviceType === device.id ? 'selected' : ''}`}\r\n                                                    onClick={() => handleDeviceSelect(device.id)}\r\n                                                >\r\n                                                    <device.icon size={32} />\r\n                                                    <span>{device.name}</span>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"form-row\">\r\n                                        <div className=\"form-group\">\r\n                                            <label>Brand *</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                name=\"brand\"\r\n                                                value={formData.brand}\r\n                                                onChange={handleInputChange}\r\n                                                placeholder=\"e.g., Apple, Samsung, Dell\"\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"form-group\">\r\n                                            <label>Model *</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                name=\"model\"\r\n                                                value={formData.model}\r\n                                                onChange={handleInputChange}\r\n                                                placeholder=\"e.g., iPhone 14 Pro, Galaxy S23\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"form-group\">\r\n                                        <label>Storage Capacity (optional)</label>\r\n                                        <select name=\"storage\" value={formData.storage} onChange={handleInputChange}>\r\n                                            <option value=\"\">Select storage</option>\r\n                                            <option value=\"32gb\">32 GB</option>\r\n                                            <option value=\"64gb\">64 GB</option>\r\n                                            <option value=\"128gb\">128 GB</option>\r\n                                            <option value=\"256gb\">256 GB</option>\r\n                                            <option value=\"512gb\">512 GB</option>\r\n                                            <option value=\"1tb\">1 TB+</option>\r\n                                        </select>\r\n                                    </div>\r\n\r\n                                    <div className=\"step-actions\">\r\n                                        <div></div>\r\n                                        <Button\r\n                                            variant=\"primary\"\r\n                                            type=\"button\"\r\n                                            onClick={() => setStep(2)}\r\n                                            disabled={!canProceedStep1}\r\n                                        >\r\n                                            Next Step <ArrowRight size={18} />\r\n                                        </Button>\r\n                                    </div>\r\n                                </motion.div>\r\n                            )}\r\n\r\n                            {/* Step 2: Condition */}\r\n                            {step === 2 && (\r\n                                <motion.div\r\n                                    className=\"form-step\"\r\n                                    initial={{ opacity: 0, x: 20 }}\r\n                                    animate={{ opacity: 1, x: 0 }}\r\n                                    transition={{ duration: 0.3 }}\r\n                                >\r\n                                    <div className=\"form-step-header\">\r\n                                        <Shield size={24} />\r\n                                        <div>\r\n                                            <h2>Device Condition</h2>\r\n                                            <p>How would you describe your device's condition?</p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"condition-grid\">\r\n                                        {conditions.map(condition => (\r\n                                            <div\r\n                                                key={condition.id}\r\n                                                className={`condition-card ${formData.condition === condition.id ? 'selected' : ''} ${condition.color}`}\r\n                                                onClick={() => handleConditionSelect(condition.id)}\r\n                                            >\r\n                                                <h4>{condition.label}</h4>\r\n                                                <p>{condition.description}</p>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n\r\n                                    {estimatedPrice && (\r\n                                        <motion.div\r\n                                            className=\"price-estimate\"\r\n                                            initial={{ opacity: 0, y: 10 }}\r\n                                            animate={{ opacity: 1, y: 0 }}\r\n                                        >\r\n                                            <div className=\"price-icon\">\r\n                                                <DollarSign size={28} />\r\n                                            </div>\r\n                                            <div>\r\n                                                <span>Estimated Value</span>\r\n                                                <strong>${estimatedPrice} - ${estimatedPrice + 50}</strong>\r\n                                            </div>\r\n                                        </motion.div>\r\n                                    )}\r\n\r\n                                    <div className=\"step-actions\">\r\n                                        <Button variant=\"secondary\" type=\"button\" onClick={() => setStep(1)}>\r\n                                            <ArrowLeft size={18} /> Back\r\n                                        </Button>\r\n                                        <Button\r\n                                            variant=\"primary\"\r\n                                            type=\"button\"\r\n                                            onClick={() => setStep(3)}\r\n                                            disabled={!canProceedStep2}\r\n                                        >\r\n                                            Next Step <ArrowRight size={18} />\r\n                                        </Button>\r\n                                    </div>\r\n                                </motion.div>\r\n                            )}\r\n\r\n                            {/* Step 3: Contact Info */}\r\n                            {step === 3 && (\r\n                                <motion.div\r\n                                    className=\"form-step\"\r\n                                    initial={{ opacity: 0, x: 20 }}\r\n                                    animate={{ opacity: 1, x: 0 }}\r\n                                    transition={{ duration: 0.3 }}\r\n                                >\r\n                                    <div className=\"form-step-header\">\r\n                                        <Send size={24} />\r\n                                        <div>\r\n                                            <h2>Contact Information</h2>\r\n                                            <p>How can we reach you?</p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"form-group\">\r\n                                        <label>Full Name *</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            name=\"name\"\r\n                                            value={formData.name}\r\n                                            onChange={handleInputChange}\r\n                                            placeholder=\"Your name\"\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div className=\"form-row\">\r\n                                        <div className=\"form-group\">\r\n                                            <label>Email *</label>\r\n                                            <input\r\n                                                type=\"email\"\r\n                                                name=\"email\"\r\n                                                value={formData.email}\r\n                                                onChange={handleInputChange}\r\n                                                placeholder=\"your@email.com\"\r\n                                                required\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"form-group\">\r\n                                            <label>Phone *</label>\r\n                                            <input\r\n                                                type=\"tel\"\r\n                                                name=\"phone\"\r\n                                                value={formData.phone}\r\n                                                onChange={handleInputChange}\r\n                                                placeholder=\"(555) 123-4567\"\r\n                                                required\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"form-group\">\r\n                                        <label>Additional Notes (optional)</label>\r\n                                        <textarea\r\n                                            name=\"notes\"\r\n                                            value={formData.notes}\r\n                                            onChange={handleInputChange}\r\n                                            placeholder=\"Any additional details about your device...\"\r\n                                            rows={4}\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div className=\"step-actions\">\r\n                                        <Button variant=\"secondary\" type=\"button\" onClick={() => setStep(2)}>\r\n                                            <ArrowLeft size={18} /> Back\r\n                                        </Button>\r\n                                        <Button\r\n                                            variant=\"primary\"\r\n                                            type=\"submit\"\r\n                                            disabled={!canProceedStep3}\r\n                                        >\r\n                                            <Send size={18} /> Get My Quote\r\n                                        </Button>\r\n                                    </div>\r\n                                </motion.div>\r\n                            )}\r\n                        </form>\r\n                    </motion.div>\r\n                </div>\r\n            </section>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SellDevice;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\Services.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[209,248],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Smartphone, Battery, Droplets, Zap, Camera, Cpu, Monitor, HardDrive, Shield, Wrench, ArrowRight, Clock, Award, CheckCircle } from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\nimport { Link } from 'react-router-dom';\r\nimport ServiceCard from '../components/ServiceCard';\r\nimport { api } from '../../../services/apiClient';\r\nimport Button from '../../../components/Button';\r\nimport './Services.css';\r\n\r\n// Icon mapping for dynamic services\r\nconst iconMap = {\r\n    'screen': Smartphone,\r\n    'battery': Battery,\r\n    'water': Droplets,\r\n    'charging': Zap,\r\n    'camera': Camera,\r\n    'software': Cpu,\r\n    'laptop': Monitor,\r\n    'hard': HardDrive,\r\n    'virus': Shield,\r\n    'default': Cpu\r\n};\r\n\r\nconst getIconForService = (name) => {\r\n    const nameLower = name.toLowerCase();\r\n    for (const [key, icon] of Object.entries(iconMap)) {\r\n        if (nameLower.includes(key)) return icon;\r\n    }\r\n    return iconMap.default;\r\n};\r\n\r\nconst Services = () => {\r\n    const [services, setServices] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        window.scrollTo(0, 0);\r\n        loadServices();\r\n\r\n        // Auto-refresh every 15 seconds to catch admin changes\r\n        const interval = setInterval(loadServices, 15000);\r\n        return () => clearInterval(interval);\r\n    }, []);\r\n\r\n    const loadServices = async () => {\r\n        try {\r\n            const data = await api.services.list();\r\n            // Only show active services\r\n            const activeServices = data.filter(s => s.active);\r\n            setServices(activeServices);\r\n        } catch (error) {\r\n            console.error('Failed to load services', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const features = [\r\n        { icon: Clock, title: 'Fast Turnaround', description: 'Most repairs completed same-day', color: 'blue' },\r\n        { icon: Award, title: 'Expert Technicians', description: 'Certified professionals', color: 'purple' },\r\n        { icon: Shield, title: '90-Day Warranty', description: 'On all repairs', color: 'green' },\r\n        { icon: CheckCircle, title: 'Quality Parts', description: 'OEM or premium quality', color: 'orange' },\r\n    ];\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"services-page\">\r\n                <div className=\"container section-padding\">\r\n                    <div className=\"loading\">Loading services...</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"services-page\">\r\n            {/* Hero Section */}\r\n            <section className=\"services-hero\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"services-hero-content\"\r\n                        initial={{ opacity: 0, y: 30 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.6 }}\r\n                    >\r\n                        <span className=\"hero-badge\">Our Services</span>\r\n                        <h1>Expert Repair Solutions</h1>\r\n                        <p>Professional repairs for all your mobile and computer needs. Fast, reliable, and backed by our quality guarantee.</p>\r\n                    </motion.div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Features Section */}\r\n            <section className=\"services-features-section\">\r\n                <div className=\"container\">\r\n                    <div className=\"features-grid\">\r\n                        {features.map((feature, index) => (\r\n                            <motion.div\r\n                                key={feature.title}\r\n                                className=\"feature-card\"\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ duration: 0.4, delay: index * 0.1 }}\r\n                            >\r\n                                <div className={`feature-icon ${feature.color}`}>\r\n                                    <feature.icon size={24} />\r\n                                </div>\r\n                                <h3>{feature.title}</h3>\r\n                                <p>{feature.description}</p>\r\n                            </motion.div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Services Grid Section */}\r\n            <section className=\"services-list-section\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"section-intro\"\r\n                        initial={{ opacity: 0, y: 20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.5 }}\r\n                    >\r\n                        <div className=\"intro-icon\">\r\n                            <Wrench size={28} />\r\n                        </div>\r\n                        <div>\r\n                            <h2>Available Services</h2>\r\n                            <p>Choose from our comprehensive range of repair services</p>\r\n                        </div>\r\n                    </motion.div>\r\n\r\n                    <div className=\"services-grid\">\r\n                        {services.map((service, index) => (\r\n                            <motion.div\r\n                                key={service.id}\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ duration: 0.4, delay: index * 0.05 }}\r\n                            >\r\n                                <ServiceCard\r\n                                    icon={getIconForService(service.name)}\r\n                                    title={service.name}\r\n                                    description={service.description}\r\n                                    price={`$${service.priceMin} - $${service.priceMax}`}\r\n                                    delay={0}\r\n                                />\r\n                            </motion.div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {services.length === 0 && (\r\n                        <div className=\"no-services\">\r\n                            <p>No services available at the moment. Please check back later.</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </section>\r\n\r\n            {/* CTA Section */}\r\n            <section className=\"services-cta-section\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"cta-card\"\r\n                        initial={{ opacity: 0, scale: 0.95 }}\r\n                        animate={{ opacity: 1, scale: 1 }}\r\n                        transition={{ duration: 0.5 }}\r\n                    >\r\n                        <div className=\"cta-content\">\r\n                            <h2>Ready to Get Your Device Fixed?</h2>\r\n                            <p>Book an appointment now and get your device repaired by our expert technicians.</p>\r\n                        </div>\r\n                        <div className=\"cta-actions\">\r\n                            <Link to=\"/book\">\r\n                                <Button variant=\"primary\">\r\n                                    Book a Repair <ArrowRight size={18} />\r\n                                </Button>\r\n                            </Link>\r\n                            <Link to=\"/contact\">\r\n                                <Button variant=\"secondary\">\r\n                                    Contact Us\r\n                                </Button>\r\n                            </Link>\r\n                        </div>\r\n                    </motion.div>\r\n                </div>\r\n            </section>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Services;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\TermsOfUse.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\TrackBooking.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[42,81],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { api } from '../../../services/apiClient';\r\nimport { mockApi } from '../../../services/mockApi'; // Keep for legacy operations\r\nimport { Search, Package, Clock, CheckCircle, XCircle, AlertCircle, MapPin, User, Phone, Mail, ArrowRight, Smartphone, Calendar, FileText, History } from 'lucide-react';\r\nimport Button from '../../../components/Button';\r\nimport { getDeviceName, getCustomerName, getBookingDate } from '../../../utils/schemaHelpers';\r\nimport './TrackBooking.css';\r\n\r\nconst TrackBooking = () => {\r\n    const [searchType, setSearchType] = useState('tracking');\r\n    const [searchValue, setSearchValue] = useState('');\r\n    const [booking, setBooking] = useState(null);\r\n    const [trackingHistory, setTrackingHistory] = useState([]);\r\n    const [error, setError] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    // Handle input change with validation\r\n    const handleInputChange = (e) => {\r\n        const value = e.target.value;\r\n\r\n        if (searchType === 'phone') {\r\n            // Only allow numbers for phone\r\n            const numbersOnly = value.replace(/[^0-9]/g, '');\r\n            setSearchValue(numbersOnly);\r\n        } else if (searchType === 'tracking') {\r\n            // Allow alphanumeric and hyphen for Tracking Number (like SFX-20251221-001)\r\n            const validChars = value.replace(/[^a-zA-Z0-9-]/g, '').toUpperCase();\r\n            setSearchValue(validChars);\r\n        } else {\r\n            // Email can have any characters\r\n            setSearchValue(value);\r\n        }\r\n    };\r\n\r\n    // Clear search value when changing search type\r\n    const handleSearchTypeChange = (type) => {\r\n        setSearchType(type);\r\n        setSearchValue('');\r\n        setError('');\r\n    };\r\n\r\n    const handleSearch = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setBooking(null);\r\n        setLoading(true);\r\n\r\n        try {\r\n            // Try searching via new API first (Supabase database)\r\n            let found = null;\r\n\r\n            if (searchType === 'tracking') {\r\n                // Use search_bookings RPC with tracking number\r\n                const results = await api.bookings.list({ search: searchValue });\r\n                found = results.find(b =>\r\n                    b.tracking_number === searchValue ||\r\n                    b.trackingNumber === searchValue ||\r\n                    b.id === searchValue\r\n                );\r\n            } else if (searchType === 'email') {\r\n                // Search by customer email\r\n                const results = await api.bookings.list({ search: searchValue });\r\n                found = results.find(b =>\r\n                    b.customer_email?.toLowerCase() === searchValue.toLowerCase() ||\r\n                    b.customer?.email?.toLowerCase() === searchValue.toLowerCase()\r\n                );\r\n            } else if (searchType === 'phone') {\r\n                // Search by customer phone\r\n                const results = await api.bookings.list({ search: searchValue });\r\n                found = results.find(b =>\r\n                    (b.customer_phone || b.customer?.phone || '').replace(/\\D/g, '') === searchValue.replace(/\\D/g, '')\r\n                );\r\n            }\r\n\r\n            // Fallback to mockApi for legacy bookings if not found\r\n            if (!found) {\r\n                const legacyBookings = await mockApi.getBookings();\r\n                if (searchType === 'tracking') {\r\n                    found = legacyBookings.find(b =>\r\n                        b.trackingNumber === searchValue ||\r\n                        b.id === searchValue ||\r\n                        `#${b.id}` === searchValue\r\n                    );\r\n                } else if (searchType === 'email') {\r\n                    found = legacyBookings.find(b =>\r\n                        b.customer?.email?.toLowerCase() === searchValue.toLowerCase()\r\n                    );\r\n                } else if (searchType === 'phone') {\r\n                    found = legacyBookings.find(b =>\r\n                        b.customer?.phone?.replace(/\\D/g, '') === searchValue.replace(/\\D/g, '')\r\n                    );\r\n                }\r\n            }\r\n\r\n            if (found) {\r\n                // Normalize the booking object for display\r\n                const normalizedBooking = {\r\n                    ...found,\r\n                    id: found.id || found.booking_id,\r\n                    trackingNumber: found.tracking_number || found.trackingNumber,\r\n                    status: found.status || 'Pending',\r\n                    device: found.device || {\r\n                        type: found.device_type,\r\n                        brand: found.device_brand,\r\n                        model: found.device_model\r\n                    },\r\n                    customer: found.customer || {\r\n                        name: found.customer_name,\r\n                        email: found.customer_email,\r\n                        phone: found.customer_phone\r\n                    },\r\n                    date: found.scheduled_date || found.date,\r\n                    time: found.scheduled_start || found.time\r\n                };\r\n                setBooking(normalizedBooking);\r\n\r\n                // Fetch tracking history for this booking\r\n                try {\r\n                    const history = await mockApi.getRepairTracking(normalizedBooking.id);\r\n                    setTrackingHistory(history || []);\r\n                } catch (historyErr) {\r\n                    console.log('Could not load tracking history:', historyErr);\r\n                    setTrackingHistory([]);\r\n                }\r\n            } else {\r\n                setError('No booking found. Please check your information and try again.');\r\n            }\r\n        } catch (err) {\r\n            console.error('Search error:', err);\r\n            setError('Failed to search. Please try again.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const getStatusIcon = (status) => {\r\n        switch (status?.toLowerCase()) {\r\n            case 'pending':\r\n                return <Clock className=\"status-icon pending\" />;\r\n            case 'confirmed':\r\n                return <AlertCircle className=\"status-icon confirmed\" />;\r\n            case 'in progress':\r\n                return <Package className=\"status-icon in-progress\" />;\r\n            case 'completed':\r\n                return <CheckCircle className=\"status-icon completed\" />;\r\n            case 'cancelled':\r\n                return <XCircle className=\"status-icon cancelled\" />;\r\n            default:\r\n                return <Clock className=\"status-icon\" />;\r\n        }\r\n    };\r\n\r\n    const getStatusStep = (status) => {\r\n        switch (status?.toLowerCase()) {\r\n            case 'pending': return 1;\r\n            case 'confirmed': return 2;\r\n            case 'in progress': return 3;\r\n            case 'completed': return 4;\r\n            default: return 0;\r\n        }\r\n    };\r\n\r\n    const statusSteps = ['Pending', 'Confirmed', 'In Progress', 'Completed'];\r\n\r\n    const searchOptions = [\r\n        { id: 'tracking', label: 'Tracking #', icon: FileText },\r\n        { id: 'email', label: 'Email', icon: Mail },\r\n        { id: 'phone', label: 'Phone', icon: Phone },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"track-page\">\r\n            {/* Hero Section */}\r\n            <section className=\"track-hero\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"track-hero-content\"\r\n                        initial={{ opacity: 0, y: 30 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.6 }}\r\n                    >\r\n                        <span className=\"hero-badge\">Track Repair</span>\r\n                        <h1>Check Your Repair Status</h1>\r\n                        <p>Enter your tracking number, email, or phone number to track the progress of your repair.</p>\r\n                    </motion.div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Search Section */}\r\n            <section className=\"track-search-section\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"search-card\"\r\n                        initial={{ opacity: 0, y: 20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.5, delay: 0.2 }}\r\n                    >\r\n                        <div className=\"search-header\">\r\n                            <div className=\"search-icon-wrapper\">\r\n                                <Search size={28} />\r\n                            </div>\r\n                            <div>\r\n                                <h2>Find Your Booking</h2>\r\n                                <p>Select a search method and enter your details</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <form className=\"search-form\" onSubmit={handleSearch}>\r\n                            <div className=\"search-type-selector\">\r\n                                {searchOptions.map((option) => (\r\n                                    <button\r\n                                        key={option.id}\r\n                                        type=\"button\"\r\n                                        className={`type-btn ${searchType === option.id ? 'active' : ''}`}\r\n                                        onClick={() => handleSearchTypeChange(option.id)}\r\n                                    >\r\n                                        <option.icon size={18} />\r\n                                        {option.label}\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n\r\n                            <div className=\"search-input-wrapper\">\r\n                                <input\r\n                                    type={searchType === 'email' ? 'email' : 'text'}\r\n                                    inputMode={searchType === 'phone' ? 'numeric' : 'text'}\r\n                                    pattern={searchType === 'phone' ? '[0-9]*' : undefined}\r\n                                    placeholder={\r\n                                        searchType === 'tracking' ? 'Enter tracking # (e.g., SFX-20251221-001)' :\r\n                                            searchType === 'email' ? 'Enter your email address' :\r\n                                                'Enter your phone number (numbers only)'\r\n                                    }\r\n                                    value={searchValue}\r\n                                    onChange={handleInputChange}\r\n                                    required\r\n                                />\r\n                                <Button variant=\"primary\" type=\"submit\" disabled={loading}>\r\n                                    {loading ? 'Searching...' : 'Track'}\r\n                                    {!loading && <ArrowRight size={18} />}\r\n                                </Button>\r\n                            </div>\r\n                        </form>\r\n\r\n                        {error && (\r\n                            <motion.div\r\n                                className=\"error-message\"\r\n                                initial={{ opacity: 0, y: -10 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                            >\r\n                                <XCircle size={20} />\r\n                                {error}\r\n                            </motion.div>\r\n                        )}\r\n                    </motion.div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Results Section */}\r\n            {booking && (\r\n                <section className=\"track-results-section\">\r\n                    <div className=\"container\">\r\n                        <motion.div\r\n                            className=\"booking-result\"\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ duration: 0.5 }}\r\n                        >\r\n                            <div className=\"result-header\">\r\n                                {getStatusIcon(booking.status)}\r\n                                <div>\r\n                                    <h2>Repair #{booking.trackingNumber || booking.id}</h2>\r\n                                    <span className={`status-badge ${booking.status?.toLowerCase().replace(' ', '-')}`}>\r\n                                        {booking.status}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {booking.status?.toLowerCase() !== 'cancelled' && (\r\n                                <div className=\"progress-tracker\">\r\n                                    {statusSteps.map((step, index) => (\r\n                                        <div key={step} className=\"progress-step\">\r\n                                            <div className={`step-circle ${index < getStatusStep(booking.status) ? 'completed' : ''} ${index === getStatusStep(booking.status) - 1 ? 'current' : ''}`}>\r\n                                                {index < getStatusStep(booking.status) ? <CheckCircle size={20} /> : index + 1}\r\n                                            </div>\r\n                                            <span className=\"step-label\">{step}</span>\r\n                                            {index < statusSteps.length - 1 && (\r\n                                                <div className={`step-line ${index < getStatusStep(booking.status) - 1 ? 'completed' : ''}`} />\r\n                                            )}\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            )}\r\n\r\n                            <div className=\"booking-details-grid\">\r\n                                <motion.div\r\n                                    className=\"detail-card\"\r\n                                    initial={{ opacity: 0, y: 10 }}\r\n                                    animate={{ opacity: 1, y: 0 }}\r\n                                    transition={{ delay: 0.1 }}\r\n                                >\r\n                                    <div className=\"detail-icon blue\">\r\n                                        <Smartphone size={20} />\r\n                                    </div>\r\n                                    <h3>Device Information</h3>\r\n                                    <p><strong>Tracking #:</strong> {booking.trackingNumber || 'N/A'}</p>\r\n                                    <p><strong>Device:</strong> {getDeviceName(booking.device)}</p>\r\n                                    <p><strong>Issue:</strong> {booking.issue || booking.notes || 'N/A'}</p>\r\n                                </motion.div>\r\n\r\n                                <motion.div\r\n                                    className=\"detail-card\"\r\n                                    initial={{ opacity: 0, y: 10 }}\r\n                                    animate={{ opacity: 1, y: 0 }}\r\n                                    transition={{ delay: 0.2 }}\r\n                                >\r\n                                    <div className=\"detail-icon purple\">\r\n                                        <Calendar size={20} />\r\n                                    </div>\r\n                                    <h3>Appointment</h3>\r\n                                    <p><strong>Date:</strong> {getBookingDate(booking)}</p>\r\n                                    <p><strong>Time:</strong> {booking.timeSlot?.name || booking.scheduledStart || booking.time || 'N/A'}</p>\r\n                                </motion.div>\r\n\r\n                                <motion.div\r\n                                    className=\"detail-card\"\r\n                                    initial={{ opacity: 0, y: 10 }}\r\n                                    animate={{ opacity: 1, y: 0 }}\r\n                                    transition={{ delay: 0.3 }}\r\n                                >\r\n                                    <div className=\"detail-icon green\">\r\n                                        <User size={20} />\r\n                                    </div>\r\n                                    <h3>Customer</h3>\r\n                                    <p><strong>Name:</strong> {getCustomerName(booking.customer)}</p>\r\n                                    <p><strong>Email:</strong> {booking.customer?.email || 'N/A'}</p>\r\n                                </motion.div>\r\n                            </div>\r\n\r\n                            {booking.notes && (\r\n                                <div className=\"notes-section\">\r\n                                    <h3><FileText size={20} /> Notes</h3>\r\n                                    {Array.isArray(booking.notes) ? (\r\n                                        <div className=\"notes-timeline\">\r\n                                            {booking.notes.map((note, index) => (\r\n                                                <motion.div\r\n                                                    key={note.id || index}\r\n                                                    className=\"note-item\"\r\n                                                    initial={{ opacity: 0, x: -20 }}\r\n                                                    animate={{ opacity: 1, x: 0 }}\r\n                                                    transition={{ delay: index * 0.1 }}\r\n                                                >\r\n                                                    <div className=\"note-dot\" />\r\n                                                    <div className=\"note-content\">\r\n                                                        <span className=\"note-date\">{note.date}</span>\r\n                                                        <p>{note.text}</p>\r\n                                                        <span className=\"note-author\">ΓÇö {note.author}</span>\r\n                                                    </div>\r\n                                                </motion.div>\r\n                                            ))}\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"notes-text\">\r\n                                            <p>{booking.notes}</p>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Tracking History Timeline */}\r\n                            {trackingHistory && trackingHistory.length > 0 && (\r\n                                <div className=\"tracking-history-section\">\r\n                                    <h3><History size={20} /> Repair History</h3>\r\n                                    <div className=\"tracking-timeline\">\r\n                                        {trackingHistory.map((log, index) => (\r\n                                            <motion.div\r\n                                                key={log.id || index}\r\n                                                className={`tracking-item ${log.status?.toLowerCase().replace(' ', '-')}`}\r\n                                                initial={{ opacity: 0, x: -20 }}\r\n                                                animate={{ opacity: 1, x: 0 }}\r\n                                                transition={{ delay: index * 0.1 }}\r\n                                            >\r\n                                                <div className={`tracking-dot ${log.status?.toLowerCase().replace(' ', '-')}`}>\r\n                                                    {getStatusIcon(log.status)}\r\n                                                </div>\r\n                                                <div className=\"tracking-content\">\r\n                                                    <div className=\"tracking-header\">\r\n                                                        <span className={`tracking-status ${log.status?.toLowerCase().replace(' ', '-')}`}>\r\n                                                            {log.status}\r\n                                                        </span>\r\n                                                        <span className=\"tracking-date\">\r\n                                                            {new Date(log.created_at).toLocaleString('en-US', {\r\n                                                                month: 'short',\r\n                                                                day: 'numeric',\r\n                                                                year: 'numeric',\r\n                                                                hour: 'numeric',\r\n                                                                minute: '2-digit',\r\n                                                                hour12: true\r\n                                                            })}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                    <p className=\"tracking-message\">{log.message}</p>\r\n                                                    {log.staff_member && (\r\n                                                        <span className=\"tracking-staff\">by {log.staff_member}</span>\r\n                                                    )}\r\n                                                </div>\r\n                                            </motion.div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </motion.div>\r\n                    </div>\r\n                </section>\r\n            )}\r\n\r\n            {/* Help Section */}\r\n            <section className=\"track-help-section\">\r\n                <div className=\"container\">\r\n                    <motion.div\r\n                        className=\"help-card\"\r\n                        initial={{ opacity: 0, y: 20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.5, delay: 0.3 }}\r\n                    >\r\n                        <div className=\"help-icon\">\r\n                            <Phone size={24} />\r\n                        </div>\r\n                        <div className=\"help-content\">\r\n                            <h3>Need Help?</h3>\r\n                            <p>Can't find your booking or have questions? Contact our support team.</p>\r\n                        </div>\r\n                        <a href=\"/contact\" className=\"help-link\">\r\n                            Contact Support <ArrowRight size={16} />\r\n                        </a>\r\n                    </motion.div>\r\n                </div>\r\n            </section>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TrackBooking;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\customer\\pages\\WarrantyPolicy.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\staff\\pages\\AdminDashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'setInventorySearch' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":82,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":82,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"setInventorySearch"},"fix":{"range":[4418,4438],"text":""},"desc":"Remove unused variable 'setInventorySearch'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setInventoryCategoryFilter' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":83,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":83,"endColumn":63,"suggestions":[{"messageId":"removeVar","data":{"varName":"setInventoryCategoryFilter"},"fix":{"range":[4491,4519],"text":""},"desc":"Remove unused variable 'setInventoryCategoryFilter'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setShowFilters' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":90,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":90,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"setShowFilters"},"fix":{"range":[4711,4727],"text":""},"desc":"Remove unused variable 'setShowFilters'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'websiteContent'. Either include it or remove the dependency array.","line":221,"column":8,"nodeType":"ArrayExpression","endLine":221,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [activeTab, websiteContent]","fix":{"range":[10293,10304],"text":"[activeTab, websiteContent]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":597,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":597,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'exportInventoryCSV' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":763,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":763,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"exportInventoryCSV"},"fix":{"range":[29046,29487],"text":""},"desc":"Remove unused variable 'exportInventoryCSV'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":2453,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":2453,"endColumn":72,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[157449,157461],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { api } from '../../../services/apiClient';\r\nimport { mockApi } from '../../../services/mockApi'; // Keep for legacy operations\r\nimport { useAuth } from '../../../context/AuthContext';\r\nimport { useNotifications } from '../../../context/NotificationContext';\r\nimport { NotificationBell } from '../../../components/Notifications';\r\nimport Button from '../../../components/Button';\r\nimport {\r\n    Users, Calendar, DollarSign, TrendingUp, Trash2, Download,\r\n    Plus, Edit2, X, Settings, Package, UserPlus, RefreshCw,\r\n    Clock, CheckCircle, AlertCircle, Activity, Search, Timer,\r\n    BarChart3, PieChart, ShoppingBag, UserCheck, ChevronLeft,\r\n    ChevronRight, Filter, CalendarDays, Minus, AlertTriangle,\r\n    FileText, Send, PackageCheck, XCircle, Layers, TrendingDown, History,\r\n    Shield, Cookie, ChevronDown, ChevronUp, Eye, ExternalLink, Mail,\r\n    Receipt, CreditCard\r\n} from 'lucide-react';\r\nimport {\r\n    LineChart, Line, BarChart, Bar, PieChart as RechartsPie, Pie, Cell,\r\n    XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend\r\n} from 'recharts';\r\nimport ThemeToggle from '../../../components/ThemeToggle';\r\nimport { validateName, validateUsername, validatePhone, validateText, validatePrice } from '../../../utils/validation';\r\nimport { getDeviceName, getCustomerName, getBookingDate } from '../../../utils/schemaHelpers';\r\nimport './AdminDashboard.css';\r\n\r\nconst AdminDashboard = () => {\r\n    const { user, logout } = useAuth();\r\n    const { addNotification } = useNotifications();\r\n    const [activeTab, setActiveTab] = useState('dashboard');\r\n    const [bookings, setBookings] = useState([]);\r\n    const [employees, setEmployees] = useState([]);\r\n    const [services, setServices] = useState([]);\r\n    const [stats, setStats] = useState({});\r\n    const [settings, setSettings] = useState({});\r\n    const [timeSlots, setTimeSlots] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [lastUpdate, setLastUpdate] = useState(new Date());\r\n    const [autoRefresh, setAutoRefresh] = useState(true);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const previousBookingsRef = useRef([]);\r\n\r\n    // New state for customers, inventory, analytics\r\n    const [customers, setCustomers] = useState([]);\r\n    const [inventory, setInventory] = useState([]);\r\n    const [analyticsData, setAnalyticsData] = useState([]);\r\n    const [revenueByService, setRevenueByService] = useState([]);\r\n    const [bookingsByStatus, setBookingsByStatus] = useState([]);\r\n\r\n    // Purchase orders and inventory analytics state\r\n    const [purchaseOrders, setPurchaseOrders] = useState([]);\r\n    const [reorderAlerts, setReorderAlerts] = useState([]);\r\n    const [inventoryAnalytics, setInventoryAnalytics] = useState(null);\r\n    const [inventoryViewMode, setInventoryViewMode] = useState('items'); // 'items', 'orders', 'analytics'\r\n    const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n\r\n    // Activity log state\r\n    const [activityLog, setActivityLog] = useState([]);\r\n    const [activityStats, setActivityStats] = useState(null);\r\n    const [activityFilters, setActivityFilters] = useState({ category: '', search: '', startDate: '', endDate: '' });\r\n    const [activityPage, setActivityPage] = useState(1);\r\n    const [activityTotal, setActivityTotal] = useState(0);\r\n\r\n    // Sales History state\r\n    const [salesHistory, setSalesHistory] = useState([]);\r\n    const [salesStats, setSalesStats] = useState(null);\r\n    const [salesFilter, setSalesFilter] = useState({ type: 'all', dateFrom: '', dateTo: '' });\r\n\r\n    // Website content CMS state\r\n    const [websiteContent, setWebsiteContent] = useState(null);\r\n    const [activeContentSection, setActiveContentSection] = useState('hero');\r\n    const [contentSaving, setContentSaving] = useState(false);\r\n    const [expandedLegalPages, setExpandedLegalPages] = useState({ privacyPolicy: true });\r\n\r\n    // Tab-specific search/filter state\r\n    const [userSearch, setUserSearch] = useState('');\r\n    const [userRoleFilter, setUserRoleFilter] = useState('all');\r\n    const [serviceSearch, setServiceSearch] = useState('');\r\n    const [serviceCategoryFilter, setServiceCategoryFilter] = useState('all');\r\n    const [customerSearch, setCustomerSearch] = useState('');\r\n    const [inventorySearch, setInventorySearch] = useState('');\r\n    const [inventoryCategoryFilter, setInventoryCategoryFilter] = useState('all');\r\n\r\n    // Pagination state\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const [itemsPerPage] = useState(10);\r\n\r\n    // Filter state\r\n    const [showFilters, setShowFilters] = useState(false);\r\n    const [dateFilter, setDateFilter] = useState({ from: '', to: '' });\r\n    const [statusFilter, setStatusFilter] = useState('all');\r\n\r\n    // Calendar view state\r\n    const [viewMode, setViewMode] = useState('table'); // 'table' or 'calendar'\r\n    const [calendarMonth, setCalendarMonth] = useState(new Date());\r\n\r\n    // Modal states\r\n    const [showUserModal, setShowUserModal] = useState(false);\r\n    const [showServiceModal, setShowServiceModal] = useState(false);\r\n    const [showSettingsModal, setShowSettingsModal] = useState(false);\r\n    const [showTimeSlotsModal, setShowTimeSlotsModal] = useState(false);\r\n    const [showCustomerModal, setShowCustomerModal] = useState(false);\r\n    const [showInventoryModal, setShowInventoryModal] = useState(false);\r\n    const [showPurchaseOrderModal, setShowPurchaseOrderModal] = useState(false);\r\n    const [editingItem, setEditingItem] = useState(null);\r\n\r\n    const loadData = useCallback(async (showLoading = false, isInitialLoad = false) => {\r\n        if (showLoading) setLoading(true);\r\n        try {\r\n            const [bookingsData, usersData, servicesData, statsData, settingsData, timeSlotsData, customersData, inventoryData, analyticsDataRes, revenueData, statusData, purchaseOrdersData, reorderAlertsData, inventoryAnalyticsData] = await Promise.all([\r\n                api.bookings.list(),\r\n                mockApi.getUsers(),\r\n                api.services.list(),\r\n                mockApi.getStats(),\r\n                mockApi.getSettings(),\r\n                api.timeSlots.list(),\r\n                api.customers.list(),\r\n                api.inventory.list(),\r\n                mockApi.getAnalyticsData(),\r\n                mockApi.getRevenueByService(),\r\n                mockApi.getBookingsByStatus(),\r\n                mockApi.getPurchaseOrders(),\r\n                mockApi.getReorderAlerts(),\r\n                mockApi.getInventoryAnalytics()\r\n            ]);\r\n\r\n            // Check for new bookings (only after initial load)\r\n            if (!isInitialLoad && previousBookingsRef.current.length > 0) {\r\n                const previousIds = previousBookingsRef.current.map(b => b.id);\r\n                const newBookings = bookingsData.filter(b => !previousIds.includes(b.id));\r\n\r\n                newBookings.forEach(booking => {\r\n                    // Handle device as object or string\r\n                    const deviceName = typeof booking.device === 'object'\r\n                        ? booking.device?.name || 'Device'\r\n                        : booking.device || 'Device';\r\n                    addNotification({\r\n                        type: 'new_booking',\r\n                        title: 'New Booking',\r\n                        message: `${booking.customer?.name || 'Customer'} booked ${deviceName} for ${booking.scheduledDate || booking.date || 'N/A'}`\r\n                    });\r\n                });\r\n            }\r\n\r\n            previousBookingsRef.current = bookingsData;\r\n            setBookings(bookingsData);\r\n            setEmployees(usersData);\r\n            setServices(servicesData);\r\n            setStats(statsData);\r\n            setSettings(settingsData);\r\n            setTimeSlots(timeSlotsData);\r\n            setCustomers(customersData);\r\n            setInventory(inventoryData);\r\n            setAnalyticsData(analyticsDataRes);\r\n            setRevenueByService(revenueData);\r\n            setBookingsByStatus(statusData);\r\n            setPurchaseOrders(purchaseOrdersData);\r\n            setReorderAlerts(reorderAlertsData);\r\n            setInventoryAnalytics(inventoryAnalyticsData);\r\n            setLastUpdate(new Date());\r\n        } catch (error) {\r\n            console.error('Failed to load data', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [addNotification]);\r\n\r\n    // Load activity log\r\n    const loadActivityLog = useCallback(async () => {\r\n        try {\r\n            const [logResult, statsResult] = await Promise.all([\r\n                mockApi.getActivityLog({\r\n                    ...activityFilters,\r\n                    page: activityPage,\r\n                    limit: 20\r\n                }),\r\n                mockApi.getActivityStats()\r\n            ]);\r\n            setActivityLog(logResult.activities);\r\n            setActivityTotal(logResult.total);\r\n            setActivityStats(statsResult);\r\n        } catch (error) {\r\n            console.error('Failed to load activity log', error);\r\n        }\r\n    }, [activityFilters, activityPage]);\r\n\r\n    // Load sales data\r\n    const loadSalesData = useCallback(async () => {\r\n        try {\r\n            const [sales, stats] = await Promise.all([\r\n                mockApi.getSales(),\r\n                mockApi.getSalesStats(salesFilter.dateFrom, salesFilter.dateTo)\r\n            ]);\r\n            setSalesHistory(sales);\r\n            setSalesStats(stats);\r\n        } catch (error) {\r\n            console.error('Failed to load sales data', error);\r\n        }\r\n    }, [salesFilter]);\r\n\r\n    // Load activity log when tab is active or filters change\r\n    useEffect(() => {\r\n        if (activeTab === 'activity') {\r\n            loadActivityLog();\r\n        }\r\n    }, [activeTab, loadActivityLog]);\r\n\r\n    // Load sales data when sales tab is active\r\n    useEffect(() => {\r\n        if (activeTab === 'sales') {\r\n            loadSalesData();\r\n        }\r\n    }, [activeTab, loadSalesData]);\r\n\r\n    // Load website content when content tab is active\r\n    useEffect(() => {\r\n        if (activeTab === 'content' && !websiteContent) {\r\n            loadWebsiteContent();\r\n        }\r\n    }, [activeTab]);\r\n\r\n    const loadWebsiteContent = async () => {\r\n        try {\r\n            const content = await mockApi.getWebsiteContent();\r\n            setWebsiteContent(content);\r\n        } catch (error) {\r\n            console.error('Failed to load website content:', error);\r\n        }\r\n    };\r\n\r\n    const handleSaveContent = async (section, data) => {\r\n        setContentSaving(true);\r\n        try {\r\n            const updated = await mockApi.updateWebsiteContent(section, data);\r\n            setWebsiteContent(updated);\r\n            alert('Content saved successfully!');\r\n        } catch (error) {\r\n            alert('Failed to save content: ' + error.message);\r\n        }\r\n        setContentSaving(false);\r\n    };\r\n\r\n    const handleResetLegalContent = async () => {\r\n        if (window.confirm('This will reset all legal pages to the default content. Any custom changes will be lost. Continue?')) {\r\n            setContentSaving(true);\r\n            try {\r\n                const freshContent = await mockApi.resetWebsiteContent();\r\n                setWebsiteContent(freshContent);\r\n                alert('Legal pages content has been reset to defaults with all sections populated!');\r\n            } catch (error) {\r\n                alert('Failed to reset content: ' + error.message);\r\n            }\r\n            setContentSaving(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        loadData(true, true); // Initial load\r\n    }, [loadData]);\r\n\r\n    // Auto-refresh every 15 seconds\r\n    useEffect(() => {\r\n        if (!autoRefresh) return;\r\n\r\n        // Refresh immediately when auto-refresh is enabled\r\n        loadData(false);\r\n\r\n        const interval = setInterval(() => {\r\n            loadData(false);\r\n        }, 15000);\r\n        return () => clearInterval(interval);\r\n    }, [autoRefresh, loadData]);\r\n\r\n\r\n    // ========== BOOKING HANDLERS ==========\r\n    const handleDeleteBooking = async (id) => {\r\n        if (!window.confirm('Are you sure you want to delete this booking?')) return;\r\n        try {\r\n            await mockApi.deleteBooking(id);\r\n            loadData();\r\n        } catch (error) {\r\n            console.error('Failed to delete booking', error);\r\n        }\r\n    };\r\n\r\n    const handleStatusChange = async (id, newStatus) => {\r\n        try {\r\n            await mockApi.updateBookingStatus(id, newStatus);\r\n\r\n            // Find the booking to get details for notification\r\n            const booking = bookings.find(b => b.id === id);\r\n            if (booking) {\r\n                addNotification({\r\n                    type: 'status_change',\r\n                    title: 'Status Updated',\r\n                    message: `${getDeviceName(booking.device)} status changed to \"${newStatus}\"`\r\n                });\r\n            }\r\n\r\n            loadData();\r\n        } catch (error) {\r\n            console.error('Failed to update status', error);\r\n        }\r\n    };\r\n\r\n    // ========== USER HANDLERS ==========\r\n    const handleSaveUser = async (userData) => {\r\n        try {\r\n            if (editingItem) {\r\n                await mockApi.updateUser(editingItem.id, userData);\r\n            } else {\r\n                await mockApi.addUser(userData);\r\n            }\r\n            setShowUserModal(false);\r\n            setEditingItem(null);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleDeleteUser = async (id) => {\r\n        if (!window.confirm('Are you sure you want to delete this user?')) return;\r\n        try {\r\n            await mockApi.deleteUser(id);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleResetPassword = async (id) => {\r\n        const newPassword = prompt('Enter new password:');\r\n        if (newPassword) {\r\n            try {\r\n                await mockApi.resetUserPassword(id, newPassword);\r\n                alert('Password reset successfully');\r\n            } catch (error) {\r\n                alert(error.message);\r\n            }\r\n        }\r\n    };\r\n\r\n    // ========== SERVICE HANDLERS ==========\r\n    const handleSaveService = async (serviceData) => {\r\n        try {\r\n            if (editingItem) {\r\n                await mockApi.updateService(editingItem.id, serviceData);\r\n            } else {\r\n                await mockApi.addService(serviceData);\r\n            }\r\n            setShowServiceModal(false);\r\n            setEditingItem(null);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleDeleteService = async (id) => {\r\n        if (!window.confirm('Are you sure you want to delete this service?')) return;\r\n        try {\r\n            await mockApi.deleteService(id);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleToggleService = async (id) => {\r\n        try {\r\n            await mockApi.toggleServiceActive(id);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    // ========== SETTINGS HANDLERS ==========\r\n    const handleSaveSettings = async (newSettings) => {\r\n        try {\r\n            await mockApi.updateSettings(newSettings);\r\n            setShowSettingsModal(false);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    // ========== CUSTOMER HANDLERS ==========\r\n    const handleSaveCustomer = async (customerData) => {\r\n        try {\r\n            if (editingItem) {\r\n                await mockApi.updateCustomer(editingItem.id, customerData);\r\n            } else {\r\n                await mockApi.addCustomer(customerData);\r\n            }\r\n            setShowCustomerModal(false);\r\n            setEditingItem(null);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleDeleteCustomer = async (id) => {\r\n        if (!window.confirm('Are you sure you want to delete this customer?')) return;\r\n        try {\r\n            await mockApi.deleteCustomer(id);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleResetCustomerPassword = async (customer) => {\r\n        // Find the customer's user account by email\r\n        const customerUser = await mockApi.getCustomerUserByEmail(customer.email);\r\n        if (!customerUser) {\r\n            alert(`No login account found for ${customer.email}. The customer may not have registered yet.`);\r\n            return;\r\n        }\r\n\r\n        const newPassword = prompt(`Enter new password for ${customer.name}:`);\r\n        if (newPassword) {\r\n            try {\r\n                await mockApi.resetUserPassword(customerUser.id, newPassword);\r\n                alert('Password reset successfully');\r\n            } catch (error) {\r\n                alert(error.message);\r\n            }\r\n        }\r\n    };\r\n\r\n    // ========== INVENTORY HANDLERS ==========\r\n    const handleSaveInventory = async (itemData) => {\r\n        try {\r\n            if (editingItem) {\r\n                await mockApi.updateInventoryItem(editingItem.id, itemData);\r\n            } else {\r\n                await mockApi.addInventoryItem(itemData);\r\n            }\r\n            setShowInventoryModal(false);\r\n            setEditingItem(null);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleDeleteInventory = async (id) => {\r\n        if (!window.confirm('Are you sure you want to delete this item?')) return;\r\n        try {\r\n            await mockApi.deleteInventoryItem(id);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleAdjustStock = async (id, adjustment) => {\r\n        try {\r\n            await mockApi.adjustStock(id, adjustment);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    // ========== PURCHASE ORDER HANDLERS ==========\r\n    const handleCreatePurchaseOrder = async (orderData) => {\r\n        try {\r\n            await mockApi.createPurchaseOrder(orderData);\r\n            setShowPurchaseOrderModal(false);\r\n            setEditingItem(null);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleUpdatePurchaseOrder = async (id, updates) => {\r\n        try {\r\n            await mockApi.updatePurchaseOrder(id, updates);\r\n            setShowPurchaseOrderModal(false);\r\n            setEditingItem(null);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleSubmitPurchaseOrder = async (id) => {\r\n        if (!window.confirm('Submit this purchase order?')) return;\r\n        try {\r\n            await mockApi.submitPurchaseOrder(id);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleReceivePurchaseOrder = async (id) => {\r\n        if (!window.confirm('Mark this order as received? This will update inventory quantities.')) return;\r\n        try {\r\n            await mockApi.receivePurchaseOrder(id);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleCancelPurchaseOrder = async (id) => {\r\n        if (!window.confirm('Cancel this purchase order?')) return;\r\n        try {\r\n            await mockApi.cancelPurchaseOrder(id);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleDeletePurchaseOrder = async (id) => {\r\n        if (!window.confirm('Delete this purchase order?')) return;\r\n        try {\r\n            await mockApi.deletePurchaseOrder(id);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    const handleCreatePOFromReorderAlerts = async () => {\r\n        if (reorderAlerts.length === 0) {\r\n            alert('No items need reordering');\r\n            return;\r\n        }\r\n        // Group by supplier\r\n        const bySupplier = reorderAlerts.reduce((acc, item) => {\r\n            if (!acc[item.supplier]) acc[item.supplier] = [];\r\n            acc[item.supplier].push({\r\n                itemId: item.id,\r\n                name: item.name,\r\n                quantity: item.shortfall,\r\n                cost: item.cost\r\n            });\r\n            return acc;\r\n        }, {});\r\n\r\n        // Create POs for each supplier\r\n        for (const [supplier, items] of Object.entries(bySupplier)) {\r\n            await mockApi.createPurchaseOrder({\r\n                supplier,\r\n                items,\r\n                notes: 'Auto-generated from reorder alerts'\r\n            });\r\n        }\r\n        loadData();\r\n    };\r\n\r\n    // ========== EXPORT ==========\r\n    const exportToCSV = () => {\r\n        const headers = ['ID', 'Device', 'Issue', 'Date', 'Time', 'Customer', 'Email', 'Phone', 'Status'];\r\n        const csvContent = [\r\n            headers.join(','),\r\n            ...bookings.map(b => [\r\n                b.id,\r\n                `\"${getDeviceName(b.device)}\"`,\r\n                `\"${b.issue || b.notes || ''}\"`,\r\n                getBookingDate(b),\r\n                b.timeSlot?.name || b.scheduledStart || b.time || '',\r\n                `\"${getCustomerName(b.customer)}\"`,\r\n                b.customer?.email || '',\r\n                b.customer?.phone || '',\r\n                b.status || ''\r\n            ].join(','))\r\n        ].join('\\n');\r\n\r\n        const blob = new Blob([csvContent], { type: 'text/csv' });\r\n        const url = window.URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = 'bookings_export.csv';\r\n        a.click();\r\n    };\r\n\r\n    const exportAllData = async () => {\r\n        try {\r\n            const data = await mockApi.exportAllData();\r\n            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\r\n            const url = window.URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.href = url;\r\n            a.download = 'sifixa_backup.json';\r\n            a.click();\r\n        } catch (error) {\r\n            alert('Failed to export data');\r\n        }\r\n    };\r\n\r\n    const handleResetAllData = async () => {\r\n        if (window.confirm('This will reset ALL data to default values. Are you sure you want to continue?')) {\r\n            try {\r\n                await mockApi.resetAllData();\r\n                alert('Data reset successful! Reloading page...');\r\n                window.location.reload();\r\n            } catch (error) {\r\n                alert('Failed to reset data: ' + error.message);\r\n            }\r\n        }\r\n    };\r\n\r\n    if (loading) return <div className=\"loading\">Loading...</div>;\r\n\r\n    // Chart colors\r\n    const CHART_COLORS = ['#3b82f6', '#22c55e', '#f97316', '#a855f7', '#06b6d4', '#ec4899'];\r\n\r\n    // Filter bookings with enhanced filters\r\n    const getFilteredBookings = () => {\r\n        let filtered = bookings;\r\n\r\n        // Search filter\r\n        if (searchTerm) {\r\n            const search = searchTerm.toLowerCase();\r\n            filtered = filtered.filter(b =>\r\n                (b.id?.toString() || '').toLowerCase().includes(search) ||\r\n                getCustomerName(b.customer).toLowerCase().includes(search) ||\r\n                (b.customer?.email || '').toLowerCase().includes(search) ||\r\n                (b.customer?.phone || '').includes(search) ||\r\n                getDeviceName(b.device).toLowerCase().includes(search) ||\r\n                (b.status || '').toLowerCase().includes(search)\r\n            );\r\n        }\r\n\r\n        // Date range filter\r\n        const bookingDate = (b) => b.scheduledDate || b.scheduled_date || b.date;\r\n        if (dateFilter.from) {\r\n            filtered = filtered.filter(b => bookingDate(b) >= dateFilter.from);\r\n        }\r\n        if (dateFilter.to) {\r\n            filtered = filtered.filter(b => bookingDate(b) <= dateFilter.to);\r\n        }\r\n\r\n        // Status filter\r\n        if (statusFilter !== 'all') {\r\n            filtered = filtered.filter(b => b.status === statusFilter);\r\n        }\r\n\r\n        return filtered;\r\n    };\r\n\r\n    const filteredBookings = getFilteredBookings();\r\n\r\n    // Filter users - exclude customer accounts (they appear in Customers tab)\r\n    const getFilteredUsers = () => {\r\n        // First, filter out customer accounts - they belong to Customers tab, not Users tab\r\n        let filtered = employees.filter(u => u.role !== 'customer');\r\n        if (userSearch) {\r\n            const search = userSearch.toLowerCase();\r\n            filtered = filtered.filter(u =>\r\n                u.name?.toLowerCase().includes(search) ||\r\n                u.username?.toLowerCase().includes(search) ||\r\n                u.email?.toLowerCase().includes(search) ||\r\n                u.role?.toLowerCase().includes(search)\r\n            );\r\n        }\r\n        if (userRoleFilter !== 'all') {\r\n            filtered = filtered.filter(u => u.role === userRoleFilter);\r\n        }\r\n        return filtered;\r\n    };\r\n\r\n    // Filter services\r\n    const getFilteredServices = () => {\r\n        let filtered = services;\r\n        if (serviceSearch) {\r\n            const search = serviceSearch.toLowerCase();\r\n            filtered = filtered.filter(s =>\r\n                s.name?.toLowerCase().includes(search) ||\r\n                s.description?.toLowerCase().includes(search)\r\n            );\r\n        }\r\n        if (serviceCategoryFilter !== 'all') {\r\n            filtered = filtered.filter(s => s.category === serviceCategoryFilter);\r\n        }\r\n        return filtered;\r\n    };\r\n\r\n    // Filter customers - also merge with customer login account info from users\r\n    const getFilteredCustomers = () => {\r\n        // Get customer login accounts from users table\r\n        const customerAccounts = employees.filter(u => u.role === 'customer');\r\n\r\n        // Merge customer data with their account info\r\n        let filtered = customers.map(c => {\r\n            const account = customerAccounts.find(a => a.email === c.email);\r\n            return {\r\n                ...c,\r\n                hasAccount: !!account,\r\n                username: account?.username || null,\r\n                accountId: account?.id || null\r\n            };\r\n        });\r\n\r\n        if (customerSearch) {\r\n            const search = customerSearch.toLowerCase();\r\n            filtered = filtered.filter(c =>\r\n                c.name?.toLowerCase().includes(search) ||\r\n                c.email?.toLowerCase().includes(search) ||\r\n                c.phone?.includes(search) ||\r\n                c.username?.toLowerCase().includes(search)\r\n            );\r\n        }\r\n        return filtered;\r\n    };\r\n\r\n    // Filter inventory\r\n    const getFilteredInventory = () => {\r\n        let filtered = inventory;\r\n        if (inventorySearch) {\r\n            const search = inventorySearch.toLowerCase();\r\n            filtered = filtered.filter(i =>\r\n                i.name?.toLowerCase().includes(search) ||\r\n                i.sku?.toLowerCase().includes(search) ||\r\n                i.supplier?.toLowerCase().includes(search)\r\n            );\r\n        }\r\n        if (inventoryCategoryFilter !== 'all') {\r\n            filtered = filtered.filter(i => i.category === inventoryCategoryFilter);\r\n        }\r\n        return filtered;\r\n    };\r\n\r\n    // Export functions\r\n    const exportUsersCSV = () => {\r\n        const headers = ['ID', 'Name', 'Username', 'Email', 'Role'];\r\n        const csvContent = [\r\n            headers.join(','),\r\n            ...getFilteredUsers().map(u => [u.id, `\"${u.name}\"`, u.username, u.email, u.role].join(','))\r\n        ].join('\\n');\r\n        downloadCSV(csvContent, 'users_export.csv');\r\n    };\r\n\r\n    const exportServicesCSV = () => {\r\n        const headers = ['ID', 'Name', 'Description', 'Price Min', 'Price Max', 'Category', 'Active'];\r\n        const csvContent = [\r\n            headers.join(','),\r\n            ...getFilteredServices().map(s => [s.id, `\"${s.name}\"`, `\"${s.description}\"`, s.priceMin, s.priceMax, s.category, s.active].join(','))\r\n        ].join('\\n');\r\n        downloadCSV(csvContent, 'services_export.csv');\r\n    };\r\n\r\n    const exportCustomersCSV = () => {\r\n        const headers = ['ID', 'Name', 'Email', 'Phone', 'Total Bookings', 'Total Spent'];\r\n        const csvContent = [\r\n            headers.join(','),\r\n            ...getFilteredCustomers().map(c => [c.id, `\"${c.name}\"`, c.email, c.phone, c.totalBookings, c.totalSpent].join(','))\r\n        ].join('\\n');\r\n        downloadCSV(csvContent, 'customers_export.csv');\r\n    };\r\n\r\n    const exportInventoryCSV = () => {\r\n        const headers = ['ID', 'Name', 'SKU', 'Category', 'Quantity', 'Min Stock', 'Cost', 'Supplier'];\r\n        const csvContent = [\r\n            headers.join(','),\r\n            ...getFilteredInventory().map(i => [i.id, `\"${i.name}\"`, i.sku, i.category, i.quantity, i.minStock, i.cost, `\"${i.supplier}\"`].join(','))\r\n        ].join('\\n');\r\n        downloadCSV(csvContent, 'inventory_export.csv');\r\n    };\r\n\r\n    const downloadCSV = (content, filename) => {\r\n        const blob = new Blob([content], { type: 'text/csv' });\r\n        const url = window.URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = filename;\r\n        a.click();\r\n    };\r\n\r\n    // Pagination\r\n    const totalPages = Math.ceil(filteredBookings.length / itemsPerPage);\r\n    const paginatedBookings = filteredBookings.slice(\r\n        (currentPage - 1) * itemsPerPage,\r\n        currentPage * itemsPerPage\r\n    );\r\n\r\n    // Calendar helpers\r\n    const getDaysInMonth = (date) => {\r\n        const year = date.getFullYear();\r\n        const month = date.getMonth();\r\n        const firstDay = new Date(year, month, 1);\r\n        const lastDay = new Date(year, month + 1, 0);\r\n        const days = [];\r\n\r\n        // Add empty days for the first week\r\n        for (let i = 0; i < firstDay.getDay(); i++) {\r\n            days.push(null);\r\n        }\r\n\r\n        // Add all days of the month\r\n        for (let i = 1; i <= lastDay.getDate(); i++) {\r\n            days.push(new Date(year, month, i));\r\n        }\r\n\r\n        return days;\r\n    };\r\n\r\n    const getBookingsForDate = (date) => {\r\n        if (!date) return [];\r\n        const dateStr = date.toISOString().split('T')[0];\r\n        return bookings.filter(b => b.date === dateStr);\r\n    };\r\n\r\n    // Low stock items count\r\n    const lowStockCount = inventory.filter(i => i.quantity <= i.minStock).length;\r\n\r\n    return (\r\n        <div className=\"admin-layout\">\r\n            {/* Sidebar */}\r\n            <aside className={`admin-sidebar ${sidebarCollapsed ? 'collapsed' : ''}`}>\r\n                <button\r\n                    className=\"sidebar-toggle\"\r\n                    onClick={() => setSidebarCollapsed(!sidebarCollapsed)}\r\n                    title={sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'}\r\n                >\r\n                    {sidebarCollapsed ? <ChevronRight size={16} /> : <ChevronLeft size={16} />}\r\n                </button>\r\n                <div className=\"sidebar-header\">\r\n                    <h2 className=\"sidebar-logo\">SIFIXA</h2>\r\n                    <span className=\"sidebar-subtitle\">Admin Panel</span>\r\n                </div>\r\n\r\n                <nav className=\"sidebar-nav\">\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'dashboard' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('dashboard')}\r\n                    >\r\n                        <TrendingUp size={20} />\r\n                        <span>Dashboard</span>\r\n                    </button>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'analytics' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('analytics')}\r\n                    >\r\n                        <BarChart3 size={20} />\r\n                        <span>Analytics</span>\r\n                    </button>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'bookings' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('bookings')}\r\n                    >\r\n                        <Calendar size={20} />\r\n                        <span>Bookings</span>\r\n                    </button>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'customers' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('customers')}\r\n                    >\r\n                        <UserCheck size={20} />\r\n                        <span>Customers</span>\r\n                    </button>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'inventory' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('inventory')}\r\n                    >\r\n                        <ShoppingBag size={20} />\r\n                        <span>Inventory</span>\r\n                        {lowStockCount > 0 && <span className=\"badge-alert\">{lowStockCount}</span>}\r\n                    </button>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'sales' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('sales')}\r\n                    >\r\n                        <Receipt size={20} />\r\n                        <span>Sales History</span>\r\n                    </button>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'employees' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('employees')}\r\n                    >\r\n                        <Users size={20} />\r\n                        <span>Users</span>\r\n                    </button>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'services' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('services')}\r\n                    >\r\n                        <Package size={20} />\r\n                        <span>Services</span>\r\n                    </button>\r\n                    <Link\r\n                        to=\"/admin/landing\"\r\n                        className=\"sidebar-link\"\r\n                    >\r\n                        <FileText size={20} />\r\n                        <span>Website Content</span>\r\n                    </Link>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'activity' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('activity')}\r\n                    >\r\n                        <History size={20} />\r\n                        <span>Activity Log</span>\r\n                    </button>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'system' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('system')}\r\n                    >\r\n                        <Settings size={20} />\r\n                        <span>System</span>\r\n                    </button>\r\n                </nav>\r\n\r\n                <div className=\"sidebar-footer\">\r\n                    <div className=\"sidebar-user\">\r\n                        <div className=\"user-avatar\">{user?.name?.charAt(0) || 'A'}</div>\r\n                        <div className=\"user-info\">\r\n                            <span className=\"user-name\">{user?.name}</span>\r\n                            <span className=\"user-role\">Administrator</span>\r\n                        </div>\r\n                    </div>\r\n                    <button className=\"sidebar-logout\" onClick={logout}>\r\n                        <X size={18} />\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Main Content */}\r\n            <main className={`admin-main ${sidebarCollapsed ? 'expanded' : ''}`}>\r\n                <div className=\"admin-topbar\">\r\n                    <div className=\"topbar-left\">\r\n                        <h1 className=\"page-title\">\r\n                            {activeTab === 'dashboard' && 'Dashboard Overview'}\r\n                            {activeTab === 'analytics' && 'Analytics & Reports'}\r\n                            {activeTab === 'bookings' && 'Bookings Management'}\r\n                            {activeTab === 'customers' && 'Customer Management'}\r\n                            {activeTab === 'inventory' && 'Inventory Management'}\r\n                            {activeTab === 'sales' && 'Sales History'}\r\n                            {activeTab === 'employees' && 'User Management'}\r\n                            {activeTab === 'services' && 'Service Management'}\r\n                            {activeTab === 'content' && 'Website Content'}\r\n                            {activeTab === 'activity' && 'Activity Log'}\r\n                            {activeTab === 'system' && 'System Settings'}\r\n                        </h1>\r\n                    </div>\r\n                    <div className=\"topbar-actions\">\r\n                        <div className=\"refresh-controls\">\r\n                            <button\r\n                                className={`auto-refresh-btn ${autoRefresh ? 'active' : ''}`}\r\n                                onClick={() => setAutoRefresh(!autoRefresh)}\r\n                                title={autoRefresh ? 'Auto-refresh ON' : 'Auto-refresh OFF'}\r\n                            >\r\n                                <Activity size={20} />\r\n                            </button>\r\n                            <button className=\"refresh-btn\" onClick={() => loadData(false)} title=\"Refresh now\">\r\n                                <RefreshCw size={20} />\r\n                            </button>\r\n                            <span className=\"last-update\">\r\n                                {lastUpdate.toLocaleTimeString()}\r\n                            </span>\r\n                        </div>\r\n                        <NotificationBell />\r\n                        <ThemeToggle />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"admin-content\">\r\n                    {/* DASHBOARD TAB */}\r\n                    {activeTab === 'dashboard' && (\r\n                        <div className=\"dashboard-overview\">\r\n                            {/* Stats Cards */}\r\n                            <div className=\"stats-grid\">\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon blue\"><Calendar size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{stats.totalBookings || 0}</span>\r\n                                        <span className=\"stat-label\">Total Bookings</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon orange\"><Clock size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{stats.pending || 0}</span>\r\n                                        <span className=\"stat-label\">Pending</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon cyan\"><AlertCircle size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{bookings.filter(b => b.status === 'In Progress').length}</span>\r\n                                        <span className=\"stat-label\">In Progress</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon green\"><CheckCircle size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{stats.completed || 0}</span>\r\n                                        <span className=\"stat-label\">Completed</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Secondary Stats */}\r\n                            <div className=\"stats-grid secondary\">\r\n                                <div className=\"stat-card mini\">\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{bookings.filter(b => b.date === new Date().toISOString().split('T')[0]).length}</span>\r\n                                        <span className=\"stat-label\">Today's Bookings</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card mini\">\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{stats.totalEmployees || 0}</span>\r\n                                        <span className=\"stat-label\">Employees</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card mini\">\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{stats.activeServices || 0}/{stats.totalServices || 0}</span>\r\n                                        <span className=\"stat-label\">Active Services</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card mini\">\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">\r\n                                            {stats.totalBookings > 0 ? Math.round(((stats.completed || 0) / stats.totalBookings) * 100) : 0}%\r\n                                        </span>\r\n                                        <span className=\"stat-label\">Completion Rate</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Recent Bookings */}\r\n                            <div className=\"dashboard-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h2>Recent Bookings</h2>\r\n                                    <Button variant=\"secondary\" onClick={() => setActiveTab('bookings')}>\r\n                                        View All\r\n                                    </Button>\r\n                                </div>\r\n                                <div className=\"recent-bookings-list\">\r\n                                    {bookings.slice(0, 5).map(booking => (\r\n                                        <div key={booking.id} className=\"recent-booking-item\">\r\n                                            <div className=\"booking-info\">\r\n                                                <strong>{getDeviceName(booking.device)}</strong>\r\n                                                <span>{getCustomerName(booking.customer)}</span>\r\n                                            </div>\r\n                                            <div className=\"booking-meta\">\r\n                                                <span className=\"booking-date\">{getBookingDate(booking)}</span>\r\n                                                <span className={`status-badge ${booking.status?.toLowerCase().replace(' ', '-')}`}>\r\n                                                    {booking.status}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                    {bookings.length === 0 && (\r\n                                        <p className=\"no-data\">No bookings yet</p>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* ANALYTICS TAB */}\r\n                    {activeTab === 'analytics' && (\r\n                        <div className=\"analytics-section\">\r\n                            {/* Revenue Overview */}\r\n                            <div className=\"analytics-grid\">\r\n                                <div className=\"chart-card full-width\">\r\n                                    <h3><DollarSign size={18} /> Revenue Trend (Last 30 Days)</h3>\r\n                                    <div className=\"chart-container\">\r\n                                        <ResponsiveContainer width=\"100%\" height={300}>\r\n                                            <LineChart data={analyticsData}>\r\n                                                <CartesianGrid strokeDasharray=\"3 3\" stroke=\"var(--border-color)\" />\r\n                                                <XAxis\r\n                                                    dataKey=\"date\"\r\n                                                    stroke=\"var(--text-secondary)\"\r\n                                                    tickFormatter={(value) => new Date(value).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\r\n                                                />\r\n                                                <YAxis stroke=\"var(--text-secondary)\" />\r\n                                                <Tooltip\r\n                                                    contentStyle={{ background: 'var(--bg-card)', border: '1px solid var(--border-color)' }}\r\n                                                    labelFormatter={(value) => new Date(value).toLocaleDateString()}\r\n                                                />\r\n                                                <Legend />\r\n                                                <Line type=\"monotone\" dataKey=\"revenue\" stroke=\"#3b82f6\" strokeWidth={2} name=\"Revenue ($)\" />\r\n                                                <Line type=\"monotone\" dataKey=\"bookings\" stroke=\"#22c55e\" strokeWidth={2} name=\"Bookings\" />\r\n                                            </LineChart>\r\n                                        </ResponsiveContainer>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"chart-card\">\r\n                                    <h3><PieChart size={18} /> Bookings by Status</h3>\r\n                                    <div className=\"chart-container\">\r\n                                        <ResponsiveContainer width=\"100%\" height={250}>\r\n                                            <RechartsPie>\r\n                                                <Pie\r\n                                                    data={bookingsByStatus.filter(s => s.count > 0)}\r\n                                                    cx=\"50%\"\r\n                                                    cy=\"50%\"\r\n                                                    outerRadius={80}\r\n                                                    dataKey=\"count\"\r\n                                                    nameKey=\"name\"\r\n                                                    label={({ name, count }) => `${name}: ${count}`}\r\n                                                >\r\n                                                    {bookingsByStatus.map((entry, index) => (\r\n                                                        <Cell key={entry.name} fill={CHART_COLORS[index % CHART_COLORS.length]} />\r\n                                                    ))}\r\n                                                </Pie>\r\n                                                <Tooltip />\r\n                                            </RechartsPie>\r\n                                        </ResponsiveContainer>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"chart-card\">\r\n                                    <h3><BarChart3 size={18} /> Service Performance</h3>\r\n                                    <div className=\"chart-container\">\r\n                                        <ResponsiveContainer width=\"100%\" height={250}>\r\n                                            <BarChart data={revenueByService}>\r\n                                                <CartesianGrid strokeDasharray=\"3 3\" stroke=\"var(--border-color)\" />\r\n                                                <XAxis dataKey=\"name\" stroke=\"var(--text-secondary)\" angle={-45} textAnchor=\"end\" height={80} />\r\n                                                <YAxis stroke=\"var(--text-secondary)\" />\r\n                                                <Tooltip contentStyle={{ background: 'var(--bg-card)', border: '1px solid var(--border-color)' }} />\r\n                                                <Bar dataKey=\"value\" fill=\"#a855f7\" name=\"Revenue ($)\" />\r\n                                            </BarChart>\r\n                                        </ResponsiveContainer>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Summary Stats */}\r\n                            <div className=\"analytics-summary\">\r\n                                <div className=\"summary-card\">\r\n                                    <h4>Total Revenue (Est.)</h4>\r\n                                    <p className=\"summary-value\">${analyticsData.reduce((acc, d) => acc + d.revenue, 0).toLocaleString()}</p>\r\n                                </div>\r\n                                <div className=\"summary-card\">\r\n                                    <h4>Total Bookings</h4>\r\n                                    <p className=\"summary-value\">{analyticsData.reduce((acc, d) => acc + d.bookings, 0)}</p>\r\n                                </div>\r\n                                <div className=\"summary-card\">\r\n                                    <h4>Avg Daily Revenue</h4>\r\n                                    <p className=\"summary-value\">${Math.round(analyticsData.reduce((acc, d) => acc + d.revenue, 0) / 30)}</p>\r\n                                </div>\r\n                                <div className=\"summary-card\">\r\n                                    <h4>Top Service</h4>\r\n                                    <p className=\"summary-value\">{revenueByService[0]?.name || 'N/A'}</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* BOOKINGS TAB */}\r\n                    {activeTab === 'bookings' && (\r\n                        <div className=\"bookings-section\">\r\n                            <div className=\"section-header table-header-pro\">\r\n                                <h2>All Bookings ({filteredBookings.length} of {bookings.length})</h2>\r\n                                <div className=\"table-actions\">\r\n                                    <div className=\"view-toggle\">\r\n                                        <button\r\n                                            className={`view-btn ${viewMode === 'table' ? 'active' : ''}`}\r\n                                            onClick={() => setViewMode('table')}\r\n                                        >\r\n                                            <Calendar size={16} /> Table\r\n                                        </button>\r\n                                        <button\r\n                                            className={`view-btn ${viewMode === 'calendar' ? 'active' : ''}`}\r\n                                            onClick={() => setViewMode('calendar')}\r\n                                        >\r\n                                            <CalendarDays size={16} /> Calendar\r\n                                        </button>\r\n                                    </div>\r\n                                    <select\r\n                                        value={statusFilter}\r\n                                        onChange={(e) => { setStatusFilter(e.target.value); setCurrentPage(1); }}\r\n                                        className=\"filter-select\"\r\n                                    >\r\n                                        <option value=\"all\">All Statuses</option>\r\n                                        <option value=\"Pending\">Pending</option>\r\n                                        <option value=\"Confirmed\">Confirmed</option>\r\n                                        <option value=\"In Progress\">In Progress</option>\r\n                                        <option value=\"Completed\">Completed</option>\r\n                                        <option value=\"Cancelled\">Cancelled</option>\r\n                                    </select>\r\n                                    <div className=\"search-wrapper\">\r\n                                        <Search className=\"search-icon\" size={18} />\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            placeholder=\"Search bookings...\"\r\n                                            value={searchTerm}\r\n                                            onChange={(e) => { setSearchTerm(e.target.value); setCurrentPage(1); }}\r\n                                            className=\"search-input\"\r\n                                        />\r\n                                    </div>\r\n                                    <Button variant=\"secondary\" onClick={exportToCSV}>\r\n                                        <Download size={16} /> Export CSV\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Advanced Filters Panel */}\r\n                            {showFilters && (\r\n                                <div className=\"filters-panel\">\r\n                                    <div className=\"filter-group\">\r\n                                        <label>Date From</label>\r\n                                        <input\r\n                                            type=\"date\"\r\n                                            value={dateFilter.from}\r\n                                            onChange={(e) => { setDateFilter({ ...dateFilter, from: e.target.value }); setCurrentPage(1); }}\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"filter-group\">\r\n                                        <label>Date To</label>\r\n                                        <input\r\n                                            type=\"date\"\r\n                                            value={dateFilter.to}\r\n                                            onChange={(e) => { setDateFilter({ ...dateFilter, to: e.target.value }); setCurrentPage(1); }}\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"filter-group\">\r\n                                        <label>Status</label>\r\n                                        <select\r\n                                            value={statusFilter}\r\n                                            onChange={(e) => { setStatusFilter(e.target.value); setCurrentPage(1); }}\r\n                                        >\r\n                                            <option value=\"all\">All Statuses</option>\r\n                                            <option value=\"Pending\">Pending</option>\r\n                                            <option value=\"Confirmed\">Confirmed</option>\r\n                                            <option value=\"In Progress\">In Progress</option>\r\n                                            <option value=\"Completed\">Completed</option>\r\n                                            <option value=\"Cancelled\">Cancelled</option>\r\n                                        </select>\r\n                                    </div>\r\n                                    <button\r\n                                        className=\"clear-filters-btn\"\r\n                                        onClick={() => { setDateFilter({ from: '', to: '' }); setStatusFilter('all'); setSearchTerm(''); }}\r\n                                    >\r\n                                        Clear All\r\n                                    </button>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Table View */}\r\n                            {viewMode === 'table' && (\r\n                                <>\r\n                                    <div className=\"table-container\">\r\n                                        <table className=\"data-table\">\r\n                                            <thead>\r\n                                                <tr>\r\n                                                    <th>ID</th>\r\n                                                    <th>Tracking #</th>\r\n                                                    <th>Device</th>\r\n                                                    <th>Customer</th>\r\n                                                    <th>Date</th>\r\n                                                    <th>Status</th>\r\n                                                    <th>Actions</th>\r\n                                                </tr>\r\n                                            </thead>\r\n                                            <tbody>\r\n                                                {paginatedBookings.length > 0 ? (\r\n                                                    paginatedBookings.map(booking => (\r\n                                                        <tr key={booking.id}>\r\n                                                            <td>\r\n                                                                <span className=\"booking-id\">#{booking.id}</span>\r\n                                                            </td>\r\n                                                            <td>\r\n                                                                <span className=\"tracking-number\">{booking.trackingNumber || 'N/A'}</span>\r\n                                                            </td>\r\n                                                            <td>\r\n                                                                <div className=\"device-cell\">\r\n                                                                    <span className=\"device-name\">{getDeviceName(booking.device)}</span>\r\n                                                                    <span className=\"issue-text\">{booking.issue || booking.notes || ''}</span>\r\n                                                                </div>\r\n                                                            </td>\r\n                                                            <td>\r\n                                                                <div className=\"user-cell\">\r\n                                                                    <div className=\"user-avatar-small\">{getCustomerName(booking.customer).charAt(0) || '?'}</div>\r\n                                                                    <div className=\"customer-info-cell\">\r\n                                                                        <span className=\"user-name\">{getCustomerName(booking.customer)}</span>\r\n                                                                        <span className=\"customer-email-cell\">{booking.customer?.email || 'N/A'}</span>\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </td>\r\n                                                            <td>\r\n                                                                <div className=\"date-cell\">\r\n                                                                    <span className=\"date-text\">{getBookingDate(booking)}</span>\r\n                                                                    <span className=\"time-text\">{booking.timeSlot?.name || booking.scheduledStart || booking.time || ''}</span>\r\n                                                                </div>\r\n                                                            </td>\r\n                                                            <td>\r\n                                                                <select\r\n                                                                    value={booking.status}\r\n                                                                    onChange={(e) => handleStatusChange(booking.id, e.target.value)}\r\n                                                                    className={`status-select-pro ${booking.status?.toLowerCase().replace(' ', '-')}`}\r\n                                                                >\r\n                                                                    <option value=\"Pending\">Pending</option>\r\n                                                                    <option value=\"Confirmed\">Confirmed</option>\r\n                                                                    <option value=\"In Progress\">In Progress</option>\r\n                                                                    <option value=\"Completed\">Completed</option>\r\n                                                                    <option value=\"Cancelled\">Cancelled</option>\r\n                                                                </select>\r\n                                                            </td>\r\n                                                            <td>\r\n                                                                <div className=\"action-buttons\">\r\n                                                                    <button className=\"icon-btn danger\" onClick={() => handleDeleteBooking(booking.id)} title=\"Delete\">\r\n                                                                        <Trash2 size={14} />\r\n                                                                    </button>\r\n                                                                </div>\r\n                                                            </td>\r\n                                                        </tr>\r\n                                                    ))\r\n                                                ) : (\r\n                                                    <tr>\r\n                                                        <td colSpan=\"7\" className=\"empty-message\">\r\n                                                            {searchTerm || statusFilter !== 'all' || dateFilter.from || dateFilter.to\r\n                                                                ? 'No bookings found matching your filters'\r\n                                                                : 'No bookings available'}\r\n                                                        </td>\r\n                                                    </tr>\r\n                                                )}\r\n                                            </tbody>\r\n                                        </table>\r\n                                    </div>\r\n\r\n                                    {/* Pagination */}\r\n                                    {totalPages > 1 && (\r\n                                        <div className=\"pagination\">\r\n                                            <span className=\"pagination-info\">\r\n                                                Showing {((currentPage - 1) * itemsPerPage) + 1}-{Math.min(currentPage * itemsPerPage, filteredBookings.length)} of {filteredBookings.length}\r\n                                            </span>\r\n                                            <div className=\"pagination-controls\">\r\n                                                <button\r\n                                                    className=\"pagination-btn\"\r\n                                                    onClick={() => setCurrentPage(p => Math.max(1, p - 1))}\r\n                                                    disabled={currentPage === 1}\r\n                                                >\r\n                                                    <ChevronLeft size={16} />\r\n                                                </button>\r\n                                                {Array.from({ length: totalPages }, (_, i) => i + 1).map(page => (\r\n                                                    <button\r\n                                                        key={page}\r\n                                                        className={`pagination-btn ${currentPage === page ? 'active' : ''}`}\r\n                                                        onClick={() => setCurrentPage(page)}\r\n                                                    >\r\n                                                        {page}\r\n                                                    </button>\r\n                                                ))}\r\n                                                <button\r\n                                                    className=\"pagination-btn\"\r\n                                                    onClick={() => setCurrentPage(p => Math.min(totalPages, p + 1))}\r\n                                                    disabled={currentPage === totalPages}\r\n                                                >\r\n                                                    <ChevronRight size={16} />\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </>\r\n                            )}\r\n\r\n                            {/* Calendar View */}\r\n                            {viewMode === 'calendar' && (\r\n                                <div className=\"calendar-view\">\r\n                                    <div className=\"calendar-header\">\r\n                                        <button onClick={() => setCalendarMonth(new Date(calendarMonth.getFullYear(), calendarMonth.getMonth() - 1))}>\r\n                                            <ChevronLeft size={20} />\r\n                                        </button>\r\n                                        <h3>{calendarMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}</h3>\r\n                                        <button onClick={() => setCalendarMonth(new Date(calendarMonth.getFullYear(), calendarMonth.getMonth() + 1))}>\r\n                                            <ChevronRight size={20} />\r\n                                        </button>\r\n                                    </div>\r\n                                    <div className=\"calendar-grid\">\r\n                                        <div className=\"calendar-day-header\">Sun</div>\r\n                                        <div className=\"calendar-day-header\">Mon</div>\r\n                                        <div className=\"calendar-day-header\">Tue</div>\r\n                                        <div className=\"calendar-day-header\">Wed</div>\r\n                                        <div className=\"calendar-day-header\">Thu</div>\r\n                                        <div className=\"calendar-day-header\">Fri</div>\r\n                                        <div className=\"calendar-day-header\">Sat</div>\r\n                                        {getDaysInMonth(calendarMonth).map((day, index) => {\r\n                                            const dayBookings = day ? getBookingsForDate(day) : [];\r\n                                            const isToday = day && day.toDateString() === new Date().toDateString();\r\n                                            return (\r\n                                                <div key={index} className={`calendar-day ${!day ? 'empty' : ''} ${isToday ? 'today' : ''}`}>\r\n                                                    {day && (\r\n                                                        <>\r\n                                                            <span className=\"day-number\">{day.getDate()}</span>\r\n                                                            {dayBookings.length > 0 && (\r\n                                                                <div className=\"day-bookings\">\r\n                                                                    {dayBookings.slice(0, 2).map(b => (\r\n                                                                        <div key={b.id} className={`booking-chip ${b.status?.toLowerCase().replace(' ', '-')}`}>\r\n                                                                            {getDeviceName(b.device)}\r\n                                                                        </div>\r\n                                                                    ))}\r\n                                                                    {dayBookings.length > 2 && (\r\n                                                                        <div className=\"booking-chip more\">+{dayBookings.length - 2} more</div>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                            )}\r\n                                                        </>\r\n                                                    )}\r\n                                                </div>\r\n                                            );\r\n                                        })}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* USERS TAB */}\r\n                    {activeTab === 'employees' && (\r\n                        <div className=\"users-section\">\r\n                            <div className=\"section-header table-header-pro\">\r\n                                <h2>User Management ({getFilteredUsers().length} of {employees.length})</h2>\r\n                                <div className=\"table-actions\">\r\n                                    <div className=\"search-wrapper\">\r\n                                        <Search className=\"search-icon\" size={18} />\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            placeholder=\"Search users...\"\r\n                                            value={userSearch}\r\n                                            onChange={(e) => setUserSearch(e.target.value)}\r\n                                            className=\"search-input\"\r\n                                        />\r\n                                    </div>\r\n                                    <select\r\n                                        value={userRoleFilter}\r\n                                        onChange={(e) => setUserRoleFilter(e.target.value)}\r\n                                        className=\"filter-select\"\r\n                                    >\r\n                                        <option value=\"all\">All Roles</option>\r\n                                        <option value=\"admin\">Administrator</option>\r\n                                        <option value=\"technician\">Technician</option>\r\n                                        <option value=\"support\">Support</option>\r\n                                        <option value=\"inventory\">Inventory</option>\r\n                                        <option value=\"sales\">Sales</option>\r\n                                    </select>\r\n                                    <Button variant=\"secondary\" onClick={exportUsersCSV}>\r\n                                        <Download size={16} /> Export CSV\r\n                                    </Button>\r\n                                    <Button variant=\"primary\" onClick={() => { setEditingItem(null); setShowUserModal(true); }}>\r\n                                        <UserPlus size={16} /> Add User\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"table-container\">\r\n                                <table className=\"data-table\">\r\n                                    <thead>\r\n                                        <tr>\r\n                                            <th>User</th>\r\n                                            <th>Username</th>\r\n                                            <th>Email</th>\r\n                                            <th>Role</th>\r\n                                            <th>Actions</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {getFilteredUsers().map(emp => (\r\n                                            <tr key={emp.id}>\r\n                                                <td>\r\n                                                    <div className=\"user-cell\">\r\n                                                        <div className=\"user-avatar-small\">{emp.name?.charAt(0) || '?'}</div>\r\n                                                        <span className=\"user-name\">{emp.name}</span>\r\n                                                    </div>\r\n                                                </td>\r\n                                                <td className=\"username-cell\">@{emp.username}</td>\r\n                                                <td>{emp.email}</td>\r\n                                                <td>\r\n                                                    <span className={`role-badge ${emp.role}`}>{emp.role}</span>\r\n                                                </td>\r\n                                                <td>\r\n                                                    <div className=\"action-buttons\">\r\n                                                        <button className=\"icon-btn\" onClick={() => { setEditingItem(emp); setShowUserModal(true); }} title=\"Edit\">\r\n                                                            <Edit2 size={14} />\r\n                                                        </button>\r\n                                                        <button className=\"icon-btn\" onClick={() => handleResetPassword(emp.id)} title=\"Reset Password\">\r\n                                                            <RefreshCw size={14} />\r\n                                                        </button>\r\n                                                        <button className=\"icon-btn danger\" onClick={() => handleDeleteUser(emp.id)} title=\"Delete\">\r\n                                                            <Trash2 size={14} />\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </td>\r\n                                            </tr>\r\n                                        ))}\r\n                                        {getFilteredUsers().length === 0 && (\r\n                                            <tr>\r\n                                                <td colSpan=\"5\" className=\"empty-message\">No users found matching your criteria.</td>\r\n                                            </tr>\r\n                                        )}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* SERVICES TAB */}\r\n                    {activeTab === 'services' && (\r\n                        <div className=\"services-section\">\r\n                            <div className=\"section-header table-header-pro\">\r\n                                <h2>Service Management ({getFilteredServices().length} of {services.length})</h2>\r\n                                <div className=\"table-actions\">\r\n                                    <div className=\"search-wrapper\">\r\n                                        <Search className=\"search-icon\" size={18} />\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            placeholder=\"Search services...\"\r\n                                            value={serviceSearch}\r\n                                            onChange={(e) => setServiceSearch(e.target.value)}\r\n                                            className=\"search-input\"\r\n                                        />\r\n                                    </div>\r\n                                    <select\r\n                                        value={serviceCategoryFilter}\r\n                                        onChange={(e) => setServiceCategoryFilter(e.target.value)}\r\n                                        className=\"filter-select\"\r\n                                    >\r\n                                        <option value=\"all\">All Categories</option>\r\n                                        <option value=\"phone\">Phone</option>\r\n                                        <option value=\"computer\">Computer</option>\r\n                                        <option value=\"both\">Both</option>\r\n                                    </select>\r\n                                    <Button variant=\"secondary\" onClick={exportServicesCSV}>\r\n                                        <Download size={16} /> Export CSV\r\n                                    </Button>\r\n                                    <Button variant=\"primary\" onClick={() => { setEditingItem(null); setShowServiceModal(true); }}>\r\n                                        <Plus size={16} /> Add Service\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"table-container\">\r\n                                <table className=\"data-table\">\r\n                                    <thead>\r\n                                        <tr>\r\n                                            <th>Service Name</th>\r\n                                            <th>Description</th>\r\n                                            <th>Price Range</th>\r\n                                            <th>Category</th>\r\n                                            <th>Status</th>\r\n                                            <th>Actions</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {getFilteredServices().map(service => (\r\n                                            <tr key={service.id} className={!service.active ? 'inactive-row' : ''}>\r\n                                                <td className=\"service-name-cell\">{service.name}</td>\r\n                                                <td className=\"description-cell\">{service.description}</td>\r\n                                                <td className=\"price-cell\">${service.priceMin} - ${service.priceMax}</td>\r\n                                                <td><span className={`category-badge ${service.category}`}>{service.category}</span></td>\r\n                                                <td>\r\n                                                    <button\r\n                                                        className={`toggle-btn-small ${service.active ? 'active' : ''}`}\r\n                                                        onClick={() => handleToggleService(service.id)}\r\n                                                    >\r\n                                                        {service.active ? 'Active' : 'Inactive'}\r\n                                                    </button>\r\n                                                </td>\r\n                                                <td>\r\n                                                    <div className=\"action-buttons\">\r\n                                                        <button className=\"icon-btn\" onClick={() => { setEditingItem(service); setShowServiceModal(true); }} title=\"Edit\">\r\n                                                            <Edit2 size={14} />\r\n                                                        </button>\r\n                                                        <button className=\"icon-btn danger\" onClick={() => handleDeleteService(service.id)} title=\"Delete\">\r\n                                                            <Trash2 size={14} />\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </td>\r\n                                            </tr>\r\n                                        ))}\r\n                                        {getFilteredServices().length === 0 && (\r\n                                            <tr>\r\n                                                <td colSpan=\"6\" className=\"empty-message\">No services found matching your criteria.</td>\r\n                                            </tr>\r\n                                        )}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* CUSTOMERS TAB */}\r\n                    {activeTab === 'customers' && (\r\n                        <div className=\"customers-section\">\r\n                            <div className=\"section-header table-header-pro\">\r\n                                <h2>Customer Management ({getFilteredCustomers().length} of {customers.length})</h2>\r\n                                <div className=\"table-actions\">\r\n                                    <div className=\"search-wrapper\">\r\n                                        <Search className=\"search-icon\" size={18} />\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            placeholder=\"Search customers...\"\r\n                                            value={customerSearch}\r\n                                            onChange={(e) => setCustomerSearch(e.target.value)}\r\n                                            className=\"search-input\"\r\n                                        />\r\n                                    </div>\r\n                                    <Button variant=\"secondary\" onClick={exportCustomersCSV}>\r\n                                        <Download size={16} /> Export CSV\r\n                                    </Button>\r\n                                    <Button variant=\"primary\" onClick={() => { setEditingItem(null); setShowCustomerModal(true); }}>\r\n                                        <UserPlus size={16} /> Add Customer\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"table-container\">\r\n                                <table className=\"data-table\">\r\n                                    <thead>\r\n                                        <tr>\r\n                                            <th>Customer</th>\r\n                                            <th>Email</th>\r\n                                            <th>Phone</th>\r\n                                            <th>Bookings</th>\r\n                                            <th>Total Spent</th>\r\n                                            <th>Tags</th>\r\n                                            <th>Portal Account</th>\r\n                                            <th>Actions</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {getFilteredCustomers().map(customer => (\r\n                                            <tr key={customer.id}>\r\n                                                <td>\r\n                                                    <div className=\"user-cell\">\r\n                                                        <div className=\"user-avatar-small\">{customer.name?.charAt(0) || '?'}</div>\r\n                                                        <span className=\"user-name\">{customer.name}</span>\r\n                                                    </div>\r\n                                                </td>\r\n                                                <td>{customer.email}</td>\r\n                                                <td>{customer.phone}</td>\r\n                                                <td className=\"center-cell\">{customer.totalBookings}</td>\r\n                                                <td className=\"amount\">${customer.totalSpent}</td>\r\n                                                <td>\r\n                                                    <div className=\"tags-cell\">\r\n                                                        {customer.tags?.slice(0, 2).map(tag => (\r\n                                                            <span key={tag} className={`customer-tag ${tag}`}>{tag}</span>\r\n                                                        ))}\r\n                                                        {customer.tags?.length > 2 && <span className=\"more-tags\">+{customer.tags.length - 2}</span>}\r\n                                                    </div>\r\n                                                </td>\r\n                                                <td>\r\n                                                    {customer.hasAccount ? (\r\n                                                        <span className=\"account-badge active\" title={`Username: @${customer.username}`}>\r\n                                                            <CheckCircle size={12} /> @{customer.username}\r\n                                                        </span>\r\n                                                    ) : (\r\n                                                        <span className=\"account-badge inactive\">No Account</span>\r\n                                                    )}\r\n                                                </td>\r\n                                                <td>\r\n                                                    <div className=\"action-buttons\">\r\n                                                        <button className=\"icon-btn\" onClick={() => { setEditingItem(customer); setShowCustomerModal(true); }} title=\"Edit\">\r\n                                                            <Edit2 size={14} />\r\n                                                        </button>\r\n                                                        {customer.hasAccount && (\r\n                                                            <button className=\"icon-btn\" onClick={() => handleResetCustomerPassword(customer)} title=\"Reset Password\">\r\n                                                                <RefreshCw size={14} />\r\n                                                            </button>\r\n                                                        )}\r\n                                                        <button className=\"icon-btn danger\" onClick={() => handleDeleteCustomer(customer.id)} title=\"Delete\">\r\n                                                            <Trash2 size={14} />\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </td>\r\n                                            </tr>\r\n                                        ))}\r\n                                        {getFilteredCustomers().length === 0 && (\r\n                                            <tr>\r\n                                                <td colSpan=\"8\" className=\"empty-message\">No customers found matching your criteria.</td>\r\n                                            </tr>\r\n                                        )}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* INVENTORY TAB */}\r\n                    {activeTab === 'inventory' && (\r\n                        <div className=\"inventory-section\">\r\n                            <div className=\"section-header\">\r\n                                <h2>Inventory Management</h2>\r\n                                <div className=\"inventory-tabs\">\r\n                                    <button\r\n                                        className={`inv-tab-btn ${inventoryViewMode === 'items' ? 'active' : ''}`}\r\n                                        onClick={() => setInventoryViewMode('items')}\r\n                                    >\r\n                                        <Package size={16} /> Items\r\n                                    </button>\r\n                                    <button\r\n                                        className={`inv-tab-btn ${inventoryViewMode === 'orders' ? 'active' : ''}`}\r\n                                        onClick={() => setInventoryViewMode('orders')}\r\n                                    >\r\n                                        <FileText size={16} /> Purchase Orders\r\n                                        {purchaseOrders.filter(o => o.status === 'Submitted').length > 0 && (\r\n                                            <span className=\"badge-small\">{purchaseOrders.filter(o => o.status === 'Submitted').length}</span>\r\n                                        )}\r\n                                    </button>\r\n                                    <button\r\n                                        className={`inv-tab-btn ${inventoryViewMode === 'analytics' ? 'active' : ''}`}\r\n                                        onClick={() => setInventoryViewMode('analytics')}\r\n                                    >\r\n                                        <BarChart3 size={16} /> Analytics\r\n                                    </button>\r\n                                </div>\r\n                                {inventoryViewMode === 'items' && (\r\n                                    <Button variant=\"primary\" onClick={() => { setEditingItem(null); setShowInventoryModal(true); }}>\r\n                                        <Plus size={16} /> Add Item\r\n                                    </Button>\r\n                                )}\r\n                                {inventoryViewMode === 'orders' && (\r\n                                    <Button variant=\"primary\" onClick={() => { setEditingItem(null); setShowPurchaseOrderModal(true); }}>\r\n                                        <Plus size={16} /> New PO\r\n                                    </Button>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Reorder Alerts Banner */}\r\n                            {reorderAlerts.length > 0 && inventoryViewMode === 'items' && (\r\n                                <div className=\"reorder-alerts-banner\">\r\n                                    <div className=\"alert-header\">\r\n                                        <AlertTriangle size={18} />\r\n                                        <span><strong>{reorderAlerts.length}</strong> items need reordering</span>\r\n                                    </div>\r\n                                    <div className=\"alert-items\">\r\n                                        {reorderAlerts.slice(0, 3).map(item => (\r\n                                            <span key={item.id} className={`alert-item ${item.urgency}`}>\r\n                                                {item.name} ({item.quantity} left)\r\n                                            </span>\r\n                                        ))}\r\n                                        {reorderAlerts.length > 3 && <span className=\"more-items\">+{reorderAlerts.length - 3} more</span>}\r\n                                    </div>\r\n                                    <Button variant=\"secondary\" onClick={handleCreatePOFromReorderAlerts}>\r\n                                        <FileText size={14} /> Create PO from Alerts\r\n                                    </Button>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Items View */}\r\n                            {inventoryViewMode === 'items' && (\r\n                                <div className=\"inventory-grid\">\r\n                                    {inventory.map(item => {\r\n                                        const isLowStock = item.quantity <= item.minStock;\r\n                                        return (\r\n                                            <div key={item.id} className={`inventory-card ${isLowStock ? 'low-stock' : ''}`}>\r\n                                                <div className=\"inventory-header\">\r\n                                                    <h3>{item.name}</h3>\r\n                                                    <span className=\"sku-badge\">{item.sku}</span>\r\n                                                </div>\r\n                                                <div className=\"inventory-details\">\r\n                                                    <p><strong>Category:</strong> {item.category}</p>\r\n                                                    <p><strong>Cost:</strong> ${item.cost}</p>\r\n                                                    <p><strong>Supplier:</strong> {item.supplier}</p>\r\n                                                    <p><strong>Last Restocked:</strong> {item.lastRestocked}</p>\r\n                                                </div>\r\n                                                <div className=\"inventory-stock\">\r\n                                                    <div className=\"stock-level\">\r\n                                                        <span className={`stock-count ${isLowStock ? 'low' : 'ok'}`}>\r\n                                                            {item.quantity}\r\n                                                        </span>\r\n                                                        <span className=\"stock-label\">in stock (min: {item.minStock})</span>\r\n                                                    </div>\r\n                                                    <div className=\"stock-controls\">\r\n                                                        <button\r\n                                                            className=\"stock-btn minus\"\r\n                                                            onClick={() => handleAdjustStock(item.id, -1)}\r\n                                                            disabled={item.quantity === 0}\r\n                                                        >\r\n                                                            <Minus size={14} />\r\n                                                        </button>\r\n                                                        <button\r\n                                                            className=\"stock-btn plus\"\r\n                                                            onClick={() => handleAdjustStock(item.id, 1)}\r\n                                                        >\r\n                                                            <Plus size={14} />\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"inventory-actions\">\r\n                                                    <button className=\"icon-btn\" onClick={() => { setEditingItem(item); setShowInventoryModal(true); }}>\r\n                                                        <Edit2 size={14} />\r\n                                                    </button>\r\n                                                    <button className=\"icon-btn danger\" onClick={() => handleDeleteInventory(item.id)}>\r\n                                                        <Trash2 size={14} />\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n                                        );\r\n                                    })}\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Purchase Orders View */}\r\n                            {inventoryViewMode === 'orders' && (\r\n                                <div className=\"purchase-orders-section\">\r\n                                    <table className=\"po-table\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th>PO #</th>\r\n                                                <th>Date</th>\r\n                                                <th>Supplier</th>\r\n                                                <th>Items</th>\r\n                                                <th>Total</th>\r\n                                                <th>Status</th>\r\n                                                <th>Actions</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {purchaseOrders.map(order => (\r\n                                                <tr key={order.id}>\r\n                                                    <td><strong>{order.id}</strong></td>\r\n                                                    <td>{order.date}</td>\r\n                                                    <td>{order.supplier}</td>\r\n                                                    <td>\r\n                                                        <span className=\"item-count\">{order.items.length} items</span>\r\n                                                        <div className=\"item-preview\">\r\n                                                            {order.items.slice(0, 2).map(i => i.name).join(', ')}\r\n                                                            {order.items.length > 2 && '...'}\r\n                                                        </div>\r\n                                                    </td>\r\n                                                    <td><strong>${order.total.toLocaleString()}</strong></td>\r\n                                                    <td>\r\n                                                        <span className={`po-status ${order.status.toLowerCase()}`}>\r\n                                                            {order.status === 'Draft' && <Edit2 size={12} />}\r\n                                                            {order.status === 'Submitted' && <Send size={12} />}\r\n                                                            {order.status === 'Received' && <PackageCheck size={12} />}\r\n                                                            {order.status === 'Cancelled' && <XCircle size={12} />}\r\n                                                            {order.status}\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <div className=\"po-actions\">\r\n                                                            {order.status === 'Draft' && (\r\n                                                                <>\r\n                                                                    <button className=\"po-action-btn submit\" onClick={() => handleSubmitPurchaseOrder(order.id)} title=\"Submit\">\r\n                                                                        <Send size={14} />\r\n                                                                    </button>\r\n                                                                    <button className=\"po-action-btn edit\" onClick={() => { setEditingItem(order); setShowPurchaseOrderModal(true); }} title=\"Edit\">\r\n                                                                        <Edit2 size={14} />\r\n                                                                    </button>\r\n                                                                </>\r\n                                                            )}\r\n                                                            {order.status === 'Submitted' && (\r\n                                                                <>\r\n                                                                    <button className=\"po-action-btn receive\" onClick={() => handleReceivePurchaseOrder(order.id)} title=\"Mark Received\">\r\n                                                                        <PackageCheck size={14} />\r\n                                                                    </button>\r\n                                                                    <button className=\"po-action-btn cancel\" onClick={() => handleCancelPurchaseOrder(order.id)} title=\"Cancel\">\r\n                                                                        <XCircle size={14} />\r\n                                                                    </button>\r\n                                                                </>\r\n                                                            )}\r\n                                                            {(order.status === 'Received' || order.status === 'Cancelled') && (\r\n                                                                <button className=\"po-action-btn delete\" onClick={() => handleDeletePurchaseOrder(order.id)} title=\"Delete\">\r\n                                                                    <Trash2 size={14} />\r\n                                                                </button>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </td>\r\n                                                </tr>\r\n                                            ))}\r\n                                            {purchaseOrders.length === 0 && (\r\n                                                <tr>\r\n                                                    <td colSpan=\"7\" className=\"no-data\">No purchase orders yet</td>\r\n                                                </tr>\r\n                                            )}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Analytics View */}\r\n                            {inventoryViewMode === 'analytics' && inventoryAnalytics && (\r\n                                <div className=\"inventory-analytics\">\r\n                                    <div className=\"inv-stats-row\">\r\n                                        <div className=\"inv-stat-card\">\r\n                                            <DollarSign size={24} />\r\n                                            <div>\r\n                                                <span className=\"stat-value\">${inventoryAnalytics.totalValue.toLocaleString()}</span>\r\n                                                <span className=\"stat-label\">Total Inventory Value</span>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"inv-stat-card\">\r\n                                            <Layers size={24} />\r\n                                            <div>\r\n                                                <span className=\"stat-value\">{inventoryAnalytics.totalItems}</span>\r\n                                                <span className=\"stat-label\">Total SKUs</span>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"inv-stat-card\">\r\n                                            <TrendingDown size={24} />\r\n                                            <div>\r\n                                                <span className=\"stat-value\">${inventoryAnalytics.totalSpent.toLocaleString()}</span>\r\n                                                <span className=\"stat-label\">Spent on Orders (MTD)</span>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"inv-stat-card\">\r\n                                            <FileText size={24} />\r\n                                            <div>\r\n                                                <span className=\"stat-value\">{inventoryAnalytics.pendingOrders}</span>\r\n                                                <span className=\"stat-label\">Pending Orders</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"inv-charts-row\">\r\n                                        <div className=\"chart-card\">\r\n                                            <h3><PieChart size={18} /> Value by Category</h3>\r\n                                            <div className=\"chart-container\">\r\n                                                <ResponsiveContainer width=\"100%\" height={250}>\r\n                                                    <RechartsPie>\r\n                                                        <Pie\r\n                                                            data={inventoryAnalytics.valueByCategory}\r\n                                                            cx=\"50%\"\r\n                                                            cy=\"50%\"\r\n                                                            outerRadius={80}\r\n                                                            dataKey=\"value\"\r\n                                                            nameKey=\"name\"\r\n                                                            label={({ name, value }) => `${name}: $${value}`}\r\n                                                        >\r\n                                                            {inventoryAnalytics.valueByCategory.map((entry, index) => (\r\n                                                                <Cell key={entry.name} fill={CHART_COLORS[index % CHART_COLORS.length]} />\r\n                                                            ))}\r\n                                                        </Pie>\r\n                                                        <Tooltip formatter={(value) => `$${value}`} />\r\n                                                    </RechartsPie>\r\n                                                </ResponsiveContainer>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"chart-card\">\r\n                                            <h3><BarChart3 size={18} /> Stock Level Distribution</h3>\r\n                                            <div className=\"stock-distribution\">\r\n                                                <div className=\"stock-bar\">\r\n                                                    <div className=\"bar-segment critical\" style={{ width: `${(inventoryAnalytics.stockLevels.critical / inventoryAnalytics.totalItems) * 100}%` }}></div>\r\n                                                    <div className=\"bar-segment low\" style={{ width: `${(inventoryAnalytics.stockLevels.low / inventoryAnalytics.totalItems) * 100}%` }}></div>\r\n                                                    <div className=\"bar-segment adequate\" style={{ width: `${(inventoryAnalytics.stockLevels.adequate / inventoryAnalytics.totalItems) * 100}%` }}></div>\r\n                                                    <div className=\"bar-segment high\" style={{ width: `${(inventoryAnalytics.stockLevels.high / inventoryAnalytics.totalItems) * 100}%` }}></div>\r\n                                                </div>\r\n                                                <div className=\"stock-legend\">\r\n                                                    <span><span className=\"dot critical\"></span> Out of Stock ({inventoryAnalytics.stockLevels.critical})</span>\r\n                                                    <span><span className=\"dot low\"></span> Low ({inventoryAnalytics.stockLevels.low})</span>\r\n                                                    <span><span className=\"dot adequate\"></span> Adequate ({inventoryAnalytics.stockLevels.adequate})</span>\r\n                                                    <span><span className=\"dot high\"></span> High ({inventoryAnalytics.stockLevels.high})</span>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"chart-card\">\r\n                                            <h3><TrendingUp size={18} /> Top Moving Items</h3>\r\n                                            <div className=\"top-items-list\">\r\n                                                {inventoryAnalytics.topMoving.map((item, index) => (\r\n                                                    <div key={item.name} className=\"top-item\">\r\n                                                        <span className=\"rank\">#{index + 1}</span>\r\n                                                        <span className=\"name\">{item.name}</span>\r\n                                                        <span className=\"usage\">{item.avgUsage.toFixed(1)}/week avg</span>\r\n                                                    </div>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* WEBSITE CONTENT TAB */}\r\n                    {activeTab === 'content' && websiteContent && (\r\n                        <div className=\"content-editor-section\">\r\n                            <div className=\"content-tabs\">\r\n                                <button className={`content-tab ${activeContentSection === 'hero' ? 'active' : ''}`} onClick={() => setActiveContentSection('hero')}>Hero</button>\r\n                                <button className={`content-tab ${activeContentSection === 'services' ? 'active' : ''}`} onClick={() => setActiveContentSection('services')}>Services</button>\r\n                                <button className={`content-tab ${activeContentSection === 'howItWorks' ? 'active' : ''}`} onClick={() => setActiveContentSection('howItWorks')}>How It Works</button>\r\n                                <button className={`content-tab ${activeContentSection === 'whyChooseUs' ? 'active' : ''}`} onClick={() => setActiveContentSection('whyChooseUs')}>Why Choose Us</button>\r\n                                <button className={`content-tab ${activeContentSection === 'cta' ? 'active' : ''}`} onClick={() => setActiveContentSection('cta')}>CTAs</button>\r\n                                <button className={`content-tab ${activeContentSection === 'contact' ? 'active' : ''}`} onClick={() => setActiveContentSection('contact')}>Contact</button>\r\n                                <button className={`content-tab ${activeContentSection === 'legal' ? 'active' : ''}`} onClick={() => setActiveContentSection('legal')}>Legal Pages</button>\r\n                            </div>\r\n\r\n                            <div className=\"content-editor-panel\">\r\n                                {/* HERO SECTION EDITOR */}\r\n                                {activeContentSection === 'hero' && (\r\n                                    <div className=\"editor-card professional-cms\">\r\n                                        <div className=\"cms-header\">\r\n                                            <div className=\"cms-header-icon\" style={{ background: 'rgba(59, 130, 246, 0.15)', color: '#3b82f6' }}>\r\n                                                <Layers size={24} />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3>Hero Section</h3>\r\n                                                <p className=\"editor-description\">Customize the main hero banner that visitors see first on your homepage.</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"cms-content\">\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><Edit2 size={16} /> Headlines</h4>\r\n                                                </div>\r\n                                                <div className=\"cms-form-grid\">\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Main Title</label>\r\n                                                        <input type=\"text\" value={websiteContent.hero?.title || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, hero: { ...websiteContent.hero, title: e.target.value } })} placeholder=\"Enter main headline...\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Subtitle</label>\r\n                                                        <input type=\"text\" value={websiteContent.hero?.subtitle || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, hero: { ...websiteContent.hero, subtitle: e.target.value } })} placeholder=\"Enter subtitle...\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group full-width\">\r\n                                                        <label><Edit2 size={14} /> Description</label>\r\n                                                        <textarea rows={3} value={websiteContent.hero?.description || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, hero: { ...websiteContent.hero, description: e.target.value } })} placeholder=\"Enter hero description...\" />\r\n                                                        <span className=\"char-count\">{(websiteContent.hero?.description || '').length} characters</span>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><Plus size={16} /> Action Buttons</h4>\r\n                                                </div>\r\n                                                <div className=\"cms-form-grid\">\r\n                                                    <div className=\"form-row\">\r\n                                                        <div className=\"form-group\">\r\n                                                            <label>Primary Button Text</label>\r\n                                                            <input type=\"text\" value={websiteContent.hero?.primaryButtonText || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, hero: { ...websiteContent.hero, primaryButtonText: e.target.value } })} placeholder=\"e.g., Book Repair Now\" />\r\n                                                        </div>\r\n                                                        <div className=\"form-group\">\r\n                                                            <label>Secondary Button Text</label>\r\n                                                            <input type=\"text\" value={websiteContent.hero?.secondaryButtonText || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, hero: { ...websiteContent.hero, secondaryButtonText: e.target.value } })} placeholder=\"e.g., Get Quote\" />\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-actions\">\r\n                                                <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"btn-preview\"><Eye size={16} /> Preview</a>\r\n                                                <button className=\"btn-save-cms\" onClick={() => handleSaveContent('hero', websiteContent.hero)} disabled={contentSaving}>\r\n                                                    {contentSaving ? 'Saving...' : <><CheckCircle size={18} /> Save Hero Section</>}\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* SERVICES SECTION EDITOR */}\r\n                                {activeContentSection === 'services' && (\r\n                                    <div className=\"editor-card professional-cms\">\r\n                                        <div className=\"cms-header\">\r\n                                            <div className=\"cms-header-icon\" style={{ background: 'rgba(139, 92, 246, 0.15)', color: '#8b5cf6' }}>\r\n                                                <Settings size={24} />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3>Services Section</h3>\r\n                                                <p className=\"editor-description\">Manage the service cards displayed on your homepage.</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"cms-content\">\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><Edit2 size={16} /> Section Header</h4>\r\n                                                </div>\r\n                                                <div className=\"cms-form-grid\">\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Section Title</label>\r\n                                                        <input type=\"text\" value={websiteContent.services?.sectionTitle || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, services: { ...websiteContent.services, sectionTitle: e.target.value } })} placeholder=\"Enter section title...\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group full-width\">\r\n                                                        <label><Edit2 size={14} /> Section Subtitle</label>\r\n                                                        <textarea rows={2} value={websiteContent.services?.sectionSubtitle || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, services: { ...websiteContent.services, sectionSubtitle: e.target.value } })} placeholder=\"Enter section subtitle...\" />\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><Package size={16} /> Service Cards</h4>\r\n                                                    <span className=\"section-badge\">{websiteContent.services?.cards?.length || 0} cards</span>\r\n                                                </div>\r\n                                                <div className=\"cms-cards-list\">\r\n                                                    {websiteContent.services?.cards?.map((card, idx) => (\r\n                                                        <div key={idx} className=\"cms-card-editor\">\r\n                                                            <div className=\"cms-card-header\">\r\n                                                                <span className=\"card-number\">Card {idx + 1}</span>\r\n                                                            </div>\r\n                                                            <div className=\"cms-form-grid\">\r\n                                                                <div className=\"form-group\">\r\n                                                                    <label>Title</label>\r\n                                                                    <input type=\"text\" value={card.title} onChange={(e) => {\r\n                                                                        const newCards = [...websiteContent.services.cards];\r\n                                                                        newCards[idx] = { ...newCards[idx], title: e.target.value };\r\n                                                                        setWebsiteContent({ ...websiteContent, services: { ...websiteContent.services, cards: newCards } });\r\n                                                                    }} placeholder=\"Service title...\" />\r\n                                                                </div>\r\n                                                                <div className=\"form-group full-width\">\r\n                                                                    <label>Description</label>\r\n                                                                    <textarea rows={2} value={card.description} onChange={(e) => {\r\n                                                                        const newCards = [...websiteContent.services.cards];\r\n                                                                        newCards[idx] = { ...newCards[idx], description: e.target.value };\r\n                                                                        setWebsiteContent({ ...websiteContent, services: { ...websiteContent.services, cards: newCards } });\r\n                                                                    }} placeholder=\"Service description...\" />\r\n                                                                </div>\r\n                                                                <div className=\"form-group full-width\">\r\n                                                                    <label>Image URL</label>\r\n                                                                    <input type=\"text\" value={card.image} onChange={(e) => {\r\n                                                                        const newCards = [...websiteContent.services.cards];\r\n                                                                        newCards[idx] = { ...newCards[idx], image: e.target.value };\r\n                                                                        setWebsiteContent({ ...websiteContent, services: { ...websiteContent.services, cards: newCards } });\r\n                                                                    }} placeholder=\"/path/to/image.png\" />\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-actions\">\r\n                                                <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"btn-preview\"><Eye size={16} /> Preview</a>\r\n                                                <button className=\"btn-save-cms\" onClick={() => handleSaveContent('services', websiteContent.services)} disabled={contentSaving}>\r\n                                                    {contentSaving ? 'Saving...' : <><CheckCircle size={18} /> Save Services</>}\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* HOW IT WORKS EDITOR */}\r\n                                {activeContentSection === 'howItWorks' && (\r\n                                    <div className=\"editor-card professional-cms\">\r\n                                        <div className=\"cms-header\">\r\n                                            <div className=\"cms-header-icon\" style={{ background: 'rgba(16, 185, 129, 0.15)', color: '#10b981' }}>\r\n                                                <Activity size={24} />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3>How It Works Section</h3>\r\n                                                <p className=\"editor-description\">Edit the step-by-step process shown to customers.</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"cms-content\">\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><Edit2 size={16} /> Section Header</h4>\r\n                                                </div>\r\n                                                <div className=\"cms-form-grid\">\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Section Title</label>\r\n                                                        <input type=\"text\" value={websiteContent.howItWorks?.sectionTitle || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, howItWorks: { ...websiteContent.howItWorks, sectionTitle: e.target.value } })} placeholder=\"Enter section title...\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Section Subtitle</label>\r\n                                                        <input type=\"text\" value={websiteContent.howItWorks?.sectionSubtitle || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, howItWorks: { ...websiteContent.howItWorks, sectionSubtitle: e.target.value } })} placeholder=\"Enter section subtitle...\" />\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><Layers size={16} /> Process Steps</h4>\r\n                                                    <span className=\"section-badge\">{websiteContent.howItWorks?.steps?.length || 0} steps</span>\r\n                                                </div>\r\n                                                <div className=\"cms-cards-list\">\r\n                                                    {websiteContent.howItWorks?.steps?.map((step, idx) => (\r\n                                                        <div key={idx} className=\"cms-card-editor\">\r\n                                                            <div className=\"cms-card-header\">\r\n                                                                <span className=\"card-number\">Step {idx + 1}</span>\r\n                                                            </div>\r\n                                                            <div className=\"cms-form-grid\">\r\n                                                                <div className=\"form-group\">\r\n                                                                    <label>Title</label>\r\n                                                                    <input type=\"text\" value={step.title} onChange={(e) => {\r\n                                                                        const newSteps = [...websiteContent.howItWorks.steps];\r\n                                                                        newSteps[idx] = { ...newSteps[idx], title: e.target.value };\r\n                                                                        setWebsiteContent({ ...websiteContent, howItWorks: { ...websiteContent.howItWorks, steps: newSteps } });\r\n                                                                    }} placeholder=\"Step title...\" />\r\n                                                                </div>\r\n                                                                <div className=\"form-group full-width\">\r\n                                                                    <label>Description</label>\r\n                                                                    <textarea rows={2} value={step.description} onChange={(e) => {\r\n                                                                        const newSteps = [...websiteContent.howItWorks.steps];\r\n                                                                        newSteps[idx] = { ...newSteps[idx], description: e.target.value };\r\n                                                                        setWebsiteContent({ ...websiteContent, howItWorks: { ...websiteContent.howItWorks, steps: newSteps } });\r\n                                                                    }} placeholder=\"Step description...\" />\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-actions\">\r\n                                                <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"btn-preview\"><Eye size={16} /> Preview</a>\r\n                                                <button className=\"btn-save-cms\" onClick={() => handleSaveContent('howItWorks', websiteContent.howItWorks)} disabled={contentSaving}>\r\n                                                    {contentSaving ? 'Saving...' : <><CheckCircle size={18} /> Save How It Works</>}\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* WHY CHOOSE US EDITOR */}\r\n                                {activeContentSection === 'whyChooseUs' && (\r\n                                    <div className=\"editor-card professional-cms\">\r\n                                        <div className=\"cms-header\">\r\n                                            <div className=\"cms-header-icon\" style={{ background: 'rgba(245, 158, 11, 0.15)', color: '#f59e0b' }}>\r\n                                                <Shield size={24} />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3>Why Choose Us Section</h3>\r\n                                                <p className=\"editor-description\">Highlight your competitive advantages and features.</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"cms-content\">\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><Edit2 size={16} /> Section Header</h4>\r\n                                                </div>\r\n                                                <div className=\"cms-form-grid\">\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Section Title</label>\r\n                                                        <input type=\"text\" value={websiteContent.whyChooseUs?.sectionTitle || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, whyChooseUs: { ...websiteContent.whyChooseUs, sectionTitle: e.target.value } })} placeholder=\"Enter section title...\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Section Subtitle</label>\r\n                                                        <input type=\"text\" value={websiteContent.whyChooseUs?.sectionSubtitle || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, whyChooseUs: { ...websiteContent.whyChooseUs, sectionSubtitle: e.target.value } })} placeholder=\"Enter section subtitle...\" />\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><CheckCircle size={16} /> Features</h4>\r\n                                                    <span className=\"section-badge\">{websiteContent.whyChooseUs?.features?.length || 0} features</span>\r\n                                                </div>\r\n                                                <div className=\"cms-cards-list\">\r\n                                                    {websiteContent.whyChooseUs?.features?.map((feature, idx) => (\r\n                                                        <div key={idx} className=\"cms-card-editor\">\r\n                                                            <div className=\"cms-card-header\">\r\n                                                                <span className=\"card-number\">Feature {idx + 1}</span>\r\n                                                            </div>\r\n                                                            <div className=\"cms-form-grid\">\r\n                                                                <div className=\"form-group\">\r\n                                                                    <label>Title</label>\r\n                                                                    <input type=\"text\" value={feature.title} onChange={(e) => {\r\n                                                                        const newFeatures = [...websiteContent.whyChooseUs.features];\r\n                                                                        newFeatures[idx] = { ...newFeatures[idx], title: e.target.value };\r\n                                                                        setWebsiteContent({ ...websiteContent, whyChooseUs: { ...websiteContent.whyChooseUs, features: newFeatures } });\r\n                                                                    }} placeholder=\"Feature title...\" />\r\n                                                                </div>\r\n                                                                <div className=\"form-group full-width\">\r\n                                                                    <label>Description</label>\r\n                                                                    <textarea rows={2} value={feature.description} onChange={(e) => {\r\n                                                                        const newFeatures = [...websiteContent.whyChooseUs.features];\r\n                                                                        newFeatures[idx] = { ...newFeatures[idx], description: e.target.value };\r\n                                                                        setWebsiteContent({ ...websiteContent, whyChooseUs: { ...websiteContent.whyChooseUs, features: newFeatures } });\r\n                                                                    }} placeholder=\"Feature description...\" />\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-actions\">\r\n                                                <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"btn-preview\"><Eye size={16} /> Preview</a>\r\n                                                <button className=\"btn-save-cms\" onClick={() => handleSaveContent('whyChooseUs', websiteContent.whyChooseUs)} disabled={contentSaving}>\r\n                                                    {contentSaving ? 'Saving...' : <><CheckCircle size={18} /> Save Why Choose Us</>}\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* CTA SECTIONS EDITOR */}\r\n                                {activeContentSection === 'cta' && (\r\n                                    <div className=\"editor-card professional-cms\">\r\n                                        <div className=\"cms-header\">\r\n                                            <div className=\"cms-header-icon\" style={{ background: 'rgba(236, 72, 153, 0.15)', color: '#ec4899' }}>\r\n                                                <TrendingUp size={24} />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3>Call to Action Sections</h3>\r\n                                                <p className=\"editor-description\">Manage the promotional CTAs on your website.</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"cms-content\">\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><DollarSign size={16} /> Sell Device CTA</h4>\r\n                                                </div>\r\n                                                <div className=\"cms-form-grid\">\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Title</label>\r\n                                                        <input type=\"text\" value={websiteContent.sellCta?.title || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, sellCta: { ...websiteContent.sellCta, title: e.target.value } })} placeholder=\"CTA title...\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group full-width\">\r\n                                                        <label><Edit2 size={14} /> Description</label>\r\n                                                        <textarea rows={2} value={websiteContent.sellCta?.description || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, sellCta: { ...websiteContent.sellCta, description: e.target.value } })} placeholder=\"CTA description...\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label>Button Text</label>\r\n                                                        <input type=\"text\" value={websiteContent.sellCta?.buttonText || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, sellCta: { ...websiteContent.sellCta, buttonText: e.target.value } })} placeholder=\"e.g., Get a Quote\" />\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><TrendingUp size={16} /> Main CTA Section</h4>\r\n                                                </div>\r\n                                                <div className=\"cms-form-grid\">\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Title</label>\r\n                                                        <input type=\"text\" value={websiteContent.ctaSection?.title || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, ctaSection: { ...websiteContent.ctaSection, title: e.target.value } })} placeholder=\"CTA title...\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Subtitle</label>\r\n                                                        <input type=\"text\" value={websiteContent.ctaSection?.subtitle || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, ctaSection: { ...websiteContent.ctaSection, subtitle: e.target.value } })} placeholder=\"CTA subtitle...\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-row\">\r\n                                                        <div className=\"form-group\">\r\n                                                            <label>Primary Button</label>\r\n                                                            <input type=\"text\" value={websiteContent.ctaSection?.primaryButtonText || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, ctaSection: { ...websiteContent.ctaSection, primaryButtonText: e.target.value } })} placeholder=\"Primary button text\" />\r\n                                                        </div>\r\n                                                        <div className=\"form-group\">\r\n                                                            <label>Secondary Button</label>\r\n                                                            <input type=\"text\" value={websiteContent.ctaSection?.secondaryButtonText || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, ctaSection: { ...websiteContent.ctaSection, secondaryButtonText: e.target.value } })} placeholder=\"Secondary button text\" />\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-actions\">\r\n                                                <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"btn-preview\"><Eye size={16} /> Preview</a>\r\n                                                <button className=\"btn-save-cms\" onClick={() => { handleSaveContent('sellCta', websiteContent.sellCta); handleSaveContent('ctaSection', websiteContent.ctaSection); }} disabled={contentSaving}>\r\n                                                    {contentSaving ? 'Saving...' : <><CheckCircle size={18} /> Save All CTAs</>}\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* CONTACT INFO EDITOR */}\r\n                                {activeContentSection === 'contact' && (\r\n                                    <div className=\"editor-card professional-cms\">\r\n                                        <div className=\"cms-header\">\r\n                                            <div className=\"cms-header-icon\" style={{ background: 'rgba(6, 182, 212, 0.15)', color: '#06b6d4' }}>\r\n                                                <Send size={24} />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3>Contact & Footer</h3>\r\n                                                <p className=\"editor-description\">Manage your business contact details and footer content.</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"cms-content\">\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><Send size={16} /> Contact Information</h4>\r\n                                                </div>\r\n                                                <div className=\"cms-form-grid\">\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><RefreshCw size={14} /> Phone</label>\r\n                                                        <input type=\"text\" value={websiteContent.contact?.phone || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, contact: { ...websiteContent.contact, phone: e.target.value } })} placeholder=\"(555) 123-4567\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><Send size={14} /> Support Email</label>\r\n                                                        <input type=\"email\" value={websiteContent.contact?.supportEmail || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, contact: { ...websiteContent.contact, supportEmail: e.target.value } })} placeholder=\"support@sifixa.com\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><Mail size={14} /> Info Email</label>\r\n                                                        <input type=\"email\" value={websiteContent.contact?.infoEmail || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, contact: { ...websiteContent.contact, infoEmail: e.target.value } })} placeholder=\"info@sifixa.com\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group full-width\">\r\n                                                        <label><Edit2 size={14} /> Address</label>\r\n                                                        <textarea rows={2} value={websiteContent.contact?.address || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, contact: { ...websiteContent.contact, address: e.target.value } })} placeholder=\"Full business address...\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group full-width\">\r\n                                                        <label><Clock size={14} /> Business Hours</label>\r\n                                                        <input type=\"text\" value={websiteContent.contact?.hours || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, contact: { ...websiteContent.contact, hours: e.target.value } })} placeholder=\"Mon-Sat: 9AM - 7PM\" />\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-section\">\r\n                                                <div className=\"cms-section-header\">\r\n                                                    <h4><Layers size={16} /> Footer Content</h4>\r\n                                                </div>\r\n                                                <div className=\"cms-form-grid\">\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><FileText size={14} /> Company Name</label>\r\n                                                        <input type=\"text\" value={websiteContent.footer?.companyName || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, footer: { ...websiteContent.footer, companyName: e.target.value } })} placeholder=\"Your Company Name\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><Edit2 size={14} /> Tagline</label>\r\n                                                        <input type=\"text\" value={websiteContent.footer?.tagline || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, footer: { ...websiteContent.footer, tagline: e.target.value } })} placeholder=\"Your company tagline\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><Send size={14} /> Footer Support Email</label>\r\n                                                        <input type=\"email\" value={websiteContent.footer?.supportEmail || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, footer: { ...websiteContent.footer, supportEmail: e.target.value } })} placeholder=\"support@sifixa.com\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group\">\r\n                                                        <label><Mail size={14} /> Footer Info Email</label>\r\n                                                        <input type=\"email\" value={websiteContent.footer?.infoEmail || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, footer: { ...websiteContent.footer, infoEmail: e.target.value } })} placeholder=\"info@sifixa.com\" />\r\n                                                    </div>\r\n                                                    <div className=\"form-group full-width\">\r\n                                                        <label><FileText size={14} /> Copyright Text</label>\r\n                                                        <input type=\"text\" value={websiteContent.footer?.copyright || ''} onChange={(e) => setWebsiteContent({ ...websiteContent, footer: { ...websiteContent.footer, copyright: e.target.value } })} placeholder=\"┬⌐ 2025 Company. All rights reserved.\" />\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"cms-actions\">\r\n                                                <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"btn-preview\"><Eye size={16} /> Preview</a>\r\n                                                <button className=\"btn-save-cms\" onClick={() => { handleSaveContent('contact', websiteContent.contact); handleSaveContent('footer', websiteContent.footer); }} disabled={contentSaving}>\r\n                                                    {contentSaving ? 'Saving...' : <><CheckCircle size={18} /> Save Contact & Footer</>}\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* LEGAL PAGES EDITOR */}\r\n                                {activeContentSection === 'legal' && (\r\n                                    <div className=\"editor-card legal-cms\">\r\n                                        <div className=\"legal-cms-header\">\r\n                                            <div>\r\n                                                <h3><FileText size={24} /> Legal Pages CMS</h3>\r\n                                                <p className=\"editor-description\">Manage your legal and policy pages. Click on a policy to expand and edit its content.</p>\r\n                                            </div>\r\n                                            <button\r\n                                                className=\"btn-reset-defaults\"\r\n                                                onClick={handleResetLegalContent}\r\n                                                disabled={contentSaving}\r\n                                                title=\"Reset all legal pages to default content\"\r\n                                            >\r\n                                                <RefreshCw size={16} /> Load Default Content\r\n                                            </button>\r\n                                        </div>\r\n\r\n                                        {/* Policy configuration */}\r\n                                        {[\r\n                                            { key: 'privacyPolicy', title: 'Privacy Policy', icon: Shield, color: '#3b82f6', path: '/privacy' },\r\n                                            { key: 'termsOfUse', title: 'Terms of Use', icon: FileText, color: '#8b5cf6', path: '/terms' },\r\n                                            { key: 'refundPolicy', title: 'Refund Policy', icon: DollarSign, color: '#10b981', path: '/refund' },\r\n                                            { key: 'warrantyPolicy', title: 'Warranty Policy', icon: Shield, color: '#f59e0b', path: '/warranty' },\r\n                                            { key: 'cookiePolicy', title: 'Cookie Policy', icon: Cookie, color: '#ec4899', path: '/cookies' }\r\n                                        ].map(({ key, title, icon: Icon, color, path }) => (\r\n                                            <div key={key} className={`legal-accordion ${expandedLegalPages[key] ? 'expanded' : ''}`}>\r\n                                                <div\r\n                                                    className=\"legal-accordion-header\"\r\n                                                    onClick={() => setExpandedLegalPages(prev => ({ ...prev, [key]: !prev[key] }))}\r\n                                                >\r\n                                                    <div className=\"legal-accordion-title\">\r\n                                                        <div className=\"legal-icon-wrapper\" style={{ background: `${color}20`, color: color }}>\r\n                                                            <Icon size={20} />\r\n                                                        </div>\r\n                                                        <div className=\"legal-title-info\">\r\n                                                            <span className=\"legal-title-text\">{title}</span>\r\n                                                            <span className=\"legal-section-count\">\r\n                                                                {websiteContent.legalPages?.[key]?.sections?.length || 0} sections\r\n                                                            </span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"legal-accordion-actions\">\r\n                                                        <a\r\n                                                            href={path}\r\n                                                            target=\"_blank\"\r\n                                                            rel=\"noopener noreferrer\"\r\n                                                            className=\"preview-link\"\r\n                                                            onClick={(e) => e.stopPropagation()}\r\n                                                            title=\"Preview page\"\r\n                                                        >\r\n                                                            <Eye size={16} />\r\n                                                        </a>\r\n                                                        {expandedLegalPages[key] ? <ChevronUp size={20} /> : <ChevronDown size={20} />}\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                {expandedLegalPages[key] && (\r\n                                                    <div className=\"legal-accordion-content\">\r\n                                                        <div className=\"legal-form-grid\">\r\n                                                            <div className=\"form-group\">\r\n                                                                <label><FileText size={14} /> Page Title</label>\r\n                                                                <input\r\n                                                                    type=\"text\"\r\n                                                                    value={websiteContent.legalPages?.[key]?.title || ''}\r\n                                                                    onChange={(e) => setWebsiteContent({\r\n                                                                        ...websiteContent,\r\n                                                                        legalPages: {\r\n                                                                            ...websiteContent.legalPages,\r\n                                                                            [key]: { ...websiteContent.legalPages?.[key], title: e.target.value }\r\n                                                                        }\r\n                                                                    })}\r\n                                                                    placeholder=\"Enter page title...\"\r\n                                                                />\r\n                                                            </div>\r\n                                                            <div className=\"form-row\">\r\n                                                                <div className=\"form-group\">\r\n                                                                    <label><Calendar size={14} /> Last Updated</label>\r\n                                                                    <input\r\n                                                                        type=\"text\"\r\n                                                                        value={websiteContent.legalPages?.[key]?.lastUpdated || ''}\r\n                                                                        onChange={(e) => setWebsiteContent({\r\n                                                                            ...websiteContent,\r\n                                                                            legalPages: {\r\n                                                                                ...websiteContent.legalPages,\r\n                                                                                [key]: { ...websiteContent.legalPages?.[key], lastUpdated: e.target.value }\r\n                                                                            }\r\n                                                                        })}\r\n                                                                        placeholder=\"e.g., December 2025\"\r\n                                                                    />\r\n                                                                </div>\r\n                                                                <div className=\"form-group\">\r\n                                                                    <label><Send size={14} /> Contact Email</label>\r\n                                                                    <input\r\n                                                                        type=\"email\"\r\n                                                                        value={websiteContent.legalPages?.[key]?.contactEmail || ''}\r\n                                                                        onChange={(e) => setWebsiteContent({\r\n                                                                            ...websiteContent,\r\n                                                                            legalPages: {\r\n                                                                                ...websiteContent.legalPages,\r\n                                                                                [key]: { ...websiteContent.legalPages?.[key], contactEmail: e.target.value }\r\n                                                                            }\r\n                                                                        })}\r\n                                                                        placeholder=\"contact@example.com\"\r\n                                                                    />\r\n                                                                </div>\r\n                                                            </div>\r\n                                                            <div className=\"form-group full-width\">\r\n                                                                <label><Edit2 size={14} /> Introduction</label>\r\n                                                                <textarea\r\n                                                                    rows={3}\r\n                                                                    value={websiteContent.legalPages?.[key]?.intro || ''}\r\n                                                                    onChange={(e) => setWebsiteContent({\r\n                                                                        ...websiteContent,\r\n                                                                        legalPages: {\r\n                                                                            ...websiteContent.legalPages,\r\n                                                                            [key]: { ...websiteContent.legalPages?.[key], intro: e.target.value }\r\n                                                                        }\r\n                                                                    })}\r\n                                                                    placeholder=\"Enter the introduction paragraph for this policy...\"\r\n                                                                />\r\n                                                                <span className=\"char-count\">{(websiteContent.legalPages?.[key]?.intro || '').length} characters</span>\r\n                                                            </div>\r\n                                                        </div>\r\n\r\n                                                        <div className=\"sections-header\">\r\n                                                            <h5><Layers size={16} /> Content Sections</h5>\r\n                                                            <button\r\n                                                                className=\"btn-add-section\"\r\n                                                                onClick={() => {\r\n                                                                    const currentSections = websiteContent.legalPages?.[key]?.sections || [];\r\n                                                                    setWebsiteContent({\r\n                                                                        ...websiteContent,\r\n                                                                        legalPages: {\r\n                                                                            ...websiteContent.legalPages,\r\n                                                                            [key]: {\r\n                                                                                ...websiteContent.legalPages?.[key],\r\n                                                                                sections: [...currentSections, { heading: '', content: '' }]\r\n                                                                            }\r\n                                                                        }\r\n                                                                    });\r\n                                                                }}\r\n                                                            >\r\n                                                                <Plus size={16} /> Add Section\r\n                                                            </button>\r\n                                                        </div>\r\n\r\n                                                        <div className=\"sections-list\">\r\n                                                            {websiteContent.legalPages?.[key]?.sections?.map((section, idx) => (\r\n                                                                <div key={idx} className=\"section-editor\">\r\n                                                                    <div className=\"section-editor-header\">\r\n                                                                        <span className=\"section-number\">Section {idx + 1}</span>\r\n                                                                        <button\r\n                                                                            className=\"btn-remove-section\"\r\n                                                                            onClick={() => {\r\n                                                                                const newSections = [...(websiteContent.legalPages?.[key]?.sections || [])];\r\n                                                                                newSections.splice(idx, 1);\r\n                                                                                setWebsiteContent({\r\n                                                                                    ...websiteContent,\r\n                                                                                    legalPages: {\r\n                                                                                        ...websiteContent.legalPages,\r\n                                                                                        [key]: {\r\n                                                                                            ...websiteContent.legalPages?.[key],\r\n                                                                                            sections: newSections\r\n                                                                                        }\r\n                                                                                    }\r\n                                                                                });\r\n                                                                            }}\r\n                                                                            title=\"Remove this section\"\r\n                                                                        >\r\n                                                                            <Trash2 size={14} />\r\n                                                                        </button>\r\n                                                                    </div>\r\n                                                                    <div className=\"form-group\">\r\n                                                                        <label>Heading</label>\r\n                                                                        <input\r\n                                                                            type=\"text\"\r\n                                                                            value={section.heading}\r\n                                                                            onChange={(e) => {\r\n                                                                                const newSections = [...(websiteContent.legalPages?.[key]?.sections || [])];\r\n                                                                                newSections[idx] = { ...newSections[idx], heading: e.target.value };\r\n                                                                                setWebsiteContent({\r\n                                                                                    ...websiteContent,\r\n                                                                                    legalPages: {\r\n                                                                                        ...websiteContent.legalPages,\r\n                                                                                        [key]: { ...websiteContent.legalPages?.[key], sections: newSections }\r\n                                                                                    }\r\n                                                                                });\r\n                                                                            }}\r\n                                                                            placeholder=\"Section heading...\"\r\n                                                                        />\r\n                                                                    </div>\r\n                                                                    <div className=\"form-group\">\r\n                                                                        <label>Content</label>\r\n                                                                        <textarea\r\n                                                                            rows={4}\r\n                                                                            value={section.content}\r\n                                                                            onChange={(e) => {\r\n                                                                                const newSections = [...(websiteContent.legalPages?.[key]?.sections || [])];\r\n                                                                                newSections[idx] = { ...newSections[idx], content: e.target.value };\r\n                                                                                setWebsiteContent({\r\n                                                                                    ...websiteContent,\r\n                                                                                    legalPages: {\r\n                                                                                        ...websiteContent.legalPages,\r\n                                                                                        [key]: { ...websiteContent.legalPages?.[key], sections: newSections }\r\n                                                                                    }\r\n                                                                                });\r\n                                                                            }}\r\n                                                                            placeholder=\"Section content...\"\r\n                                                                        />\r\n                                                                        <span className=\"char-count\">{(section.content || '').length} characters</span>\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            ))}\r\n                                                            {(!websiteContent.legalPages?.[key]?.sections || websiteContent.legalPages?.[key]?.sections.length === 0) && (\r\n                                                                <div className=\"no-sections\">\r\n                                                                    <Layers size={32} />\r\n                                                                    <p>No sections yet. Click \"Add Section\" to create your first content section.</p>\r\n                                                                </div>\r\n                                                            )}\r\n                                                        </div>\r\n\r\n                                                        <div className=\"legal-actions\">\r\n                                                            <button\r\n                                                                className=\"btn-save-policy\"\r\n                                                                onClick={() => handleSaveContent('legalPages', websiteContent.legalPages)}\r\n                                                                disabled={contentSaving}\r\n                                                            >\r\n                                                                {contentSaving ? (\r\n                                                                    <>Saving...</>\r\n                                                                ) : (\r\n                                                                    <>\r\n                                                                        <CheckCircle size={18} />\r\n                                                                        Save {title}\r\n                                                                    </>\r\n                                                                )}\r\n                                                            </button>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* ACTIVITY LOG TAB */}\r\n                    {activeTab === 'activity' && (\r\n                        <div className=\"activity-section\">\r\n                            {/* Activity Stats */}\r\n                            {activityStats && (\r\n                                <div className=\"activity-stats-grid\">\r\n                                    <div className=\"activity-stat-card\">\r\n                                        <div className=\"stat-icon blue\"><History size={24} /></div>\r\n                                        <div className=\"stat-info\">\r\n                                            <span className=\"stat-value\">{activityStats.totalActivities}</span>\r\n                                            <span className=\"stat-label\">Total Activities</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"activity-stat-card\">\r\n                                        <div className=\"stat-icon green\"><Activity size={24} /></div>\r\n                                        <div className=\"stat-info\">\r\n                                            <span className=\"stat-value\">{activityStats.activitiesToday}</span>\r\n                                            <span className=\"stat-label\">Today</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"activity-stat-card\">\r\n                                        <div className=\"stat-icon purple\"><Calendar size={24} /></div>\r\n                                        <div className=\"stat-info\">\r\n                                            <span className=\"stat-value\">{activityStats.activitiesThisWeek}</span>\r\n                                            <span className=\"stat-label\">This Week</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"activity-stat-card\">\r\n                                        <div className=\"stat-icon orange\"><DollarSign size={24} /></div>\r\n                                        <div className=\"stat-info\">\r\n                                            <span className=\"stat-value\">${activityStats.totalRevenue?.toFixed(2) || '0.00'}</span>\r\n                                            <span className=\"stat-label\">Revenue Tracked</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Filters */}\r\n                            <div className=\"activity-filters\">\r\n                                <div className=\"filter-group\">\r\n                                    <div className=\"search-box\">\r\n                                        <Search size={18} />\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            placeholder=\"Search activities...\"\r\n                                            value={activityFilters.search}\r\n                                            onChange={(e) => setActivityFilters({ ...activityFilters, search: e.target.value })}\r\n                                        />\r\n                                    </div>\r\n                                    <select\r\n                                        value={activityFilters.category}\r\n                                        onChange={(e) => setActivityFilters({ ...activityFilters, category: e.target.value })}\r\n                                        className=\"filter-select\"\r\n                                    >\r\n                                        <option value=\"\">All Categories</option>\r\n                                        <option value=\"auth\">Authentication</option>\r\n                                        <option value=\"booking\">Bookings</option>\r\n                                        <option value=\"inventory\">Inventory</option>\r\n                                        <option value=\"sales\">Sales</option>\r\n                                        <option value=\"customer\">Customer</option>\r\n                                        <option value=\"employee\">Employee</option>\r\n                                        <option value=\"system\">System</option>\r\n                                    </select>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={activityFilters.startDate}\r\n                                        onChange={(e) => setActivityFilters({ ...activityFilters, startDate: e.target.value })}\r\n                                        className=\"date-input\"\r\n                                        placeholder=\"From\"\r\n                                    />\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={activityFilters.endDate}\r\n                                        onChange={(e) => setActivityFilters({ ...activityFilters, endDate: e.target.value })}\r\n                                        className=\"date-input\"\r\n                                        placeholder=\"To\"\r\n                                    />\r\n                                    <Button\r\n                                        variant=\"secondary\"\r\n                                        onClick={() => setActivityFilters({ category: '', search: '', startDate: '', endDate: '' })}\r\n                                    >\r\n                                        Clear\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Activity Timeline */}\r\n                            <div className=\"activity-timeline\">\r\n                                <h3><History size={18} /> Recent Activity ({activityTotal} total)</h3>\r\n                                {activityLog.length === 0 ? (\r\n                                    <div className=\"empty-state\">\r\n                                        <History size={48} />\r\n                                        <p>No activities found</p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"activity-list\">\r\n                                        {activityLog.map((activity) => (\r\n                                            <div key={activity.id} className={`activity-item category-${activity.category}`}>\r\n                                                <div className=\"activity-avatar\">\r\n                                                    {activity.userName?.charAt(0) || '?'}\r\n                                                </div>\r\n                                                <div className=\"activity-content\">\r\n                                                    <div className=\"activity-header\">\r\n                                                        <span className=\"activity-user\">{activity.userName}</span>\r\n                                                        <span className={`activity-role role-${activity.userRole}`}>{activity.userRole}</span>\r\n                                                        <span className={`activity-category cat-${activity.category}`}>{activity.category}</span>\r\n                                                    </div>\r\n                                                    <div className=\"activity-action\">{activity.action}</div>\r\n                                                    <div className=\"activity-details\">{activity.details}</div>\r\n                                                    {activity.metadata?.amount && (\r\n                                                        <div className=\"activity-amount\">\r\n                                                            <DollarSign size={14} /> ${activity.metadata.amount.toFixed(2)}\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                                <div className=\"activity-time\">\r\n                                                    {new Date(activity.timestamp).toLocaleString()}\r\n                                                </div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Pagination */}\r\n                                {activityTotal > 20 && (\r\n                                    <div className=\"activity-pagination\">\r\n                                        <Button\r\n                                            variant=\"secondary\"\r\n                                            onClick={() => setActivityPage(p => Math.max(1, p - 1))}\r\n                                            disabled={activityPage === 1}\r\n                                        >\r\n                                            <ChevronLeft size={16} /> Previous\r\n                                        </Button>\r\n                                        <span className=\"page-info\">\r\n                                            Page {activityPage} of {Math.ceil(activityTotal / 20)}\r\n                                        </span>\r\n                                        <Button\r\n                                            variant=\"secondary\"\r\n                                            onClick={() => setActivityPage(p => p + 1)}\r\n                                            disabled={activityPage >= Math.ceil(activityTotal / 20)}\r\n                                        >\r\n                                            Next <ChevronRight size={16} />\r\n                                        </Button>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Top Users */}\r\n                            {activityStats?.topUsers && activityStats.topUsers.length > 0 && (\r\n                                <div className=\"top-users-section\">\r\n                                    <h3><Users size={18} /> Most Active Users</h3>\r\n                                    <div className=\"top-users-list\">\r\n                                        {activityStats.topUsers.map((user, index) => (\r\n                                            <div key={user.name} className=\"top-user-item\">\r\n                                                <span className=\"user-rank\">#{index + 1}</span>\r\n                                                <span className=\"user-name\">{user.name}</span>\r\n                                                <span className=\"user-count\">{user.count} actions</span>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* SALES HISTORY TAB */}\r\n                    {activeTab === 'sales' && (\r\n                        <div className=\"sales-history-section\">\r\n                            {/* Sales Stats */}\r\n                            <div className=\"stats-grid\">\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon blue\"><DollarSign size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">${salesStats?.totalRevenue?.toFixed(2) || '0.00'}</span>\r\n                                        <span className=\"stat-label\">Total Revenue</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon green\"><Receipt size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{salesStats?.totalTransactions || 0}</span>\r\n                                        <span className=\"stat-label\">Transactions</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon orange\"><ShoppingBag size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">${salesStats?.retailRevenue?.toFixed(2) || '0.00'}</span>\r\n                                        <span className=\"stat-label\">Retail Sales</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon cyan\"><CheckCircle size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">${salesStats?.repairRevenue?.toFixed(2) || '0.00'}</span>\r\n                                        <span className=\"stat-label\">Repair Pickups</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Filters */}\r\n                            <div className=\"section-header\">\r\n                                <h2>Transaction History</h2>\r\n                                <div className=\"filter-row\">\r\n                                    <select\r\n                                        value={salesFilter.type}\r\n                                        onChange={(e) => setSalesFilter({ ...salesFilter, type: e.target.value })}\r\n                                        className=\"filter-select\"\r\n                                    >\r\n                                        <option value=\"all\">All Types</option>\r\n                                        <option value=\"retail\">Retail Sales</option>\r\n                                        <option value=\"repair-pickup\">Repair Pickups</option>\r\n                                    </select>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={salesFilter.dateFrom}\r\n                                        onChange={(e) => setSalesFilter({ ...salesFilter, dateFrom: e.target.value })}\r\n                                        className=\"filter-input\"\r\n                                        placeholder=\"From Date\"\r\n                                    />\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={salesFilter.dateTo}\r\n                                        onChange={(e) => setSalesFilter({ ...salesFilter, dateTo: e.target.value })}\r\n                                        className=\"filter-input\"\r\n                                        placeholder=\"To Date\"\r\n                                    />\r\n                                    <Button variant=\"secondary\" onClick={loadSalesData}>\r\n                                        <RefreshCw size={16} /> Refresh\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Transactions Table */}\r\n                            <div className=\"table-container\">\r\n                                <table className=\"data-table\">\r\n                                    <thead>\r\n                                        <tr>\r\n                                            <th>Receipt #</th>\r\n                                            <th>Date</th>\r\n                                            <th>Time</th>\r\n                                            <th>Type</th>\r\n                                            <th>Customer</th>\r\n                                            <th>Items</th>\r\n                                            <th>Payment</th>\r\n                                            <th>Total</th>\r\n                                            <th>Employee</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {salesHistory\r\n                                            .filter(sale => {\r\n                                                if (salesFilter.type !== 'all' && sale.type !== salesFilter.type) return false;\r\n                                                if (salesFilter.dateFrom && sale.date < salesFilter.dateFrom) return false;\r\n                                                if (salesFilter.dateTo && sale.date > salesFilter.dateTo) return false;\r\n                                                return true;\r\n                                            })\r\n                                            .map(sale => (\r\n                                                <tr key={sale.id}>\r\n                                                    <td className=\"receipt-number\">{sale.receiptNumber || sale.id}</td>\r\n                                                    <td>{sale.date}</td>\r\n                                                    <td>{sale.time}</td>\r\n                                                    <td>\r\n                                                        <span className={`type-badge ${sale.type === 'retail' ? 'retail' : 'repair'}`}>\r\n                                                            {sale.type === 'retail' ? 'Retail' : 'Repair Pickup'}\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td>{sale.customerName || 'Walk-in'}</td>\r\n                                                    <td>\r\n                                                        {sale.items?.length > 0 ? (\r\n                                                            <div className=\"items-list\">\r\n                                                                {sale.items.slice(0, 2).map((item, idx) => (\r\n                                                                    <span key={idx} className=\"item-name\">{item.name || item.serviceName}</span>\r\n                                                                ))}\r\n                                                                {sale.items.length > 2 && (\r\n                                                                    <span className=\"more-items\">+{sale.items.length - 2} more</span>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        ) : '-'}\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <span className=\"payment-method\">\r\n                                                            <CreditCard size={14} /> {sale.paymentMethod || 'Cash'}\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td className=\"amount\">${sale.total?.toFixed(2) || '0.00'}</td>\r\n                                                    <td>{sale.employeeName || '-'}</td>\r\n                                                </tr>\r\n                                            ))}\r\n                                        {salesHistory.length === 0 && (\r\n                                            <tr>\r\n                                                <td colSpan=\"9\" className=\"empty-message\">\r\n                                                    No sales transactions found. Complete a sale in POS to see it here.\r\n                                                </td>\r\n                                            </tr>\r\n                                        )}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n\r\n                            {/* Summary */}\r\n                            {salesHistory.length > 0 && (\r\n                                <div className=\"sales-summary\">\r\n                                    <div className=\"summary-item\">\r\n                                        <span>Average Transaction:</span>\r\n                                        <strong>${salesStats?.averageTransactionValue?.toFixed(2) || '0.00'}</strong>\r\n                                    </div>\r\n                                    <div className=\"summary-item\">\r\n                                        <span>Retail Transactions:</span>\r\n                                        <strong>{salesStats?.retailTransactions || 0}</strong>\r\n                                    </div>\r\n                                    <div className=\"summary-item\">\r\n                                        <span>Repair Pickups:</span>\r\n                                        <strong>{salesStats?.repairPickups || 0}</strong>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* SYSTEM TAB */}\r\n                    {activeTab === 'system' && (\r\n                        <div className=\"system-section\">\r\n                            <h2>System Management</h2>\r\n                            <div className=\"system-grid\">\r\n                                <div className=\"system-card\">\r\n                                    <h3>Business Settings</h3>\r\n                                    <div className=\"settings-info\">\r\n                                        <p><strong>Name:</strong> {settings.businessName}</p>\r\n                                        <p><strong>Email:</strong> {settings.email}</p>\r\n                                        <p><strong>Phone:</strong> {settings.phone}</p>\r\n                                        <p><strong>Address:</strong> {settings.address}</p>\r\n                                    </div>\r\n                                    <Button variant=\"secondary\" onClick={() => setShowSettingsModal(true)}>\r\n                                        <Settings size={16} /> Edit Settings\r\n                                    </Button>\r\n                                </div>\r\n                                <div className=\"system-card\">\r\n                                    <h3>Data Management</h3>\r\n                                    <p>Export or reset all system data.</p>\r\n                                    <div className=\"system-actions\">\r\n                                        <Button variant=\"secondary\" onClick={exportAllData}>\r\n                                            <Download size={16} /> Export All Data\r\n                                        </Button>\r\n                                        <Button variant=\"danger\" onClick={handleResetAllData}>\r\n                                            <RefreshCw size={16} /> Reset All Data\r\n                                        </Button>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"system-card\">\r\n                                    <h3>Statistics Summary</h3>\r\n                                    <div className=\"stats-summary\">\r\n                                        <p><strong>Total Bookings:</strong> {stats.totalBookings}</p>\r\n                                        <p><strong>Completed:</strong> {stats.completed}</p>\r\n                                        <p><strong>Admins:</strong> {stats.totalAdmins}</p>\r\n                                        <p><strong>Employees:</strong> {stats.totalEmployees}</p>\r\n                                        <p><strong>Services:</strong> {stats.totalServices} ({stats.activeServices} active)</p>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"system-card time-slots-card\">\r\n                                    <h3><Timer size={18} /> Time Slot Availability</h3>\r\n                                    <p>Configure booking time slots and capacity.</p>\r\n                                    <div className=\"time-slots-list\">\r\n                                        {timeSlots.map(slot => (\r\n                                            <div key={slot.id} className={`time-slot-item ${slot.active ? '' : 'inactive'}`}>\r\n                                                <div className=\"slot-info\">\r\n                                                    <strong>{slot.name}</strong>\r\n                                                    <span>{slot.startTime} - {slot.endTime}</span>\r\n                                                </div>\r\n                                                <div className=\"slot-capacity\">\r\n                                                    <span className=\"capacity-badge\">{slot.maxBookings} slots</span>\r\n                                                    <label className=\"toggle-switch\">\r\n                                                        <input\r\n                                                            type=\"checkbox\"\r\n                                                            checked={slot.active}\r\n                                                            onChange={async (e) => {\r\n                                                                await mockApi.updateTimeSlot(slot.id, { active: e.target.checked });\r\n                                                                loadData();\r\n                                                            }}\r\n                                                        />\r\n                                                        <span className=\"toggle-slider\"></span>\r\n                                                    </label>\r\n                                                </div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                    <Button variant=\"secondary\" onClick={() => setShowTimeSlotsModal(true)}>\r\n                                        <Edit2 size={16} /> Edit Time Slots\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </main>\r\n\r\n            {/* MODALS */}\r\n            {showUserModal && (\r\n                <UserModal\r\n                    user={editingItem}\r\n                    onSave={handleSaveUser}\r\n                    onClose={() => { setShowUserModal(false); setEditingItem(null); }}\r\n                />\r\n            )}\r\n\r\n            {showServiceModal && (\r\n                <ServiceModal\r\n                    service={editingItem}\r\n                    onSave={handleSaveService}\r\n                    onClose={() => { setShowServiceModal(false); setEditingItem(null); }}\r\n                />\r\n            )}\r\n\r\n            {showSettingsModal && (\r\n                <SettingsModal\r\n                    settings={settings}\r\n                    onSave={handleSaveSettings}\r\n                    onClose={() => setShowSettingsModal(false)}\r\n                />\r\n            )}\r\n\r\n            {showTimeSlotsModal && (\r\n                <TimeSlotsModal\r\n                    timeSlots={timeSlots}\r\n                    onSave={() => { setShowTimeSlotsModal(false); loadData(); }}\r\n                    onClose={() => setShowTimeSlotsModal(false)}\r\n                />\r\n            )}\r\n\r\n            {showCustomerModal && (\r\n                <CustomerModal\r\n                    customer={editingItem}\r\n                    onSave={handleSaveCustomer}\r\n                    onClose={() => { setShowCustomerModal(false); setEditingItem(null); }}\r\n                />\r\n            )}\r\n\r\n            {showInventoryModal && (\r\n                <InventoryModal\r\n                    item={editingItem}\r\n                    onSave={handleSaveInventory}\r\n                    onClose={() => { setShowInventoryModal(false); setEditingItem(null); }}\r\n                />\r\n            )}\r\n\r\n            {showPurchaseOrderModal && (\r\n                <PurchaseOrderModal\r\n                    order={editingItem}\r\n                    inventory={inventory}\r\n                    onSave={(orderData) => {\r\n                        if (editingItem) {\r\n                            handleUpdatePurchaseOrder(editingItem.id, orderData);\r\n                        } else {\r\n                            handleCreatePurchaseOrder(orderData);\r\n                        }\r\n                    }}\r\n                    onClose={() => { setShowPurchaseOrderModal(false); setEditingItem(null); }}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\n// ========== MODAL COMPONENTS ==========\r\n\r\nconst UserModal = ({ user, onSave, onClose }) => {\r\n    const [formData, setFormData] = useState({\r\n        name: user?.name || '',\r\n        username: user?.username || '',\r\n        email: user?.email || '',\r\n        role: user?.role || 'technician',\r\n        password: ''\r\n    });\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        const data = { ...formData };\r\n        if (!data.password) delete data.password;\r\n        onSave(data);\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>{user ? 'Edit User' : 'Add New User'}</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group\">\r\n                        <label>Full Name</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.name}\r\n                            onChange={e => setFormData({ ...formData, name: validateName(e.target.value) })}\r\n                            placeholder=\"Letters only\"\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Username</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.username}\r\n                            onChange={e => setFormData({ ...formData, username: validateUsername(e.target.value) })}\r\n                            placeholder=\"Lowercase, no spaces\"\r\n                            required\r\n                            disabled={!!user}\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Email</label>\r\n                        <input type=\"email\" value={formData.email} onChange={e => setFormData({ ...formData, email: e.target.value })} required />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Role</label>\r\n                        <select value={formData.role} onChange={e => setFormData({ ...formData, role: e.target.value })}>\r\n                            <option value=\"admin\">Administrator</option>\r\n                            <option value=\"technician\">Technician</option>\r\n                            <option value=\"support\">Support Team</option>\r\n                            <option value=\"inventory\">Inventory Staff</option>\r\n                            <option value=\"sales\">Sales / Cashier (POS)</option>\r\n                        </select>\r\n                    </div>\r\n                    {!user && (\r\n                        <div className=\"form-group\">\r\n                            <label>Password</label>\r\n                            <input type=\"password\" value={formData.password} onChange={e => setFormData({ ...formData, password: e.target.value })} placeholder=\"Default: password123\" />\r\n                        </div>\r\n                    )}\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\">{user ? 'Update' : 'Add'} User</Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst ServiceModal = ({ service, onSave, onClose }) => {\r\n    const [formData, setFormData] = useState({\r\n        name: service?.name || '',\r\n        description: service?.description || '',\r\n        priceMin: service?.priceMin || '',\r\n        priceMax: service?.priceMax || '',\r\n        category: service?.category || 'phone'\r\n    });\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSave({\r\n            ...formData,\r\n            priceMin: Number(formData.priceMin),\r\n            priceMax: Number(formData.priceMax)\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>{service ? 'Edit Service' : 'Add New Service'}</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group\">\r\n                        <label>Service Name</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.name}\r\n                            onChange={e => setFormData({ ...formData, name: validateText(e.target.value) })}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Description</label>\r\n                        <textarea\r\n                            value={formData.description}\r\n                            onChange={e => setFormData({ ...formData, description: validateText(e.target.value) })}\r\n                            rows=\"3\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>Min Price ($)</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                inputMode=\"decimal\"\r\n                                value={formData.priceMin}\r\n                                onChange={e => setFormData({ ...formData, priceMin: validatePrice(e.target.value) })}\r\n                                placeholder=\"Numbers only\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Max Price ($)</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                inputMode=\"decimal\"\r\n                                value={formData.priceMax}\r\n                                onChange={e => setFormData({ ...formData, priceMax: validatePrice(e.target.value) })}\r\n                                placeholder=\"Numbers only\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Category</label>\r\n                        <select value={formData.category} onChange={e => setFormData({ ...formData, category: e.target.value })}>\r\n                            <option value=\"phone\">Phone</option>\r\n                            <option value=\"computer\">Computer</option>\r\n                            <option value=\"both\">Both</option>\r\n                        </select>\r\n                    </div>\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\">{service ? 'Update' : 'Add'} Service</Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst SettingsModal = ({ settings, onSave, onClose }) => {\r\n    const [formData, setFormData] = useState({ ...settings });\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSave(formData);\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Business Settings</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group\">\r\n                        <label>Business Name</label>\r\n                        <input type=\"text\" value={formData.businessName} onChange={e => setFormData({ ...formData, businessName: validateText(e.target.value) })} />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Email</label>\r\n                        <input type=\"email\" value={formData.email} onChange={e => setFormData({ ...formData, email: e.target.value })} />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Phone</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            inputMode=\"numeric\"\r\n                            value={formData.phone}\r\n                            onChange={e => setFormData({ ...formData, phone: validatePhone(e.target.value) })}\r\n                            placeholder=\"Numbers only\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Address</label>\r\n                        <input type=\"text\" value={formData.address} onChange={e => setFormData({ ...formData, address: validateText(e.target.value) })} />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Business Hours</label>\r\n                        <input type=\"text\" value={formData.businessHours} onChange={e => setFormData({ ...formData, businessHours: validateText(e.target.value) })} />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Tax Rate (%)</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            inputMode=\"decimal\"\r\n                            value={formData.taxRate}\r\n                            onChange={e => setFormData({ ...formData, taxRate: validatePrice(e.target.value) })}\r\n                            placeholder=\"0-100\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\">Save Settings</Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst TimeSlotsModal = ({ timeSlots, onSave, onClose }) => {\r\n    const [slots, setSlots] = useState(timeSlots.map(s => ({ ...s })));\r\n\r\n    const handleSlotChange = (id, field, value) => {\r\n        setSlots(slots.map(s =>\r\n            s.id === id ? { ...s, [field]: value } : s\r\n        ));\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        for (const slot of slots) {\r\n            await mockApi.updateTimeSlot(slot.id, slot);\r\n        }\r\n        onSave();\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content modal-wide\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Edit Time Slots</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"time-slots-editor\">\r\n                        {slots.map(slot => (\r\n                            <div key={slot.id} className=\"time-slot-edit-row\">\r\n                                <div className=\"form-group\">\r\n                                    <label>Name</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={slot.name}\r\n                                        onChange={e => handleSlotChange(slot.id, 'name', e.target.value)}\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Start Time</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={slot.startTime}\r\n                                        onChange={e => handleSlotChange(slot.id, 'startTime', e.target.value)}\r\n                                        placeholder=\"e.g. 8:00 AM\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>End Time</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={slot.endTime}\r\n                                        onChange={e => handleSlotChange(slot.id, 'endTime', e.target.value)}\r\n                                        placeholder=\"e.g. 12:00 PM\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Max Bookings</label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        min=\"1\"\r\n                                        max=\"20\"\r\n                                        value={slot.maxBookings}\r\n                                        onChange={e => handleSlotChange(slot.id, 'maxBookings', parseInt(e.target.value) || 1)}\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Active</label>\r\n                                    <label className=\"toggle-switch inline\">\r\n                                        <input\r\n                                            type=\"checkbox\"\r\n                                            checked={slot.active}\r\n                                            onChange={e => handleSlotChange(slot.id, 'active', e.target.checked)}\r\n                                        />\r\n                                        <span className=\"toggle-slider\"></span>\r\n                                    </label>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\">Save Time Slots</Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst CustomerModal = ({ customer, onSave, onClose }) => {\r\n    const [formData, setFormData] = useState({\r\n        name: customer?.name || '',\r\n        email: customer?.email || '',\r\n        phone: customer?.phone || '',\r\n        notes: customer?.notes || '',\r\n        tags: customer?.tags?.join(', ') || ''\r\n    });\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSave({\r\n            ...formData,\r\n            tags: formData.tags.split(',').map(t => t.trim()).filter(t => t)\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>{customer ? 'Edit Customer' : 'Add New Customer'}</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group\">\r\n                        <label>Full Name</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.name}\r\n                            onChange={e => setFormData({ ...formData, name: e.target.value })}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Email</label>\r\n                        <input\r\n                            type=\"email\"\r\n                            value={formData.email}\r\n                            onChange={e => setFormData({ ...formData, email: e.target.value })}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Phone</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.phone}\r\n                            onChange={e => setFormData({ ...formData, phone: validatePhone(e.target.value) })}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Notes</label>\r\n                        <textarea\r\n                            value={formData.notes}\r\n                            onChange={e => setFormData({ ...formData, notes: e.target.value })}\r\n                            rows=\"3\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Tags (comma-separated)</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.tags}\r\n                            onChange={e => setFormData({ ...formData, tags: e.target.value })}\r\n                            placeholder=\"vip, business, repeat\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\">{customer ? 'Update' : 'Add'} Customer</Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst InventoryModal = ({ item, onSave, onClose }) => {\r\n    const [formData, setFormData] = useState({\r\n        name: item?.name || '',\r\n        sku: item?.sku || '',\r\n        category: item?.category || 'screens',\r\n        quantity: item?.quantity || 0,\r\n        minStock: item?.minStock || 5,\r\n        cost: item?.cost || '',\r\n        supplier: item?.supplier || ''\r\n    });\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSave({\r\n            ...formData,\r\n            quantity: Number(formData.quantity),\r\n            minStock: Number(formData.minStock),\r\n            cost: Number(formData.cost)\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>{item ? 'Edit Inventory Item' : 'Add New Item'}</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group\">\r\n                        <label>Item Name</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.name}\r\n                            onChange={e => setFormData({ ...formData, name: e.target.value })}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>SKU</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={formData.sku}\r\n                                onChange={e => setFormData({ ...formData, sku: e.target.value.toUpperCase() })}\r\n                                placeholder=\"e.g. SCR-IP15\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Category</label>\r\n                            <select value={formData.category} onChange={e => setFormData({ ...formData, category: e.target.value })}>\r\n                                <option value=\"screens\">Screens</option>\r\n                                <option value=\"batteries\">Batteries</option>\r\n                                <option value=\"components\">Components</option>\r\n                                <option value=\"storage\">Storage</option>\r\n                                <option value=\"tools\">Tools</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>Quantity</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                min=\"0\"\r\n                                value={formData.quantity}\r\n                                onChange={e => setFormData({ ...formData, quantity: e.target.value })}\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Min Stock Alert</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                min=\"1\"\r\n                                value={formData.minStock}\r\n                                onChange={e => setFormData({ ...formData, minStock: e.target.value })}\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>Cost ($)</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={formData.cost}\r\n                                onChange={e => setFormData({ ...formData, cost: validatePrice(e.target.value) })}\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Supplier</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={formData.supplier}\r\n                                onChange={e => setFormData({ ...formData, supplier: e.target.value })}\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\">{item ? 'Update' : 'Add'} Item</Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst PurchaseOrderModal = ({ order, inventory, onSave, onClose }) => {\r\n    const [formData, setFormData] = useState({\r\n        supplier: order?.supplier || '',\r\n        notes: order?.notes || '',\r\n        items: order?.items || [{ itemId: '', name: '', quantity: 1, cost: 0 }]\r\n    });\r\n\r\n    const suppliers = [...new Set(inventory.map(i => i.supplier))];\r\n\r\n    const handleAddItem = () => {\r\n        setFormData({\r\n            ...formData,\r\n            items: [...formData.items, { itemId: '', name: '', quantity: 1, cost: 0 }]\r\n        });\r\n    };\r\n\r\n    const handleRemoveItem = (index) => {\r\n        const newItems = formData.items.filter((_, i) => i !== index);\r\n        setFormData({ ...formData, items: newItems });\r\n    };\r\n\r\n    const handleItemChange = (index, field, value) => {\r\n        const newItems = [...formData.items];\r\n        newItems[index][field] = value;\r\n\r\n        // If itemId changes, update name and cost from inventory\r\n        if (field === 'itemId' && value) {\r\n            const invItem = inventory.find(i => i.id === parseInt(value));\r\n            if (invItem) {\r\n                newItems[index].name = invItem.name;\r\n                newItems[index].cost = invItem.cost;\r\n            }\r\n        }\r\n\r\n        setFormData({ ...formData, items: newItems });\r\n    };\r\n\r\n    const calculateTotal = () => {\r\n        return formData.items.reduce((sum, item) => sum + (item.quantity * item.cost), 0);\r\n    };\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        if (formData.items.length === 0 || !formData.items[0].itemId) {\r\n            alert('Please add at least one item');\r\n            return;\r\n        }\r\n        onSave({\r\n            ...formData,\r\n            items: formData.items.filter(i => i.itemId).map(i => ({\r\n                ...i,\r\n                itemId: parseInt(i.itemId),\r\n                quantity: parseInt(i.quantity),\r\n                cost: parseFloat(i.cost)\r\n            }))\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content modal-large\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>{order ? 'Edit Purchase Order' : 'New Purchase Order'}</h2>\r\n                    <button className=\"close-btn\" onClick={onClose}><X size={20} /></button>\r\n                </div>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>Supplier</label>\r\n                            <select\r\n                                value={formData.supplier}\r\n                                onChange={e => setFormData({ ...formData, supplier: e.target.value })}\r\n                                required\r\n                            >\r\n                                <option value=\"\">Select Supplier</option>\r\n                                {suppliers.map(s => (\r\n                                    <option key={s} value={s}>{s}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Notes</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={formData.notes}\r\n                                onChange={e => setFormData({ ...formData, notes: e.target.value })}\r\n                                placeholder=\"Optional notes\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"po-items-section\">\r\n                        <h4>Order Items</h4>\r\n                        <table className=\"po-items-table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Item</th>\r\n                                    <th>Quantity</th>\r\n                                    <th>Unit Cost</th>\r\n                                    <th>Subtotal</th>\r\n                                    <th></th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {formData.items.map((item, index) => (\r\n                                    <tr key={index}>\r\n                                        <td>\r\n                                            <select\r\n                                                value={item.itemId}\r\n                                                onChange={e => handleItemChange(index, 'itemId', e.target.value)}\r\n                                                required\r\n                                            >\r\n                                                <option value=\"\">Select Item</option>\r\n                                                {inventory\r\n                                                    .filter(i => !formData.supplier || i.supplier === formData.supplier)\r\n                                                    .map(i => (\r\n                                                        <option key={i.id} value={i.id}>{i.name} ({i.sku})</option>\r\n                                                    ))\r\n                                                }\r\n                                            </select>\r\n                                        </td>\r\n                                        <td>\r\n                                            <input\r\n                                                type=\"number\"\r\n                                                min=\"1\"\r\n                                                value={item.quantity}\r\n                                                onChange={e => handleItemChange(index, 'quantity', e.target.value)}\r\n                                                required\r\n                                            />\r\n                                        </td>\r\n                                        <td>${item.cost}</td>\r\n                                        <td><strong>${(item.quantity * item.cost).toFixed(2)}</strong></td>\r\n                                        <td>\r\n                                            {formData.items.length > 1 && (\r\n                                                <button type=\"button\" className=\"icon-btn danger\" onClick={() => handleRemoveItem(index)}>\r\n                                                    <Trash2 size={14} />\r\n                                                </button>\r\n                                            )}\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                            <tfoot>\r\n                                <tr>\r\n                                    <td colSpan=\"3\" style={{ textAlign: 'right' }}><strong>Total:</strong></td>\r\n                                    <td><strong>${calculateTotal().toFixed(2)}</strong></td>\r\n                                    <td></td>\r\n                                </tr>\r\n                            </tfoot>\r\n                        </table>\r\n                        <Button type=\"button\" variant=\"secondary\" onClick={handleAddItem}>\r\n                            <Plus size={14} /> Add Item\r\n                        </Button>\r\n                    </div>\r\n\r\n                    <div className=\"modal-actions\">\r\n                        <Button variant=\"secondary\" type=\"button\" onClick={onClose}>Cancel</Button>\r\n                        <Button variant=\"primary\" type=\"submit\">{order ? 'Update' : 'Create'} Order</Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AdminDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\staff\\pages\\EmployeeDashboard.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadBookings'. Either include it or remove the dependency array.","line":91,"column":8,"nodeType":"ArrayExpression","endLine":91,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [loadBookings]","fix":{"range":[4324,4326],"text":"[loadBookings]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'completedCount' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":233,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":233,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"completedCount"},"fix":{"range":[9259,9336],"text":""},"desc":"Remove unused variable 'completedCount'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'todaysBookings' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":234,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":234,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"todaysBookings"},"fix":{"range":[9342,9455],"text":""},"desc":"Remove unused variable 'todaysBookings'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { api } from '../../../services/apiClient';\r\nimport { mockApi } from '../../../services/mockApi'; // Keep for legacy operations\r\nimport { useAuth } from '../../../context/AuthContext';\r\nimport { useNotifications } from '../../../context/NotificationContext';\r\nimport { NotificationBell } from '../../../components/Notifications';\r\nimport Button from '../../../components/Button';\r\nimport ThemeToggle from '../../../components/ThemeToggle';\r\nimport { RefreshCw, Activity, Calendar, Clipboard, User, MessageSquare, Search, DollarSign, Clock, AlertTriangle, Play, Square, TrendingUp, CheckCircle, X, LogOut, ChevronLeft, ChevronRight, Camera, Upload, Trash2 } from 'lucide-react';\r\nimport { validateText } from '../../../utils/validation';\r\nimport { getDeviceName, getCustomerName, getBookingDate } from '../../../utils/schemaHelpers';\r\nimport './EmployeeDashboard.css';\r\n\r\nconst EmployeeDashboard = () => {\r\n    const { user, logout } = useAuth();\r\n    const { addNotification } = useNotifications();\r\n    const [activeTab, setActiveTab] = useState('dashboard');\r\n    const [bookings, setBookings] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [selectedBooking, setSelectedBooking] = useState(null);\r\n    const [noteText, setNoteText] = useState('');\r\n    const [lastUpdate, setLastUpdate] = useState(new Date());\r\n    const [autoRefresh, setAutoRefresh] = useState(true);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [statusFilter, setStatusFilter] = useState('all');\r\n    const [costEstimateInput, setCostEstimateInput] = useState('');\r\n    const previousBookingsRef = useRef([]);\r\n    const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n\r\n    // Gallery state\r\n    const [galleryItems, setGalleryItems] = useState([]);\r\n    const [newGalleryItem, setNewGalleryItem] = useState({\r\n        title: '',\r\n        description: '',\r\n        beforeImage: '',\r\n        afterImage: ''\r\n    });\r\n\r\n    // Filter bookings based on search and status\r\n    const filteredBookings = bookings.filter(booking => {\r\n        const matchesSearch = searchQuery.trim() === '' ||\r\n            getDeviceName(booking.device).toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n            getCustomerName(booking.customer).toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n            booking.id?.toLowerCase().includes(searchQuery.toLowerCase());\r\n\r\n        const matchesStatus = statusFilter === 'all' || booking.status === statusFilter;\r\n\r\n        return matchesSearch && matchesStatus;\r\n    });\r\n\r\n    const loadBookings = useCallback(async (showLoading = false, isInitialLoad = false) => {\r\n        if (showLoading) setLoading(true);\r\n        try {\r\n            const data = await api.bookings.list();\r\n\r\n            // Check for new bookings (only after initial load)\r\n            if (!isInitialLoad && previousBookingsRef.current.length > 0) {\r\n                const previousIds = previousBookingsRef.current.map(b => b.id);\r\n                const newBookings = data.filter(b => !previousIds.includes(b.id));\r\n\r\n                newBookings.forEach(booking => {\r\n                    addNotification({\r\n                        type: 'new_booking',\r\n                        title: 'New Booking',\r\n                        message: `${getCustomerName(booking.customer)} booked ${getDeviceName(booking.device)} for ${getBookingDate(booking)}`\r\n                    });\r\n                });\r\n            }\r\n\r\n            previousBookingsRef.current = data;\r\n            setBookings(data);\r\n            setLastUpdate(new Date());\r\n            if (selectedBooking) {\r\n                const updated = data.find(b => b.id === selectedBooking.id);\r\n                if (updated) setSelectedBooking(updated);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to load bookings', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [selectedBooking, addNotification]);\r\n\r\n    useEffect(() => {\r\n        loadBookings(true, true); // Initial load\r\n        // Load gallery items from localStorage\r\n        const stored = localStorage.getItem('galleryItems');\r\n        if (stored) {\r\n            setGalleryItems(JSON.parse(stored));\r\n        }\r\n    }, []);\r\n\r\n    // Auto-refresh every 15 seconds\r\n    useEffect(() => {\r\n        if (!autoRefresh) return;\r\n\r\n        // Refresh immediately when enabled\r\n        loadBookings(false);\r\n\r\n        const interval = setInterval(() => {\r\n            loadBookings(false);\r\n        }, 15000);\r\n        return () => clearInterval(interval);\r\n    }, [autoRefresh, loadBookings]);\r\n\r\n    const handleStatusChange = async (id, newStatus) => {\r\n        // Confirm critical status changes\r\n        if (newStatus === 'Cancelled') {\r\n            if (!window.confirm('Are you sure you want to cancel this booking? This action cannot be easily undone.')) {\r\n                return;\r\n            }\r\n        }\r\n        if (newStatus === 'Completed') {\r\n            if (!window.confirm('Mark this repair as completed? The customer will be notified.')) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        try {\r\n            await mockApi.updateBookingStatus(id, newStatus);\r\n\r\n            // Find the booking to get details for notification\r\n            const booking = bookings.find(b => b.id === id);\r\n            if (booking) {\r\n                addNotification({\r\n                    type: 'status_change',\r\n                    title: 'Status Updated',\r\n                    message: `${getDeviceName(booking.device)} status changed to \"${newStatus}\"`\r\n                });\r\n            }\r\n\r\n            loadBookings(false);\r\n            if (selectedBooking && selectedBooking.id === id) {\r\n                setSelectedBooking({ ...selectedBooking, status: newStatus });\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to update status', error);\r\n        }\r\n    };\r\n\r\n    const handleAddNote = async (e) => {\r\n        e.preventDefault();\r\n        if (!noteText.trim() || !selectedBooking) return;\r\n\r\n        try {\r\n            await mockApi.addBookingNote(selectedBooking.id, noteText, user.name);\r\n            setNoteText('');\r\n            loadBookings(false);\r\n            const updatedBooking = {\r\n                ...selectedBooking,\r\n                notes: [...selectedBooking.notes, {\r\n                    id: Date.now(),\r\n                    text: noteText,\r\n                    author: user.name,\r\n                    date: new Date().toISOString().split('T')[0]\r\n                }]\r\n            };\r\n            setSelectedBooking(updatedBooking);\r\n        } catch (error) {\r\n            console.error('Failed to add note', error);\r\n        }\r\n    };\r\n\r\n    const handlePriorityChange = async (id, priority) => {\r\n        try {\r\n            await mockApi.updateBookingPriority(id, priority);\r\n            loadBookings(false);\r\n            if (selectedBooking && selectedBooking.id === id) {\r\n                setSelectedBooking({ ...selectedBooking, priority });\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to update priority', error);\r\n        }\r\n    };\r\n\r\n    const handleCostEstimateUpdate = async (e) => {\r\n        e.preventDefault();\r\n        if (!selectedBooking || costEstimateInput === '') return;\r\n\r\n        const cost = parseFloat(costEstimateInput);\r\n        if (isNaN(cost) || cost < 0) {\r\n            alert('Please enter a valid cost amount');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            await mockApi.updateBookingCostEstimate(selectedBooking.id, cost);\r\n            loadBookings(false);\r\n            setSelectedBooking({ ...selectedBooking, costEstimate: cost });\r\n        } catch (error) {\r\n            console.error('Failed to update cost estimate', error);\r\n        }\r\n    };\r\n\r\n    const handleStartTimer = async () => {\r\n        if (!selectedBooking) return;\r\n        try {\r\n            const updated = await mockApi.startRepairTimer(selectedBooking.id);\r\n            setSelectedBooking(updated);\r\n            loadBookings(false);\r\n        } catch (error) {\r\n            console.error('Failed to start timer', error);\r\n        }\r\n    };\r\n\r\n    const handleStopTimer = async () => {\r\n        if (!selectedBooking) return;\r\n        try {\r\n            const updated = await mockApi.stopRepairTimer(selectedBooking.id);\r\n            setSelectedBooking(updated);\r\n            loadBookings(false);\r\n        } catch (error) {\r\n            console.error('Failed to stop timer', error);\r\n        }\r\n    };\r\n\r\n    const formatTime = (minutes) => {\r\n        if (!minutes) return '0m';\r\n        const hrs = Math.floor(minutes / 60);\r\n        const mins = minutes % 60;\r\n        return hrs > 0 ? `${hrs}h ${mins}m` : `${mins}m`;\r\n    };\r\n\r\n    const isTimerRunning = (booking) => {\r\n        return booking?.timeTracking?.startTime && !booking?.timeTracking?.endTime;\r\n    };\r\n\r\n    if (loading) return <div className=\"loading\">Loading...</div>;\r\n\r\n    // Calculate stats for dashboard\r\n    const pendingCount = bookings.filter(b => b.status === 'Pending').length;\r\n    const inProgressCount = bookings.filter(b => b.status === 'In Progress').length;\r\n    const completedCount = bookings.filter(b => b.status === 'Completed').length;\r\n    const todaysBookings = bookings.filter(b => getBookingDate(b) === new Date().toISOString().split('T')[0]).length;\r\n\r\n    return (\r\n        <div className=\"admin-layout\">\r\n            {/* Sidebar */}\r\n            <aside className={`admin-sidebar ${sidebarCollapsed ? 'collapsed' : ''}`}>\r\n                <button\r\n                    className=\"sidebar-toggle\"\r\n                    onClick={() => setSidebarCollapsed(!sidebarCollapsed)}\r\n                    title={sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'}\r\n                >\r\n                    {sidebarCollapsed ? <ChevronRight size={16} /> : <ChevronLeft size={16} />}\r\n                </button>\r\n                <div className=\"sidebar-header\">\r\n                    <h2 className=\"sidebar-logo\">SIFIXA</h2>\r\n                    <span className=\"sidebar-subtitle\">Employee Panel</span>\r\n                </div>\r\n\r\n                <nav className=\"sidebar-nav\">\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'dashboard' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('dashboard')}\r\n                    >\r\n                        <TrendingUp size={20} />\r\n                        <span>Dashboard</span>\r\n                    </button>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'bookings' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('bookings')}\r\n                    >\r\n                        <Clipboard size={20} />\r\n                        <span>My Bookings</span>\r\n                    </button>\r\n                    <button\r\n                        className={`sidebar-link ${activeTab === 'gallery' ? 'active' : ''}`}\r\n                        onClick={() => setActiveTab('gallery')}\r\n                    >\r\n                        <Camera size={20} />\r\n                        <span>Gallery</span>\r\n                    </button>\r\n                </nav>\r\n\r\n                <div className=\"sidebar-footer\">\r\n                    <div className=\"sidebar-user\">\r\n                        <div className=\"user-avatar\">{user?.name?.charAt(0) || 'E'}</div>\r\n                        <div className=\"user-info\">\r\n                            <span className=\"user-name\">{user?.name}</span>\r\n                            <span className=\"user-role\">Employee</span>\r\n                        </div>\r\n                    </div>\r\n                    <button className=\"sidebar-logout\" onClick={logout}>\r\n                        <LogOut size={18} />\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Main Content */}\r\n            <main className={`admin-main ${sidebarCollapsed ? 'expanded' : ''}`}>\r\n                <div className=\"admin-topbar\">\r\n                    <div className=\"topbar-left\">\r\n                        <h1 className=\"page-title\">\r\n                            {activeTab === 'dashboard' && 'Dashboard Overview'}\r\n                            {activeTab === 'bookings' && 'My Bookings'}\r\n                            {activeTab === 'gallery' && 'Before & After Gallery'}\r\n                        </h1>\r\n                    </div>\r\n                    <div className=\"topbar-actions\">\r\n                        <div className=\"refresh-controls\">\r\n                            <button\r\n                                className={`auto-refresh-btn ${autoRefresh ? 'active' : ''}`}\r\n                                onClick={() => setAutoRefresh(!autoRefresh)}\r\n                                title={autoRefresh ? 'Auto-refresh ON' : 'Auto-refresh OFF'}\r\n                            >\r\n                                <Activity size={16} />\r\n                            </button>\r\n                            <button className=\"refresh-btn\" onClick={() => loadBookings(false)} title=\"Refresh now\">\r\n                                <RefreshCw size={16} />\r\n                            </button>\r\n                            <span className=\"last-update\">\r\n                                {lastUpdate.toLocaleTimeString()}\r\n                            </span>\r\n                        </div>\r\n                        <NotificationBell />\r\n                        <ThemeToggle />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"admin-content\">\r\n                    {/* DASHBOARD TAB */}\r\n                    {activeTab === 'dashboard' && (\r\n                        <div className=\"dashboard-overview\">\r\n                            {/* Stats Cards */}\r\n                            <div className=\"stats-grid\">\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon blue\"><Clipboard size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{bookings.length}</span>\r\n                                        <span className=\"stat-label\">Total Assigned</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon orange\"><Clock size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{pendingCount}</span>\r\n                                        <span className=\"stat-label\">Pending</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"stat-card\">\r\n                                    <div className=\"stat-icon cyan\"><AlertTriangle size={24} /></div>\r\n                                    <div className=\"stat-info\">\r\n                                        <span className=\"stat-value\">{inProgressCount}</span>\r\n                                        <span className=\"stat-label\">In Progress</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Recent Bookings */}\r\n                            <div className=\"dashboard-section\">\r\n                                <div className=\"section-header\">\r\n                                    <h2>Recent Bookings</h2>\r\n                                    <Button variant=\"secondary\" onClick={() => setActiveTab('bookings')}>\r\n                                        View All\r\n                                    </Button>\r\n                                </div>\r\n                                <div className=\"recent-bookings-list\">\r\n                                    {bookings.slice(0, 5).map(booking => (\r\n                                        <div key={booking.id} className=\"recent-booking-item\" onClick={() => { setSelectedBooking(booking); setActiveTab('bookings'); }}>\r\n                                            <div className=\"booking-info\">\r\n                                                <strong>{getDeviceName(booking.device)}</strong>\r\n                                                <span>{getCustomerName(booking.customer)}</span>\r\n                                            </div>\r\n                                            <div className=\"booking-meta\">\r\n                                                <span className=\"booking-date\">{getBookingDate(booking)}</span>\r\n                                                <span className={`status-badge ${booking.status?.toLowerCase().replace(' ', '-')}`}>\r\n                                                    {booking.status}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                    {bookings.length === 0 && (\r\n                                        <p className=\"no-data\">No bookings assigned yet</p>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* BOOKINGS TAB */}\r\n                    {activeTab === 'bookings' && (\r\n                        <div className=\"bookings-section\">\r\n                            <div className=\"table-header\">\r\n                                <h2><Clipboard size={20} /> Assigned Bookings</h2>\r\n                                <span className=\"booking-count\">{filteredBookings.length} of {bookings.length} bookings</span>\r\n                            </div>\r\n\r\n                            {/* Search and Filter Controls */}\r\n                            <div className=\"filter-controls\">\r\n                                <div className=\"search-box\">\r\n                                    <Search size={18} />\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        placeholder=\"Search by device, customer, or ID...\"\r\n                                        value={searchQuery}\r\n                                        onChange={(e) => setSearchQuery(e.target.value)}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"status-filter\">\r\n                                    <label>Status:</label>\r\n                                    <select value={statusFilter} onChange={(e) => setStatusFilter(e.target.value)}>\r\n                                        <option value=\"all\">All Statuses</option>\r\n                                        <option value=\"Pending\">Pending</option>\r\n                                        <option value=\"Confirmed\">Confirmed</option>\r\n                                        <option value=\"In Progress\">In Progress</option>\r\n                                        <option value=\"Completed\">Completed</option>\r\n                                        <option value=\"Cancelled\">Cancelled</option>\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"dashboard-grid\">\r\n                                <div className=\"bookings-list\">\r\n                                    <div className=\"bookings-container\">\r\n                                        {filteredBookings.length === 0 ? (\r\n                                            <div className=\"empty-state\">\r\n                                                <p>{bookings.length === 0 ? 'No bookings yet.' : 'No bookings match your search.'}</p>\r\n                                            </div>\r\n                                        ) : (\r\n                                            filteredBookings.map(booking => (\r\n                                                <div\r\n                                                    key={booking.id}\r\n                                                    className={`booking-card ${selectedBooking?.id === booking.id ? 'active' : ''} ${booking.priority === 'urgent' ? 'priority-urgent' : ''}`}\r\n                                                    onClick={() => setSelectedBooking(booking)}\r\n                                                >\r\n                                                    <div className=\"booking-card-header\">\r\n                                                        <div className=\"device-with-priority\">\r\n                                                            <span className=\"device-name\">{getDeviceName(booking.device)}</span>\r\n                                                            {(booking.priority === 'urgent' || booking.priority === 'high') && (\r\n                                                                <span className={`priority-badge ${booking.priority}`}>\r\n                                                                    <AlertTriangle size={12} />\r\n                                                                    {booking.priority}\r\n                                                                </span>\r\n                                                            )}\r\n                                                        </div>\r\n                                                        <span className={`status-badge ${booking.status?.toLowerCase().replace(' ', '-')}`}>\r\n                                                            {booking.status}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                    <p className=\"booking-date\">\r\n                                                        <Calendar size={14} /> {getBookingDate(booking)} ΓÇó {booking.timeSlot?.name || booking.scheduledStart || booking.time || ''}\r\n                                                    </p>\r\n                                                    <div className=\"booking-card-footer\">\r\n                                                        <p className=\"customer-name\">\r\n                                                            <User size={14} /> {getCustomerName(booking.customer)}\r\n                                                        </p>\r\n                                                        {booking.costEstimate && (\r\n                                                            <span className=\"cost-badge\">\r\n                                                                <DollarSign size={12} />${booking.costEstimate}\r\n                                                            </span>\r\n                                                        )}\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"booking-details\">\r\n                                    {selectedBooking ? (\r\n                                        <div className=\"details-content\">\r\n                                            <div className=\"details-header\">\r\n                                                <div>\r\n                                                    <h2>Booking Details</h2>\r\n                                                    <span className=\"booking-id\">#{selectedBooking.id}</span>\r\n                                                </div>\r\n                                                <div className=\"header-controls\">\r\n                                                    <div className=\"priority-select\">\r\n                                                        <AlertTriangle size={16} />\r\n                                                        <select\r\n                                                            value={selectedBooking.priority || 'normal'}\r\n                                                            onChange={(e) => handlePriorityChange(selectedBooking.id, e.target.value)}\r\n                                                            className={`priority-dropdown ${selectedBooking.priority || 'normal'}`}\r\n                                                        >\r\n                                                            <option value=\"low\">Low</option>\r\n                                                            <option value=\"normal\">Normal</option>\r\n                                                            <option value=\"high\">High</option>\r\n                                                            <option value=\"urgent\">Urgent</option>\r\n                                                        </select>\r\n                                                    </div>\r\n                                                    <div className=\"status-actions\">\r\n                                                        <select\r\n                                                            value={selectedBooking.status}\r\n                                                            onChange={(e) => handleStatusChange(selectedBooking.id, e.target.value)}\r\n                                                        >\r\n                                                            <option value=\"Pending\">Pending</option>\r\n                                                            <option value=\"Confirmed\">Confirmed</option>\r\n                                                            <option value=\"In Progress\">In Progress</option>\r\n                                                            <option value=\"Completed\">Completed</option>\r\n                                                            <option value=\"Cancelled\">Cancelled</option>\r\n                                                        </select>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Time Tracking Bar */}\r\n                                            <div className=\"time-tracking-bar\">\r\n                                                <div className=\"time-info\">\r\n                                                    <Clock size={18} />\r\n                                                    <span className=\"time-label\">Time Tracked:</span>\r\n                                                    <span className=\"time-value\">{formatTime(selectedBooking.timeTracking?.totalMinutes)}</span>\r\n                                                    {isTimerRunning(selectedBooking) && (\r\n                                                        <span className=\"timer-running\">\r\n                                                            <span className=\"pulse-dot\"></span>\r\n                                                            Timer running...\r\n                                                        </span>\r\n                                                    )}\r\n                                                </div>\r\n                                                <div className=\"timer-controls\">\r\n                                                    {!isTimerRunning(selectedBooking) ? (\r\n                                                        <button className=\"timer-btn start\" onClick={handleStartTimer} title=\"Start Timer\">\r\n                                                            <Play size={16} /> Start\r\n                                                        </button>\r\n                                                    ) : (\r\n                                                        <button className=\"timer-btn stop\" onClick={handleStopTimer} title=\"Stop Timer\">\r\n                                                            <Square size={16} /> Stop\r\n                                                        </button>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"details-grid\">\r\n                                                <div className=\"info-card\">\r\n                                                    <h3><Clipboard size={16} /> Device Info</h3>\r\n                                                    <p><strong>Model:</strong> {getDeviceName(selectedBooking.device)}</p>\r\n                                                    <p><strong>Issue:</strong> {selectedBooking.issue || selectedBooking.notes || 'N/A'}</p>\r\n                                                </div>\r\n\r\n                                                <div className=\"info-card\">\r\n                                                    <h3><User size={16} /> Customer Info</h3>\r\n                                                    <p><strong>Name:</strong> {getCustomerName(selectedBooking.customer)}</p>\r\n                                                    <p><strong>Email:</strong> {selectedBooking.customer?.email || 'N/A'}</p>\r\n                                                    <p><strong>Phone:</strong> {selectedBooking.customer?.phone || 'N/A'}</p>\r\n                                                </div>\r\n\r\n                                                <div className=\"info-card\">\r\n                                                    <h3><Calendar size={16} /> Appointment</h3>\r\n                                                    <p><strong>Date:</strong> {getBookingDate(selectedBooking)}</p>\r\n                                                    <p><strong>Time:</strong> {selectedBooking.timeSlot?.name || selectedBooking.scheduledStart || selectedBooking.time || 'N/A'}</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Cost Estimate Section */}\r\n                                            <div className=\"cost-estimate-section\">\r\n                                                <h3><DollarSign size={16} /> Cost Estimate</h3>\r\n                                                <div className=\"cost-estimate-content\">\r\n                                                    <div className=\"current-estimate\">\r\n                                                        <span className=\"estimate-label\">Current Estimate:</span>\r\n                                                        <span className=\"estimate-value\">\r\n                                                            {selectedBooking.costEstimate != null\r\n                                                                ? `$${selectedBooking.costEstimate.toFixed(2)}`\r\n                                                                : 'Not set'}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                    <form className=\"update-estimate-form\" onSubmit={handleCostEstimateUpdate}>\r\n                                                        <div className=\"input-group\">\r\n                                                            <span className=\"currency-symbol\">$</span>\r\n                                                            <input\r\n                                                                type=\"number\"\r\n                                                                placeholder=\"Enter estimate...\"\r\n                                                                value={costEstimateInput}\r\n                                                                onChange={(e) => setCostEstimateInput(e.target.value)}\r\n                                                                min=\"0\"\r\n                                                                step=\"0.01\"\r\n                                                            />\r\n                                                        </div>\r\n                                                        <Button variant=\"primary\" type=\"submit\" disabled={!costEstimateInput}>Update</Button>\r\n                                                    </form>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"notes-section\">\r\n                                                <h3><MessageSquare size={16} /> Notes ({selectedBooking.notes.length})</h3>\r\n                                                <div className=\"notes-list\">\r\n                                                    {selectedBooking.notes.length === 0 && <p className=\"no-notes\">No notes yet.</p>}\r\n                                                    {selectedBooking.notes.map(note => (\r\n                                                        <div key={note.id} className=\"note-item\">\r\n                                                            <div className=\"note-header\">\r\n                                                                <span className=\"note-author\">{note.author}</span>\r\n                                                                <span className=\"note-date\">{note.date}</span>\r\n                                                            </div>\r\n                                                            <p>{note.text}</p>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                                <form className=\"add-note-form\" onSubmit={handleAddNote}>\r\n                                                    <input\r\n                                                        type=\"text\"\r\n                                                        placeholder=\"Add a note...\"\r\n                                                        value={noteText}\r\n                                                        onChange={(e) => setNoteText(validateText(e.target.value))}\r\n                                                        maxLength={500}\r\n                                                    />\r\n                                                    <Button variant=\"primary\" type=\"submit\" disabled={!noteText.trim()}>Add</Button>\r\n                                                </form>\r\n                                            </div>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"empty-state\">\r\n                                            <Clipboard size={48} />\r\n                                            <p>Select a booking to view details</p>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* GALLERY TAB */}\r\n                    {activeTab === 'gallery' && (\r\n                        <div className=\"gallery-management\">\r\n                            <div className=\"gallery-upload-section\">\r\n                                <div className=\"upload-card\">\r\n                                    <h3><Upload size={20} /> Add New Before & After</h3>\r\n                                    <form onSubmit={(e) => {\r\n                                        e.preventDefault();\r\n                                        if (!newGalleryItem.title || !newGalleryItem.beforeImage || !newGalleryItem.afterImage) {\r\n                                            alert('Please fill in all required fields');\r\n                                            return;\r\n                                        }\r\n                                        const newItem = {\r\n                                            id: Date.now(),\r\n                                            ...newGalleryItem\r\n                                        };\r\n                                        const updatedItems = [...galleryItems, newItem];\r\n                                        setGalleryItems(updatedItems);\r\n                                        localStorage.setItem('galleryItems', JSON.stringify(updatedItems));\r\n                                        setNewGalleryItem({ title: '', description: '', beforeImage: '', afterImage: '' });\r\n                                        addNotification({\r\n                                            type: 'success',\r\n                                            title: 'Gallery Updated',\r\n                                            message: 'New before/after photo added successfully'\r\n                                        });\r\n                                    }}>\r\n                                        <div className=\"form-group\">\r\n                                            <label>Title *</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                placeholder=\"e.g., iPhone Screen Repair\"\r\n                                                value={newGalleryItem.title}\r\n                                                onChange={(e) => setNewGalleryItem({ ...newGalleryItem, title: e.target.value })}\r\n                                                required\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"form-group\">\r\n                                            <label>Description</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                placeholder=\"e.g., Shattered screen restored\"\r\n                                                value={newGalleryItem.description}\r\n                                                onChange={(e) => setNewGalleryItem({ ...newGalleryItem, description: e.target.value })}\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"image-inputs\">\r\n                                            <div className=\"form-group\">\r\n                                                <label>Before Image URL *</label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    placeholder=\"/gallery/before-image.png\"\r\n                                                    value={newGalleryItem.beforeImage}\r\n                                                    onChange={(e) => setNewGalleryItem({ ...newGalleryItem, beforeImage: e.target.value })}\r\n                                                    required\r\n                                                />\r\n                                                {newGalleryItem.beforeImage && (\r\n                                                    <img src={newGalleryItem.beforeImage} alt=\"Before preview\" className=\"image-preview\" />\r\n                                                )}\r\n                                            </div>\r\n                                            <div className=\"form-group\">\r\n                                                <label>After Image URL *</label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    placeholder=\"/gallery/after-image.png\"\r\n                                                    value={newGalleryItem.afterImage}\r\n                                                    onChange={(e) => setNewGalleryItem({ ...newGalleryItem, afterImage: e.target.value })}\r\n                                                    required\r\n                                                />\r\n                                                {newGalleryItem.afterImage && (\r\n                                                    <img src={newGalleryItem.afterImage} alt=\"After preview\" className=\"image-preview\" />\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                        <Button variant=\"primary\" type=\"submit\">\r\n                                            <Upload size={16} /> Add to Gallery\r\n                                        </Button>\r\n                                    </form>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"gallery-list-section\">\r\n                                <h3><Camera size={20} /> Current Gallery Items ({galleryItems.length})</h3>\r\n                                {galleryItems.length === 0 ? (\r\n                                    <div className=\"empty-state\">\r\n                                        <Camera size={48} />\r\n                                        <p>No gallery items yet. Add your first before/after photo above.</p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"gallery-items-grid\">\r\n                                        {galleryItems.map(item => (\r\n                                            <div key={item.id} className=\"gallery-item-card\">\r\n                                                <div className=\"gallery-images\">\r\n                                                    <div className=\"gallery-image-box\">\r\n                                                        <span className=\"image-label\">Before</span>\r\n                                                        <img src={item.beforeImage} alt=\"Before\" />\r\n                                                    </div>\r\n                                                    <div className=\"gallery-image-box\">\r\n                                                        <span className=\"image-label\">After</span>\r\n                                                        <img src={item.afterImage} alt=\"After\" />\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"gallery-item-info\">\r\n                                                    <h4>{item.title}</h4>\r\n                                                    <p>{item.description}</p>\r\n                                                </div>\r\n                                                <button\r\n                                                    className=\"delete-btn\"\r\n                                                    onClick={() => {\r\n                                                        if (window.confirm('Delete this gallery item?')) {\r\n                                                            const updated = galleryItems.filter(g => g.id !== item.id);\r\n                                                            setGalleryItems(updated);\r\n                                                            localStorage.setItem('galleryItems', JSON.stringify(updated));\r\n                                                        }\r\n                                                    }}\r\n                                                >\r\n                                                    <Trash2 size={16} />\r\n                                                </button>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default EmployeeDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\staff\\pages\\InventoryDashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'api' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"api"},"fix":{"range":[304,354],"text":""},"desc":"Remove unused variable 'api'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'addNotification' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":18,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"addNotification"},"fix":{"range":[869,916],"text":""},"desc":"Remove unused variable 'addNotification'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'showPOModal' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":40,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"showPOModal"},"fix":{"range":[1905,1916],"text":""},"desc":"Remove unused variable 'showPOModal'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setShowPOModal' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":40,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"setShowPOModal"},"fix":{"range":[1916,1932],"text":""},"desc":"Remove unused variable 'setShowPOModal'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'poForm' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":41,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"poForm"},"fix":{"range":[1965,1971],"text":""},"desc":"Remove unused variable 'poForm'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setPOForm' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":41,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"setPOForm"},"fix":{"range":[1971,1982],"text":""},"desc":"Remove unused variable 'setPOForm'."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadData` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  46 |\n  47 |     useEffect(() => {\n> 48 |         loadData();\n     |         ^^^^^^^^ `loadData` accessed before it is declared\n  49 |     }, []);\n  50 |\n  51 |     // Auto-refresh every 30 seconds\n\n  58 |     }, [autoRefresh]);\n  59 |\n> 60 |     const loadData = async (showLoading = true) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 61 |         if (showLoading) setLoading(true);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 62 |         try {\n     ΓÇª\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         if (showLoading) setLoading(false);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |     };\n     | ^^^^^^^ `loadData` is declared here\n  81 |\n  82 |\n  83 |     const handleLogout = () => {","line":48,"column":9,"nodeType":null,"endLine":48,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'categories' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":88,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":88,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"categories"},"fix":{"range":[3356,3484],"text":""},"desc":"Remove unused variable 'categories'."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../../../context/AuthContext';\r\nimport { useNotifications } from '../../../context/NotificationContext';\r\nimport { NotificationBell } from '../../../components/Notifications';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { api } from '../../../services/apiClient';\r\nimport { mockApi } from '../../../services/mockApi'; // Keep for legacy operations\r\nimport {\r\n    Package, Plus, Search, AlertTriangle, TrendingUp, TrendingDown,\r\n    Truck, ClipboardList, BarChart3, Edit2, Trash2, Save, X,\r\n    ChevronDown, ChevronLeft, ChevronRight, RefreshCw, User, LogOut, LayoutDashboard,\r\n    CheckCircle, Clock, Archive, Filter, Download, Timer\r\n} from 'lucide-react';\r\nimport './InventoryDashboard.css';\r\n\r\nconst InventoryDashboard = () => {\r\n    const { user, logout } = useAuth();\r\n    const { addNotification } = useNotifications();\r\n    const navigate = useNavigate();\r\n\r\n    const [activeTab, setActiveTab] = useState('dashboard');\r\n    const [loading, setLoading] = useState(true);\r\n    const [inventory, setInventory] = useState([]);\r\n    const [products, setProducts] = useState([]);\r\n    const [purchaseOrders, setPurchaseOrders] = useState([]);\r\n    const [analytics, setAnalytics] = useState(null);\r\n    const [lowStockAlerts, setLowStockAlerts] = useState([]);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [categoryFilter, setCategoryFilter] = useState('all');\r\n    const [autoRefresh, setAutoRefresh] = useState(true);\r\n    const [lastUpdate, setLastUpdate] = useState(new Date());\r\n    const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n\r\n    // Edit modal state\r\n    const [showEditModal, setShowEditModal] = useState(false);\r\n    const [editingItem, setEditingItem] = useState(null);\r\n    const [editForm, setEditForm] = useState({});\r\n\r\n    // PO modal state\r\n    const [showPOModal, setShowPOModal] = useState(false);\r\n    const [poForm, setPOForm] = useState({\r\n        supplier: '',\r\n        items: [],\r\n        notes: ''\r\n    });\r\n\r\n    useEffect(() => {\r\n        loadData();\r\n    }, []);\r\n\r\n    // Auto-refresh every 30 seconds\r\n    useEffect(() => {\r\n        if (!autoRefresh) return;\r\n        const interval = setInterval(() => {\r\n            loadData(false);\r\n        }, 30000);\r\n        return () => clearInterval(interval);\r\n    }, [autoRefresh]);\r\n\r\n    const loadData = async (showLoading = true) => {\r\n        if (showLoading) setLoading(true);\r\n        try {\r\n            const [inventoryData, productsData, posData, analyticsData, alertsData] = await Promise.all([\r\n                mockApi.getInventory(),\r\n                mockApi.getStoreProducts(),\r\n                mockApi.getPurchaseOrders(),\r\n                mockApi.getInventoryAnalytics(),\r\n                mockApi.getReorderAlerts()\r\n            ]);\r\n            setInventory(inventoryData);\r\n            setProducts(productsData);\r\n            setPurchaseOrders(posData);\r\n            setAnalytics(analyticsData);\r\n            setLowStockAlerts(alertsData);\r\n            setLastUpdate(new Date());\r\n        } catch (error) {\r\n            console.error('Error loading data:', error);\r\n        }\r\n        if (showLoading) setLoading(false);\r\n    };\r\n\r\n\r\n    const handleLogout = () => {\r\n        logout();\r\n        navigate('/login');\r\n    };\r\n\r\n    const categories = [...new Set([\r\n        ...inventory.map(i => i.category),\r\n        ...products.map(p => p.category)\r\n    ])];\r\n\r\n    const filteredInventory = inventory\r\n        .filter(item => categoryFilter === 'all' || item.category === categoryFilter)\r\n        .filter(item =>\r\n            searchTerm === '' ||\r\n            item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            item.sku?.toLowerCase().includes(searchTerm.toLowerCase())\r\n        );\r\n\r\n    const filteredProducts = products\r\n        .filter(item => categoryFilter === 'all' || item.category === categoryFilter)\r\n        .filter(item =>\r\n            searchTerm === '' ||\r\n            item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            item.sku?.toLowerCase().includes(searchTerm.toLowerCase())\r\n        );\r\n\r\n    const getStockStatus = (item) => {\r\n        if (item.quantity === 0) return 'out-of-stock';\r\n        if (item.quantity <= item.minStock) return 'low-stock';\r\n        if (item.quantity <= item.minStock * 2) return 'adequate';\r\n        return 'good';\r\n    };\r\n\r\n    const openEditModal = (item, type) => {\r\n        setEditingItem({ ...item, type });\r\n        setEditForm({\r\n            name: item.name,\r\n            quantity: item.quantity,\r\n            minStock: item.minStock,\r\n            cost: item.cost,\r\n            price: item.price || 0,\r\n            supplier: item.supplier || ''\r\n        });\r\n        setShowEditModal(true);\r\n    };\r\n\r\n    const handleSaveEdit = async () => {\r\n        try {\r\n            if (editingItem.type === 'inventory') {\r\n                await mockApi.updateInventoryItem(editingItem.id, editForm);\r\n            } else {\r\n                await mockApi.updateStoreProduct(editingItem.id, editForm);\r\n            }\r\n            await loadData();\r\n            setShowEditModal(false);\r\n            setEditingItem(null);\r\n        } catch (error) {\r\n            console.error('Error updating item:', error);\r\n            alert('Failed to update item');\r\n        }\r\n    };\r\n\r\n    const handleQuickStockUpdate = async (item, change, type) => {\r\n        try {\r\n            if (type === 'inventory') {\r\n                await mockApi.updateInventoryItem(item.id, {\r\n                    quantity: Math.max(0, item.quantity + change)\r\n                });\r\n            } else {\r\n                await mockApi.updateProductStock(item.id, change);\r\n            }\r\n            await loadData();\r\n        } catch (error) {\r\n            console.error('Error updating stock:', error);\r\n        }\r\n    };\r\n\r\n    const handleReceivePO = async (orderId) => {\r\n        try {\r\n            const order = purchaseOrders.find(po => po.id === orderId);\r\n            if (order) {\r\n                // Update inventory quantities\r\n                for (const item of order.items) {\r\n                    const invItem = inventory.find(i => i.id === item.itemId);\r\n                    if (invItem) {\r\n                        await mockApi.updateInventoryItem(invItem.id, {\r\n                            quantity: invItem.quantity + item.quantity,\r\n                            lastRestocked: new Date().toISOString().split('T')[0]\r\n                        });\r\n                    }\r\n                }\r\n                // Mark PO as received\r\n                await mockApi.updatePurchaseOrder(orderId, {\r\n                    status: 'Received',\r\n                    receivedDate: new Date().toISOString().split('T')[0]\r\n                });\r\n                await loadData();\r\n                alert('Purchase order received successfully!');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error receiving PO:', error);\r\n            alert('Failed to receive purchase order');\r\n        }\r\n    };\r\n\r\n    const renderSidebar = () => (\r\n        <aside className={`inventory-sidebar ${sidebarCollapsed ? 'collapsed' : ''}`}>\r\n            <button\r\n                className=\"sidebar-toggle\"\r\n                onClick={() => setSidebarCollapsed(!sidebarCollapsed)}\r\n                title={sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'}\r\n            >\r\n                {sidebarCollapsed ? <ChevronRight size={16} /> : <ChevronLeft size={16} />}\r\n            </button>\r\n            <div className=\"sidebar-header\">\r\n                <div className=\"logo\">\r\n                    <Package size={28} />\r\n                    <span>Inventory</span>\r\n                </div>\r\n            </div>\r\n\r\n            <nav className=\"sidebar-nav\">\r\n                <button\r\n                    className={`nav-item ${activeTab === 'dashboard' ? 'active' : ''}`}\r\n                    onClick={() => setActiveTab('dashboard')}\r\n                >\r\n                    <LayoutDashboard size={20} />\r\n                    <span>Dashboard</span>\r\n                </button>\r\n                <button\r\n                    className={`nav-item ${activeTab === 'parts' ? 'active' : ''}`}\r\n                    onClick={() => setActiveTab('parts')}\r\n                >\r\n                    <Archive size={20} />\r\n                    <span>Repair Parts</span>\r\n                </button>\r\n                <button\r\n                    className={`nav-item ${activeTab === 'products' ? 'active' : ''}`}\r\n                    onClick={() => setActiveTab('products')}\r\n                >\r\n                    <Package size={20} />\r\n                    <span>Store Products</span>\r\n                </button>\r\n                <button\r\n                    className={`nav-item ${activeTab === 'orders' ? 'active' : ''}`}\r\n                    onClick={() => setActiveTab('orders')}\r\n                >\r\n                    <Truck size={20} />\r\n                    <span>Purchase Orders</span>\r\n                </button>\r\n                <button\r\n                    className={`nav-item ${activeTab === 'alerts' ? 'active' : ''}`}\r\n                    onClick={() => setActiveTab('alerts')}\r\n                >\r\n                    <AlertTriangle size={20} />\r\n                    <span>Low Stock</span>\r\n                    {lowStockAlerts.length > 0 && (\r\n                        <span className=\"alert-badge\">{lowStockAlerts.length}</span>\r\n                    )}\r\n                </button>\r\n            </nav>\r\n\r\n            <div className=\"sidebar-footer\">\r\n                <div className=\"user-info\">\r\n                    <div className=\"user-avatar\">\r\n                        <User size={20} />\r\n                    </div>\r\n                    <div className=\"user-details\">\r\n                        <span className=\"user-name\">{user?.name}</span>\r\n                        <span className=\"user-role\">Data Entry</span>\r\n                    </div>\r\n                </div>\r\n                <button className=\"logout-btn\" onClick={handleLogout}>\r\n                    <LogOut size={18} />\r\n                </button>\r\n            </div>\r\n        </aside>\r\n    );\r\n\r\n    const renderDashboard = () => (\r\n        <div className=\"inventory-dashboard-content\">\r\n            <div className=\"dashboard-header\">\r\n                <h1>Inventory Dashboard</h1>\r\n                <div className=\"header-actions\">\r\n                    <div className=\"refresh-controls\">\r\n                        <button className=\"refresh-btn\" onClick={() => loadData(false)} title=\"Refresh now\">\r\n                            <RefreshCw size={18} />\r\n                        </button>\r\n                        <button\r\n                            className={`auto-refresh-btn ${autoRefresh ? 'active' : ''}`}\r\n                            onClick={() => setAutoRefresh(!autoRefresh)}\r\n                            title={autoRefresh ? 'Disable auto-refresh' : 'Enable auto-refresh'}\r\n                        >\r\n                            <Timer size={18} />\r\n                        </button>\r\n                        <span className=\"last-update\">\r\n                            Updated: {lastUpdate.toLocaleTimeString()}\r\n                        </span>\r\n                    </div>\r\n                    <NotificationBell />\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <div className=\"stats-grid\">\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon total\">\r\n                        <Package size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{analytics?.totalItems || 0}</span>\r\n                        <span className=\"stat-label\">Total Items</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon value\">\r\n                        <TrendingUp size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">${analytics?.totalValue?.toLocaleString() || 0}</span>\r\n                        <span className=\"stat-label\">Inventory Value</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card warning\">\r\n                    <div className=\"stat-icon low\">\r\n                        <AlertTriangle size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{analytics?.stockLevels?.low || 0}</span>\r\n                        <span className=\"stat-label\">Low Stock</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card danger\">\r\n                    <div className=\"stat-icon critical\">\r\n                        <TrendingDown size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{analytics?.stockLevels?.critical || 0}</span>\r\n                        <span className=\"stat-label\">Out of Stock</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon pending\">\r\n                        <Truck size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{analytics?.pendingOrders || 0}</span>\r\n                        <span className=\"stat-label\">Pending Orders</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon spent\">\r\n                        <ClipboardList size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">${analytics?.totalSpent?.toLocaleString() || 0}</span>\r\n                        <span className=\"stat-label\">Total Spent</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"dashboard-sections\">\r\n                <section className=\"dashboard-section\">\r\n                    <h2>Stock by Category</h2>\r\n                    <div className=\"category-list\">\r\n                        {analytics?.valueByCategory?.map(cat => (\r\n                            <div key={cat.name} className=\"category-item\">\r\n                                <div className=\"category-info\">\r\n                                    <span className=\"category-name\">{cat.name}</span>\r\n                                    <span className=\"category-count\">{cat.count} items</span>\r\n                                </div>\r\n                                <span className=\"category-value\">${cat.value.toLocaleString()}</span>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </section>\r\n\r\n                <section className=\"dashboard-section\">\r\n                    <h2>Top Moving Items</h2>\r\n                    <div className=\"moving-list\">\r\n                        {analytics?.topMoving?.map((item, idx) => (\r\n                            <div key={item.name} className=\"moving-item\">\r\n                                <span className=\"moving-rank\">#{idx + 1}</span>\r\n                                <span className=\"moving-name\">{item.name}</span>\r\n                                <span className=\"moving-usage\">{item.avgUsage.toFixed(1)}/month</span>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </section>\r\n\r\n                <section className=\"dashboard-section full-width\">\r\n                    <h2>Reorder Alerts</h2>\r\n                    {lowStockAlerts.length === 0 ? (\r\n                        <p className=\"no-alerts\">All stock levels are adequate! Γ£ô</p>\r\n                    ) : (\r\n                        <div className=\"alerts-list\">\r\n                            {lowStockAlerts.slice(0, 5).map(alert => (\r\n                                <div key={alert.id} className={`alert-item ${alert.urgency}`}>\r\n                                    <div className=\"alert-icon\">\r\n                                        <AlertTriangle size={20} />\r\n                                    </div>\r\n                                    <div className=\"alert-info\">\r\n                                        <span className=\"alert-name\">{alert.name}</span>\r\n                                        <span className=\"alert-stock\">\r\n                                            {alert.quantity} in stock (min: {alert.minStock})\r\n                                        </span>\r\n                                    </div>\r\n                                    <span className={`urgency-badge ${alert.urgency}`}>\r\n                                        {alert.urgency}\r\n                                    </span>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </section>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderInventoryTable = (items, type) => (\r\n        <div className=\"inventory-table-container\">\r\n            <table className=\"inventory-table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th>Item</th>\r\n                        <th>SKU</th>\r\n                        <th>Category</th>\r\n                        <th>Stock</th>\r\n                        <th>Min</th>\r\n                        <th>Cost</th>\r\n                        {type === 'product' && <th>Price</th>}\r\n                        <th>Status</th>\r\n                        <th>Actions</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {items.map(item => (\r\n                        <tr key={item.id} className={getStockStatus(item)}>\r\n                            <td className=\"item-name\">{item.name}</td>\r\n                            <td className=\"item-sku\">{item.sku}</td>\r\n                            <td className=\"item-category\">{item.category}</td>\r\n                            <td className=\"item-stock\">\r\n                                <div className=\"stock-controls\">\r\n                                    <button\r\n                                        className=\"stock-btn minus\"\r\n                                        onClick={() => handleQuickStockUpdate(item, -1, type === 'product' ? 'product' : 'inventory')}\r\n                                    >\r\n                                        -\r\n                                    </button>\r\n                                    <span>{item.quantity}</span>\r\n                                    <button\r\n                                        className=\"stock-btn plus\"\r\n                                        onClick={() => handleQuickStockUpdate(item, 1, type === 'product' ? 'product' : 'inventory')}\r\n                                    >\r\n                                        +\r\n                                    </button>\r\n                                </div>\r\n                            </td>\r\n                            <td>{item.minStock}</td>\r\n                            <td>${item.cost}</td>\r\n                            {type === 'product' && <td>${item.price}</td>}\r\n                            <td>\r\n                                <span className={`status-badge ${getStockStatus(item)}`}>\r\n                                    {getStockStatus(item).replace('-', ' ')}\r\n                                </span>\r\n                            </td>\r\n                            <td className=\"actions\">\r\n                                <button\r\n                                    className=\"action-btn edit\"\r\n                                    onClick={() => openEditModal(item, type === 'product' ? 'product' : 'inventory')}\r\n                                >\r\n                                    <Edit2 size={16} />\r\n                                </button>\r\n                            </td>\r\n                        </tr>\r\n                    ))}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    );\r\n\r\n    const renderParts = () => (\r\n        <div className=\"inventory-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Repair Parts Inventory</h1>\r\n                <div className=\"header-actions\">\r\n                    <div className=\"search-box\">\r\n                        <Search size={18} />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search parts...\"\r\n                            value={searchTerm}\r\n                            onChange={(e) => setSearchTerm(e.target.value)}\r\n                        />\r\n                    </div>\r\n                    <select\r\n                        className=\"filter-select\"\r\n                        value={categoryFilter}\r\n                        onChange={(e) => setCategoryFilter(e.target.value)}\r\n                    >\r\n                        <option value=\"all\">All Categories</option>\r\n                        {[...new Set(inventory.map(i => i.category))].map(cat => (\r\n                            <option key={cat} value={cat}>{cat}</option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n            </div>\r\n            {renderInventoryTable(filteredInventory, 'inventory')}\r\n        </div>\r\n    );\r\n\r\n    const renderProducts = () => (\r\n        <div className=\"inventory-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Store Products</h1>\r\n                <div className=\"header-actions\">\r\n                    <div className=\"search-box\">\r\n                        <Search size={18} />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search products...\"\r\n                            value={searchTerm}\r\n                            onChange={(e) => setSearchTerm(e.target.value)}\r\n                        />\r\n                    </div>\r\n                    <select\r\n                        className=\"filter-select\"\r\n                        value={categoryFilter}\r\n                        onChange={(e) => setCategoryFilter(e.target.value)}\r\n                    >\r\n                        <option value=\"all\">All Categories</option>\r\n                        {[...new Set(products.map(p => p.category))].map(cat => (\r\n                            <option key={cat} value={cat}>{cat}</option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n            </div>\r\n            {renderInventoryTable(filteredProducts, 'product')}\r\n        </div>\r\n    );\r\n\r\n    const renderOrders = () => (\r\n        <div className=\"inventory-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Purchase Orders</h1>\r\n            </div>\r\n\r\n            <div className=\"orders-list\">\r\n                {purchaseOrders.map(order => (\r\n                    <div key={order.id} className=\"order-card\">\r\n                        <div className=\"order-header\">\r\n                            <div className=\"order-id\">\r\n                                <ClipboardList size={20} />\r\n                                <span>{order.id}</span>\r\n                            </div>\r\n                            <span className={`status-badge ${order.status.toLowerCase().replace(' ', '-')}`}>\r\n                                {order.status}\r\n                            </span>\r\n                        </div>\r\n\r\n                        <div className=\"order-details\">\r\n                            <div className=\"detail\">\r\n                                <span className=\"label\">Supplier:</span>\r\n                                <span className=\"value\">{order.supplier}</span>\r\n                            </div>\r\n                            <div className=\"detail\">\r\n                                <span className=\"label\">Date:</span>\r\n                                <span className=\"value\">{order.date}</span>\r\n                            </div>\r\n                            <div className=\"detail\">\r\n                                <span className=\"label\">Total:</span>\r\n                                <span className=\"value\">${order.total}</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"order-items\">\r\n                            <h4>Items:</h4>\r\n                            {order.items.map((item, idx) => (\r\n                                <div key={idx} className=\"order-item\">\r\n                                    <span>{item.name}</span>\r\n                                    <span>x{item.quantity}</span>\r\n                                    <span>${item.cost * item.quantity}</span>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n\r\n                        {order.status === 'Submitted' && (\r\n                            <div className=\"order-actions\">\r\n                                <button\r\n                                    className=\"btn-receive\"\r\n                                    onClick={() => handleReceivePO(order.id)}\r\n                                >\r\n                                    <CheckCircle size={16} />\r\n                                    Mark as Received\r\n                                </button>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderAlerts = () => (\r\n        <div className=\"inventory-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Low Stock Alerts</h1>\r\n            </div>\r\n\r\n            {lowStockAlerts.length === 0 ? (\r\n                <div className=\"empty-state\">\r\n                    <CheckCircle size={64} />\r\n                    <h2>All Good!</h2>\r\n                    <p>All inventory levels are adequate.</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"alerts-grid\">\r\n                    {lowStockAlerts.map(alert => (\r\n                        <div key={alert.id} className={`alert-card ${alert.urgency}`}>\r\n                            <div className=\"alert-header\">\r\n                                <AlertTriangle size={24} />\r\n                                <span className={`urgency-tag ${alert.urgency}`}>\r\n                                    {alert.urgency}\r\n                                </span>\r\n                            </div>\r\n                            <h3>{alert.name}</h3>\r\n                            <div className=\"alert-stats\">\r\n                                <div className=\"stat\">\r\n                                    <span className=\"stat-value\">{alert.quantity}</span>\r\n                                    <span className=\"stat-label\">In Stock</span>\r\n                                </div>\r\n                                <div className=\"stat\">\r\n                                    <span className=\"stat-value\">{alert.minStock}</span>\r\n                                    <span className=\"stat-label\">Minimum</span>\r\n                                </div>\r\n                                <div className=\"stat\">\r\n                                    <span className=\"stat-value\">{alert.shortfall}</span>\r\n                                    <span className=\"stat-label\">Suggested Order</span>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"alert-meta\">\r\n                                <span>SKU: {alert.sku}</span>\r\n                                <span>Supplier: {alert.supplier}</span>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n\r\n    const renderEditModal = () => (\r\n        <div className=\"modal-overlay\" onClick={() => setShowEditModal(false)}>\r\n            <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Edit {editingItem?.name}</h2>\r\n                    <button className=\"modal-close\" onClick={() => setShowEditModal(false)}>\r\n                        <X size={24} />\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"modal-body\">\r\n                    <div className=\"form-group\">\r\n                        <label>Name</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={editForm.name}\r\n                            onChange={(e) => setEditForm({ ...editForm, name: e.target.value })}\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>Quantity</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={editForm.quantity}\r\n                                onChange={(e) => setEditForm({ ...editForm, quantity: parseInt(e.target.value) || 0 })}\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Min Stock</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={editForm.minStock}\r\n                                onChange={(e) => setEditForm({ ...editForm, minStock: parseInt(e.target.value) || 0 })}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>Cost ($)</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                step=\"0.01\"\r\n                                value={editForm.cost}\r\n                                onChange={(e) => setEditForm({ ...editForm, cost: parseFloat(e.target.value) || 0 })}\r\n                            />\r\n                        </div>\r\n                        {editingItem?.type === 'product' && (\r\n                            <div className=\"form-group\">\r\n                                <label>Price ($)</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    step=\"0.01\"\r\n                                    value={editForm.price}\r\n                                    onChange={(e) => setEditForm({ ...editForm, price: parseFloat(e.target.value) || 0 })}\r\n                                />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Supplier</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={editForm.supplier}\r\n                            onChange={(e) => setEditForm({ ...editForm, supplier: e.target.value })}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"modal-footer\">\r\n                    <button className=\"btn-cancel\" onClick={() => setShowEditModal(false)}>\r\n                        Cancel\r\n                    </button>\r\n                    <button className=\"btn-save\" onClick={handleSaveEdit}>\r\n                        <Save size={16} />\r\n                        Save Changes\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"inventory-loading\">\r\n                <div className=\"loader\"></div>\r\n                <p>Loading Inventory Dashboard...</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"inventory-dashboard\">\r\n            {renderSidebar()}\r\n            <main className={`inventory-main ${sidebarCollapsed ? 'expanded' : ''}`}>\r\n                {activeTab === 'dashboard' && renderDashboard()}\r\n                {activeTab === 'parts' && renderParts()}\r\n                {activeTab === 'products' && renderProducts()}\r\n                {activeTab === 'orders' && renderOrders()}\r\n                {activeTab === 'alerts' && renderAlerts()}\r\n            </main>\r\n            {showEditModal && renderEditModal()}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default InventoryDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\staff\\pages\\LandingEditor.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":14,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[570,597],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  60 |\n  61 |     useEffect(() => {\n> 62 |         loadData();\n     |         ^^^^^^^^ Avoid calling setState() directly within an effect\n  63 |     }, [loadData]);\n  64 |\n  65 |     const showMessage = (type, text) => {","line":62,"column":9,"nodeType":null,"endLine":62,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":77,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":96,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":108,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":108,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":126,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":126,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":138,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":138,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":156,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":156,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":168,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":168,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":184,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":184,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":206,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":229,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":229,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":241,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":241,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":253,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":253,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'index' is defined but never used.","line":404,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":404,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"index"},"fix":{"range":[16645,16652],"text":""},"desc":"Remove unused variable 'index'."}]}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useAuth } from '../../../context/AuthContext';\r\nimport { landingService } from '../../../services/landingService';\r\nimport {\r\n    Save, Plus, Trash2, Edit2, X, ChevronDown, ChevronUp,\r\n    ArrowLeft, Image, Type, FileText, Star, MessageSquare, HelpCircle,\r\n    Layout, Smartphone, Laptop, Tablet, Settings, Megaphone, Layers,\r\n    DollarSign, ImageIcon, Scale\r\n} from 'lucide-react';\r\nimport { Link } from 'react-router-dom';\r\nimport './LandingEditor.css';\r\n\r\nconst LandingEditor = () => {\r\n    const { user } = useAuth();\r\n    const [activeSection, setActiveSection] = useState('hero');\r\n    const [loading, setLoading] = useState(true);\r\n    const [saving, setSaving] = useState(false);\r\n    const [message, setMessage] = useState({ type: '', text: '' });\r\n\r\n    // Data state\r\n    const [hero, setHero] = useState(null);\r\n    const [services, setServices] = useState([]);\r\n    const [testimonials, setTestimonials] = useState([]);\r\n    const [faq, setFaq] = useState([]);\r\n    const [sections, setSections] = useState({});\r\n    const [settings, setSettings] = useState({});\r\n    const [pricing, setPricing] = useState([]);\r\n    const [gallery, setGallery] = useState([]);\r\n    const [legalPages, setLegalPages] = useState([]);\r\n\r\n    // Edit state\r\n    const [editingItem, setEditingItem] = useState(null);\r\n    const [showModal, setShowModal] = useState(false);\r\n\r\n    const loadData = useCallback(async () => {\r\n        setLoading(true);\r\n        try {\r\n            const [landingData, settingsData, pricingData, galleryData, legalData] = await Promise.all([\r\n                landingService.getLanding(),\r\n                landingService.getSettings(),\r\n                landingService.getPricingAdmin(),\r\n                landingService.getGalleryAdmin(),\r\n                landingService.getLegalPages()\r\n            ]);\r\n            setHero(landingData.hero);\r\n            setServices(landingData.services);\r\n            setTestimonials(landingData.testimonials);\r\n            setFaq(landingData.faq);\r\n            setSections(landingData.sections);\r\n            setSettings(settingsData);\r\n            setPricing(pricingData);\r\n            setGallery(galleryData);\r\n            setLegalPages(legalData);\r\n        } catch (error) {\r\n            console.error('Failed to load landing data:', error);\r\n            setMessage({ type: 'error', text: 'Failed to load data' });\r\n        }\r\n        setLoading(false);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        loadData();\r\n    }, [loadData]);\r\n\r\n    const showMessage = (type, text) => {\r\n        setMessage({ type, text });\r\n        setTimeout(() => setMessage({ type: '', text: '' }), 3000);\r\n    };\r\n\r\n    // ========== HERO HANDLERS ==========\r\n    const handleSaveHero = async (e) => {\r\n        e.preventDefault();\r\n        setSaving(true);\r\n        try {\r\n            await landingService.updateHero(hero);\r\n            showMessage('success', 'Hero updated successfully!');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to update hero');\r\n        }\r\n        setSaving(false);\r\n    };\r\n\r\n    // ========== SERVICES HANDLERS ==========\r\n    const handleSaveService = async (serviceData) => {\r\n        setSaving(true);\r\n        try {\r\n            if (editingItem?.id) {\r\n                await landingService.updateService(editingItem.id, serviceData);\r\n            } else {\r\n                await landingService.createService(serviceData);\r\n            }\r\n            await loadData();\r\n            setShowModal(false);\r\n            setEditingItem(null);\r\n            showMessage('success', 'Service saved!');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to save service');\r\n        }\r\n        setSaving(false);\r\n    };\r\n\r\n    const handleDeleteService = async (id) => {\r\n        if (!window.confirm('Delete this service?')) return;\r\n        try {\r\n            await landingService.deleteService(id);\r\n            await loadData();\r\n            showMessage('success', 'Service deleted');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to delete');\r\n        }\r\n    };\r\n\r\n    // ========== TESTIMONIALS HANDLERS ==========\r\n    const handleSaveTestimonial = async (data) => {\r\n        setSaving(true);\r\n        try {\r\n            if (editingItem?.id) {\r\n                await landingService.updateTestimonial(editingItem.id, data);\r\n            } else {\r\n                await landingService.createTestimonial(data);\r\n            }\r\n            await loadData();\r\n            setShowModal(false);\r\n            setEditingItem(null);\r\n            showMessage('success', 'Testimonial saved!');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to save testimonial');\r\n        }\r\n        setSaving(false);\r\n    };\r\n\r\n    const handleDeleteTestimonial = async (id) => {\r\n        if (!window.confirm('Delete this testimonial?')) return;\r\n        try {\r\n            await landingService.deleteTestimonial(id);\r\n            await loadData();\r\n            showMessage('success', 'Testimonial deleted');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to delete');\r\n        }\r\n    };\r\n\r\n    // ========== FAQ HANDLERS ==========\r\n    const handleSaveFaq = async (data) => {\r\n        setSaving(true);\r\n        try {\r\n            if (editingItem?.id) {\r\n                await landingService.updateFaq(editingItem.id, data);\r\n            } else {\r\n                await landingService.createFaq(data);\r\n            }\r\n            await loadData();\r\n            setShowModal(false);\r\n            setEditingItem(null);\r\n            showMessage('success', 'FAQ saved!');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to save FAQ');\r\n        }\r\n        setSaving(false);\r\n    };\r\n\r\n    const handleDeleteFaq = async (id) => {\r\n        if (!window.confirm('Delete this FAQ?')) return;\r\n        try {\r\n            await landingService.deleteFaq(id);\r\n            await loadData();\r\n            showMessage('success', 'FAQ deleted');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to delete');\r\n        }\r\n    };\r\n\r\n    // ========== SECTIONS HANDLERS ==========\r\n    const handleSaveSection = async (sectionKey) => {\r\n        setSaving(true);\r\n        try {\r\n            const sectionData = sections[sectionKey];\r\n            await landingService.updateSection(sectionKey, {\r\n                title: sectionData?.title,\r\n                subtitle: sectionData?.subtitle,\r\n                content: sectionData?.content\r\n            });\r\n            showMessage('success', 'Section updated!');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to update section');\r\n        }\r\n        setSaving(false);\r\n    };\r\n\r\n    const updateSectionField = (sectionKey, field, value) => {\r\n        setSections(prev => ({\r\n            ...prev,\r\n            [sectionKey]: {\r\n                ...prev[sectionKey],\r\n                [field]: value\r\n            }\r\n        }));\r\n    };\r\n\r\n    // ========== SETTINGS HANDLERS ==========\r\n    const handleSaveSetting = async (key) => {\r\n        setSaving(true);\r\n        try {\r\n            await landingService.updateSetting(key, settings[key]);\r\n            showMessage('success', 'Settings saved!');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to save settings');\r\n        }\r\n        setSaving(false);\r\n    };\r\n\r\n    const updateSettingField = (key, value) => {\r\n        setSettings(prev => ({ ...prev, [key]: value }));\r\n    };\r\n\r\n    // ========== GALLERY HANDLERS ==========\r\n    const handleSaveGallery = async (data) => {\r\n        setSaving(true);\r\n        try {\r\n            if (editingItem?.id) {\r\n                await landingService.updateGalleryItem(editingItem.id, data);\r\n            } else {\r\n                await landingService.createGalleryItem(data);\r\n            }\r\n            await loadData();\r\n            setShowModal(false);\r\n            setEditingItem(null);\r\n            showMessage('success', 'Gallery item saved!');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to save gallery');\r\n        }\r\n        setSaving(false);\r\n    };\r\n\r\n    const handleDeleteGallery = async (id) => {\r\n        if (!window.confirm('Delete this gallery item?')) return;\r\n        try {\r\n            await landingService.deleteGalleryItem(id);\r\n            await loadData();\r\n            showMessage('success', 'Gallery item deleted');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to delete');\r\n        }\r\n    };\r\n\r\n    // ========== LEGAL HANDLERS ==========\r\n    const handleSaveLegal = async (pageKey, updates) => {\r\n        setSaving(true);\r\n        try {\r\n            await landingService.updateLegalPage(pageKey, updates);\r\n            await loadData();\r\n            showMessage('success', 'Legal page saved!');\r\n        } catch (error) {\r\n            showMessage('error', 'Failed to save legal page');\r\n        }\r\n        setSaving(false);\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"landing-editor\">\r\n                <div className=\"loading-state\">Loading landing page content...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const sidebarItems = [\r\n        { id: 'hero', label: 'Hero Section', icon: Layout },\r\n        { id: 'services', label: 'Services', icon: Smartphone },\r\n        { id: 'how_it_works', label: 'How It Works', icon: Layers },\r\n        { id: 'why_choose_us', label: 'Why Choose Us', icon: Star },\r\n        { id: 'cta', label: 'CTA Sections', icon: Megaphone },\r\n        { id: 'testimonials', label: 'Testimonials', icon: MessageSquare },\r\n        { id: 'faq', label: 'FAQ', icon: HelpCircle },\r\n        { id: 'pricing', label: 'Pricing', icon: DollarSign },\r\n        { id: 'gallery', label: 'Gallery', icon: ImageIcon },\r\n        { id: 'settings', label: 'Site Settings', icon: Settings },\r\n        { id: 'legal', label: 'Legal Pages', icon: Scale },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"landing-editor\">\r\n            {/* Header */}\r\n            <header className=\"editor-header\">\r\n                <div className=\"header-left\">\r\n                    <Link to=\"/admin\" className=\"back-link\">\r\n                        <ArrowLeft size={20} /> Back to Admin\r\n                    </Link>\r\n                    <h1>Landing Page CMS</h1>\r\n                </div>\r\n                <div className=\"header-right\">\r\n                    <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"preview-btn\">\r\n                        Preview Site\r\n                    </a>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Message Toast */}\r\n            {message.text && (\r\n                <div className={`toast-message ${message.type}`}>\r\n                    {message.text}\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"editor-layout\">\r\n                {/* Sidebar */}\r\n                <aside className=\"editor-sidebar\">\r\n                    <nav className=\"sidebar-nav\">\r\n                        {sidebarItems.map(item => (\r\n                            <button\r\n                                key={item.id}\r\n                                className={`nav-item ${activeSection === item.id ? 'active' : ''}`}\r\n                                onClick={() => setActiveSection(item.id)}\r\n                            >\r\n                                <item.icon size={20} />\r\n                                <span>{item.label}</span>\r\n                            </button>\r\n                        ))}\r\n                    </nav>\r\n                </aside>\r\n\r\n                {/* Content */}\r\n                <main className=\"editor-content\">\r\n                    {/* Hero Section */}\r\n                    {activeSection === 'hero' && hero && (\r\n                        <section className=\"content-section\">\r\n                            <h2><Layout size={24} /> Hero Section</h2>\r\n                            <form onSubmit={handleSaveHero} className=\"edit-form\">\r\n                                <div className=\"form-group\">\r\n                                    <label>Title</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={hero.title || ''}\r\n                                        onChange={(e) => setHero({ ...hero, title: e.target.value })}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Subtitle</label>\r\n                                    <textarea\r\n                                        value={hero.subtitle || ''}\r\n                                        onChange={(e) => setHero({ ...hero, subtitle: e.target.value })}\r\n                                        rows={3}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-row\">\r\n                                    <div className=\"form-group\">\r\n                                        <label>Primary CTA Text</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={hero.cta_text || ''}\r\n                                            onChange={(e) => setHero({ ...hero, cta_text: e.target.value })}\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"form-group\">\r\n                                        <label>Primary CTA Link</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={hero.cta_link || ''}\r\n                                            onChange={(e) => setHero({ ...hero, cta_link: e.target.value })}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"form-row\">\r\n                                    <div className=\"form-group\">\r\n                                        <label>Secondary CTA Text</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={hero.secondary_cta_text || ''}\r\n                                            onChange={(e) => setHero({ ...hero, secondary_cta_text: e.target.value })}\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"form-group\">\r\n                                        <label>Secondary CTA Link</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={hero.secondary_cta_link || ''}\r\n                                            onChange={(e) => setHero({ ...hero, secondary_cta_link: e.target.value })}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                                <button type=\"submit\" className=\"save-btn\" disabled={saving}>\r\n                                    <Save size={18} /> {saving ? 'Saving...' : 'Save Changes'}\r\n                                </button>\r\n                            </form>\r\n                        </section>\r\n                    )}\r\n\r\n                    {/* Services Section */}\r\n                    {activeSection === 'services' && (\r\n                        <section className=\"content-section\">\r\n                            <div className=\"section-header-row\">\r\n                                <h2><Smartphone size={24} /> Services</h2>\r\n                                <button\r\n                                    className=\"add-btn\"\r\n                                    onClick={() => {\r\n                                        setEditingItem({ title: '', description: '', icon: 'Smartphone', image: '', display_order: services.length + 1 });\r\n                                        setShowModal(true);\r\n                                    }}\r\n                                >\r\n                                    <Plus size={18} /> Add Service\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"items-list\">\r\n                                {services.map((service, index) => (\r\n                                    <div key={service.id} className=\"list-item\">\r\n                                        <div className=\"item-info\">\r\n                                            <strong>{service.title}</strong>\r\n                                            <span>{service.description}</span>\r\n                                        </div>\r\n                                        <div className=\"item-actions\">\r\n                                            <button onClick={() => { setEditingItem(service); setShowModal(true); }}>\r\n                                                <Edit2 size={16} />\r\n                                            </button>\r\n                                            <button onClick={() => handleDeleteService(service.id)} className=\"delete-btn\">\r\n                                                <Trash2 size={16} />\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </section>\r\n                    )}\r\n\r\n                    {/* Testimonials Section */}\r\n                    {activeSection === 'testimonials' && (\r\n                        <section className=\"content-section\">\r\n                            <div className=\"section-header-row\">\r\n                                <h2><Star size={24} /> Testimonials</h2>\r\n                                <button\r\n                                    className=\"add-btn\"\r\n                                    onClick={() => {\r\n                                        setEditingItem({ customer_name: '', customer_title: '', content: '', rating: 5, device_repaired: '', display_order: testimonials.length + 1 });\r\n                                        setShowModal(true);\r\n                                    }}\r\n                                >\r\n                                    <Plus size={18} /> Add Testimonial\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"items-list\">\r\n                                {testimonials.map((t) => (\r\n                                    <div key={t.id} className=\"list-item\">\r\n                                        <div className=\"item-info\">\r\n                                            <strong>{t.customer_name}</strong>\r\n                                            <span>\"{t.content?.substring(0, 60)}...\"</span>\r\n                                        </div>\r\n                                        <div className=\"item-actions\">\r\n                                            <button onClick={() => { setEditingItem(t); setShowModal(true); }}>\r\n                                                <Edit2 size={16} />\r\n                                            </button>\r\n                                            <button onClick={() => handleDeleteTestimonial(t.id)} className=\"delete-btn\">\r\n                                                <Trash2 size={16} />\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </section>\r\n                    )}\r\n\r\n                    {/* FAQ Section */}\r\n                    {activeSection === 'faq' && (\r\n                        <section className=\"content-section\">\r\n                            <div className=\"section-header-row\">\r\n                                <h2><HelpCircle size={24} /> FAQ</h2>\r\n                                <button\r\n                                    className=\"add-btn\"\r\n                                    onClick={() => {\r\n                                        setEditingItem({ question: '', answer: '', category: 'General', display_order: faq.length + 1 });\r\n                                        setShowModal(true);\r\n                                    }}\r\n                                >\r\n                                    <Plus size={18} /> Add FAQ\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"items-list\">\r\n                                {faq.map((item) => (\r\n                                    <div key={item.id} className=\"list-item\">\r\n                                        <div className=\"item-info\">\r\n                                            <strong>{item.question}</strong>\r\n                                            <span>{item.answer?.substring(0, 80)}...</span>\r\n                                        </div>\r\n                                        <div className=\"item-actions\">\r\n                                            <button onClick={() => { setEditingItem(item); setShowModal(true); }}>\r\n                                                <Edit2 size={16} />\r\n                                            </button>\r\n                                            <button onClick={() => handleDeleteFaq(item.id)} className=\"delete-btn\">\r\n                                                <Trash2 size={16} />\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </section>\r\n                    )}\r\n\r\n                    {/* How It Works Section */}\r\n                    {activeSection === 'how_it_works' && (\r\n                        <section className=\"content-section\">\r\n                            <h2><Layers size={24} /> How It Works</h2>\r\n                            <form onSubmit={(e) => { e.preventDefault(); handleSaveSection('how_it_works'); }} className=\"edit-form\">\r\n                                <div className=\"form-group\">\r\n                                    <label>Section Title</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={sections.how_it_works?.title || ''}\r\n                                        onChange={(e) => updateSectionField('how_it_works', 'title', e.target.value)}\r\n                                        placeholder=\"How It Works\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Section Subtitle</label>\r\n                                    <textarea\r\n                                        value={sections.how_it_works?.subtitle || ''}\r\n                                        onChange={(e) => updateSectionField('how_it_works', 'subtitle', e.target.value)}\r\n                                        rows={2}\r\n                                        placeholder=\"Choose the service option that works best for you\"\r\n                                    />\r\n                                </div>\r\n                                <p className=\"form-note\">Note: The 3 service options (We Come To You, Visit Our Shop, Pickup & Delivery) are built into the component for the carousel experience.</p>\r\n                                <button type=\"submit\" className=\"save-btn\" disabled={saving}>\r\n                                    <Save size={18} /> {saving ? 'Saving...' : 'Save Changes'}\r\n                                </button>\r\n                            </form>\r\n                        </section>\r\n                    )}\r\n\r\n                    {/* Why Choose Us Section */}\r\n                    {activeSection === 'why_choose_us' && (\r\n                        <section className=\"content-section\">\r\n                            <h2><Star size={24} /> Why Choose Us</h2>\r\n                            <form onSubmit={(e) => { e.preventDefault(); handleSaveSection('why_choose_us'); }} className=\"edit-form\">\r\n                                <div className=\"form-group\">\r\n                                    <label>Section Title</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={sections.why_choose_us?.title || ''}\r\n                                        onChange={(e) => updateSectionField('why_choose_us', 'title', e.target.value)}\r\n                                        placeholder=\"Why Choose SIFIXA?\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Section Subtitle</label>\r\n                                    <textarea\r\n                                        value={sections.why_choose_us?.subtitle || ''}\r\n                                        onChange={(e) => updateSectionField('why_choose_us', 'subtitle', e.target.value)}\r\n                                        rows={2}\r\n                                        placeholder=\"We are committed to providing the best repair experience\"\r\n                                    />\r\n                                </div>\r\n                                <p className=\"form-note\">Note: Feature cards (Fast Turnaround, Warranty, etc.) are currently built into the component.</p>\r\n                                <button type=\"submit\" className=\"save-btn\" disabled={saving}>\r\n                                    <Save size={18} /> {saving ? 'Saving...' : 'Save Changes'}\r\n                                </button>\r\n                            </form>\r\n                        </section>\r\n                    )}\r\n\r\n                    {/* CTA Sections */}\r\n                    {activeSection === 'cta' && (\r\n                        <section className=\"content-section\">\r\n                            <h2><Megaphone size={24} /> CTA Sections</h2>\r\n\r\n                            {/* Main CTA */}\r\n                            <div className=\"edit-form\" style={{ marginBottom: '2rem' }}>\r\n                                <h3 style={{ marginBottom: '1rem' }}>Main CTA (Book Repair)</h3>\r\n                                <div className=\"form-group\">\r\n                                    <label>Title</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={sections.cta?.title || ''}\r\n                                        onChange={(e) => updateSectionField('cta', 'title', e.target.value)}\r\n                                        placeholder=\"Ready to Get Your Device Fixed?\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Subtitle</label>\r\n                                    <textarea\r\n                                        value={sections.cta?.subtitle || ''}\r\n                                        onChange={(e) => updateSectionField('cta', 'subtitle', e.target.value)}\r\n                                        rows={2}\r\n                                        placeholder=\"Book a repair now and get your device back in perfect condition.\"\r\n                                    />\r\n                                </div>\r\n                                <button type=\"button\" className=\"save-btn\" disabled={saving} onClick={() => handleSaveSection('cta')}>\r\n                                    <Save size={18} /> {saving ? 'Saving...' : 'Save Main CTA'}\r\n                                </button>\r\n                            </div>\r\n\r\n                            {/* Sell CTA */}\r\n                            <div className=\"edit-form\">\r\n                                <h3 style={{ marginBottom: '1rem' }}>Sell Device CTA</h3>\r\n                                <div className=\"form-group\">\r\n                                    <label>Title</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={sections.sell_cta?.title || ''}\r\n                                        onChange={(e) => updateSectionField('sell_cta', 'title', e.target.value)}\r\n                                        placeholder=\"Sell Your Old Device\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Description</label>\r\n                                    <textarea\r\n                                        value={sections.sell_cta?.subtitle || ''}\r\n                                        onChange={(e) => updateSectionField('sell_cta', 'subtitle', e.target.value)}\r\n                                        rows={2}\r\n                                        placeholder=\"Got an old phone, tablet, or laptop? Get instant cash!\"\r\n                                    />\r\n                                </div>\r\n                                <button type=\"button\" className=\"save-btn\" disabled={saving} onClick={() => handleSaveSection('sell_cta')}>\r\n                                    <Save size={18} /> {saving ? 'Saving...' : 'Save Sell CTA'}\r\n                                </button>\r\n                            </div>\r\n                        </section>\r\n                    )}\r\n\r\n                    {/* Pricing Section */}\r\n                    {activeSection === 'pricing' && (\r\n                        <section className=\"content-section\">\r\n                            <h2><DollarSign size={24} /> Pricing</h2>\r\n                            <p className=\"form-note\">Manage pricing categories and their items. Changes are saved when you edit individual items.</p>\r\n\r\n                            {pricing.map((category) => (\r\n                                <div key={category.id} className=\"edit-form\" style={{ marginBottom: '2rem' }}>\r\n                                    <h3>{category.category}</h3>\r\n                                    <table className=\"item-table\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th>Service Name</th>\r\n                                                <th>Price</th>\r\n                                                <th>Active</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {(category.items || []).map((item) => (\r\n                                                <tr key={item.id}>\r\n                                                    <td>{item.name}</td>\r\n                                                    <td>{item.price}</td>\r\n                                                    <td>Γ£ô</td>\r\n                                                </tr>\r\n                                            ))}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            ))}\r\n                        </section>\r\n                    )}\r\n\r\n                    {/* Gallery Section */}\r\n                    {activeSection === 'gallery' && (\r\n                        <section className=\"content-section\">\r\n                            <div className=\"section-header-actions\">\r\n                                <h2><ImageIcon size={24} /> Before/After Gallery</h2>\r\n                                <button onClick={() => { setEditingItem({ type: 'gallery' }); setShowModal(true); }} className=\"add-btn\">\r\n                                    <Plus size={18} /> Add Gallery Item\r\n                                </button>\r\n                            </div>\r\n\r\n                            <div className=\"items-grid\">\r\n                                {gallery.map((item) => (\r\n                                    <div key={item.id} className=\"item-card\">\r\n                                        <div className=\"item-content\">\r\n                                            <h3>{item.title}</h3>\r\n                                            <p>{item.description}</p>\r\n                                            <div className=\"gallery-preview\">\r\n                                                <span>Before: {item.before_image || 'Not set'}</span>\r\n                                                <span>After: {item.after_image || 'Not set'}</span>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"item-actions\">\r\n                                            <button onClick={() => { setEditingItem({ ...item, type: 'gallery' }); setShowModal(true); }}><Edit2 size={14} /></button>\r\n                                            <button onClick={() => handleDeleteGallery(item.id)} className=\"delete-btn\"><Trash2 size={14} /></button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </section>\r\n                    )}\r\n\r\n                    {/* Settings Section */}\r\n                    {activeSection === 'settings' && (\r\n                        <section className=\"content-section\">\r\n                            <h2><Settings size={24} /> Site Settings</h2>\r\n\r\n                            {/* Brand Settings */}\r\n                            <div className=\"edit-form\" style={{ marginBottom: '2rem' }}>\r\n                                <h3>Brand</h3>\r\n                                <div className=\"form-group\">\r\n                                    <label>Company Name</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={settings.brand?.name || ''}\r\n                                        onChange={(e) => updateSettingField('brand', { ...settings.brand, name: e.target.value })}\r\n                                        placeholder=\"SIFIXA\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Tagline</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={settings.brand?.tagline || ''}\r\n                                        onChange={(e) => updateSettingField('brand', { ...settings.brand, tagline: e.target.value })}\r\n                                        placeholder=\"Premium Device Repair\"\r\n                                    />\r\n                                </div>\r\n                                <button type=\"button\" className=\"save-btn\" disabled={saving} onClick={() => handleSaveSetting('brand')}>\r\n                                    <Save size={18} /> {saving ? 'Saving...' : 'Save Brand'}\r\n                                </button>\r\n                            </div>\r\n\r\n                            {/* Contact Settings */}\r\n                            <div className=\"edit-form\" style={{ marginBottom: '2rem' }}>\r\n                                <h3>Contact Info</h3>\r\n                                <div className=\"form-group\">\r\n                                    <label>Address</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={settings.contact?.address || ''}\r\n                                        onChange={(e) => updateSettingField('contact', { ...settings.contact, address: e.target.value })}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Phone</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={settings.contact?.phone || ''}\r\n                                        onChange={(e) => updateSettingField('contact', { ...settings.contact, phone: e.target.value })}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Support Email</label>\r\n                                    <input\r\n                                        type=\"email\"\r\n                                        value={settings.contact?.supportEmail || ''}\r\n                                        onChange={(e) => updateSettingField('contact', { ...settings.contact, supportEmail: e.target.value })}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Business Hours</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={settings.contact?.hours || ''}\r\n                                        onChange={(e) => updateSettingField('contact', { ...settings.contact, hours: e.target.value })}\r\n                                    />\r\n                                </div>\r\n                                <button type=\"button\" className=\"save-btn\" disabled={saving} onClick={() => handleSaveSetting('contact')}>\r\n                                    <Save size={18} /> {saving ? 'Saving...' : 'Save Contact'}\r\n                                </button>\r\n                            </div>\r\n\r\n                            {/* Social Links */}\r\n                            <div className=\"edit-form\">\r\n                                <h3>Social Links</h3>\r\n                                <div className=\"form-group\">\r\n                                    <label>Facebook URL</label>\r\n                                    <input\r\n                                        type=\"url\"\r\n                                        value={settings.social_links?.facebook || ''}\r\n                                        onChange={(e) => updateSettingField('social_links', { ...settings.social_links, facebook: e.target.value })}\r\n                                        placeholder=\"https://facebook.com/yourpage\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Instagram URL</label>\r\n                                    <input\r\n                                        type=\"url\"\r\n                                        value={settings.social_links?.instagram || ''}\r\n                                        onChange={(e) => updateSettingField('social_links', { ...settings.social_links, instagram: e.target.value })}\r\n                                        placeholder=\"https://instagram.com/yourpage\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label>Twitter/X URL</label>\r\n                                    <input\r\n                                        type=\"url\"\r\n                                        value={settings.social_links?.twitter || ''}\r\n                                        onChange={(e) => updateSettingField('social_links', { ...settings.social_links, twitter: e.target.value })}\r\n                                        placeholder=\"https://twitter.com/yourpage\"\r\n                                    />\r\n                                </div>\r\n                                <button type=\"button\" className=\"save-btn\" disabled={saving} onClick={() => handleSaveSetting('social_links')}>\r\n                                    <Save size={18} /> {saving ? 'Saving...' : 'Save Social Links'}\r\n                                </button>\r\n                            </div>\r\n                        </section>\r\n                    )}\r\n\r\n                    {/* Legal Pages Section */}\r\n                    {activeSection === 'legal' && (\r\n                        <section className=\"content-section\">\r\n                            <h2><Scale size={24} /> Legal Pages</h2>\r\n                            <p className=\"form-note\">Edit content for Privacy Policy, Terms, Refund, Warranty, and Cookie Policy pages.</p>\r\n\r\n                            {legalPages.map((page) => (\r\n                                <div key={page.page_key} className=\"edit-form\" style={{ marginBottom: '2rem' }}>\r\n                                    <h3>{page.title}</h3>\r\n                                    <div className=\"form-group\">\r\n                                        <label>Title</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            defaultValue={page.title}\r\n                                            onBlur={(e) => {\r\n                                                if (e.target.value !== page.title) {\r\n                                                    handleSaveLegal(page.page_key, { title: e.target.value, content: page.content });\r\n                                                }\r\n                                            }}\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"form-group\">\r\n                                        <label>Content (Markdown)</label>\r\n                                        <textarea\r\n                                            rows={8}\r\n                                            defaultValue={page.content}\r\n                                            onBlur={(e) => {\r\n                                                if (e.target.value !== page.content) {\r\n                                                    handleSaveLegal(page.page_key, { title: page.title, content: e.target.value });\r\n                                                }\r\n                                            }}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </section>\r\n                    )}\r\n                </main>\r\n            </div>\r\n\r\n            {/* Modal */}\r\n            {showModal && editingItem && (\r\n                <div className=\"modal-overlay\" onClick={() => setShowModal(false)}>\r\n                    <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\r\n                        <div className=\"modal-header\">\r\n                            <h3>{editingItem.id ? 'Edit' : 'Add'} {editingItem.type === 'gallery' ? 'Gallery Item' : activeSection === 'services' ? 'Service' : activeSection === 'testimonials' ? 'Testimonial' : 'FAQ'}</h3>\r\n                            <button onClick={() => setShowModal(false)}><X size={20} /></button>\r\n                        </div>\r\n\r\n                        {activeSection === 'services' && (\r\n                            <ServiceForm\r\n                                data={editingItem}\r\n                                onSave={handleSaveService}\r\n                                onCancel={() => setShowModal(false)}\r\n                                saving={saving}\r\n                            />\r\n                        )}\r\n\r\n                        {activeSection === 'testimonials' && (\r\n                            <TestimonialForm\r\n                                data={editingItem}\r\n                                onSave={handleSaveTestimonial}\r\n                                onCancel={() => setShowModal(false)}\r\n                                saving={saving}\r\n                            />\r\n                        )}\r\n\r\n                        {activeSection === 'faq' && (\r\n                            <FaqForm\r\n                                data={editingItem}\r\n                                onSave={handleSaveFaq}\r\n                                onCancel={() => setShowModal(false)}\r\n                                saving={saving}\r\n                            />\r\n                        )}\r\n\r\n                        {editingItem.type === 'gallery' && (\r\n                            <GalleryForm\r\n                                data={editingItem}\r\n                                onSave={handleSaveGallery}\r\n                                onCancel={() => setShowModal(false)}\r\n                                saving={saving}\r\n                            />\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\n// ========== FORM COMPONENTS ==========\r\nconst ServiceForm = ({ data, onSave, onCancel, saving }) => {\r\n    const [form, setForm] = useState(data);\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSave(form);\r\n    };\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} className=\"modal-form\">\r\n            <div className=\"form-group\">\r\n                <label>Title</label>\r\n                <input type=\"text\" value={form.title || ''} onChange={(e) => setForm({ ...form, title: e.target.value })} required />\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label>Description</label>\r\n                <textarea value={form.description || ''} onChange={(e) => setForm({ ...form, description: e.target.value })} rows={3} />\r\n            </div>\r\n            <div className=\"form-row\">\r\n                <div className=\"form-group\">\r\n                    <label>Icon</label>\r\n                    <select value={form.icon || 'Smartphone'} onChange={(e) => setForm({ ...form, icon: e.target.value })}>\r\n                        <option value=\"Smartphone\">Smartphone</option>\r\n                        <option value=\"Tablet\">Tablet</option>\r\n                        <option value=\"Laptop\">Laptop</option>\r\n                    </select>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label>Image URL</label>\r\n                    <input type=\"text\" value={form.image || ''} onChange={(e) => setForm({ ...form, image: e.target.value })} />\r\n                </div>\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label>Link</label>\r\n                <input type=\"text\" value={form.link || '/services'} onChange={(e) => setForm({ ...form, link: e.target.value })} />\r\n            </div>\r\n            <div className=\"form-actions\">\r\n                <button type=\"button\" onClick={onCancel} className=\"cancel-btn\">Cancel</button>\r\n                <button type=\"submit\" className=\"save-btn\" disabled={saving}>{saving ? 'Saving...' : 'Save'}</button>\r\n            </div>\r\n        </form>\r\n    );\r\n};\r\n\r\nconst TestimonialForm = ({ data, onSave, onCancel, saving }) => {\r\n    const [form, setForm] = useState(data);\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSave(form);\r\n    };\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} className=\"modal-form\">\r\n            <div className=\"form-row\">\r\n                <div className=\"form-group\">\r\n                    <label>Customer Name</label>\r\n                    <input type=\"text\" value={form.customer_name || ''} onChange={(e) => setForm({ ...form, customer_name: e.target.value })} required />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label>Title/Role</label>\r\n                    <input type=\"text\" value={form.customer_title || ''} onChange={(e) => setForm({ ...form, customer_title: e.target.value })} placeholder=\"e.g. iPhone User\" />\r\n                </div>\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label>Testimonial Content</label>\r\n                <textarea value={form.content || ''} onChange={(e) => setForm({ ...form, content: e.target.value })} rows={4} required />\r\n            </div>\r\n            <div className=\"form-row\">\r\n                <div className=\"form-group\">\r\n                    <label>Rating</label>\r\n                    <select value={form.rating || 5} onChange={(e) => setForm({ ...form, rating: parseInt(e.target.value) })}>\r\n                        {[5, 4, 3, 2, 1].map(r => <option key={r} value={r}>{r} Stars</option>)}\r\n                    </select>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label>Device Repaired</label>\r\n                    <input type=\"text\" value={form.device_repaired || ''} onChange={(e) => setForm({ ...form, device_repaired: e.target.value })} placeholder=\"e.g. iPhone 14 Pro\" />\r\n                </div>\r\n            </div>\r\n            <div className=\"form-actions\">\r\n                <button type=\"button\" onClick={onCancel} className=\"cancel-btn\">Cancel</button>\r\n                <button type=\"submit\" className=\"save-btn\" disabled={saving}>{saving ? 'Saving...' : 'Save'}</button>\r\n            </div>\r\n        </form>\r\n    );\r\n};\r\n\r\nconst FaqForm = ({ data, onSave, onCancel, saving }) => {\r\n    const [form, setForm] = useState(data);\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSave(form);\r\n    };\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} className=\"modal-form\">\r\n            <div className=\"form-group\">\r\n                <label>Question</label>\r\n                <input type=\"text\" value={form.question || ''} onChange={(e) => setForm({ ...form, question: e.target.value })} required />\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label>Answer</label>\r\n                <textarea value={form.answer || ''} onChange={(e) => setForm({ ...form, answer: e.target.value })} rows={4} required />\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label>Category</label>\r\n                <input type=\"text\" value={form.category || 'General'} onChange={(e) => setForm({ ...form, category: e.target.value })} />\r\n            </div>\r\n            <div className=\"form-actions\">\r\n                <button type=\"button\" onClick={onCancel} className=\"cancel-btn\">Cancel</button>\r\n                <button type=\"submit\" className=\"save-btn\" disabled={saving}>{saving ? 'Saving...' : 'Save'}</button>\r\n            </div>\r\n        </form>\r\n    );\r\n};\r\n\r\nconst GalleryForm = ({ data, onSave, onCancel, saving }) => {\r\n    const [form, setForm] = useState(data);\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSave(form);\r\n    };\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} className=\"modal-form\">\r\n            <div className=\"form-group\">\r\n                <label>Title</label>\r\n                <input type=\"text\" value={form.title || ''} onChange={(e) => setForm({ ...form, title: e.target.value })} required />\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label>Description</label>\r\n                <textarea value={form.description || ''} onChange={(e) => setForm({ ...form, description: e.target.value })} rows={2} />\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label>Before Image URL</label>\r\n                <input type=\"text\" value={form.before_image || ''} onChange={(e) => setForm({ ...form, before_image: e.target.value })} placeholder=\"/gallery/phone-before.png\" />\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label>After Image URL</label>\r\n                <input type=\"text\" value={form.after_image || ''} onChange={(e) => setForm({ ...form, after_image: e.target.value })} placeholder=\"/gallery/phone-after.png\" />\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label>Display Order</label>\r\n                <input type=\"number\" value={form.display_order || 0} onChange={(e) => setForm({ ...form, display_order: parseInt(e.target.value) })} />\r\n            </div>\r\n            <div className=\"form-actions\">\r\n                <button type=\"button\" onClick={onCancel} className=\"cancel-btn\">Cancel</button>\r\n                <button type=\"submit\" className=\"save-btn\" disabled={saving}>{saving ? 'Saving...' : 'Save'}</button>\r\n            </div>\r\n        </form>\r\n    );\r\n};\r\n\r\nexport default LandingEditor;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\staff\\pages\\POSDashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'api' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"api"},"fix":{"range":[304,354],"text":""},"desc":"Remove unused variable 'api'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'addNotification' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":19,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"addNotification"},"fix":{"range":[937,984],"text":""},"desc":"Remove unused variable 'addNotification'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setAutoRefresh' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":30,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"setAutoRefresh"},"fix":{"range":[1479,1495],"text":""},"desc":"Remove unused variable 'setAutoRefresh'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'lastUpdate' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":31,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"lastUpdate"},"fix":{"range":[1527,1537],"text":""},"desc":"Remove unused variable 'lastUpdate'."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadData` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  49 |\n  50 |     useEffect(() => {\n> 51 |         loadData();\n     |         ^^^^^^^^ `loadData` accessed before it is declared\n  52 |     }, []);\n  53 |\n  54 |     // Auto-refresh every 30 seconds\n\n  61 |     }, [autoRefresh]);\n  62 |\n> 63 |     const loadData = async (showLoading = true) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 64 |         if (showLoading) setLoading(true);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 65 |         try {\n     ΓÇª\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |         if (showLoading) setLoading(false);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |     };\n     | ^^^^^^^ `loadData` is declared here\n  82 |\n  83 |\n  84 |     const handleLogout = () => {","line":51,"column":9,"nodeType":null,"endLine":51,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'renderHistory' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":507,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":507,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"renderHistory"},"fix":{"range":[20463,22314],"text":""},"desc":"Remove unused variable 'renderHistory'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'renderStats' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":547,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":547,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"renderStats"},"fix":{"range":[22322,25350],"text":""},"desc":"Remove unused variable 'renderStats'."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../../../context/AuthContext';\r\nimport { useNotifications } from '../../../context/NotificationContext';\r\nimport { NotificationBell } from '../../../components/Notifications';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { api } from '../../../services/apiClient';\r\nimport { mockApi } from '../../../services/mockApi'; // Keep for legacy operations\r\nimport {\r\n    ShoppingCart, Plus, Minus, Trash2, DollarSign, CreditCard,\r\n    Banknote, Search, Package, Wrench, BarChart3, Clock,\r\n    CheckCircle, User, LogOut, LayoutDashboard, Receipt,\r\n    X, ChevronRight, ChevronLeft, Phone, ArrowRight, Printer, RefreshCw, Timer\r\n} from 'lucide-react';\r\nimport { getDeviceName, getCustomerName, getBookingDate } from '../../../utils/schemaHelpers';\r\nimport './POSDashboard.css';\r\n\r\nconst POSDashboard = () => {\r\n    const { user, logout } = useAuth();\r\n    const { addNotification } = useNotifications();\r\n    const navigate = useNavigate();\r\n\r\n    const [activeView, setActiveView] = useState('pos');\r\n    const [products, setProducts] = useState([]);\r\n    const [repairsReady, setRepairsReady] = useState([]);\r\n    const [sales, setSales] = useState([]);\r\n    const [stats, setStats] = useState(null);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [categoryFilter, setCategoryFilter] = useState('all');\r\n    const [loading, setLoading] = useState(true);\r\n    const [autoRefresh, setAutoRefresh] = useState(true);\r\n    const [lastUpdate, setLastUpdate] = useState(new Date());\r\n    const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n\r\n    // Cart state\r\n    const [cart, setCart] = useState([]);\r\n    const [customerName, setCustomerName] = useState('Walk-in Customer');\r\n    const [discount, setDiscount] = useState(0);\r\n\r\n    // Checkout modal state\r\n    const [showCheckout, setShowCheckout] = useState(false);\r\n    const [paymentMethod, setPaymentMethod] = useState('Credit Card');\r\n    const [processing, setProcessing] = useState(false);\r\n\r\n    // Receipt modal state\r\n    const [showReceipt, setShowReceipt] = useState(false);\r\n    const [lastSale, setLastSale] = useState(null);\r\n\r\n    const TAX_RATE = 0.08; // 8% tax\r\n\r\n    useEffect(() => {\r\n        loadData();\r\n    }, []);\r\n\r\n    // Auto-refresh every 30 seconds\r\n    useEffect(() => {\r\n        if (!autoRefresh) return;\r\n        const interval = setInterval(() => {\r\n            loadData(false);\r\n        }, 30000);\r\n        return () => clearInterval(interval);\r\n    }, [autoRefresh]);\r\n\r\n    const loadData = async (showLoading = true) => {\r\n        if (showLoading) setLoading(true);\r\n        try {\r\n            const [productsData, repairsData, salesData, statsData] = await Promise.all([\r\n                mockApi.getStoreProducts(),\r\n                mockApi.getRepairsReadyForPickup(),\r\n                mockApi.getSales(),\r\n                mockApi.getSalesStats()\r\n            ]);\r\n            setProducts(productsData);\r\n            setRepairsReady(repairsData);\r\n            setSales(salesData);\r\n            setStats(statsData);\r\n            setLastUpdate(new Date());\r\n        } catch (error) {\r\n            console.error('Error loading data:', error);\r\n        }\r\n        if (showLoading) setLoading(false);\r\n    };\r\n\r\n\r\n    const handleLogout = () => {\r\n        logout();\r\n        navigate('/login');\r\n    };\r\n\r\n    const categories = ['all', ...new Set(products.map(p => p.category))];\r\n\r\n    const filteredProducts = products\r\n        .filter(p => categoryFilter === 'all' || p.category === categoryFilter)\r\n        .filter(p =>\r\n            searchTerm === '' ||\r\n            p.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            p.sku?.toLowerCase().includes(searchTerm.toLowerCase())\r\n        );\r\n\r\n    // Cart functions\r\n    const addToCart = (product) => {\r\n        const existing = cart.find(item => item.productId === product.id && item.type === 'product');\r\n        if (existing) {\r\n            if (existing.quantity >= product.quantity) {\r\n                alert('Not enough stock available');\r\n                return;\r\n            }\r\n            setCart(cart.map(item =>\r\n                item.productId === product.id && item.type === 'product'\r\n                    ? { ...item, quantity: item.quantity + 1, total: (item.quantity + 1) * item.price }\r\n                    : item\r\n            ));\r\n        } else {\r\n            if (product.quantity < 1) {\r\n                alert('Product out of stock');\r\n                return;\r\n            }\r\n            setCart([...cart, {\r\n                productId: product.id,\r\n                name: product.name,\r\n                price: product.price,\r\n                quantity: 1,\r\n                total: product.price,\r\n                type: 'product'\r\n            }]);\r\n        }\r\n    };\r\n\r\n    const addRepairToCart = (repair) => {\r\n        const existing = cart.find(item => item.bookingId === repair.id);\r\n        if (existing) {\r\n            alert('This repair is already in the cart');\r\n            return;\r\n        }\r\n        // Calculate repair price (using average of service price range)\r\n        const repairPrice = repair.costEstimate || 99; // Default price if not set\r\n        const deviceName = getDeviceName(repair.device);\r\n        const customerName = getCustomerName(repair.customer);\r\n        setCart([...cart, {\r\n            bookingId: repair.id,\r\n            name: `${deviceName} - ${repair.issue || repair.notes || 'Repair'}`,\r\n            price: repairPrice,\r\n            quantity: 1,\r\n            total: repairPrice,\r\n            type: 'repair',\r\n            customerName: customerName\r\n        }]);\r\n        // Auto-set customer name if not walk-in\r\n        if (customerName !== 'Unknown Customer' && customerName !== 'Walk-in Customer') {\r\n            setCustomerName(customerName);\r\n        }\r\n    };\r\n\r\n    const updateCartQuantity = (index, change) => {\r\n        const item = cart[index];\r\n        if (item.type === 'repair') return; // Can't change repair quantity\r\n\r\n        const newQuantity = item.quantity + change;\r\n        if (newQuantity < 1) {\r\n            removeFromCart(index);\r\n            return;\r\n        }\r\n\r\n        const product = products.find(p => p.id === item.productId);\r\n        if (product && newQuantity > product.quantity) {\r\n            alert('Not enough stock available');\r\n            return;\r\n        }\r\n\r\n        setCart(cart.map((cartItem, i) =>\r\n            i === index\r\n                ? { ...cartItem, quantity: newQuantity, total: newQuantity * cartItem.price }\r\n                : cartItem\r\n        ));\r\n    };\r\n\r\n    const removeFromCart = (index) => {\r\n        setCart(cart.filter((_, i) => i !== index));\r\n    };\r\n\r\n    const clearCart = () => {\r\n        setCart([]);\r\n        setCustomerName('Walk-in Customer');\r\n        setDiscount(0);\r\n    };\r\n\r\n    // Calculations\r\n    const subtotal = cart.reduce((sum, item) => sum + item.total, 0);\r\n    const discountAmount = (subtotal * discount) / 100;\r\n    const taxableAmount = subtotal - discountAmount;\r\n    const taxAmount = taxableAmount * TAX_RATE;\r\n    const total = taxableAmount + taxAmount;\r\n\r\n    // Checkout\r\n    const handleCheckout = async () => {\r\n        if (cart.length === 0) return;\r\n\r\n        setProcessing(true);\r\n        try {\r\n            // Determine sale type\r\n            const hasRepair = cart.some(item => item.type === 'repair');\r\n            const hasProduct = cart.some(item => item.type === 'product');\r\n            const saleType = hasRepair && hasProduct ? 'mixed' : hasRepair ? 'repair-pickup' : 'retail';\r\n\r\n            const saleData = {\r\n                items: cart.map(item => ({\r\n                    productId: item.productId || null,\r\n                    bookingId: item.bookingId || null,\r\n                    name: item.name,\r\n                    quantity: item.quantity,\r\n                    price: item.price,\r\n                    total: item.total\r\n                })),\r\n                subtotal,\r\n                tax: parseFloat(taxAmount.toFixed(2)),\r\n                discount: parseFloat(discountAmount.toFixed(2)),\r\n                total: parseFloat(total.toFixed(2)),\r\n                paymentMethod,\r\n                employeeId: user.id,\r\n                employeeName: user.name,\r\n                customerId: null,\r\n                customerName,\r\n                type: saleType\r\n            };\r\n\r\n            const newSale = await mockApi.addSale(saleData);\r\n\r\n            // Mark repairs as picked up\r\n            for (const item of cart) {\r\n                if (item.bookingId) {\r\n                    await mockApi.markRepairPickedUp(item.bookingId);\r\n                }\r\n            }\r\n\r\n            setLastSale(newSale);\r\n            setShowCheckout(false);\r\n            setShowReceipt(true);\r\n            clearCart();\r\n            await loadData(); // Refresh data\r\n\r\n        } catch (error) {\r\n            console.error('Error processing sale:', error);\r\n            alert('Failed to process sale. Please try again.');\r\n        }\r\n        setProcessing(false);\r\n    };\r\n\r\n    const renderSidebar = () => (\r\n        <aside className={`pos-sidebar ${sidebarCollapsed ? 'collapsed' : ''}`}>\r\n            <button\r\n                className=\"sidebar-toggle\"\r\n                onClick={() => setSidebarCollapsed(!sidebarCollapsed)}\r\n                title={sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'}\r\n            >\r\n                {sidebarCollapsed ? <ChevronRight size={16} /> : <ChevronLeft size={16} />}\r\n            </button>\r\n            <div className=\"sidebar-header\">\r\n                <div className=\"logo\">\r\n                    <ShoppingCart size={28} />\r\n                    <span>POS</span>\r\n                </div>\r\n            </div>\r\n\r\n            <nav className=\"sidebar-nav\">\r\n                <button\r\n                    className={`nav-item ${activeView === 'pos' ? 'active' : ''}`}\r\n                    onClick={() => setActiveView('pos')}\r\n                >\r\n                    <ShoppingCart size={20} />\r\n                    <span>Point of Sale</span>\r\n                </button>\r\n                <button\r\n                    className={`nav-item ${activeView === 'repairs' ? 'active' : ''}`}\r\n                    onClick={() => setActiveView('repairs')}\r\n                >\r\n                    <Wrench size={20} />\r\n                    <span>Repair Pickup</span>\r\n                    {repairsReady.length > 0 && (\r\n                        <span className=\"badge\">{repairsReady.length}</span>\r\n                    )}\r\n                </button>\r\n            </nav>\r\n\r\n\r\n            <div className=\"sidebar-footer\">\r\n                <div className=\"user-info\">\r\n                    <div className=\"user-avatar\">\r\n                        <User size={20} />\r\n                    </div>\r\n                    <div className=\"user-details\">\r\n                        <span className=\"user-name\">{user?.name}</span>\r\n                        <span className=\"user-role\">Cashier</span>\r\n                    </div>\r\n                </div>\r\n                <button className=\"logout-btn\" onClick={handleLogout}>\r\n                    <LogOut size={18} />\r\n                </button>\r\n            </div>\r\n        </aside>\r\n    );\r\n\r\n    const renderCart = () => (\r\n        <aside className=\"pos-cart\">\r\n            <div className=\"cart-header\">\r\n                <h2>Current Sale</h2>\r\n                {cart.length > 0 && (\r\n                    <button className=\"clear-cart\" onClick={clearCart}>\r\n                        <Trash2 size={16} />\r\n                        Clear\r\n                    </button>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"customer-input\">\r\n                <User size={18} />\r\n                <input\r\n                    type=\"text\"\r\n                    value={customerName}\r\n                    onChange={(e) => setCustomerName(e.target.value)}\r\n                    placeholder=\"Customer name...\"\r\n                />\r\n            </div>\r\n\r\n            <div className=\"cart-items\">\r\n                {cart.length === 0 ? (\r\n                    <div className=\"cart-empty\">\r\n                        <ShoppingCart size={48} />\r\n                        <p>Cart is empty</p>\r\n                        <span>Add products or repairs</span>\r\n                    </div>\r\n                ) : (\r\n                    cart.map((item, index) => (\r\n                        <div key={index} className={`cart-item ${item.type}`}>\r\n                            <div className=\"item-info\">\r\n                                <span className=\"item-name\">{item.name}</span>\r\n                                <span className=\"item-price\">${item.price.toFixed(2)}</span>\r\n                            </div>\r\n                            <div className=\"item-actions\">\r\n                                {item.type === 'product' ? (\r\n                                    <div className=\"quantity-controls\">\r\n                                        <button onClick={() => updateCartQuantity(index, -1)}>\r\n                                            <Minus size={14} />\r\n                                        </button>\r\n                                        <span>{item.quantity}</span>\r\n                                        <button onClick={() => updateCartQuantity(index, 1)}>\r\n                                            <Plus size={14} />\r\n                                        </button>\r\n                                    </div>\r\n                                ) : (\r\n                                    <span className=\"repair-badge\">Repair</span>\r\n                                )}\r\n                                <span className=\"item-total\">${item.total.toFixed(2)}</span>\r\n                                <button className=\"remove-btn\" onClick={() => removeFromCart(index)}>\r\n                                    <X size={16} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    ))\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"cart-summary\">\r\n                <div className=\"summary-row\">\r\n                    <span>Subtotal</span>\r\n                    <span>${subtotal.toFixed(2)}</span>\r\n                </div>\r\n                <div className=\"summary-row discount-row\">\r\n                    <div className=\"discount-input\">\r\n                        <span>Discount</span>\r\n                        <input\r\n                            type=\"number\"\r\n                            value={discount}\r\n                            onChange={(e) => setDiscount(Math.max(0, Math.min(100, parseFloat(e.target.value) || 0)))}\r\n                            min=\"0\"\r\n                            max=\"100\"\r\n                        />\r\n                        <span>%</span>\r\n                    </div>\r\n                    <span>-${discountAmount.toFixed(2)}</span>\r\n                </div>\r\n                <div className=\"summary-row\">\r\n                    <span>Tax (8%)</span>\r\n                    <span>${taxAmount.toFixed(2)}</span>\r\n                </div>\r\n                <div className=\"summary-row total\">\r\n                    <span>Total</span>\r\n                    <span>${total.toFixed(2)}</span>\r\n                </div>\r\n            </div>\r\n\r\n            <button\r\n                className=\"checkout-btn\"\r\n                onClick={() => setShowCheckout(true)}\r\n                disabled={cart.length === 0}\r\n            >\r\n                <CreditCard size={20} />\r\n                Checkout\r\n            </button>\r\n        </aside>\r\n    );\r\n\r\n    const renderPOS = () => (\r\n        <div className=\"pos-content\">\r\n            <div className=\"pos-header\">\r\n                <div className=\"search-box\">\r\n                    <Search size={18} />\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Search products...\"\r\n                        value={searchTerm}\r\n                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"category-tabs\">\r\n                {categories.map(cat => (\r\n                    <button\r\n                        key={cat}\r\n                        className={`category-tab ${categoryFilter === cat ? 'active' : ''}`}\r\n                        onClick={() => setCategoryFilter(cat)}\r\n                    >\r\n                        {cat === 'all' ? 'All' : cat.replace('-', ' ')}\r\n                    </button>\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"products-grid\">\r\n                {filteredProducts.map(product => (\r\n                    <button\r\n                        key={product.id}\r\n                        className={`product-card ${product.quantity < 1 ? 'out-of-stock' : ''}`}\r\n                        onClick={() => addToCart(product)}\r\n                        disabled={product.quantity < 1}\r\n                    >\r\n                        <div className=\"product-icon\">\r\n                            <Package size={24} />\r\n                        </div>\r\n                        <h3>{product.name}</h3>\r\n                        <p className=\"product-price\">${product.price.toFixed(2)}</p>\r\n                        <span className={`stock-badge ${product.quantity < 5 ? 'low' : ''}`}>\r\n                            {product.quantity < 1 ? 'Out of stock' : `${product.quantity} in stock`}\r\n                        </span>\r\n                    </button>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderRepairs = () => (\r\n        <div className=\"pos-content repairs-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Repairs Ready for Pickup</h1>\r\n                <button className=\"refresh-btn\" onClick={loadData}>\r\n                    <RefreshCw size={18} />\r\n                    Refresh\r\n                </button>\r\n            </div>\r\n\r\n            {repairsReady.length === 0 ? (\r\n                <div className=\"empty-state\">\r\n                    <CheckCircle size={64} />\r\n                    <h2>All Clear!</h2>\r\n                    <p>No repairs awaiting pickup at this time.</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"repairs-grid\">\r\n                    {repairsReady.map(repair => {\r\n                        const deviceName = getDeviceName(repair.device);\r\n                        const customerName = getCustomerName(repair.customer);\r\n                        return (\r\n                            <div key={repair.id} className=\"repair-card\">\r\n                                <div className=\"repair-header\">\r\n                                    <Wrench size={24} />\r\n                                    <span className=\"repair-id\">#{repair.id}</span>\r\n                                </div>\r\n                                <h3>{deviceName}</h3>\r\n                                <p className=\"repair-issue\">{repair.issue || repair.notes || ''}</p>\r\n                                <div className=\"repair-customer\">\r\n                                    <User size={16} />\r\n                                    <span>{customerName}</span>\r\n                                </div>\r\n                                <div className=\"repair-details\">\r\n                                    <div className=\"detail\">\r\n                                        <Clock size={14} />\r\n                                        <span>Completed: {repair.completedDate || getBookingDate(repair)}</span>\r\n                                    </div>\r\n                                    <div className=\"detail\">\r\n                                        <DollarSign size={14} />\r\n                                        <span>${repair.costEstimate || '99.00'}</span>\r\n                                    </div>\r\n                                </div>\r\n                                <button\r\n                                    className=\"add-to-cart-btn\"\r\n                                    onClick={() => addRepairToCart(repair)}\r\n                                >\r\n                                    <Plus size={18} />\r\n                                    Add to Sale\r\n                                </button>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n\r\n    const renderHistory = () => (\r\n        <div className=\"pos-content history-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Sales History</h1>\r\n            </div>\r\n\r\n            <div className=\"sales-list\">\r\n                {sales.slice().reverse().map(sale => (\r\n                    <div key={sale.id} className=\"sale-card\">\r\n                        <div className=\"sale-header\">\r\n                            <div className=\"sale-info\">\r\n                                <span className=\"sale-id\">{sale.receiptNumber}</span>\r\n                                <span className=\"sale-date\">{sale.date} at {sale.time}</span>\r\n                            </div>\r\n                            <span className={`sale-type ${sale.type}`}>\r\n                                {sale.type.replace('-', ' ')}\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"sale-details\">\r\n                            <div className=\"sale-customer\">\r\n                                <User size={16} />\r\n                                <span>{sale.customerName}</span>\r\n                            </div>\r\n                            <div className=\"sale-items-count\">\r\n                                {sale.items.length} item{sale.items.length !== 1 ? 's' : ''}\r\n                            </div>\r\n                            <div className=\"sale-payment\">\r\n                                <CreditCard size={16} />\r\n                                <span>{sale.paymentMethod}</span>\r\n                            </div>\r\n                            <div className=\"sale-total\">\r\n                                ${sale.total.toFixed(2)}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderStats = () => (\r\n        <div className=\"pos-content stats-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Sales Statistics</h1>\r\n            </div>\r\n\r\n            <div className=\"stats-grid\">\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon transactions\">\r\n                        <Receipt size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{stats?.totalTransactions || 0}</span>\r\n                        <span className=\"stat-label\">Total Transactions</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon revenue\">\r\n                        <DollarSign size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">${stats?.totalRevenue?.toFixed(2) || '0.00'}</span>\r\n                        <span className=\"stat-label\">Total Revenue</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon retail\">\r\n                        <ShoppingCart size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{stats?.retailTransactions || 0}</span>\r\n                        <span className=\"stat-label\">Retail Sales</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon repairs\">\r\n                        <Wrench size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{stats?.repairPickups || 0}</span>\r\n                        <span className=\"stat-label\">Repair Pickups</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon average\">\r\n                        <BarChart3 size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">${stats?.averageTransactionValue?.toFixed(2) || '0.00'}</span>\r\n                        <span className=\"stat-label\">Avg Transaction</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon repair-rev\">\r\n                        <DollarSign size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">${stats?.repairRevenue?.toFixed(2) || '0.00'}</span>\r\n                        <span className=\"stat-label\">Repair Revenue</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderCheckoutModal = () => (\r\n        <div className=\"modal-overlay\" onClick={() => setShowCheckout(false)}>\r\n            <div className=\"modal-content checkout-modal\" onClick={(e) => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Complete Sale</h2>\r\n                    <button className=\"modal-close\" onClick={() => setShowCheckout(false)}>\r\n                        <X size={24} />\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"modal-body\">\r\n                    <div className=\"checkout-summary\">\r\n                        <h3>Order Summary</h3>\r\n                        <div className=\"checkout-items\">\r\n                            {cart.map((item, index) => (\r\n                                <div key={index} className=\"checkout-item\">\r\n                                    <span>{item.name} x{item.quantity}</span>\r\n                                    <span>${item.total.toFixed(2)}</span>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                        <div className=\"checkout-totals\">\r\n                            <div className=\"total-row\">\r\n                                <span>Subtotal</span>\r\n                                <span>${subtotal.toFixed(2)}</span>\r\n                            </div>\r\n                            {discountAmount > 0 && (\r\n                                <div className=\"total-row discount\">\r\n                                    <span>Discount ({discount}%)</span>\r\n                                    <span>-${discountAmount.toFixed(2)}</span>\r\n                                </div>\r\n                            )}\r\n                            <div className=\"total-row\">\r\n                                <span>Tax</span>\r\n                                <span>${taxAmount.toFixed(2)}</span>\r\n                            </div>\r\n                            <div className=\"total-row grand-total\">\r\n                                <span>Total</span>\r\n                                <span>${total.toFixed(2)}</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"payment-methods\">\r\n                        <h3>Payment Method</h3>\r\n                        <div className=\"payment-options\">\r\n                            {['Credit Card', 'Debit Card', 'Cash', 'Apple Pay', 'Google Pay'].map(method => (\r\n                                <button\r\n                                    key={method}\r\n                                    className={`payment-option ${paymentMethod === method ? 'active' : ''}`}\r\n                                    onClick={() => setPaymentMethod(method)}\r\n                                >\r\n                                    {method === 'Cash' ? <Banknote size={20} /> : <CreditCard size={20} />}\r\n                                    <span>{method}</span>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"modal-footer\">\r\n                    <button className=\"btn-cancel\" onClick={() => setShowCheckout(false)}>\r\n                        Cancel\r\n                    </button>\r\n                    <button\r\n                        className=\"btn-complete\"\r\n                        onClick={handleCheckout}\r\n                        disabled={processing}\r\n                    >\r\n                        {processing ? 'Processing...' : `Complete Sale - $${total.toFixed(2)}`}\r\n                        <ArrowRight size={18} />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderReceiptModal = () => (\r\n        <div className=\"modal-overlay\" onClick={() => setShowReceipt(false)}>\r\n            <div className=\"modal-content receipt-modal\" onClick={(e) => e.stopPropagation()}>\r\n                <div className=\"receipt\">\r\n                    <div className=\"receipt-header\">\r\n                        <CheckCircle size={48} className=\"success-icon\" />\r\n                        <h2>Sale Complete!</h2>\r\n                        <p className=\"receipt-number\">{lastSale?.receiptNumber}</p>\r\n                    </div>\r\n\r\n                    <div className=\"receipt-body\">\r\n                        <div className=\"receipt-info\">\r\n                            <span>{lastSale?.date}</span>\r\n                            <span>{lastSale?.time}</span>\r\n                        </div>\r\n                        <div className=\"receipt-customer\">\r\n                            <User size={16} />\r\n                            <span>{lastSale?.customerName}</span>\r\n                        </div>\r\n\r\n                        <div className=\"receipt-items\">\r\n                            {lastSale?.items.map((item, index) => (\r\n                                <div key={index} className=\"receipt-item\">\r\n                                    <span>{item.name} x{item.quantity}</span>\r\n                                    <span>${item.total.toFixed(2)}</span>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n\r\n                        <div className=\"receipt-totals\">\r\n                            <div className=\"receipt-row\">\r\n                                <span>Subtotal</span>\r\n                                <span>${lastSale?.subtotal.toFixed(2)}</span>\r\n                            </div>\r\n                            {lastSale?.discount > 0 && (\r\n                                <div className=\"receipt-row\">\r\n                                    <span>Discount</span>\r\n                                    <span>-${lastSale?.discount.toFixed(2)}</span>\r\n                                </div>\r\n                            )}\r\n                            <div className=\"receipt-row\">\r\n                                <span>Tax</span>\r\n                                <span>${lastSale?.tax.toFixed(2)}</span>\r\n                            </div>\r\n                            <div className=\"receipt-row total\">\r\n                                <span>Total</span>\r\n                                <span>${lastSale?.total.toFixed(2)}</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"receipt-payment\">\r\n                            Paid with {lastSale?.paymentMethod}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"receipt-footer\">\r\n                        <p>Thank you for choosing SIFIXA!</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"receipt-actions\">\r\n                    <button className=\"btn-print\">\r\n                        <Printer size={18} />\r\n                        Print Receipt\r\n                    </button>\r\n                    <button className=\"btn-done\" onClick={() => setShowReceipt(false)}>\r\n                        Done\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"pos-loading\">\r\n                <div className=\"loader\"></div>\r\n                <p>Loading POS System...</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"pos-dashboard\">\r\n            {renderSidebar()}\r\n            <main className={`pos-main ${sidebarCollapsed ? 'expanded' : ''}`}>\r\n                {activeView === 'pos' && renderPOS()}\r\n                {activeView === 'repairs' && renderRepairs()}\r\n            </main>\r\n            {(activeView === 'pos' || activeView === 'repairs') && renderCart()}\r\n            {showCheckout && renderCheckoutModal()}\r\n            {showReceipt && renderReceiptModal()}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default POSDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\staff\\pages\\StaffLogin.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\systems\\staff\\pages\\SupportDashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'addNotification' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":20,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"addNotification"},"fix":{"range":[990,1037],"text":""},"desc":"Remove unused variable 'addNotification'."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadData` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  45 |\n  46 |     useEffect(() => {\n> 47 |         loadData();\n     |         ^^^^^^^^ `loadData` accessed before it is declared\n  48 |     }, []);\n  49 |\n  50 |     // Auto-refresh every 30 seconds\n\n  57 |     }, [autoRefresh]);\n  58 |\n> 59 |     const loadData = async (showLoading = true) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 60 |         if (showLoading) setLoading(true);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 61 |         try {\n     ΓÇª\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 78 |         if (showLoading) setLoading(false);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |     };\n     | ^^^^^^^ `loadData` is declared here\n  80 |\n  81 |\n  82 |     const handleLogout = () => {","line":47,"column":9,"nodeType":null,"endLine":47,"endColumn":17}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../../../context/AuthContext';\r\nimport { useNotifications } from '../../../context/NotificationContext';\r\nimport { NotificationBell } from '../../../components/Notifications';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { api } from '../../../services/apiClient';\r\nimport { mockApi } from '../../../services/mockApi'; // Keep for legacy operations\r\nimport {\r\n    MessageSquare, Send, Phone, Mail, Clock, User, Search,\r\n    FileText, CheckCircle, AlertCircle, XCircle, Filter,\r\n    ChevronDown, ChevronRight, ChevronLeft, RefreshCw, Bell, Calendar,\r\n    Smartphone, Laptop, Package, MessageCircle, LogOut,\r\n    Home, Users, Inbox, Settings, LayoutDashboard, Timer\r\n} from 'lucide-react';\r\nimport { getDeviceName, getCustomerName, getBookingDate } from '../../../utils/schemaHelpers';\r\nimport './SupportDashboard.css';\r\n\r\nconst SupportDashboard = () => {\r\n    const { user, logout } = useAuth();\r\n    const { addNotification } = useNotifications();\r\n    const navigate = useNavigate();\r\n\r\n    const [activeTab, setActiveTab] = useState('dashboard');\r\n    const [loading, setLoading] = useState(true);\r\n    const [stats, setStats] = useState(null);\r\n    const [bookings, setBookings] = useState([]);\r\n    const [customers, setCustomers] = useState([]);\r\n    const [messages, setMessages] = useState([]);\r\n    const [templates, setTemplates] = useState([]);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [statusFilter, setStatusFilter] = useState('all');\r\n    const [autoRefresh, setAutoRefresh] = useState(true);\r\n    const [lastUpdate, setLastUpdate] = useState(new Date());\r\n    const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n\r\n    // Message composition state\r\n    const [showMessageModal, setShowMessageModal] = useState(false);\r\n    const [selectedCustomer, setSelectedCustomer] = useState(null);\r\n    const [selectedBooking, setSelectedBooking] = useState(null);\r\n    const [selectedTemplate, setSelectedTemplate] = useState(null);\r\n    const [messageChannel, setMessageChannel] = useState('email');\r\n    const [messageSubject, setMessageSubject] = useState('');\r\n    const [messageContent, setMessageContent] = useState('');\r\n    const [sending, setSending] = useState(false);\r\n\r\n    useEffect(() => {\r\n        loadData();\r\n    }, []);\r\n\r\n    // Auto-refresh every 30 seconds\r\n    useEffect(() => {\r\n        if (!autoRefresh) return;\r\n        const interval = setInterval(() => {\r\n            loadData(false);\r\n        }, 30000);\r\n        return () => clearInterval(interval);\r\n    }, [autoRefresh]);\r\n\r\n    const loadData = async (showLoading = true) => {\r\n        if (showLoading) setLoading(true);\r\n        try {\r\n            const [statsData, bookingsData, customersData, messagesData, templatesData] = await Promise.all([\r\n                mockApi.getSupportStats(),\r\n                api.bookings.list(),\r\n                api.customers.list(),\r\n                mockApi.getCustomerMessages(),\r\n                mockApi.getMessageTemplates()\r\n            ]);\r\n            setStats(statsData);\r\n            setBookings(bookingsData);\r\n            setCustomers(customersData);\r\n            setMessages(messagesData);\r\n            setTemplates(templatesData);\r\n            setLastUpdate(new Date());\r\n        } catch (error) {\r\n            console.error('Error loading data:', error);\r\n        }\r\n        if (showLoading) setLoading(false);\r\n    };\r\n\r\n\r\n    const handleLogout = () => {\r\n        logout();\r\n        navigate('/login');\r\n    };\r\n\r\n    const getStatusColor = (status) => {\r\n        switch (status) {\r\n            case 'Pending': return 'status-pending';\r\n            case 'Confirmed': return 'status-confirmed';\r\n            case 'In Progress': return 'status-progress';\r\n            case 'Completed': return 'status-completed';\r\n            case 'Cancelled': return 'status-cancelled';\r\n            default: return '';\r\n        }\r\n    };\r\n\r\n    const filteredBookings = bookings\r\n        .filter(b => statusFilter === 'all' || b.status === statusFilter)\r\n        .filter(b =>\r\n            searchTerm === '' ||\r\n            getDeviceName(b.device).toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            getCustomerName(b.customer).toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            (b.issue || b.notes || '').toLowerCase().includes(searchTerm.toLowerCase())\r\n        )\r\n        .sort((a, b) => new Date(getBookingDate(b)) - new Date(getBookingDate(a)));\r\n\r\n    const openMessageModal = (customer, booking = null) => {\r\n        setSelectedCustomer(customer);\r\n        setSelectedBooking(booking);\r\n        setSelectedTemplate(null);\r\n        setMessageSubject('');\r\n        setMessageContent('');\r\n        setMessageChannel('email');\r\n        setShowMessageModal(true);\r\n    };\r\n\r\n    const handleTemplateSelect = (template) => {\r\n        setSelectedTemplate(template);\r\n\r\n        // Get data for template placeholders\r\n        const data = {\r\n            customerName: getCustomerName(selectedCustomer),\r\n            deviceName: getDeviceName(selectedBooking?.device),\r\n            serviceName: selectedBooking?.issue || selectedBooking?.notes || '',\r\n            estimatedDate: selectedBooking?.estimatedCompletion || 'TBD',\r\n            appointmentDate: getBookingDate(selectedBooking),\r\n            appointmentTime: selectedBooking?.timeSlot?.name || selectedBooking?.scheduledStart || selectedBooking?.time || ''\r\n        };\r\n\r\n        const filled = mockApi.fillMessageTemplate(template, data);\r\n        setMessageSubject(filled.subject);\r\n        setMessageContent(filled.message);\r\n    };\r\n\r\n    const handleSendMessage = async () => {\r\n        if (!selectedCustomer || !messageContent) return;\r\n\r\n        setSending(true);\r\n        try {\r\n            const messageData = {\r\n                customerId: selectedCustomer.id,\r\n                customerName: selectedCustomer.name,\r\n                customerEmail: selectedCustomer.email,\r\n                customerPhone: selectedCustomer.phone,\r\n                bookingId: selectedBooking?.id || null,\r\n                employeeId: user.id,\r\n                employeeName: user.name,\r\n                type: selectedTemplate?.type || 'custom',\r\n                subject: messageSubject,\r\n                message: messageContent,\r\n                channel: messageChannel\r\n            };\r\n\r\n            await mockApi.sendCustomerMessage(messageData);\r\n            await loadData(); // Refresh messages\r\n            setShowMessageModal(false);\r\n            alert('Message sent successfully!');\r\n        } catch (error) {\r\n            console.error('Error sending message:', error);\r\n            alert('Failed to send message');\r\n        }\r\n        setSending(false);\r\n    };\r\n\r\n    const renderSidebar = () => (\r\n        <aside className={`support-sidebar ${sidebarCollapsed ? 'collapsed' : ''}`}>\r\n            <button\r\n                className=\"sidebar-toggle\"\r\n                onClick={() => setSidebarCollapsed(!sidebarCollapsed)}\r\n                title={sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'}\r\n            >\r\n                {sidebarCollapsed ? <ChevronRight size={16} /> : <ChevronLeft size={16} />}\r\n            </button>\r\n            <div className=\"sidebar-header\">\r\n                <div className=\"logo\">\r\n                    <MessageSquare size={28} />\r\n                    <span>Support</span>\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <nav className=\"sidebar-nav\">\r\n                <button\r\n                    className={`nav-item ${activeTab === 'dashboard' ? 'active' : ''}`}\r\n                    onClick={() => setActiveTab('dashboard')}\r\n                >\r\n                    <LayoutDashboard size={20} />\r\n                    <span>Dashboard</span>\r\n                </button>\r\n                <button\r\n                    className={`nav-item ${activeTab === 'bookings' ? 'active' : ''}`}\r\n                    onClick={() => setActiveTab('bookings')}\r\n                >\r\n                    <Package size={20} />\r\n                    <span>Repairs</span>\r\n                </button>\r\n                <button\r\n                    className={`nav-item ${activeTab === 'customers' ? 'active' : ''}`}\r\n                    onClick={() => setActiveTab('customers')}\r\n                >\r\n                    <Users size={20} />\r\n                    <span>Customers</span>\r\n                </button>\r\n                <button\r\n                    className={`nav-item ${activeTab === 'messages' ? 'active' : ''}`}\r\n                    onClick={() => setActiveTab('messages')}\r\n                >\r\n                    <Inbox size={20} />\r\n                    <span>Messages</span>\r\n                </button>\r\n                <button\r\n                    className={`nav-item ${activeTab === 'templates' ? 'active' : ''}`}\r\n                    onClick={() => setActiveTab('templates')}\r\n                >\r\n                    <FileText size={20} />\r\n                    <span>Templates</span>\r\n                </button>\r\n            </nav>\r\n\r\n            <div className=\"sidebar-footer\">\r\n                <div className=\"user-info\">\r\n                    <div className=\"user-avatar\">\r\n                        <User size={20} />\r\n                    </div>\r\n                    <div className=\"user-details\">\r\n                        <span className=\"user-name\">{user?.name}</span>\r\n                        <span className=\"user-role\">Support</span>\r\n                    </div>\r\n                </div>\r\n                <button className=\"logout-btn\" onClick={handleLogout}>\r\n                    <LogOut size={18} />\r\n                </button>\r\n            </div>\r\n        </aside>\r\n    );\r\n\r\n    const renderDashboard = () => (\r\n        <div className=\"support-dashboard-content\">\r\n            <div className=\"dashboard-header\">\r\n                <h1>Support Dashboard</h1>\r\n                <div className=\"header-actions\">\r\n                    <div className=\"refresh-controls\">\r\n                        <button className=\"refresh-btn\" onClick={() => loadData(false)} title=\"Refresh now\">\r\n                            <RefreshCw size={18} />\r\n                        </button>\r\n                        <button\r\n                            className={`auto-refresh-btn ${autoRefresh ? 'active' : ''}`}\r\n                            onClick={() => setAutoRefresh(!autoRefresh)}\r\n                            title={autoRefresh ? 'Disable auto-refresh' : 'Enable auto-refresh'}\r\n                        >\r\n                            <Timer size={18} />\r\n                        </button>\r\n                        <span className=\"last-update\">\r\n                            Updated: {lastUpdate.toLocaleTimeString()}\r\n                        </span>\r\n                    </div>\r\n                    <NotificationBell />\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <div className=\"stats-grid\">\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon pending\">\r\n                        <Clock size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{stats?.pendingRepairs || 0}</span>\r\n                        <span className=\"stat-label\">Pending Repairs</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon progress\">\r\n                        <AlertCircle size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{stats?.inProgressRepairs || 0}</span>\r\n                        <span className=\"stat-label\">In Progress</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon completed\">\r\n                        <CheckCircle size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{stats?.completedToday || 0}</span>\r\n                        <span className=\"stat-label\">Completed Today</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon pickup\">\r\n                        <Package size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{stats?.awaitingPickup || 0}</span>\r\n                        <span className=\"stat-label\">Awaiting Pickup</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon messages\">\r\n                        <MessageCircle size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{stats?.messagesToday || 0}</span>\r\n                        <span className=\"stat-label\">Messages Today</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-icon total\">\r\n                        <Users size={24} />\r\n                    </div>\r\n                    <div className=\"stat-info\">\r\n                        <span className=\"stat-value\">{customers.length}</span>\r\n                        <span className=\"stat-label\">Total Customers</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"dashboard-sections\">\r\n                <section className=\"dashboard-section\">\r\n                    <h2>Recent Repairs</h2>\r\n                    <div className=\"recent-list\">\r\n                        {bookings.slice(0, 5).map(booking => {\r\n                            const deviceName = getDeviceName(booking.device);\r\n                            const customerName = getCustomerName(booking.customer);\r\n                            return (\r\n                                <div key={booking.id} className=\"recent-item\">\r\n                                    <div className=\"item-icon\">\r\n                                        {deviceName.includes('MacBook') || deviceName.includes('Laptop')\r\n                                            ? <Laptop size={20} />\r\n                                            : <Smartphone size={20} />\r\n                                        }\r\n                                    </div>\r\n                                    <div className=\"item-info\">\r\n                                        <span className=\"item-title\">{deviceName}</span>\r\n                                        <span className=\"item-subtitle\">{customerName} - {booking.issue || booking.notes || ''}</span>\r\n                                    </div>\r\n                                    <span className={`status-badge ${getStatusColor(booking.status)}`}>\r\n                                        {booking.status}\r\n                                    </span>\r\n                                    <button\r\n                                        className=\"action-btn\"\r\n                                        onClick={() => {\r\n                                            const customer = customers.find(c => c.name === customerName || c.email === booking.customer?.email);\r\n                                            if (customer) openMessageModal(customer, booking);\r\n                                        }}\r\n                                    >\r\n                                        <Send size={16} />\r\n                                    </button>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </section>\r\n\r\n                <section className=\"dashboard-section\">\r\n                    <h2>Recent Messages</h2>\r\n                    <div className=\"recent-list\">\r\n                        {messages.slice(0, 5).map(msg => (\r\n                            <div key={msg.id} className=\"recent-item\">\r\n                                <div className={`item-icon ${msg.channel}`}>\r\n                                    {msg.channel === 'email' ? <Mail size={20} /> : <Phone size={20} />}\r\n                                </div>\r\n                                <div className=\"item-info\">\r\n                                    <span className=\"item-title\">{msg.customerName}</span>\r\n                                    <span className=\"item-subtitle\">{msg.subject}</span>\r\n                                </div>\r\n                                <span className=\"message-time\">\r\n                                    {new Date(msg.sentAt).toLocaleDateString()}\r\n                                </span>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </section>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderBookings = () => (\r\n        <div className=\"support-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Repair Orders</h1>\r\n                <div className=\"header-actions\">\r\n                    <div className=\"search-box\">\r\n                        <Search size={18} />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search repairs...\"\r\n                            value={searchTerm}\r\n                            onChange={(e) => setSearchTerm(e.target.value)}\r\n                        />\r\n                    </div>\r\n                    <select\r\n                        className=\"filter-select\"\r\n                        value={statusFilter}\r\n                        onChange={(e) => setStatusFilter(e.target.value)}\r\n                    >\r\n                        <option value=\"all\">All Status</option>\r\n                        <option value=\"Pending\">Pending</option>\r\n                        <option value=\"Confirmed\">Confirmed</option>\r\n                        <option value=\"In Progress\">In Progress</option>\r\n                        <option value=\"Completed\">Completed</option>\r\n                        <option value=\"Cancelled\">Cancelled</option>\r\n                    </select>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"bookings-list\">\r\n                {filteredBookings.map(booking => {\r\n                    const deviceName = getDeviceName(booking.device);\r\n                    const customerName = getCustomerName(booking.customer);\r\n                    return (\r\n                        <div key={booking.id} className=\"booking-card\">\r\n                            <div className=\"booking-header\">\r\n                                <div className=\"booking-device\">\r\n                                    {deviceName.includes('MacBook') || deviceName.includes('Laptop')\r\n                                        ? <Laptop size={24} />\r\n                                        : <Smartphone size={24} />\r\n                                    }\r\n                                    <div>\r\n                                        <h3>{deviceName}</h3>\r\n                                        <p>{booking.issue || booking.notes || ''}</p>\r\n                                    </div>\r\n                                </div>\r\n                                <span className={`status-badge ${getStatusColor(booking.status)}`}>\r\n                                    {booking.status}\r\n                                </span>\r\n                            </div>\r\n                            <div className=\"booking-details\">\r\n                                <div className=\"detail\">\r\n                                    <User size={16} />\r\n                                    <span>{customerName}</span>\r\n                                </div>\r\n                                <div className=\"detail\">\r\n                                    <Calendar size={16} />\r\n                                    <span>{getBookingDate(booking)}</span>\r\n                                </div>\r\n                                <div className=\"detail\">\r\n                                    <Clock size={16} />\r\n                                    <span>{booking.timeSlot?.name || booking.scheduledStart || booking.time || ''}</span>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"booking-actions\">\r\n                                <button\r\n                                    className=\"btn-contact\"\r\n                                    onClick={() => {\r\n                                        const customer = customers.find(c => c.name === customerName || c.email === booking.customer?.email);\r\n                                        if (customer) openMessageModal(customer, booking);\r\n                                    }}\r\n                                >\r\n                                    <Send size={16} />\r\n                                    Contact Customer\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderCustomers = () => (\r\n        <div className=\"support-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Customers</h1>\r\n                <div className=\"search-box\">\r\n                    <Search size={18} />\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Search customers...\"\r\n                        value={searchTerm}\r\n                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"customers-grid\">\r\n                {customers\r\n                    .filter(c =>\r\n                        searchTerm === '' ||\r\n                        c.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                        c.email.toLowerCase().includes(searchTerm.toLowerCase())\r\n                    )\r\n                    .map(customer => (\r\n                        <div key={customer.id} className=\"customer-card\">\r\n                            <div className=\"customer-avatar\">\r\n                                <User size={32} />\r\n                            </div>\r\n                            <div className=\"customer-info\">\r\n                                <h3>{customer.name}</h3>\r\n                                <p className=\"customer-email\">\r\n                                    <Mail size={14} />\r\n                                    {customer.email}\r\n                                </p>\r\n                                <p className=\"customer-phone\">\r\n                                    <Phone size={14} />\r\n                                    {customer.phone}\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"customer-stats\">\r\n                                <div className=\"stat\">\r\n                                    <span className=\"stat-value\">{customer.totalBookings}</span>\r\n                                    <span className=\"stat-label\">Repairs</span>\r\n                                </div>\r\n                                <div className=\"stat\">\r\n                                    <span className=\"stat-value\">${customer.totalSpent}</span>\r\n                                    <span className=\"stat-label\">Spent</span>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"customer-actions\">\r\n                                <button\r\n                                    className=\"btn-message\"\r\n                                    onClick={() => openMessageModal(customer)}\r\n                                >\r\n                                    <MessageSquare size={16} />\r\n                                    Message\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderMessages = () => (\r\n        <div className=\"support-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Message History</h1>\r\n            </div>\r\n\r\n            <div className=\"messages-list\">\r\n                {messages.map(msg => (\r\n                    <div key={msg.id} className=\"message-card\">\r\n                        <div className=\"message-header\">\r\n                            <div className=\"message-recipient\">\r\n                                <div className={`channel-badge ${msg.channel}`}>\r\n                                    {msg.channel === 'email' ? <Mail size={16} /> : <Phone size={16} />}\r\n                                    {msg.channel.toUpperCase()}\r\n                                </div>\r\n                                <h3>{msg.customerName}</h3>\r\n                            </div>\r\n                            <span className=\"message-time\">\r\n                                {new Date(msg.sentAt).toLocaleString()}\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"message-content\">\r\n                            <p className=\"message-subject\">{msg.subject}</p>\r\n                            <p className=\"message-body\">{msg.message}</p>\r\n                        </div>\r\n                        <div className=\"message-meta\">\r\n                            <span className=\"sent-by\">Sent by: {msg.employeeName}</span>\r\n                            <span className={`message-status ${msg.status}`}>\r\n                                {msg.status === 'sent' ? <CheckCircle size={14} /> : <Clock size={14} />}\r\n                                {msg.status}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderTemplates = () => (\r\n        <div className=\"support-content\">\r\n            <div className=\"content-header\">\r\n                <h1>Message Templates</h1>\r\n            </div>\r\n\r\n            <div className=\"templates-grid\">\r\n                {templates.map(template => (\r\n                    <div key={template.id} className=\"template-card\">\r\n                        <div className=\"template-header\">\r\n                            <h3>{template.name}</h3>\r\n                            <div className=\"template-channels\">\r\n                                {template.channels.map(ch => (\r\n                                    <span key={ch} className={`channel-tag ${ch}`}>\r\n                                        {ch === 'email' ? <Mail size={12} /> : <Phone size={12} />}\r\n                                    </span>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"template-content\">\r\n                            <p className=\"template-subject\">{template.subject}</p>\r\n                            <p className=\"template-body\">{template.message}</p>\r\n                        </div>\r\n                        <div className=\"template-type\">\r\n                            <span className={`type-badge ${template.type}`}>{template.type}</span>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderMessageModal = () => (\r\n        <div className=\"modal-overlay\" onClick={() => setShowMessageModal(false)}>\r\n            <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h2>Send Message</h2>\r\n                    <button className=\"modal-close\" onClick={() => setShowMessageModal(false)}>\r\n                        <XCircle size={24} />\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"modal-body\">\r\n                    <div className=\"recipient-info\">\r\n                        <User size={20} />\r\n                        <span>{selectedCustomer?.name}</span>\r\n                        {selectedBooking && (\r\n                            <span className=\"booking-ref\">Re: {getDeviceName(selectedBooking.device)} - {selectedBooking.issue || selectedBooking.notes || ''}</span>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Channel</label>\r\n                        <div className=\"channel-options\">\r\n                            <button\r\n                                className={`channel-btn ${messageChannel === 'email' ? 'active' : ''}`}\r\n                                onClick={() => setMessageChannel('email')}\r\n                            >\r\n                                <Mail size={18} />\r\n                                Email\r\n                            </button>\r\n                            <button\r\n                                className={`channel-btn ${messageChannel === 'sms' ? 'active' : ''}`}\r\n                                onClick={() => setMessageChannel('sms')}\r\n                            >\r\n                                <Phone size={18} />\r\n                                SMS\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Use Template</label>\r\n                        <select\r\n                            value={selectedTemplate?.id || ''}\r\n                            onChange={(e) => {\r\n                                const template = templates.find(t => t.id === parseInt(e.target.value));\r\n                                if (template) handleTemplateSelect(template);\r\n                            }}\r\n                        >\r\n                            <option value=\"\">Select a template...</option>\r\n                            {templates.map(t => (\r\n                                <option key={t.id} value={t.id}>{t.name}</option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Subject</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={messageSubject}\r\n                            onChange={(e) => setMessageSubject(e.target.value)}\r\n                            placeholder=\"Message subject...\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Message</label>\r\n                        <textarea\r\n                            value={messageContent}\r\n                            onChange={(e) => setMessageContent(e.target.value)}\r\n                            placeholder=\"Type your message...\"\r\n                            rows={6}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"modal-footer\">\r\n                    <button className=\"btn-cancel\" onClick={() => setShowMessageModal(false)}>\r\n                        Cancel\r\n                    </button>\r\n                    <button\r\n                        className=\"btn-send\"\r\n                        onClick={handleSendMessage}\r\n                        disabled={sending || !messageContent}\r\n                    >\r\n                        {sending ? 'Sending...' : 'Send Message'}\r\n                        <Send size={16} />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"support-loading\">\r\n                <div className=\"loader\"></div>\r\n                <p>Loading Support Dashboard...</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"support-dashboard\">\r\n            {renderSidebar()}\r\n            <main className={`support-main ${sidebarCollapsed ? 'expanded' : ''}`}>\r\n\r\n                {activeTab === 'dashboard' && renderDashboard()}\r\n                {activeTab === 'bookings' && renderBookings()}\r\n                {activeTab === 'customers' && renderCustomers()}\r\n                {activeTab === 'messages' && renderMessages()}\r\n                {activeTab === 'templates' && renderTemplates()}\r\n            </main>\r\n            {showMessageModal && renderMessageModal()}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SupportDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\utils\\pdfGenerator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\utils\\schemaHelpers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\src\\utils\\validation.js","messages":[{"ruleId":"no-control-regex","severity":2,"message":"Unexpected control character(s) in regular expression: \\x00, \\x08, \\x0b, \\x0c, \\x0e, \\x1f.","line":32,"column":26,"nodeType":"Literal","messageId":"unexpected","endLine":32,"endColumn":61}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Input validation utilities\r\n\r\n// Validate and sanitize phone number - only numbers allowed\r\nexport const validatePhone = (value) => {\r\n    return value.replace(/[^0-9]/g, '');\r\n};\r\n\r\n// Validate name - letters, spaces, and common name characters only\r\nexport const validateName = (value) => {\r\n    return value.replace(/[^a-zA-Z\\s'-]/g, '');\r\n};\r\n\r\n// Validate username - alphanumeric and underscore only\r\nexport const validateUsername = (value) => {\r\n    return value.replace(/[^a-zA-Z0-9_]/g, '').toLowerCase();\r\n};\r\n\r\n// Validate price - numbers and decimal only\r\nexport const validatePrice = (value) => {\r\n    const cleaned = value.replace(/[^0-9.]/g, '');\r\n    // Ensure only one decimal point\r\n    const parts = cleaned.split('.');\r\n    if (parts.length > 2) {\r\n        return parts[0] + '.' + parts.slice(1).join('');\r\n    }\r\n    return cleaned;\r\n};\r\n\r\n// Validate text - remove potentially dangerous characters\r\nexport const validateText = (value) => {\r\n    // Remove control characters and null bytes\r\n    return value.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F]/g, '');\r\n};\r\n\r\n// Sanitize email - allow valid email characters\r\nexport const validateEmail = (value) => {\r\n    return value.replace(/[^a-zA-Z0-9@._+-]/g, '').toLowerCase();\r\n};\r\n\r\n// Validate email format\r\nexport const isValidEmail = (email) => {\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return emailRegex.test(email);\r\n};\r\n\r\n// Validate that a phone number has reasonable length\r\nexport const isValidPhone = (phone) => {\r\n    const cleaned = phone.replace(/\\D/g, '');\r\n    return cleaned.length >= 10 && cleaned.length <= 15;\r\n};\r\n\r\n// Validate booking ID format\r\nexport const validateBookingId = (value) => {\r\n    return value.replace(/[^a-zA-Z0-9-]/g, '').toUpperCase();\r\n};\r\n\r\n// Validate numbers only\r\nexport const validateNumbersOnly = (value) => {\r\n    return value.replace(/[^0-9]/g, '');\r\n};\r\n\r\n// Validate percentage (0-100)\r\nexport const validatePercentage = (value) => {\r\n    const num = parseFloat(value);\r\n    if (isNaN(num)) return '';\r\n    if (num < 0) return '0';\r\n    if (num > 100) return '100';\r\n    return value;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\slema\\.gemini\\antigravity\\scratch\\mobile-repair-shop\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
